(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/3d/webgl-engine/lib/Util":1490,"esri/core/tsSupport/generatorHelper":1516,"esri/views/3d/support/imageUtils":1525,"esri/views/webgl/ShaderSnippets":1637,"esri/views/2d/engine/webgl/WGLDisplayRecord":1649,"esri/core/libs/gl-matrix/mat4":1661,"esri/views/2d/engine/webgl/util/serializationUtils":1665,"esri/views/2d/engine/webgl/Geometry":1666,"esri/views/2d/engine/webgl/GeometryUtils":1667,"esri/views/webgl/ShaderVariations":1678,"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":1679,"esri/core/HandleOwner":1680,"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":1681,"esri/views/2d/engine/webgl/shaders/glShaderSnippets":1692,"esri/core/libs/gl-matrix/vec4":1693,"esri/views/2d/engine/webgl/Rect":1698,"esri/views/2d/engine/webgl/MaterialInfo":1708,"esri/views/2d/engine/webgl/MaterialKeyInfo":1709,"esri/core/libs/gl-matrix/vec3":1710,"esri/views/2d/engine/webgl/brushes/WGLBrush":1720,"esri/views/2d/engine/webgl/MaterialInfoUtils":1721,"esri/views/2d/engine/webgl/collisions/BoundingBox":1723,"esri/views/2d/engine/webgl/TextShaping":1728,"esri/views/2d/engine/webgl/TileClipper":1729,"esri/views/2d/engine/webgl/util/Writer":1735,"esri/views/2d/engine/webgl/WGLPainter":1798,"esri/views/2d/engine/webgl/MaterialInfoUtils_updateMaterialVariations":1799,"esri/views/2d/engine/webgl/WGLDisplayObject":1800,"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":1801,"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":1802,"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":1803,"esri/views/2d/engine/webgl/util/vvFlagUtils":1804,"esri/views/2d/engine/webgl/LineTess":1811,"dojo/text!esri/views/2d/engine/webgl/shaders/tileInfo.xml":1813,"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":1815,"esri/views/2d/engine/webgl/util/BidiText":1816,"esri/views/2d/engine/webgl/fontUtils":1817,"esri/views/2d/engine/StageGL":1850,"esri/views/2d/engine/webgl/Fader":1851,"esri/views/2d/engine/webgl/BitBlitRenderer":1852,"dojo/text!esri/views/2d/engine/webgl/shaders/backgroundShaders.xml":1853,"dojo/text!esri/views/2d/engine/webgl/shaders/bitblitShaders.xml":1854,"dojo/text!esri/views/2d/engine/webgl/shaders/stencilShaders.xml":1855,"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":1856,"esri/views/2d/engine/webgl/MaterialManager":1857,"esri/views/2d/engine/webgl/shaders/iconShaderSnippets":1858,"dojo/text!esri/views/2d/engine/webgl/shaders/iconShaders.xml":1859,"esri/views/2d/engine/webgl/shaders/fillShaderSnippets":1860,"dojo/text!esri/views/2d/engine/webgl/shaders/fillShaders.xml":1861,"esri/views/2d/engine/webgl/shaders/labelShaderSnippets":1862,"dojo/text!esri/views/2d/engine/webgl/shaders/labelShaders.xml":1863,"esri/views/2d/engine/webgl/shaders/lineShaderSnippets":1864,"dojo/text!esri/views/2d/engine/webgl/shaders/lineShaders.xml":1865,"esri/views/2d/engine/webgl/shaders/textShaderSnippets":1866,"dojo/text!esri/views/2d/engine/webgl/shaders/textShaders.xml":1867,"esri/views/webgl/ShaderSourceVariator":1868,"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":1869,"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":1870,"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":1871,"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":1872,"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":1873,"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":1874,"esri/views/2d/engine/webgl/painter/WGLHighlightPainter":1875,"esri/views/2d/engine/webgl/painter/highlight/HighlightRenderer":1876,"esri/views/2d/engine/webgl/shaders/hlShaderSnippets":1877,"dojo/text!esri/views/2d/engine/webgl/shaders/hlShaders.xml":1878,"esri/views/2d/engine/webgl/painter/highlight/HighlightSurfaces":1879,"esri/views/2d/engine/webgl/MeshData":1885,"esri/views/2d/engine/webgl/collisions/Metric":1886,"esri/views/2d/engine/webgl/mesh/VertexVector":1887,"esri/views/2d/engine/webgl/mesh/templates/meshTemplateUtils":1888,"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":1889,"esri/views/2d/engine/webgl/mesh/Tesselator":1890,"esri/core/libs/libtess/libtess":1891,"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":1892,"esri/views/2d/engine/webgl/util/Matcher":1893,"esri/views/2d/engine/webgl/WGLDisplayList":1894,"esri/views/2d/layers/features/tileRenderers/BaseTileRenderer":1895,"esri/views/2d/engine/webgl/SDFHelper":1950,"esri/views/2d/engine/webgl/RectangleBinPack":1951,"esri/views/2d/layers/features/tileRenderers/SymbolTileRenderer":2342,"esri/views/2d/engine/webgl/WGLFeatureView":2343,"esri/views/2d/engine/webgl/TileData":2344,"esri/views/2d/engine/webgl/MemoryRequirements":2345,"esri/views/2d/engine/webgl/TileBufferData":2346,"esri/views/2d/engine/webgl/TileDisplayData":2347,"esri/views/2d/engine/webgl/mesh/VertexBuffer":2348,"esri/views/2d/engine/webgl/util/Reader":2349,"esri/views/2d/engine/webgl/TextureManager":2350,"esri/views/2d/engine/webgl/CIMSymbolHelper":2351,"esri/views/2d/engine/webgl/CIMSymbolDrawHelper":2352,"esri/views/2d/engine/webgl/GlyphMosaic":2353,"esri/views/2d/engine/webgl/GlyphSource":2354,"esri/views/2d/engine/webgl/SpriteMosaic":2355,"esri/views/2d/engine/webgl/WGLRendererInfo":2356,"esri/views/2d/engine/webgl/WGLTile":2357,"esri/views/2d/engine/webgl/DisplayRecordStore":2358,"esri/views/2d/engine/webgl/FreeList":2359,"esri/views/2d/engine/webgl/DirtyMap":2360,"esri/views/2d/engine/webgl/WGLBuffers":2361})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{1490:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1513),i(1491)],void 0===(n=function(e,t,i,r){function n(e,t){if(!e){var i=new Error("dummy");throw i.stack&&console.log(i.stack),new C(t)}}function o(e,t,i){return e<t?t:e>i?i:e}function a(e){return e/180*Math.PI}function s(e){return 180*e/Math.PI}function l(e,t,i){r.mat4d.multiply(t,e,v),r.mat4d.inverse(v);for(var n=0;n<8;++n)r.mat4d.multiplyVec4(v,_[n],m),r.vec3d.set3(m[0]/m[3],m[1]/m[3],m[2]/m[3],i[n])}function u(e,t){i.plane.fromPoints(e[4],e[0],e[3],t[0]),i.plane.fromPoints(e[1],e[5],e[6],t[1]),i.plane.fromPoints(e[4],e[5],e[1],t[2]),i.plane.fromPoints(e[3],e[2],e[6],t[3]),i.plane.fromPoints(e[0],e[1],e[2],t[4]),i.plane.fromPoints(e[5],e[4],e[7],t[5])}function h(e,i,r,n){var o=6378137/Math.sqrt(1-t.ECCENTRICITY_SQUARED*Math.pow(Math.sin(e),2)),a=Math.cos(e);n[0]=(o+r)*Math.cos(i)*a,n[1]=(o*(1-t.ECCENTRICITY_SQUARED)+r)*Math.sin(e),n[2]=-(o+r)*Math.sin(i)*a}function d(e){for(var t in e)return t}function c(e,t){e[12]=t[0],e[13]=t[1],e[14]=t[2]}function f(e,t){void 0===t&&(t=0);for(var i=0,r=0;r<4;r++)i+=e[t+r]*P[r];return i}function p(e){return e-Math.floor(e)}Object.defineProperty(t,"__esModule",{value:!0});var v=r.mat4d.create(),_=[r.vec4d.createFrom(-1,-1,-1,1),r.vec4d.createFrom(1,-1,-1,1),r.vec4d.createFrom(1,1,-1,1),r.vec4d.createFrom(-1,1,-1,1),r.vec4d.createFrom(-1,-1,1,1),r.vec4d.createFrom(1,-1,1,1),r.vec4d.createFrom(1,1,1,1),r.vec4d.createFrom(-1,1,1,1)],m=r.vec4d.create(),g=[r.vec3d.create(),r.vec3d.create(),r.vec3d.create(),r.vec3d.create(),r.vec3d.create(),r.vec3d.create(),r.vec3d.create(),r.vec3d.create()],y=r.vec3d.create(),x=r.vec3d.create(),S=r.vec3d.create(),V=r.vec3d.create(),I=r.vec3d.create(),b=r.vec3d.create(),w=r.vec3d.create(),M=r.vec3d.create(),T=r.vec3d.create(),E=r.vec3d.create(),L=r.vec3d.create(),D=r.vec3d.create(),F=r.vec3d.create(),O=r.vec3d.createFrom(0,0,0),C=function(){function e(e){this.message=e}return e.prototype.toString=function(){return"AssertException: "+this.message},e}();t.AssertException=C,t.EARTH_RADIUS=6378137,t.METER2FEET=3.28084,t.ECCENTRICITY_SQUARED=.0066943799901414,t.VertexAttrConstants={POSITION:"position",NORMAL:"normal",NORMALCOMPRESSED:"normalCompressed",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",COLOR:"color",SYMBOLCOLOR:"symbolColor",SIZE:"size",REGION:"region",COMPONENTINDEX:"componentIndex"},t.assert=n,t.verify=function(e,t){e||(console.log("Verify failed: "+t),console.log(new Error("dummy").stack))},t.isPowerOfTwo=function(e){return 0==(e&e-1)},t.lerp=function(e,t,i){return e+(t-e)*i},t.clamp=o,t.encodeInt16=function(e){return o(Math.round(32767*e),-32767,32767)},t.encodeNormal=function(e,t){var i=Math.abs(e[0]),r=Math.abs(e[1]),n=1/(i+r+Math.abs(e[2])),o=i*n,a=r*n,s=Math.min(e[2]*n,0);t[0]=A(e[0])*(o-s),t[1]=A(e[1])*(a-s)};var A="function"==typeof Math.sign?Math.sign:function(e){return+(e>0)-+(e<0)||0};t.fallbackIfUndefined=function(e,t){return void 0===e?t:e},t.hex2rgb=function(e){return[((e=Math.floor(e))>>16&255)/255,(e>>8&255)/255,(255&e)/255]},t.rgb2hex=function(e){return"0x"+((o(Math.round(255*e[0]),0,255)<<16)+(o(Math.round(255*e[1]),0,255)<<8)+o(Math.round(255*e[2]),0,255)).toString(16)},t.dec2hex=function(e){var t=e.toString(16);return"00000000".substr(0,8-t.length)+t},t.deg2rad=a,t.rad2deg=s,t.azimuthElevationAngle2Direction=function(e,t){var i=1.5*Math.PI-e,r=.5*Math.PI-t;return[Math.cos(i)*Math.sin(r),Math.cos(r),Math.sin(i)*Math.sin(r)]},t.raySphere=function(e,t,i,n,o){i=i||O;var a=r.vec3d.subtract(e,i,y),s=r.vec3d.dot(t,t),l=2*r.vec3d.dot(t,a),u=l*l-4*s*(r.vec3d.dot(a,a)-n*n);if(u<0)return!1;var h=Math.sqrt(u),d=(-l-h)/(2*s),c=(-l+h)/(2*s);return(d<0||c<d&&c>0)&&(d=c),d>0&&(o&&r.vec3d.add(e,r.vec3d.scale(t,d,F),o),!0)},t.rayTriangle3D=function(e,t,i,n,o,a,s,l,u){void 0===u&&(u=r.vec3d.create());var h=n[s]-i[a],d=n[s+1]-i[a+1],c=n[s+2]-i[a+2],f=o[l]-i[a],p=o[l+1]-i[a+1],v=o[l+2]-i[a+2],_=t[1]*v-p*t[2],m=t[2]*f-v*t[0],g=t[0]*p-f*t[1],y=h*_+d*m+c*g;if(y>-1e-5&&y<1e-5)return!1;var x=1/y,S=e[0]-i[a],V=e[1]-i[a+1],I=e[2]-i[a+2];if(u[1]=x*(S*_+V*m+I*g),u[1]<0||u[1]>1)return!1;var b=V*c-d*I,w=I*h-c*S,M=S*d-h*V;return u[2]=x*(t[0]*b+t[1]*w+t[2]*M),!(u[2]<0||u[1]+u[2]>1||(u[0]=x*(f*b+p*w+v*M),0))},t.rayBoxTest=function(e,t,i,r){var n,o=(i[0]-e[0])/t[0],a=(r[0]-e[0])/t[0];o>a&&(n=o,o=a,a=n);var s=(i[1]-e[1])/t[1],l=(r[1]-e[1])/t[1];if(s>l&&(n=s,s=l,l=n),o>l||s>a)return!1;s>o&&(o=s),l<a&&(a=l);var u=(i[2]-e[2])/t[2],h=(r[2]-e[2])/t[2];return u>h&&(n=u,u=h,h=n),!(o>h||u>a||(h<a&&(a=h),a<0))},t.rayRay2D=function(e,t,i,n,o,a){void 0===a&&(a=r.vec2d.create());var s=(n[o]-i[o])*(t[0]-e[0])-(n[0]-i[0])*(t[o]-e[o]),l=(n[0]-i[0])*(e[o]-i[o])-(n[o]-i[o])*(e[0]-i[0]);if(0===s)return!1;var u=l/s;return a[0]=e[0]+u*(t[0]-e[0]),a[1]=e[o]+u*(t[o]-e[o]),!0},t.matrixToFrustumPoints=l,t.matrixToFrustumPlanes=function(e,t,i,r){void 0===r&&(r=i,i=g),l(e,t,i),u(i,r)},t.frustumPointsToPlanes=u,t.project=function(e,t,i,o,a){a||(a=e),m[0]=e[0],m[1]=e[1],m[2]=e[2],m[3]=1,r.mat4d.multiplyVec4(t,m),a.length>2&&(a[2]=-m[2]),r.mat4d.multiplyVec4(i,m),n(0!==m[3]),a[0]=m[0]/m[3],a[1]=m[1]/m[3],a[2]=m[2]/m[3],a[0]=(.5*a[0]+.5)*o[2]+o[0],a[1]=(.5*a[1]+.5)*o[3]+o[1]},t.geodeticToGeocentricLatidude=function(e){return Math.atan((1-t.ECCENTRICITY_SQUARED)*Math.tan(e))},t.latLon2positionWGS84Ellipsoid=h,t.pos2latLon=function(e,t){var i=r.vec3d.length(e);t[0]=Math.asin(o(e[1]/i,-1,1));var n=Math.cos(t[0]);t[1]=(e[2]<0?1:-1)*Math.acos(o(e[0]/(n*i),-1,1)),t[0]=s(t[0]),t[1]=s(t[1]),t[2]=i},t.pos2latLonWGS84Ellipsoid=function(e,i){var r=6378137,n=e[0],o=-e[2],a=e[1],s=Math.sqrt(Math.pow(r,2)*(1-t.ECCENTRICITY_SQUARED)),l=Math.sqrt((Math.pow(r,2)-Math.pow(s,2))/Math.pow(s,2)),u=Math.sqrt(Math.pow(n,2)+Math.pow(o,2)),h=Math.atan2(r*a,s*u),d=Math.atan2(o,n),c=Math.atan2(a+Math.pow(l,2)*s*Math.pow(Math.sin(h),3),u-t.ECCENTRICITY_SQUARED*r*Math.pow(Math.cos(h),3)),f=r/Math.sqrt(1-t.ECCENTRICITY_SQUARED*Math.pow(Math.sin(c),2)),p=u/Math.cos(c)-f+t.EARTH_RADIUS;i[0]=c,i[1]=d,i[2]=p},t.computeGlobeTransformation=function(e,t,i){var n=a(e[0]),o=a(e[1]);return h(n,o,t,x),r.mat4d.translate(i,x),r.mat4d.rotateY(i,.5*Math.PI+o),r.mat4d.rotateX(i,.5*Math.PI-n),i},t.readUInt16=function(e,t){return e[t]+(e[t+1]<<8)},t.readUInt32=function(e,t){return e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24)},t.setIfDefined=function(e,t,i){void 0!==t[e]&&(i[e]=t[e])},t.array2object=function(e,t){var i={};if(void 0!==t)for(var r=0,n=e;r<n.length;r++)i[t(s=n[r])]=s;else for(var o=0,a=e;o<a.length;o++){var s;i[s=a[o]]=s}return i},t.object2array=function(e){var t=[];for(var i in e)t.push(e[i]);return t},t.mergeObjects=function(e,t,i){if(void 0===i&&(i={}),i!==e)for(var r in e)i[r]=e[r];if(i!==t)for(var n in t)i[n]=t[n];return i},t.subtractObjects=function(e,t){var i={};for(var r in e)void 0===t[r]&&(i[r]=e[r]);return i},t.intersectObjects=function(e,t){var i={};for(var r in e)void 0!==t[r]&&(i[r]=e[r]);return i},t.getFirstObjectKey=d,t.getFirstObjectValue=function(e){return e[d(e)]},t.objectEmpty=function(e){for(var t in e)return!1;return!0},t.byteBuffer2base64image=function(e,t,i,r,o){var a=4*t;n(e.length===a*i,"buffer length must match image resolution");var s=document.createElement("canvas");s.width=t,s.height=i;for(var l=s.getContext("2d"),u=l.getImageData(0,0,t,i),h=u.data,d=0;d<i;++d)for(var c=d*a,f=(i-1-d)*a,p=0;p<a;++p)h[c++]=e[f++];return l.putImageData(u,0,0),s.toDataURL(r,o)},t.cround=function(e){return Math.round(100*e)/100},t.logWithBase=function(e,t){return Math.log(e)/Math.log(t)},t.setMatrixTranslation=c,t.setMatrixTranslation3=function(e,t,i,r){e[12]=t,e[13]=i,e[14]=r},t.getMatrixTranslation=function(e,t){return void 0===t&&(t=r.vec3d.create()),t[0]=e[12],t[1]=e[13],t[2]=e[14],t},t.createTranslationMatrix=function(e,t){return c(e=r.mat4d.identity(e),t),e},t.isTranslationMatrix=function(e){return 1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&1===e[15]},t.fovx2fovy=function(e,t,i){return 2*Math.atan(i*Math.tan(.5*e)/t)},t.fovy2fovx=function(e,t,i){return 2*Math.atan(t*Math.tan(.5*e)/i)},t.fovx2fovd=function(e,t,i){return 2*Math.atan(Math.sqrt(t*t+i*i)*Math.tan(.5*e)/t)},t.fovy2fovd=function(e,t,i){return 2*Math.atan(Math.sqrt(t*t+i*i)*Math.tan(.5*e)/i)},t.fovd2fovx=function(e,t,i){return 2*Math.atan(t*Math.tan(.5*e)/Math.sqrt(t*t+i*i))},t.fovd2fovy=function(e,t,i){return 2*Math.atan(i*Math.tan(.5*e)/Math.sqrt(t*t+i*i))},t.nextHighestPowerOfTwo=function(e){--e;for(var t=1;t<32;t<<=1)e|=e>>t;return e+1},t.nextHighestPowerOfTen=function(e){return Math.pow(10,Math.ceil(Math.LOG10E*Math.log(e)))},t.lineLineDistanceSquared3D=function(e,t,i,n,a){var s=S,l=V;if(s[0]=e[0]-i[0],s[1]=e[1]-i[1],s[2]=e[2]-i[2],l[0]=n[0]-i[0],l[1]=n[1]-i[1],l[2]=n[2]-i[2],Math.abs(l[0])<1e-4&&Math.abs(l[1])<1e-4&&Math.abs(l[2])<1e-4)return a.success=!1,a;var u=I;if(u[0]=t[0]-e[0],u[1]=t[1]-e[1],u[2]=t[2]-e[2],Math.abs(u[0])<1e-4&&Math.abs(u[1])<1e-4&&Math.abs(u[2])<1e-4)return a.success=!1,a;var h=s[0]*l[0]+s[1]*l[1]+s[2]*l[2],d=l[0]*u[0]+l[1]*u[1]+l[2]*u[2],c=s[0]*u[0]+s[1]*u[1]+s[2]*u[2],f=l[0]*l[0]+l[1]*l[1]+l[2]*l[2],p=(u[0]*u[0]+u[1]*u[1]+u[2]*u[2])*f-d*d;if(Math.abs(p)<1e-4)return a.success=!1,a;var v=o((h*d-c*f)/p,0,1),_=o((h+d*v)/f,0,1),m=b,g=w;m[0]=e[0]+v*u[0],m[1]=e[1]+v*u[1],m[2]=e[2]+v*u[2],g[0]=i[0]+_*l[0],g[1]=i[1]+_*l[1],g[2]=i[2]+_*l[2];var y=r.vec3d.dist2(m,g);return a.success=!0,a.dist2=y,a.pa=m,a.pb=g,a},t.pointLineSegmentDistanceSquared2D=function(e,t,i){var n=L,a=D,s=F,l=E,u=M,h=T;n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=0,a[0]=i[0]-e[0],a[1]=i[1]-e[1],a[2]=0,s[0]=i[0],s[1]=i[1],s[2]=0;var d=o(r.vec2d.dot(a,n)/r.vec2d.dot(n,n),0,1);l[0]=n[0]*d,l[1]=n[1]*d,u[0]=e[0]+l[0],u[1]=e[1]+l[1],r.vec2d.subtract(s,u,h);var c=r.vec2d.dot(h,h),f=r.vec2d.dot(a,a),p=r.vec2d.dot(n,n),v=r.vec2d.dot(l,l);return(v>f||v>p)&&(c=Number.MAX_VALUE),c},t.packFloatRGBA=function(e,t,i){void 0===i&&(i=0);for(var r=o(e,0,R),n=0;n<4;n++)t[i+n]=Math.floor(256*p(r*z[n]))},t.unpackFloatRGBA=f;var z=[1,256,65536,16777216],P=[1/256,1/65536,1/16777216,1/4294967296],R=f(new Uint8ClampedArray([255,255,255,255]));t.inverseProjectionInfo=function(e,t,i,n,o){var a=e;0===e[11]?(n[0]=2/(t*a[0]),n[1]=2/(i*a[5]),n[2]=(1+a[12])/a[0],n[3]=(1+a[13])/a[5],r.vec2d.set2(0,1,o)):(n[0]=-2/(t*a[0]),n[1]=-2/(i*a[5]),n[2]=(1-a[8])/a[0],n[3]=(1-a[9])/a[5],r.vec2d.set2(1,0,o))}}.apply(null,r))||(e.exports=n)},1516:function(e,t,i){var r;void 0===(r=function(){return function(e,t){function i(e){return function(t){return r([e,t])}}function r(i){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,o&&(a=2&i[0]?o.return:i[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,i[1])).done)return a;switch(o=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!(a=(a=l.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){l.label=i[1];break}if(6===i[0]&&l.label<a[1]){l.label=a[1],a=i;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(i);break}a[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(e){i=[6,e],o=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var n,o,a,s,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s}}.apply(null,[]))||(e.exports=r)},1525:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(21)],void 0===(n=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.dataURItoBlob=function(e){for(var t=atob(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),n=new Uint8Array(r),o=0;o<t.length;o++)n[o]=t.charCodeAt(o);return new Blob([r],{type:i})},t.requestImage=function(e){return i(e,{responseType:"image",allowImageDataAccess:!0}).then(function(e){return e.data})}}.apply(null,r))||(e.exports=n)},1637:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1663)],void 0===(n=function(e,t,i){return function(){function e(e){if(e)for(var t in e)this[t]=e[t]}return e.parse=function(e,t){for(var r=i.parse(e).getElementsByTagName("snippet"),n=/\$[a-zA-Z][a-zA-Z0-9]*(?:\([^\(\)]*\))?[ \t]*/,o=/[\$\s]+/g,a=/\(([^\(\)]*)\)/,s=0;s<r.length;s++){for(var l=r[s].getAttribute("name"),u=r[s].textContent;;){var h=u.match(n);if(null==h)break;var d=h[0].replace(o,""),c=d.match(a),f=void 0;c&&(f=c[1].split(",").map(function(e){return e.trim()}));var p=d.replace(a,""),v=t._instantiate(p,f);u=u.replace(h[0],v)}t[l]=u}},e.prototype._instantiate=function(e,t){var i=this[e];for(t||(t=[]);;){var r=i.match(/\$(\d+)/);if(null==r)break;var n=t[parseInt(r[1],10)];i=i.replace(r[0],n)}return i},e}()}.apply(null,r))||(e.exports=n)},1649:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(9),i(1885)],void 0===(n=function(e,t,i,r){var n=i.getLogger("esri/views/2d/engine/webgl/WGLDisplayRecord");return function(){function e(e,t,i){this.id=e,this.geometryType=t,this._materialInfo=i,this.meshData=null,this.symbolLevel=0,this.zOrder=0,this.vertexFrom=0,this.vertexCount=0,this.indexFrom=0,this.indexCount=0}return Object.defineProperty(e.prototype,"sortKey",{get:function(){return void 0===this._sortKey&&this._computeSortKey(),this._sortKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"materialInfo",{get:function(){return"number"==typeof this._materialInfo?(n.warn("Tried to read materialInfo, but found an index! Was materialInfo deserialized correctly?"),null):this._materialInfo},set:function(e){this._materialInfo=e},enumerable:!0,configurable:!0}),e.prototype.copy=function(){var t=new e(this.id,this.geometryType,this._materialInfo);return t.vertexFrom=this.vertexFrom,t.vertexCount=this.vertexCount,t.indexFrom=this.indexFrom,t.indexCount=this.indexCount,t.zOrder=this.zOrder,t.symbolLevel=this.symbolLevel,t.meshData=this.meshData,t},e.prototype.setMeshDataFromBuffers=function(e,t,i){var n=new r;for(var o in t){for(var a=t[o].stride,s=t[o].data,l=[],u=0;u<a*e.vertexCount/4;++u)l[u]=s[u+a*e.vertexFrom/4];n.vertexData.set(o,l)}n.indexData.length=0;for(u=0;u<e.indexCount;++u)n.indexData[u]=i[u+e.indexFrom]-e.vertexFrom;n.vertexCount=e.vertexCount,this.meshData=n},e.prototype.readMeshDataFromBuffers=function(e,t){for(var i in this.meshData?this.meshData.clear():this.meshData=new r,e){for(var n=e[i].stride,o=e[i].data,a=[],s=0;s<n*this.vertexCount/4;++s)a[s]=o[s+n*this.vertexFrom/4];this.meshData.vertexData.set(i,a)}this.meshData.indexData.length=0;for(s=0;s<this.indexCount;++s)this.meshData.indexData[s]=t[s+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount},e.prototype.writeMeshDataToBuffers=function(e,t,i,r){for(var n in t)for(var o=t[n].stride,a=this.meshData.vertexData.get(n),s=t[n].data,l=0;l<o*this.meshData.vertexCount/4;++l)s[l+o*e/4]=a[l];for(l=0;l<this.meshData.indexData.length;++l)r[l+i]=this.meshData.indexData[l]+e;this.vertexFrom=e,this.vertexCount=this.meshData.vertexCount,this.indexFrom=i,this.indexCount=this.meshData.indexData.length},e.writeAllMeshDataToBuffers=function(e,t,i){for(var r=0,n=0,o=0,a=e;o<a.length;o++){var s=a[o];s.writeMeshDataToBuffers(r,t,n,i),r+=s.vertexCount,n+=s.indexCount}},e.prototype._computeSortKey=function(){this._sortKey=(31&this.symbolLevel)<<12|(127&this.zOrder)<<4|7&this.geometryType},e.prototype.serialize=function(e){return e.writeInt32(this.geometryType),e.writeInt32(this._materialInfo),e.writeInt32(this.symbolLevel),e.writeInt32(this.zOrder),e.writeInt32(this.vertexFrom),e.writeInt32(this.vertexCount),e.writeInt32(this.indexFrom),e.writeInt32(this.indexCount),e},e.deserialize=function(t,i){var r=t.readInt32(),n=i.store&&i.store.get(t.readInt32())||t.readInt32(),o=new e(i.id,r,n);return o.symbolLevel=t.readInt32(),o.zOrder=t.readInt32(),o.vertexFrom=t.readInt32(),o.vertexCount=t.readInt32(),o.indexFrom=t.readInt32(),o.indexCount=t.readInt32(),o},e}()}.apply(null,r))||(e.exports=n)},1661:function(e,t,i){var r,n;r=[i(259)],void 0===(n=function(e){var t={scalar:{},SIMD:{},create:function(){var t=new e.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},clone:function(t){var i=new e.ARRAY_TYPE(16);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},fromValues:function(t,i,r,n,o,a,s,l,u,h,d,c,f,p,v,_){var m=new e.ARRAY_TYPE(16);return m[0]=t,m[1]=i,m[2]=r,m[3]=n,m[4]=o,m[5]=a,m[6]=s,m[7]=l,m[8]=u,m[9]=h,m[10]=d,m[11]=c,m[12]=f,m[13]=p,m[14]=v,m[15]=_,m},set:function(e,t,i,r,n,o,a,s,l,u,h,d,c,f,p,v,_){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e[4]=o,e[5]=a,e[6]=s,e[7]=l,e[8]=u,e[9]=h,e[10]=d,e[11]=c,e[12]=f,e[13]=p,e[14]=v,e[15]=_,e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}};return t.scalar.transpose=function(e,t){if(e===t){var i=t[1],r=t[2],n=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=i,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=n,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.SIMD.transpose=function(e,t){var i,r,n,o,a,s,l,u,h,d;return i=SIMD.Float32x4.load(t,0),r=SIMD.Float32x4.load(t,4),n=SIMD.Float32x4.load(t,8),o=SIMD.Float32x4.load(t,12),a=SIMD.Float32x4.shuffle(i,r,0,1,4,5),s=SIMD.Float32x4.shuffle(n,o,0,1,4,5),l=SIMD.Float32x4.shuffle(a,s,0,2,4,6),u=SIMD.Float32x4.shuffle(a,s,1,3,5,7),SIMD.Float32x4.store(e,0,l),SIMD.Float32x4.store(e,4,u),a=SIMD.Float32x4.shuffle(i,r,2,3,6,7),s=SIMD.Float32x4.shuffle(n,o,2,3,6,7),h=SIMD.Float32x4.shuffle(a,s,0,2,4,6),d=SIMD.Float32x4.shuffle(a,s,1,3,5,7),SIMD.Float32x4.store(e,8,h),SIMD.Float32x4.store(e,12,d),e},t.transpose=e.USE_SIMD?t.SIMD.transpose:t.scalar.transpose,t.scalar.invert=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],h=t[8],d=t[9],c=t[10],f=t[11],p=t[12],v=t[13],_=t[14],m=t[15],g=i*s-r*a,y=i*l-n*a,x=i*u-o*a,S=r*l-n*s,V=r*u-o*s,I=n*u-o*l,b=h*v-d*p,w=h*_-c*p,M=h*m-f*p,T=d*_-c*v,E=d*m-f*v,L=c*m-f*_,D=g*L-y*E+x*T+S*M-V*w+I*b;return D?(D=1/D,e[0]=(s*L-l*E+u*T)*D,e[1]=(n*E-r*L-o*T)*D,e[2]=(v*I-_*V+m*S)*D,e[3]=(c*V-d*I-f*S)*D,e[4]=(l*M-a*L-u*w)*D,e[5]=(i*L-n*M+o*w)*D,e[6]=(_*x-p*I-m*y)*D,e[7]=(h*I-c*x+f*y)*D,e[8]=(a*E-s*M+u*b)*D,e[9]=(r*M-i*E-o*b)*D,e[10]=(p*V-v*x+m*g)*D,e[11]=(d*x-h*V-f*g)*D,e[12]=(s*w-a*T-l*b)*D,e[13]=(i*T-r*w+n*b)*D,e[14]=(v*y-p*S-_*g)*D,e[15]=(h*S-d*y+c*g)*D,e):null},t.SIMD.invert=function(e,t){var i,r,n,o,a,s,l,u,h,d,c=SIMD.Float32x4.load(t,0),f=SIMD.Float32x4.load(t,4),p=SIMD.Float32x4.load(t,8),v=SIMD.Float32x4.load(t,12);return a=SIMD.Float32x4.shuffle(c,f,0,1,4,5),r=SIMD.Float32x4.shuffle(p,v,0,1,4,5),i=SIMD.Float32x4.shuffle(a,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,a,1,3,5,7),a=SIMD.Float32x4.shuffle(c,f,2,3,6,7),o=SIMD.Float32x4.shuffle(p,v,2,3,6,7),n=SIMD.Float32x4.shuffle(a,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,a,1,3,5,7),a=SIMD.Float32x4.mul(n,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.mul(r,a),l=SIMD.Float32x4.mul(i,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,a),s),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),a=SIMD.Float32x4.mul(r,n),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),s),h=SIMD.Float32x4.mul(i,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(o,a)),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),a=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,3,0,1),o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),n=SIMD.Float32x4.swizzle(n,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,a),s),u=SIMD.Float32x4.mul(i,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(n,a)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),a=SIMD.Float32x4.mul(i,r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),u),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),h),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),u),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(n,a)),a=SIMD.Float32x4.mul(i,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(n,a)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),u),a=SIMD.Float32x4.swizzle(a,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,a),l),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(r,a)),a=SIMD.Float32x4.mul(i,n),a=SIMD.Float32x4.swizzle(a,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),l),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(r,a)),a=SIMD.Float32x4.swizzle(a,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(o,a)),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),h),d=SIMD.Float32x4.mul(i,s),d=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(d,2,3,0,1),d),d=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(d,1,0,3,2),d),a=SIMD.Float32x4.reciprocalApproximation(d),d=SIMD.Float32x4.sub(SIMD.Float32x4.add(a,a),SIMD.Float32x4.mul(d,SIMD.Float32x4.mul(a,a))),(d=SIMD.Float32x4.swizzle(d,0,0,0,0))?(SIMD.Float32x4.store(e,0,SIMD.Float32x4.mul(d,s)),SIMD.Float32x4.store(e,4,SIMD.Float32x4.mul(d,l)),SIMD.Float32x4.store(e,8,SIMD.Float32x4.mul(d,u)),SIMD.Float32x4.store(e,12,SIMD.Float32x4.mul(d,h)),e):null},t.invert=e.USE_SIMD?t.SIMD.invert:t.scalar.invert,t.scalar.adjoint=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],h=t[8],d=t[9],c=t[10],f=t[11],p=t[12],v=t[13],_=t[14],m=t[15];return e[0]=s*(c*m-f*_)-d*(l*m-u*_)+v*(l*f-u*c),e[1]=-(r*(c*m-f*_)-d*(n*m-o*_)+v*(n*f-o*c)),e[2]=r*(l*m-u*_)-s*(n*m-o*_)+v*(n*u-o*l),e[3]=-(r*(l*f-u*c)-s*(n*f-o*c)+d*(n*u-o*l)),e[4]=-(a*(c*m-f*_)-h*(l*m-u*_)+p*(l*f-u*c)),e[5]=i*(c*m-f*_)-h*(n*m-o*_)+p*(n*f-o*c),e[6]=-(i*(l*m-u*_)-a*(n*m-o*_)+p*(n*u-o*l)),e[7]=i*(l*f-u*c)-a*(n*f-o*c)+h*(n*u-o*l),e[8]=a*(d*m-f*v)-h*(s*m-u*v)+p*(s*f-u*d),e[9]=-(i*(d*m-f*v)-h*(r*m-o*v)+p*(r*f-o*d)),e[10]=i*(s*m-u*v)-a*(r*m-o*v)+p*(r*u-o*s),e[11]=-(i*(s*f-u*d)-a*(r*f-o*d)+h*(r*u-o*s)),e[12]=-(a*(d*_-c*v)-h*(s*_-l*v)+p*(s*c-l*d)),e[13]=i*(d*_-c*v)-h*(r*_-n*v)+p*(r*c-n*d),e[14]=-(i*(s*_-l*v)-a*(r*_-n*v)+p*(r*l-n*s)),e[15]=i*(s*c-l*d)-a*(r*c-n*d)+h*(r*l-n*s),e},t.SIMD.adjoint=function(e,t){var i,r,n,o,a,s,l,u,h,d=SIMD.Float32x4.load(t,0),c=SIMD.Float32x4.load(t,4),f=SIMD.Float32x4.load(t,8),p=SIMD.Float32x4.load(t,12);return a=SIMD.Float32x4.shuffle(d,c,0,1,4,5),r=SIMD.Float32x4.shuffle(f,p,0,1,4,5),i=SIMD.Float32x4.shuffle(a,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,a,1,3,5,7),a=SIMD.Float32x4.shuffle(d,c,2,3,6,7),o=SIMD.Float32x4.shuffle(f,p,2,3,6,7),n=SIMD.Float32x4.shuffle(a,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,a,1,3,5,7),a=SIMD.Float32x4.mul(n,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.mul(r,a),l=SIMD.Float32x4.mul(i,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,a),s),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),a=SIMD.Float32x4.mul(r,n),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),s),h=SIMD.Float32x4.mul(i,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(o,a)),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),a=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,3,0,1),o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),n=SIMD.Float32x4.swizzle(n,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,a),s),u=SIMD.Float32x4.mul(i,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(n,a)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),a=SIMD.Float32x4.mul(i,r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),u),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),h),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),u),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(n,a)),a=SIMD.Float32x4.mul(i,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(n,a)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),u),a=SIMD.Float32x4.swizzle(a,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,a),l),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(r,a)),a=SIMD.Float32x4.mul(i,n),a=SIMD.Float32x4.swizzle(a,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),l),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(r,a)),a=SIMD.Float32x4.swizzle(a,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(o,a)),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),h),SIMD.Float32x4.store(e,0,s),SIMD.Float32x4.store(e,4,l),SIMD.Float32x4.store(e,8,u),SIMD.Float32x4.store(e,12,h),e},t.adjoint=e.USE_SIMD?t.SIMD.adjoint:t.scalar.adjoint,t.determinant=function(e){var t=e[0],i=e[1],r=e[2],n=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],h=e[9],d=e[10],c=e[11],f=e[12],p=e[13],v=e[14],_=e[15];return(t*a-i*o)*(d*_-c*v)-(t*s-r*o)*(h*_-c*p)+(t*l-n*o)*(h*v-d*p)+(i*s-r*a)*(u*_-c*f)-(i*l-n*a)*(u*v-d*f)+(r*l-n*s)*(u*p-h*f)},t.SIMD.multiply=function(e,t,i){var r=SIMD.Float32x4.load(t,0),n=SIMD.Float32x4.load(t,4),o=SIMD.Float32x4.load(t,8),a=SIMD.Float32x4.load(t,12),s=SIMD.Float32x4.load(i,0),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),a))));SIMD.Float32x4.store(e,0,l);var u=SIMD.Float32x4.load(i,4),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),a))));SIMD.Float32x4.store(e,4,h);var d=SIMD.Float32x4.load(i,8),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),a))));SIMD.Float32x4.store(e,8,c);var f=SIMD.Float32x4.load(i,12),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),a))));return SIMD.Float32x4.store(e,12,p),e},t.scalar.multiply=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],h=t[7],d=t[8],c=t[9],f=t[10],p=t[11],v=t[12],_=t[13],m=t[14],g=t[15],y=i[0],x=i[1],S=i[2],V=i[3];return e[0]=y*r+x*s+S*d+V*v,e[1]=y*n+x*l+S*c+V*_,e[2]=y*o+x*u+S*f+V*m,e[3]=y*a+x*h+S*p+V*g,y=i[4],x=i[5],S=i[6],V=i[7],e[4]=y*r+x*s+S*d+V*v,e[5]=y*n+x*l+S*c+V*_,e[6]=y*o+x*u+S*f+V*m,e[7]=y*a+x*h+S*p+V*g,y=i[8],x=i[9],S=i[10],V=i[11],e[8]=y*r+x*s+S*d+V*v,e[9]=y*n+x*l+S*c+V*_,e[10]=y*o+x*u+S*f+V*m,e[11]=y*a+x*h+S*p+V*g,y=i[12],x=i[13],S=i[14],V=i[15],e[12]=y*r+x*s+S*d+V*v,e[13]=y*n+x*l+S*c+V*_,e[14]=y*o+x*u+S*f+V*m,e[15]=y*a+x*h+S*p+V*g,e},t.multiply=e.USE_SIMD?t.SIMD.multiply:t.scalar.multiply,t.mul=t.multiply,t.scalar.translate=function(e,t,i){var r,n,o,a,s,l,u,h,d,c,f,p,v=i[0],_=i[1],m=i[2];return t===e?(e[12]=t[0]*v+t[4]*_+t[8]*m+t[12],e[13]=t[1]*v+t[5]*_+t[9]*m+t[13],e[14]=t[2]*v+t[6]*_+t[10]*m+t[14],e[15]=t[3]*v+t[7]*_+t[11]*m+t[15]):(r=t[0],n=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],h=t[7],d=t[8],c=t[9],f=t[10],p=t[11],e[0]=r,e[1]=n,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=u,e[7]=h,e[8]=d,e[9]=c,e[10]=f,e[11]=p,e[12]=r*v+s*_+d*m+t[12],e[13]=n*v+l*_+c*m+t[13],e[14]=o*v+u*_+f*m+t[14],e[15]=a*v+h*_+p*m+t[15]),e},t.SIMD.translate=function(e,t,i){var r=SIMD.Float32x4.load(t,0),n=SIMD.Float32x4.load(t,4),o=SIMD.Float32x4.load(t,8),a=SIMD.Float32x4.load(t,12),s=SIMD.Float32x4(i[0],i[1],i[2],0);t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11]),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(s,0,0,0,0)),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(s,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,2,2,2,2));var l=SIMD.Float32x4.add(r,SIMD.Float32x4.add(n,SIMD.Float32x4.add(o,a)));return SIMD.Float32x4.store(e,12,l),e},t.translate=e.USE_SIMD?t.SIMD.translate:t.scalar.translate,t.scalar.scale=function(e,t,i){var r=i[0],n=i[1],o=i[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.SIMD.scale=function(e,t,i){var r,n,o,a=SIMD.Float32x4(i[0],i[1],i[2],0);return r=SIMD.Float32x4.load(t,0),SIMD.Float32x4.store(e,0,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(a,0,0,0,0))),n=SIMD.Float32x4.load(t,4),SIMD.Float32x4.store(e,4,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(a,1,1,1,1))),o=SIMD.Float32x4.load(t,8),SIMD.Float32x4.store(e,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(a,2,2,2,2))),e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.scale=e.USE_SIMD?t.SIMD.scale:t.scalar.scale,t.rotate=function(t,i,r,n){var o,a,s,l,u,h,d,c,f,p,v,_,m,g,y,x,S,V,I,b,w,M,T,E,L=n[0],D=n[1],F=n[2],O=Math.sqrt(L*L+D*D+F*F);return Math.abs(O)<e.EPSILON?null:(L*=O=1/O,D*=O,F*=O,o=Math.sin(r),s=1-(a=Math.cos(r)),l=i[0],u=i[1],h=i[2],d=i[3],c=i[4],f=i[5],p=i[6],v=i[7],_=i[8],m=i[9],g=i[10],y=i[11],x=L*L*s+a,S=D*L*s+F*o,V=F*L*s-D*o,I=L*D*s-F*o,b=D*D*s+a,w=F*D*s+L*o,M=L*F*s+D*o,T=D*F*s-L*o,E=F*F*s+a,t[0]=l*x+c*S+_*V,t[1]=u*x+f*S+m*V,t[2]=h*x+p*S+g*V,t[3]=d*x+v*S+y*V,t[4]=l*I+c*b+_*w,t[5]=u*I+f*b+m*w,t[6]=h*I+p*b+g*w,t[7]=d*I+v*b+y*w,t[8]=l*M+c*T+_*E,t[9]=u*M+f*T+m*E,t[10]=h*M+p*T+g*E,t[11]=d*M+v*T+y*E,i!==t&&(t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t)},t.scalar.rotateX=function(e,t,i){var r=Math.sin(i),n=Math.cos(i),o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],h=t[9],d=t[10],c=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*n+u*r,e[5]=a*n+h*r,e[6]=s*n+d*r,e[7]=l*n+c*r,e[8]=u*n-o*r,e[9]=h*n-a*r,e[10]=d*n-s*r,e[11]=c*n-l*r,e},t.SIMD.rotateX=function(e,t,i){var r=SIMD.Float32x4.splat(Math.sin(i)),n=SIMD.Float32x4.splat(Math.cos(i));t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var o=SIMD.Float32x4.load(t,4),a=SIMD.Float32x4.load(t,8);return SIMD.Float32x4.store(e,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(a,r))),SIMD.Float32x4.store(e,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,n),SIMD.Float32x4.mul(o,r))),e},t.rotateX=e.USE_SIMD?t.SIMD.rotateX:t.scalar.rotateX,t.scalar.rotateY=function(e,t,i){var r=Math.sin(i),n=Math.cos(i),o=t[0],a=t[1],s=t[2],l=t[3],u=t[8],h=t[9],d=t[10],c=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*n-u*r,e[1]=a*n-h*r,e[2]=s*n-d*r,e[3]=l*n-c*r,e[8]=o*r+u*n,e[9]=a*r+h*n,e[10]=s*r+d*n,e[11]=l*r+c*n,e},t.SIMD.rotateY=function(e,t,i){var r=SIMD.Float32x4.splat(Math.sin(i)),n=SIMD.Float32x4.splat(Math.cos(i));t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var o=SIMD.Float32x4.load(t,0),a=SIMD.Float32x4.load(t,8);return SIMD.Float32x4.store(e,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(a,r))),SIMD.Float32x4.store(e,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(a,n))),e},t.rotateY=e.USE_SIMD?t.SIMD.rotateY:t.scalar.rotateY,t.scalar.rotateZ=function(e,t,i){var r=Math.sin(i),n=Math.cos(i),o=t[0],a=t[1],s=t[2],l=t[3],u=t[4],h=t[5],d=t[6],c=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*n+u*r,e[1]=a*n+h*r,e[2]=s*n+d*r,e[3]=l*n+c*r,e[4]=u*n-o*r,e[5]=h*n-a*r,e[6]=d*n-s*r,e[7]=c*n-l*r,e},t.SIMD.rotateZ=function(e,t,i){var r=SIMD.Float32x4.splat(Math.sin(i)),n=SIMD.Float32x4.splat(Math.cos(i));t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var o=SIMD.Float32x4.load(t,0),a=SIMD.Float32x4.load(t,4);return SIMD.Float32x4.store(e,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(a,r))),SIMD.Float32x4.store(e,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,n),SIMD.Float32x4.mul(o,r))),e},t.rotateZ=e.USE_SIMD?t.SIMD.rotateZ:t.scalar.rotateZ,t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(t,i,r){var n,o,a,s=r[0],l=r[1],u=r[2],h=Math.sqrt(s*s+l*l+u*u);return Math.abs(h)<e.EPSILON?null:(s*=h=1/h,l*=h,u*=h,n=Math.sin(i),a=1-(o=Math.cos(i)),t[0]=s*s*a+o,t[1]=l*s*a+u*n,t[2]=u*s*a-l*n,t[3]=0,t[4]=s*l*a-u*n,t[5]=l*l*a+o,t[6]=u*l*a+s*n,t[7]=0,t[8]=s*u*a+l*n,t[9]=l*u*a-s*n,t[10]=u*u*a+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},t.fromXRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=i,e[7]=0,e[8]=0,e[9]=-i,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-i,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=i,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=0,e[3]=0,e[4]=-i,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=r+r,l=n+n,u=o+o,h=r*s,d=r*l,c=r*u,f=n*l,p=n*u,v=o*u,_=a*s,m=a*l,g=a*u;return e[0]=1-(f+v),e[1]=d+g,e[2]=c-m,e[3]=0,e[4]=d-g,e[5]=1-(h+v),e[6]=p+_,e[7]=0,e[8]=c+m,e[9]=p-_,e[10]=1-(h+f),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e},t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getRotation=function(e,t){var i=t[0]+t[5]+t[10],r=0;return i>0?(r=2*Math.sqrt(i+1),e[3]=.25*r,e[0]=(t[6]-t[9])/r,e[1]=(t[8]-t[2])/r,e[2]=(t[1]-t[4])/r):t[0]>t[5]&t[0]>t[10]?(r=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/r,e[0]=.25*r,e[1]=(t[1]+t[4])/r,e[2]=(t[8]+t[2])/r):t[5]>t[10]?(r=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/r,e[0]=(t[1]+t[4])/r,e[1]=.25*r,e[2]=(t[6]+t[9])/r):(r=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/r,e[0]=(t[8]+t[2])/r,e[1]=(t[6]+t[9])/r,e[2]=.25*r),e},t.fromRotationTranslationScale=function(e,t,i,r){var n=t[0],o=t[1],a=t[2],s=t[3],l=n+n,u=o+o,h=a+a,d=n*l,c=n*u,f=n*h,p=o*u,v=o*h,_=a*h,m=s*l,g=s*u,y=s*h,x=r[0],S=r[1],V=r[2];return e[0]=(1-(p+_))*x,e[1]=(c+y)*x,e[2]=(f-g)*x,e[3]=0,e[4]=(c-y)*S,e[5]=(1-(d+_))*S,e[6]=(v+m)*S,e[7]=0,e[8]=(f+g)*V,e[9]=(v-m)*V,e[10]=(1-(d+p))*V,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,i,r,n){var o=t[0],a=t[1],s=t[2],l=t[3],u=o+o,h=a+a,d=s+s,c=o*u,f=o*h,p=o*d,v=a*h,_=a*d,m=s*d,g=l*u,y=l*h,x=l*d,S=r[0],V=r[1],I=r[2],b=n[0],w=n[1],M=n[2];return e[0]=(1-(v+m))*S,e[1]=(f+x)*S,e[2]=(p-y)*S,e[3]=0,e[4]=(f-x)*V,e[5]=(1-(c+m))*V,e[6]=(_+g)*V,e[7]=0,e[8]=(p+y)*I,e[9]=(_-g)*I,e[10]=(1-(c+v))*I,e[11]=0,e[12]=i[0]+b-(e[0]*b+e[4]*w+e[8]*M),e[13]=i[1]+w-(e[1]*b+e[5]*w+e[9]*M),e[14]=i[2]+M-(e[2]*b+e[6]*w+e[10]*M),e[15]=1,e},t.fromQuat=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=i+i,s=r+r,l=n+n,u=i*a,h=r*a,d=r*s,c=n*a,f=n*s,p=n*l,v=o*a,_=o*s,m=o*l;return e[0]=1-d-p,e[1]=h+m,e[2]=c-_,e[3]=0,e[4]=h-m,e[5]=1-u-p,e[6]=f+v,e[7]=0,e[8]=c+_,e[9]=f-v,e[10]=1-u-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,i,r,n,o,a){var s=1/(i-t),l=1/(n-r),u=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*l,e[6]=0,e[7]=0,e[8]=(i+t)*s,e[9]=(n+r)*l,e[10]=(a+o)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*u,e[15]=0,e},t.perspective=function(e,t,i,r,n){var o=1/Math.tan(t/2),a=1/(r-n);return e[0]=o/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(n+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*n*r*a,e[15]=0,e},t.perspectiveFromFieldOfView=function(e,t,i,r){var n=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+s),u=2/(n+o);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-(a-s)*l*.5,e[9]=(n-o)*u*.5,e[10]=r/(i-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*i/(i-r),e[15]=0,e},t.ortho=function(e,t,i,r,n,o,a){var s=1/(t-i),l=1/(r-n),u=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+i)*s,e[13]=(n+r)*l,e[14]=(a+o)*u,e[15]=1,e},t.lookAt=function(i,r,n,o){var a,s,l,u,h,d,c,f,p,v,_=r[0],m=r[1],g=r[2],y=o[0],x=o[1],S=o[2],V=n[0],I=n[1],b=n[2];return Math.abs(_-V)<e.EPSILON&&Math.abs(m-I)<e.EPSILON&&Math.abs(g-b)<e.EPSILON?t.identity(i):(c=_-V,f=m-I,p=g-b,a=x*(p*=v=1/Math.sqrt(c*c+f*f+p*p))-S*(f*=v),s=S*(c*=v)-y*p,l=y*f-x*c,(v=Math.sqrt(a*a+s*s+l*l))?(a*=v=1/v,s*=v,l*=v):(a=0,s=0,l=0),u=f*l-p*s,h=p*a-c*l,d=c*s-f*a,(v=Math.sqrt(u*u+h*h+d*d))?(u*=v=1/v,h*=v,d*=v):(u=0,h=0,d=0),i[0]=a,i[1]=u,i[2]=c,i[3]=0,i[4]=s,i[5]=h,i[6]=f,i[7]=0,i[8]=l,i[9]=d,i[10]=p,i[11]=0,i[12]=-(a*_+s*m+l*g),i[13]=-(u*_+h*m+d*g),i[14]=-(c*_+f*m+p*g),i[15]=1,i)},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e[9]=t[9]+i[9],e[10]=t[10]+i[10],e[11]=t[11]+i[11],e[12]=t[12]+i[12],e[13]=t[13]+i[13],e[14]=t[14]+i[14],e[15]=t[15]+i[15],e},t.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e[9]=t[9]-i[9],e[10]=t[10]-i[10],e[11]=t[11]-i[11],e[12]=t[12]-i[12],e[13]=t[13]-i[13],e[14]=t[14]-i[14],e[15]=t[15]-i[15],e},t.sub=t.subtract,t.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12]*i,e[13]=t[13]*i,e[14]=t[14]*i,e[15]=t[15]*i,e},t.multiplyScalarAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e[6]=t[6]+i[6]*r,e[7]=t[7]+i[7]*r,e[8]=t[8]+i[8]*r,e[9]=t[9]+i[9]*r,e[10]=t[10]+i[10]*r,e[11]=t[11]+i[11]*r,e[12]=t[12]+i[12]*r,e[13]=t[13]+i[13]*r,e[14]=t[14]+i[14]*r,e[15]=t[15]+i[15]*r,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],h=t[7],d=t[8],c=t[9],f=t[10],p=t[11],v=t[12],_=t[13],m=t[14],g=t[15],y=i[0],x=i[1],S=i[2],V=i[3],I=i[4],b=i[5],w=i[6],M=i[7],T=i[8],E=i[9],L=i[10],D=i[11],F=i[12],O=i[13],C=i[14],A=i[15];return Math.abs(r-y)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(n-x)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(o-S)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(a-V)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(V))&&Math.abs(s-I)<=e.EPSILON*Math.max(1,Math.abs(s),Math.abs(I))&&Math.abs(l-b)<=e.EPSILON*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(u-w)<=e.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(h-M)<=e.EPSILON*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(d-T)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(c-E)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(f-L)<=e.EPSILON*Math.max(1,Math.abs(f),Math.abs(L))&&Math.abs(p-D)<=e.EPSILON*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(v-F)<=e.EPSILON*Math.max(1,Math.abs(v),Math.abs(F))&&Math.abs(_-O)<=e.EPSILON*Math.max(1,Math.abs(_),Math.abs(O))&&Math.abs(m-C)<=e.EPSILON*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(g-A)<=e.EPSILON*Math.max(1,Math.abs(g),Math.abs(A))},t}.apply(null,r))||(e.exports=n)},1665:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.serializeList=function(e,t){if(null!==t){e.writeInt32(t.length);for(var i=0,r=t;i<r.length;i++)r[i].serialize(e);return e}e.writeInt32(0)},t.deserializeList=function(e,t,i){for(var r=e.readInt32(),n=new Array(r),o=0;o<n.length;o++)n[o]=t.deserialize(e,i);return n}}.apply(null,r))||(e.exports=n)},1666:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.equals=function(e,t){return e===this.x&&t===this.y},e.prototype.isEqual=function(e){return e.x===this.x&&e.y===this.y},e.prototype.setCoords=function(e,t){this.x=e,this.y=t},e.prototype.normalize=function(){var e=this.x,t=this.y,i=Math.sqrt(e*e+t*t);this.x/=i,this.y/=i},e.prototype.rightPerpendicular=function(){var e=this.x;this.x=this.y,this.y=-e},e.prototype.move=function(e,t){this.x+=e,this.y+=t},e.prototype.assign=function(e){this.x=e.x,this.y=e.y},e.prototype.assignAdd=function(e,t){this.x=e.x+t.x,this.y=e.y+t.y},e.prototype.assignSub=function(e,t){this.x=e.x-t.x,this.y=e.y-t.y},e.prototype.rotate=function(e,t){var i=this.x,r=this.y;this.x=i*e-r*t,this.y=i*t+r*e},e.prototype.scale=function(e){this.x*=e,this.y*=e},e.prototype.length=function(){var e=this.x,t=this.y;return Math.sqrt(e*e+t*t)},e.distance=function(e,t){var i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)},e.add=function(t,i){return new e(t.x+i.x,t.y+i.y)},e.sub=function(t,i){return new e(t.x-i.x,t.y-i.y)},e}();t.Point=i}.apply(null,r))||(e.exports=n)},1667:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){function i(e,t){return(e%=t)>=0?e:e+t}Object.defineProperty(t,"__esModule",{value:!0}),t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var r=1/Math.LN2;t.positiveMod=i,t.radToByte=function(e){return i(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return i(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*r},t.sqr=function(e){return e*e},t.clamp=function(e,t,i){return Math.min(Math.max(e,t),i)},t.interpolate=function(e,t,i){return e*(1-i)+t*i},t.between=function(e,t,i){return e>=t&&e<=i||e>=i&&e<=t}}.apply(null,r))||(e.exports=n)},1678:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1496),i(1868),i(1492)],void 0===(n=function(e,t,i,r,n){function o(e){return e.reduce(function(e,t,i){return t&&(e|=1<<i),e},0)}return function(){function e(e,t,i,r,n,o){if("string"==typeof e)this._initParams(e,t,i,r,n,o);else{var a=e;this._initObject({programNamePrefix:a.programNamePrefix,shaderSnippetPrefixes:a.shaderSnippetPrefixes,baseDefines:a.baseDefines,snippets:a.snippets,rctx:a.rctx,vertexAttribLocs:a.vertexAttribLocs})}}return e.prototype.dispose=function(){this._programCache&&(this._programCache.forEach(function(e){return e.dispose()}),this._programCache.clear())},e.prototype._initObject=function(e){this._initParams(e.programNamePrefix,e.shaderSnippetPrefixes,e.baseDefines,e.snippets,e.rctx,e.vertexAttribLocs)},e.prototype._initParams=function(e,t,i,n,o,a){this._defaultSnippets=n,this._defaultRctx=o,this._defaultVertexAttribLocs=a,this._programCache=new Map,this._variationInfo=new Map,this._shaderSourceVariator=new r(e,t,i)},e.prototype.addDefine=function(e,t,i,r){this._shaderSourceVariator.addDefine(e,t,i,r)},e.prototype.addBinaryShaderSnippetSuffix=function(e,t,i){this._shaderSourceVariator.addBinaryShaderSnippetSuffix(e,t,i)},e.prototype.addNaryShaderSnippetSuffix=function(e,t){this._shaderSourceVariator.addNaryShaderSnippetSuffix(e,t)},e.prototype.getProgram=function(e,t,r,a){if(t=t||this._defaultSnippets,r=r||this._defaultRctx,a=a||this._defaultVertexAttribLocs,!t)throw new Error("No ShaderSnippets provided to getProgram nor to ShaderVariations constructor.");if(!r)throw new Error("No RenderingContext provided to getProgram nor to ShaderVariations constructor.");if(!a)throw new Error("No VertexAttributeLocations provided to getProgram nor to ShaderVariations constructor.");var s=o(e);if(this._programCache.has(s))return this._programCache.get(s);var l,u,h,d=this._shaderSourceVariator.getShaderVariation(e);u=t[l=d.shaderSnippetNames[0]],n.assert(null!=u,"shader snippet '"+l+"' does not exist"),h=t[l=d.shaderSnippetNames[1]],n.assert(null!=h,"shader snippet '"+l+"' does not exist");var c=new i(r,u,h,a,d.defines);return this._programCache.set(s,c),c},e.prototype.getProgramByKey=function(e){if(this._programCache.has(e))return this._programCache.get(e);if(!this._variationInfo[e])return null;var t,r,o,a=this._variationInfo[e],s=this._defaultSnippets,l=this._defaultRctx,u=this._defaultVertexAttribLocs;r=s[t=a.shaderSnippetNames[0]],n.assert(null!=r,"shader snippet '"+t+"' does not exist"),o=s[t=a.shaderSnippetNames[1]],n.assert(null!=o,"shader snippet '"+t+"' does not exist");var h=new i(l,r,o,u,a.defines);return this._programCache.set(e,h),h},e.prototype.getProgramInfo=function(e){var t=this._shaderSourceVariator.getShaderVariation(e),i=o(e);return this._variationInfo[i]||(this._variationInfo[i]=t),{name:t.programName,key:i}},e}()}.apply(null,r))||(e.exports=n)},1679:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(1720),i(518)],void 0===(n=function(e,t,i,r,n){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.draw=function(e,t){var i=this;if(t.canDisplay){var r=this.getGeometryType(),o=t.getDisplayList(e.drawPhase),a=t.getGeometry(r);a&&n.forEachIter(o.ofType(r),function(r){return i.drawGeometry(e,t,r,a)})}},t}(r.default);t.default=o}.apply(null,r))||(e.exports=n)},1680:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(0),i(4),i(15),i(1)],void 0===(n=function(e,t,i,r,n,o,a){return function(e){function t(){var t=e.call(this)||this;return t.handles=new o,t}return i(t,e),t.prototype.destroy=function(){this.handles.destroy()},r([a.property({readOnly:!0})],t.prototype,"handles",void 0),r([a.subclass("esri.core.HandleOwner")],t)}(a.declared(n))}.apply(null,r))||(e.exports=n)},1681:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12)],void 0===(n=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(){}}();t.default=r}.apply(null,r))||(e.exports=n)},1692:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1853),i(1854),i(1855),i(1813),i(1637)],void 0===(n=function(e,t,i,r,n,o,a){var s=new a;return a.parse(i,s),a.parse(r,s),a.parse(n,s),a.parse(o,s),s}.apply(null,r))||(e.exports=n)},1693:function(e,t,i){var r,n;r=[i(259)],void 0===(n=function(e){var t={create:function(){var t=new e.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},clone:function(t){var i=new e.ARRAY_TYPE(4);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i},fromValues:function(t,i,r,n){var o=new e.ARRAY_TYPE(4);return o[0]=t,o[1]=i,o[2]=r,o[3]=n,o},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},set:function(e,t,i,r,n){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e},add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e},subtract:function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e}};return t.sub=t.subtract,t.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e},t.mul=t.multiply,t.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e[3]=t[3]/i[3],e},t.div=t.divide,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},t.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e[3]=Math.min(t[3],i[3]),e},t.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e[3]=Math.max(t[3],i[3]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},t.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},t.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e},t.distance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(i*i+r*r+n*n+o*o)},t.dist=t.distance,t.squaredDistance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],o=t[3]-e[3];return i*i+r*r+n*n+o*o},t.sqrDist=t.squaredDistance,t.length=function(e){var t=e[0],i=e[1],r=e[2],n=e[3];return Math.sqrt(t*t+i*i+r*r+n*n)},t.len=t.length,t.squaredLength=function(e){var t=e[0],i=e[1],r=e[2],n=e[3];return t*t+i*i+r*r+n*n},t.sqrLen=t.squaredLength,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},t.normalize=function(e,t){var i=t[0],r=t[1],n=t[2],o=t[3],a=i*i+r*r+n*n+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=i*a,e[1]=r*a,e[2]=n*a,e[3]=o*a),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},t.lerp=function(e,t,i,r){var n=t[0],o=t[1],a=t[2],s=t[3];return e[0]=n+r*(i[0]-n),e[1]=o+r*(i[1]-o),e[2]=a+r*(i[2]-a),e[3]=s+r*(i[3]-s),e},t.random=function(i,r){return r=r||1,i[0]=e.RANDOM(),i[1]=e.RANDOM(),i[2]=e.RANDOM(),i[3]=e.RANDOM(),t.normalize(i,i),t.scale(i,i,r),i},t.transformMat4=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=t[3];return e[0]=i[0]*r+i[4]*n+i[8]*o+i[12]*a,e[1]=i[1]*r+i[5]*n+i[9]*o+i[13]*a,e[2]=i[2]*r+i[6]*n+i[10]*o+i[14]*a,e[3]=i[3]*r+i[7]*n+i[11]*o+i[15]*a,e},t.transformQuat=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=i[0],s=i[1],l=i[2],u=i[3],h=u*r+s*o-l*n,d=u*n+l*r-a*o,c=u*o+a*n-s*r,f=-a*r-s*n-l*o;return e[0]=h*u+f*-a+d*-l-c*-s,e[1]=d*u+f*-s+c*-a-h*-l,e[2]=c*u+f*-l+h*-s-d*-a,e[3]=t[3],e},t.forEach=function(){var e=t.create();return function(t,i,r,n,o,a){var s,l;for(i||(i=4),r||(r=0),l=n?Math.min(n*i+r,t.length):t.length,s=r;s<l;s+=i)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),t.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(t,i){var r=t[0],n=t[1],o=t[2],a=t[3],s=i[0],l=i[1],u=i[2],h=i[3];return Math.abs(r-s)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-l)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(o-u)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(a-h)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))},t}.apply(null,r))||(e.exports=n)},1698:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(e,t,i,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=e,this.y=t,this.width=i,this.height=r}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this.width<=0||this.height<=0},enumerable:!0,configurable:!0}),e}()}.apply(null,r))||(e.exports=n)},1708:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1511),i(1721),i(1799),i(1709),i(1665)],void 0===(n=function(e,t,i,r,n,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t,i){this.unit=e,this.pageId=t,this.semantic=i}return e.prototype.clone=function(){return new e(this.unit,this.pageId,this.semantic)},e.prototype.serialize=function(e){return e.writeInt32(this.unit),e.writeInt32(this.pageId),e},e.deserialize=function(t){return new e(t.readInt32(),t.readInt32(),"u_texture")},e}();t.TexBindingInfo=s;var l=function(){function e(e,t){this.name=e,this.value=t}return e.prototype.clone=function(){return new e(this.name,this.value)},e.prototype.serialize=function(e){return e.writeInt32(this.value),e},e.deserialize=function(t){return new e("u_my_param",t.readInt32())},e}();t.MaterialParam=l;var u=function(){function e(){this.texBindingInfo=[],this.materialParams=[]}return e.fromSprite=function(t,n,a){var l=new e,u=new o;return u.geometryType=n,t?(u.sdf=t.sdf,u.pattern=!0,l.texBindingInfo.push(new s(1,t.page,"u_texture"))):(u.sdf=!1,u.pattern=!1),0===a?u.vvOpacity=u.vvSizeMinMaxValue=u.vvSizeScaleStops=u.vvSizeFieldStops=u.vvSizeUnitValue=u.vvColor=u.vvRotation=!1:(u.vvOpacity=0!=(a&i.WGLVVFlag.OPACITY),u.vvSizeMinMaxValue=0!=(a&i.WGLVVFlag.SIZE_MINMAX_VALUE),u.vvSizeScaleStops=0!=(a&i.WGLVVFlag.SIZE_SCALE_STOPS),u.vvSizeFieldStops=0!=(a&i.WGLVVFlag.SIZE_FIELD_STOPS),u.vvSizeUnitValue=0!=(a&i.WGLVVFlag.SIZE_UNIT_VALUE),u.vvColor=0!=(a&i.WGLVVFlag.COLOR),u.vvRotation=0!=(a&i.WGLVVFlag.ROTATION)),u.visibility=!1,l.materialKey=r.getMaterialKey(u),l.materialKeyInfo=u,l},e.fromGlyph=function(t,n,a){var l=new e,u=new o;return u.geometryType=n,u.sdf=!0,u.pattern=!1,u.visibility=!1,u.heatmap=!1,l.texBindingInfo.push(new s(2,t.page,"u_texture")),0===a?u.vvOpacity=u.vvSizeMinMaxValue=u.vvSizeScaleStops=u.vvSizeFieldStops=u.vvSizeUnitValue=u.vvColor=u.vvRotation=!1:(u.vvOpacity=0!=(a&i.WGLVVFlag.OPACITY),u.vvSizeMinMaxValue=0!=(a&i.WGLVVFlag.SIZE_MINMAX_VALUE),u.vvSizeScaleStops=0!=(a&i.WGLVVFlag.SIZE_SCALE_STOPS),u.vvSizeFieldStops=0!=(a&i.WGLVVFlag.SIZE_FIELD_STOPS),u.vvSizeUnitValue=0!=(a&i.WGLVVFlag.SIZE_UNIT_VALUE),u.vvColor=0!=(a&i.WGLVVFlag.COLOR),u.vvRotation=0!=(a&i.WGLVVFlag.ROTATION)),l.materialKey=r.getMaterialKey(u),l.materialKeyInfo=u,l},e.prototype.copy=function(e){this.materialParams=e.materialParams.map(function(e){return e.clone()}),this.texBindingInfo=e.texBindingInfo.map(function(e){return e.clone()}),e.materialKeyInfo&&(this.materialKeyInfo=new o,this.materialKeyInfo.copy(e.materialKeyInfo)),this.materialKey=e.materialKey},e.prototype.serialize=function(e){return e.writeInt32(this.materialKey),a.serializeList(e,this.texBindingInfo),a.serializeList(e,this.materialParams),e},e.deserialize=function(t){var i=new e;return i.materialKey=t.readInt32(),i.texBindingInfo=a.deserializeList(t,s),i.materialParams=a.deserializeList(t,l),i.materialKeyInfo=new o,n(i.materialKeyInfo,i.materialKey),i},e}();t.default=u}.apply(null,r))||(e.exports=n)},1709:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(){this.sdf=!1,this.vvSizeMinMaxValue=!1,this.vvSizeScaleStops=!1,this.vvSizeFieldStops=!1,this.vvSizeUnitValue=!1,this.vvColor=!1,this.vvRotation=!1,this.vvOpacity=!1,this.visibility=!1,this.pattern=!1,this.heatmap=!1}return e.prototype.copy=function(e){this.geometryType=e.geometryType,this.sdf=e.sdf,this.vvSizeMinMaxValue=e.vvSizeMinMaxValue,this.vvSizeScaleStops=e.vvSizeScaleStops,this.vvSizeFieldStops=e.vvSizeFieldStops,this.vvSizeUnitValue=e.vvSizeUnitValue,this.vvColor=e.vvColor,this.vvRotation=e.vvRotation,this.vvOpacity=e.vvOpacity,this.visibility=e.visibility,this.pattern=e.pattern,this.heatmap=e.heatmap},e.prototype.hasVV=function(){return void 0===this._hasVV&&(this._hasVV=this.vvColor||this.vvOpacity||this.vvRotation||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue),this._hasVV},e.prototype.hasVVSize=function(){return this.vvSizeMinMaxValue||this.vvSizeFieldStops||this.vvSizeScaleStops||this.vvSizeUnitValue},e.prototype.hasVVColor=function(){return this.vvColor},e.prototype.hasVVRotation=function(){return this.vvRotation},e.prototype.hasVVOpacity=function(){return this.vvOpacity},e}()}.apply(null,r))||(e.exports=n)},1710:function(e,t,i){var r,n;r=[i(259)],void 0===(n=function(e){var t={create:function(){var t=new e.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},clone:function(t){var i=new e.ARRAY_TYPE(3);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i},fromValues:function(t,i,r){var n=new e.ARRAY_TYPE(3);return n[0]=t,n[1]=i,n[2]=r,n},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},set:function(e,t,i,r){return e[0]=t,e[1]=i,e[2]=r,e},add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},subtract:function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}};return t.sub=t.subtract,t.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e},t.mul=t.multiply,t.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e},t.div=t.divide,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},t.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e},t.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},t.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},t.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e},t.distance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return Math.sqrt(i*i+r*r+n*n)},t.dist=t.distance,t.squaredDistance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return i*i+r*r+n*n},t.sqrDist=t.squaredDistance,t.length=function(e){var t=e[0],i=e[1],r=e[2];return Math.sqrt(t*t+i*i+r*r)},t.len=t.length,t.squaredLength=function(e){var t=e[0],i=e[1],r=e[2];return t*t+i*i+r*r},t.sqrLen=t.squaredLength,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},t.normalize=function(e,t){var i=t[0],r=t[1],n=t[2],o=i*i+r*r+n*n;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},t.cross=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=i[0],s=i[1],l=i[2];return e[0]=n*l-o*s,e[1]=o*a-r*l,e[2]=r*s-n*a,e},t.lerp=function(e,t,i,r){var n=t[0],o=t[1],a=t[2];return e[0]=n+r*(i[0]-n),e[1]=o+r*(i[1]-o),e[2]=a+r*(i[2]-a),e},t.hermite=function(e,t,i,r,n,o){var a=o*o,s=a*(2*o-3)+1,l=a*(o-2)+o,u=a*(o-1),h=a*(3-2*o);return e[0]=t[0]*s+i[0]*l+r[0]*u+n[0]*h,e[1]=t[1]*s+i[1]*l+r[1]*u+n[1]*h,e[2]=t[2]*s+i[2]*l+r[2]*u+n[2]*h,e},t.bezier=function(e,t,i,r,n,o){var a=1-o,s=a*a,l=o*o,u=s*a,h=3*o*s,d=3*l*a,c=l*o;return e[0]=t[0]*u+i[0]*h+r[0]*d+n[0]*c,e[1]=t[1]*u+i[1]*h+r[1]*d+n[1]*c,e[2]=t[2]*u+i[2]*h+r[2]*d+n[2]*c,e},t.random=function(t,i){i=i||1;var r=2*e.RANDOM()*Math.PI,n=2*e.RANDOM()-1,o=Math.sqrt(1-n*n)*i;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=n*i,t},t.transformMat4=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=i[3]*r+i[7]*n+i[11]*o+i[15];return a=a||1,e[0]=(i[0]*r+i[4]*n+i[8]*o+i[12])/a,e[1]=(i[1]*r+i[5]*n+i[9]*o+i[13])/a,e[2]=(i[2]*r+i[6]*n+i[10]*o+i[14])/a,e},t.transformMat3=function(e,t,i){var r=t[0],n=t[1],o=t[2];return e[0]=r*i[0]+n*i[3]+o*i[6],e[1]=r*i[1]+n*i[4]+o*i[7],e[2]=r*i[2]+n*i[5]+o*i[8],e},t.transformQuat=function(e,t,i){var r=t[0],n=t[1],o=t[2],a=i[0],s=i[1],l=i[2],u=i[3],h=u*r+s*o-l*n,d=u*n+l*r-a*o,c=u*o+a*n-s*r,f=-a*r-s*n-l*o;return e[0]=h*u+f*-a+d*-l-c*-s,e[1]=d*u+f*-s+c*-a-h*-l,e[2]=c*u+f*-l+h*-s-d*-a,e},t.rotateX=function(e,t,i,r){var n=[],o=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],o[0]=n[0],o[1]=n[1]*Math.cos(r)-n[2]*Math.sin(r),o[2]=n[1]*Math.sin(r)+n[2]*Math.cos(r),e[0]=o[0]+i[0],e[1]=o[1]+i[1],e[2]=o[2]+i[2],e},t.rotateY=function(e,t,i,r){var n=[],o=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],o[0]=n[2]*Math.sin(r)+n[0]*Math.cos(r),o[1]=n[1],o[2]=n[2]*Math.cos(r)-n[0]*Math.sin(r),e[0]=o[0]+i[0],e[1]=o[1]+i[1],e[2]=o[2]+i[2],e},t.rotateZ=function(e,t,i,r){var n=[],o=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],o[0]=n[0]*Math.cos(r)-n[1]*Math.sin(r),o[1]=n[0]*Math.sin(r)+n[1]*Math.cos(r),o[2]=n[2],e[0]=o[0]+i[0],e[1]=o[1]+i[1],e[2]=o[2]+i[2],e},t.forEach=function(){var e=t.create();return function(t,i,r,n,o,a){var s,l;for(i||(i=3),r||(r=0),l=n?Math.min(n*i+r,t.length):t.length,s=r;s<l;s+=i)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}(),t.angle=function(e,i){var r=t.fromValues(e[0],e[1],e[2]),n=t.fromValues(i[0],i[1],i[2]);t.normalize(r,r),t.normalize(n,n);var o=t.dot(r,n);return o>1?0:Math.acos(o)},t.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.equals=function(t,i){var r=t[0],n=t[1],o=t[2],a=i[0],s=i[1],l=i[2];return Math.abs(r-a)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-l)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},t}.apply(null,r))||(e.exports=n)},1720:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(){}}();t.default=i}.apply(null,r))||(e.exports=n)},1721:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1511),i(1708),i(1709)],void 0===(n=function(e,t,i,r,n){function o(e){if(e.geometryType===i.WGLGeometryType.UNKNOWN)return-1;var t=function(e){var t=[];return t[0]=!!e.sdf,t[1]=!!e.vvSizeMinMaxValue,t[2]=!!e.vvSizeScaleStops,t[3]=!!e.vvSizeFieldStops,t[4]=!!e.vvSizeUnitValue,t[5]=!!e.vvColor,t[6]=!!e.vvRotation,t[7]=!!e.vvOpacity,t[8]=!!e.visibility,t[9]=!!e.pattern,t[10]=!!e.heatmap,t.reduce(function(e,t,i){return t&&(e|=1<<i+2),e},0)}(e)<<3;return e.geometryType+t}Object.defineProperty(t,"__esModule",{value:!0}),t.createTextMaterialInfo=function(e,t,a){var s=new r.default,l=new n;return l.geometryType=a,l.sdf=!0,l.pattern=!1,l.visibility=!1,l.heatmap=!1,s.texBindingInfo.push(new r.TexBindingInfo(2,e.page,"u_texture")),0===t?l.vvOpacity=l.vvSizeMinMaxValue=l.vvSizeScaleStops=l.vvSizeFieldStops=l.vvSizeUnitValue=l.vvColor=l.vvRotation=!1:(l.vvOpacity=0!=(t&i.WGLVVFlag.OPACITY),l.vvSizeMinMaxValue=0!=(t&i.WGLVVFlag.SIZE_MINMAX_VALUE),l.vvSizeScaleStops=0!=(t&i.WGLVVFlag.SIZE_SCALE_STOPS),l.vvSizeFieldStops=0!=(t&i.WGLVVFlag.SIZE_FIELD_STOPS),l.vvSizeUnitValue=0!=(t&i.WGLVVFlag.SIZE_UNIT_VALUE),l.vvColor=0!=(t&i.WGLVVFlag.COLOR),l.vvRotation=0!=(t&i.WGLVVFlag.ROTATION)),s.materialKey=o(l),s.materialKeyInfo=l,s},t.createMaterialInfo=function(e,t,a){var s=new r.default,l=new n;if(l.geometryType=t,e){var u=e.spriteMosaicItem;l.sdf=u.sdf,l.pattern=!0,s.texBindingInfo.push(new r.TexBindingInfo(1,u.page,"u_texture"))}else l.sdf=!1,l.pattern=!1;return 0===a?l.vvOpacity=l.vvSizeMinMaxValue=l.vvSizeScaleStops=l.vvSizeFieldStops=l.vvSizeUnitValue=l.vvColor=l.vvRotation=!1:(l.vvOpacity=0!=(a&i.WGLVVFlag.OPACITY),l.vvSizeMinMaxValue=0!=(a&i.WGLVVFlag.SIZE_MINMAX_VALUE),l.vvSizeScaleStops=0!=(a&i.WGLVVFlag.SIZE_SCALE_STOPS),l.vvSizeFieldStops=0!=(a&i.WGLVVFlag.SIZE_FIELD_STOPS),l.vvSizeUnitValue=0!=(a&i.WGLVVFlag.SIZE_UNIT_VALUE),l.vvColor=0!=(a&i.WGLVVFlag.COLOR),l.vvRotation=0!=(a&i.WGLVVFlag.ROTATION)),l.visibility=!1,s.materialKey=o(l),s.materialKeyInfo=l,s},t.getMaterialKey=o,t.getMaterialVariations=function(e){return{geometryType:7&e,variations:[0!=(1&(e>>=3)),0!=(2&e),0!=(4&e),0!=(8&e),0!=(16&e),0!=(32&e),0!=(64&e),0!=(128&e),0!=(256&e),0!=(512&e),0!=(1024&e),0!=(2048&e),0!=(4096&e)]}}}.apply(null,r))||(e.exports=n)},1723:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(483)],void 0===(n=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,r,n){this.width=r,this.height=n,this.center=i.fromValues(e,t)}return Object.defineProperty(e.prototype,"x",{get:function(){return this.center[0]},set:function(e){this.center[0]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.center[1]},set:function(e){this.center[1]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"halfWidth",{get:function(){return this.width/2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"halfHeight",{get:function(){return this.height/2},enumerable:!0,configurable:!0}),e.prototype.serialize=function(e){return e.writeF32(this.center[0]),e.writeF32(this.center[1]),e.writeInt32(this.width),e.writeInt32(this.height),e},e.deserialize=function(t){return new e(t.readF32(),t.readF32(),t.readInt32(),t.readInt32())},e}();t.default=r}.apply(null,r))||(e.exports=n)},1728:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1698)],void 0===(n=function(e,t,i){return function(){function e(e,t,i,r,n,o,a,s){this._glyphItems=e,this._maxWidth=t,this._lineHeight=i,this._letterSpacing=r,this._offset=n,this._hAnchor=o,this._vAnchor=a,this._justify=s}return e.prototype.getShaping=function(e,t){for(var i=this._letterSpacing,r=this._lineHeight,n=this._justify,o=this._maxWidth,a=[],s=0,l=0,u=0,h=0,d=-1,c=0,f=-1,p=e.length,v=0;v<p;v++){var _=e.charCodeAt(v);if(10!==_){for(var m=void 0,g=0,y=this._glyphItems;g<y.length&&!(m=y[g][_]);g++);if(m){if(a.push({codePoint:_,x:s,y:l,glyphMosaicItem:m}),s+=m.metrics.advance+i,o>0&&s>o&&f>=0){var x=f+1,S=a[x].x;c=Math.max(S,c);for(var V=x;V<a.length;V++)t?a[V].y-=r:a[V].y+=r,a[V].x-=S;n&&this._applyJustification(a,h,f),t?l-=r:l+=r,s-=S,++u,h=x,f=-1}++d,32===_&&(f=a.length-1)}}else{if(v===p-1)continue;if(d>=h){S=(I=a[d]).x+I.glyphMosaicItem.metrics.advance;c=Math.max(S,c),n&&this._applyJustification(a,h,d),h=a.length}t?l-=r:l+=r,s=0,++u}}if(d>=h){var I,b=(I=a[d]).x+I.glyphMosaicItem.metrics.advance;c=Math.max(c,b),n&&this._applyJustification(a,h,d)}if(a.length>0){var w=(n-this._hAnchor)*c,M=(-this._vAnchor*(u+1)+.5)*r;t&&u&&(M+=u*r),w+=this._offset[0],M+=this._offset[1];for(var T=0,E=a;T<E.length;T++){var L=E[T];L.x+=w,L.y+=M}}return a},e.getBox=function(e){var t=e.length;if(0!==t){for(var i=e[0].x+e[0].glyphMosaicItem.metrics.left,r=i,n=e[0].y,o=n,a=n,s=1;s<t;s++){var l=e[s],u=l.x+l.glyphMosaicItem.metrics.left;u<i&&(i=u),u>r&&(r=u);var h=l.y;if(h<n&&(n=h),h>o&&(o=h),h!==a){var d=e[s-1].glyphMosaicItem.metrics.width;r=Math.max(r,e[s-1].x+e[s-1].glyphMosaicItem.metrics.left+d),a=h}}var c=e[t-1].glyphMosaicItem.metrics.width;return r=Math.max(r,e[t-1].x+e[t-1].glyphMosaicItem.metrics.left+c),{x:i,y:o+=12,width:r-i,height:o-(n-=12)}}},e.addDecoration=function(e,t){var r=e.length;if(0!==r){for(var n=e[0].x+e[0].glyphMosaicItem.metrics.left,o=e[0].y,a=1;a<r;a++){var s=e[a];if(s.y!==o){var l=e[a-1].x+e[a-1].glyphMosaicItem.metrics.left+e[a-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:n,y:o+t-3,glyphMosaicItem:{rect:new i(4,0,4,8),metrics:{width:l-n,height:8,left:0,top:0,advance:0},page:0}}),o=s.y,n=s.x+s.glyphMosaicItem.metrics.left}}var u=e[r-1].x+e[r-1].glyphMosaicItem.metrics.left+e[r-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:n,y:o+t-3,glyphMosaicItem:{rect:new i(4,0,4,8),metrics:{width:u-n,height:8,left:0,top:0,advance:0},page:0}})}},e.prototype._applyJustification=function(e,t,i){for(var r=e[i],n=r.glyphMosaicItem.metrics.advance,o=(r.x+n)*this._justify,a=t;a<=i;a++)e[a].x-=o},e}()}.apply(null,r))||(e.exports=n)},1729:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1666),i(1667)],void 0===(n=function(e,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(e,t,i){this.ratio=e,this.x=t,this.y=i}}(),o=function(){function e(e,t,i,r,n){void 0===r&&(r=8),void 0===n&&(n=8),this.lines=[],this.starts=[],this.pixelRatio=r,this.pixelMargin=n,this.tileSize=512*r,this.dz=e,this.yPos=t,this.xPos=i}return e.prototype.setExtent=function(e){this.finalRatio=this.tileSize/e*(1<<this.dz);var t=this.pixelRatio*this.pixelMargin;t/=this.finalRatio;var i=e>>this.dz;t>i&&(t=i),this.margin=t,this.xmin=i*this.xPos-t,this.ymin=i*this.yPos-t,this.xmax=this.xmin+i+2*t,this.ymax=this.ymin+i+2*t},e.prototype.reset=function(e){this.type=e,this.lines=[],this.starts=[],this.line=null,this.start=0},e.prototype.moveTo=function(e,t){this._pushLine(),this._prevIsIn=this._isIn(e,t),this._moveTo(e,t,this._prevIsIn),this._prevPt=new i.Point(e,t),this._firstPt=new i.Point(e,t),this._dist=0},e.prototype.lineTo=function(e,t){var r,o,a,s,l,u,h,d,c=this._isIn(e,t),f=new i.Point(e,t),p=i.Point.distance(this._prevPt,f);if(c)this._prevIsIn?this._lineTo(e,t,!0):(r=this._prevPt,o=f,a=this._intersect(o,r),this.start=this._dist+p*(1-this._r),this._lineTo(a.x,a.y,!0),this._lineTo(o.x,o.y,!0));else if(this._prevIsIn)o=this._prevPt,r=f,a=this._intersect(o,r),this._lineTo(a.x,a.y,!0),this._lineTo(r.x,r.y,!1);else{var v=this._prevPt,_=f;if(v.x<=this.xmin&&_.x<=this.xmin||v.x>=this.xmax&&_.x>=this.xmax||v.y<=this.ymin&&_.y<=this.ymin||v.y>=this.ymax&&_.y>=this.ymax)this._lineTo(_.x,_.y,!1);else{var m=[];if((v.x<this.xmin&&_.x>this.xmin||v.x>this.xmin&&_.x<this.xmin)&&(s=(this.xmin-v.x)/(_.x-v.x),(d=v.y+s*(_.y-v.y))<=this.ymin?u=!1:d>=this.ymax?u=!0:m.push(new n(s,this.xmin,d))),(v.x<this.xmax&&_.x>this.xmax||v.x>this.xmax&&_.x<this.xmax)&&(s=(this.xmax-v.x)/(_.x-v.x),(d=v.y+s*(_.y-v.y))<=this.ymin?u=!1:d>=this.ymax?u=!0:m.push(new n(s,this.xmax,d))),(v.y<this.ymin&&_.y>this.ymin||v.y>this.ymin&&_.y<this.ymin)&&(s=(this.ymin-v.y)/(_.y-v.y),(h=v.x+s*(_.x-v.x))<=this.xmin?l=!1:h>=this.xmax?l=!0:m.push(new n(s,h,this.ymin))),(v.y<this.ymax&&_.y>this.ymax||v.y>this.ymax&&_.y<this.ymax)&&(s=(this.ymax-v.y)/(_.y-v.y),(h=v.x+s*(_.x-v.x))<=this.xmin?l=!1:h>=this.xmax?l=!0:m.push(new n(s,h,this.ymax))),0===m.length)l?u?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):u?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(m.length>1&&m[0].ratio>m[1].ratio)this.start=this._dist+p*m[1].ratio,this._lineTo(m[1].x,m[1].y,!0),this._lineTo(m[0].x,m[0].y,!0);else{this.start=this._dist+p*m[0].ratio;for(var g=0;g<m.length;g++)this._lineTo(m[g].x,m[g].y,!0)}this._lineTo(_.x,_.y,!1)}}this._dist+=p,this._prevIsIn=c,this._prevPt=f},e.prototype.close=function(){if(this.line.length>2){var e=this._firstPt,t=this._prevPt;e.x===t.x&&e.y===t.y||this.lineTo(e.x,e.y);for(var i=this.line,r=i.length;r>=4&&(i[0].x===i[1].x&&i[0].x===i[r-2].x||i[0].y===i[1].y&&i[0].y===i[r-2].y);)i.pop(),i[0].x=i[r-2].x,i[0].y=i[r-2].y,--r}},e.prototype.result=function(e){return void 0===e&&(e=!0),this._pushLine(),0===this.lines.length?null:(3===this.type&&e&&s.simplify(this.tileSize,this.margin*this.finalRatio,this.lines),this.lines)},e.prototype.resultWithStarts=function(){if(2!==this.type)throw new Error("Only valid for lines");this._pushLine();var e=this.lines,t=e.length;if(0===t)return null;for(var i=[],r=0;r<t;r++)i.push({line:e[r],start:this.starts[r]||0});return i},e.prototype._isIn=function(e,t){return e>=this.xmin&&e<=this.xmax&&t>=this.ymin&&t<=this.ymax},e.prototype._intersect=function(e,t){var r,n,o;if(t.x>=this.xmin&&t.x<=this.xmax)o=((n=t.y<=this.ymin?this.ymin:this.ymax)-e.y)/(t.y-e.y),r=e.x+o*(t.x-e.x);else if(t.y>=this.ymin&&t.y<=this.ymax)o=((r=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),n=e.y+o*(t.y-e.y);else{n=t.y<=this.ymin?this.ymin:this.ymax;var a=((r=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),s=(n-e.y)/(t.y-e.y);a<s?(o=a,n=e.y+a*(t.y-e.y)):(o=s,r=e.x+s*(t.x-e.x))}return this._r=o,new i.Point(r,n)},e.prototype._pushLine=function(){this.line&&(1===this.type?this.line.length>0&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?this.line.length>1&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&this.line.length>3&&(this.lines.push(this.line),this.starts.push(this.start))),this.line=[],this.start=0},e.prototype._moveTo=function(e,t,r){3!==this.type?r&&(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new i.Point(e,t))):(r||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new i.Point(e,t)),this._is_h=!1,this._is_v=!1)},e.prototype._lineTo=function(e,t,r){var n,o;if(3!==this.type)if(r){if(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.length>0&&(n=this.line[this.line.length-1]).equals(e,t))return;this.line.push(new i.Point(e,t))}else this.line&&this.line.length>0&&this._pushLine();else if(r||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line&&this.line.length>0){var a=(n=this.line[this.line.length-1]).x===e,s=n.y===t;if(a&&s)return;this._is_h&&a?(n.x=e,n.y=t,(o=this.line[this.line.length-2]).x===e&&o.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(o=this.line[this.line.length-2],this._is_h=o.x===e,this._is_v=o.y===t)):(this._is_h=o.x===e,this._is_v=o.y===t)):this._is_v&&s?(n.x=e,n.y=t,(o=this.line[this.line.length-2]).x===e&&o.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(o=this.line[this.line.length-2],this._is_h=o.x===e,this._is_v=o.y===t)):(this._is_h=o.x===e,this._is_v=o.y===t)):(this.line.push(new i.Point(e,t)),this._is_h=a,this._is_v=s)}else this.line.push(new i.Point(e,t))},e}();t.TileClipper=o;var a=function(){function e(){}return e.prototype.setExtent=function(e){this._ratio=4096===e?1:4096/e},e.prototype.reset=function(e){this.type=e,this.lines=[],this.line=null},e.prototype.moveTo=function(e,t){this.line&&this.lines.push(this.line),this.line=[];var r=this._ratio;this.line.push(new i.Point(Math.round(e*r),Math.round(t*r)))},e.prototype.lineTo=function(e,t){var r=this._ratio;this.line.push(new i.Point(Math.round(e*r),Math.round(t*r)))},e.prototype.close=function(){var e=this.line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])},e.prototype.result=function(){return this.line&&this.lines.push(this.line),0===this.lines.length?null:(3===this.type&&1!==this._ratio&&s.simplify(4096,64,this.lines),this.lines)},e}();t.SimpleBuilder=a;var s=function(){function e(){}return e.simplify=function(t,i,r){if(r){for(var n=-i,o=t+i,a=-i,s=t+i,l=[],u=[],h=r.length,d=0;d<h;++d){var c=r[d];if(c&&!(c.length<2))for(var f=c[0],p=void 0,v=c.length,_=1;_<v;++_)p=c[_],f.x===p.x&&(f.x<=n&&(f.y>p.y?(l.push(d),l.push(_),l.push(0),l.push(-1)):(u.push(d),u.push(_),u.push(0),u.push(-1))),f.x>=o&&(f.y<p.y?(l.push(d),l.push(_),l.push(1),l.push(-1)):(u.push(d),u.push(_),u.push(1),u.push(-1)))),f.y===p.y&&(f.y<=a&&(f.x<p.x?(l.push(d),l.push(_),l.push(2),l.push(-1)):(u.push(d),u.push(_),u.push(2),u.push(-1))),f.y>=s&&(f.x>p.x?(l.push(d),l.push(_),l.push(3),l.push(-1)):(u.push(d),u.push(_),u.push(3),u.push(-1)))),f=p}if(0!==l.length&&0!==u.length){e.fillParent(r,u,l),e.fillParent(r,l,u);var m=[];e.calcDeltas(m,u,l),e.calcDeltas(m,l,u),e.addDeltas(m,r)}}},e.fillParent=function(e,t,i){for(var n=i.length,o=t.length,a=0;a<o;a+=4){for(var s=t[a],l=t[a+1],u=t[a+2],h=e[s][l-1],d=e[s][l],c=8092,f=-1,p=0;p<n;p+=4)if(i[p+2]===u){var v=i[p],_=i[p+1],m=e[v][_-1],g=e[v][_];switch(u){case 0:case 1:if(r.between(h.y,m.y,g.y)&&r.between(d.y,m.y,g.y))(y=Math.abs(g.y-m.y))<c&&(c=y,f=p);break;case 2:case 3:var y;if(r.between(h.x,m.x,g.x)&&r.between(d.x,m.x,g.x))(y=Math.abs(g.x-m.x))<c&&(c=y,f=p)}}t[a+3]=f}},e.calcDeltas=function(t,i,r){for(var n=i.length,o=0;o<n;o+=4){var a=e.calcDelta(o,i,r,[]);t.push(i[o]),t.push(i[o+1]),t.push(i[o+2]),t.push(a)}},e.calcDelta=function(t,i,r,n){var o=i[t+3];if(-1===o)return 0;var a=n.length;return a>1&&n[a-2]===o?0:(n.push(o),e.calcDelta(o,r,i,n)+1)},e.addDeltas=function(e,t){for(var i=e.length,r=0,n=0;n<i;n+=4){(s=e[n+3])>r&&(r=s)}for(n=0;n<i;n+=4){var o=t[e[n]],a=e[n+1],s=r-e[n+3];switch(e[n+2]){case 0:o[a-1].x-=s,o[a].x-=s,1===a&&(o[o.length-1].x-=s),a===o.length-1&&(o[0].x-=s);break;case 1:o[a-1].x+=s,o[a].x+=s,1===a&&(o[o.length-1].x+=s),a===o.length-1&&(o[0].x+=s);break;case 2:o[a-1].y-=s,o[a].y-=s,1===a&&(o[o.length-1].y-=s),a===o.length-1&&(o[0].y-=s);break;case 3:o[a-1].y+=s,o[a].y+=s,1===a&&(o[o.length-1].y+=s),a===o.length-1&&(o[0].y+=s)}}},e}()}.apply(null,r))||(e.exports=n)},1735:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._pos=0;var i=t?this._roundToNearest4(t):40;this._array=new ArrayBuffer(i),this._buffer=new e(this._array),this._ctor=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this._pos},enumerable:!0,configurable:!0}),e.prototype._roundToNearest4=function(e){var t=Math.round(e);return t+(4-t%4)},e.prototype._ensureSize=function(e){if(this._pos+e>=this._buffer.length){var t=this._roundToNearest4(1.5*(this._array.byteLength+4*e)),i=new ArrayBuffer(t),r=new this._ctor(i);r.set(this._buffer,0),this._array=i,this._buffer=r}},e.prototype.writeInt32=function(e){this._ensureSize(1);var t=this._pos;return this._buffer[this._pos++]=e,t},e.prototype.writeF32=function(e){this._ensureSize(1);var t=this._pos;return new Float32Array(this._array,4*this._pos,1)[0]=e,this._pos++,t},e.prototype.writeUint32=function(e){this._ensureSize(1);var t=this._pos;return this._buffer[this._pos++]=e,t},e.prototype.push=function(e){this._ensureSize(1);var t=this._pos;return this._buffer[this._pos++]=e,t},e.prototype.writeRegion=function(e){this._ensureSize(e.length);var t=this._pos;return this._buffer.set(e,this._pos),this._pos+=e.length,t},e.prototype.buffer=function(){var e=this._array.slice(0,4*this._pos);return this.destroy(),e},e.prototype.destroy=function(){this._array=null,this._buffer=null},e}();t.default=i}.apply(null,r))||(e.exports=n)},1798:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(10),i(11),i(1661),i(1511),i(1667),i(1857),i(1527),i(1856),i(1869),i(1870),i(1871),i(1872),i(1873),i(1874),i(1875),i(1498)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,h,d,c,f,p,v,_,m){Object.defineProperty(t,"__esModule",{value:!0});var g=function(){function e(){this._initialized=!1}return e.prototype.registerPass=function(e,t){this._initialize();for(var i=0,r=t;i<r.length;i++){var n=r[i];this._passMap.set(n,e)}return this},e.prototype.getPaintPassTs=function(e){return this._initialize(),this._passMap.has(e)?[this._passMap.get(e)]:[]},e.prototype._initialize=function(){this._initialized||(this._passMap=new Map,this._initialized=!0)},e}();t.WGLPainterOptions=g;var y=new Uint8Array(4*l.C_HITTEST_SEARCH_SIZE*l.C_HITTEST_SEARCH_SIZE),x=new Uint32Array(y.buffer),S=function(){function e(){this._hlPainter=new _,this._extrudeMatrix=new Float32Array(16),this._extrudeNoRotationMatrix=new Float32Array(16),this._extrudeRotateVector=new Float32Array([0,0,1]),this._extrudeScaleVector=new Float32Array([1,1,1]),this._state={rotation:0,width:0,height:0},this._cachedWidth=0,this._cachedHeight=0,this._cachedRotation=0,this.materialManager=new s}return e.allGeometryPhases=function(){return[o.WGLDrawPhase.FILL,o.WGLDrawPhase.LINE,o.WGLDrawPhase.MARKER,o.WGLDrawPhase.TEXT]},e.toWGLDrawPhases=function(e){for(var t,i=[],r=0;r<o.WGLDrawPhase.NUM_DRAW_PHASES;r++)(t=1<<r)&e&&i.push(t);return i},Object.defineProperty(e.prototype,"extrudeMatrix",{get:function(){return this._extrudeMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extrudeNoRotationMatrix",{get:function(){return this._extrudeNoRotationMatrix},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.materialManager.dispose(),this.textureManager=null,this._hlPainter&&(this._hlPainter.dispose(),this._hlPainter=null),this._hittestFBO&&(this._hittestFBO.dispose(),this._hittestFBO=null),this._passes&&(this._passes.forEach(function(e){return e.dispose()}),this._passes.clear()),this._brushes&&(this._brushes.forEach(function(e){return e.forEach(function(e){return e.dispose()})}),this._brushes.clear())},e.prototype.initialize=function(e){this.materialManager.initialize(e)},e.prototype.update=function(e,t){this._state=e,this._state.width===this._cachedWidth&&this._state.height===this._cachedHeight&&this._state.rotation===this._cachedRotation||(this._extrudeScaleVector[0]=2/e.width,this._extrudeScaleVector[1]=-2/e.height,n.identity(this._extrudeMatrix),n.rotate(this._extrudeMatrix,this._extrudeMatrix,-e.rotation*a.C_DEG_TO_RAD,this._extrudeRotateVector),n.scale(this._extrudeMatrix,this._extrudeMatrix,this._extrudeScaleVector),n.transpose(this._extrudeMatrix,this._extrudeMatrix),n.identity(this._extrudeNoRotationMatrix),n.scale(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix,this._extrudeScaleVector),n.transpose(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix),this._cachedWidth=this._state.width,this._cachedHeight=this._state.height,this._cachedRotation=this._state.rotation)},e.prototype.getBrushes=function(e){if(!this._brushes){var t=new d.default,i=new p.default,r=new f.default,n=new v.default,a=new c.default,s=new u.default,l=new h.default;this._brushes=new Map,this._brushes.set(o.WGLDrawPhase.FILL,[t]),this._brushes.set(o.WGLDrawPhase.MARKER,[i]),this._brushes.set(o.WGLDrawPhase.LINE,[r]),this._brushes.set(o.WGLDrawPhase.TEXT,[n]),this._brushes.set(o.WGLDrawPhase.LABEL,[a]),this._brushes.set(o.WGLDrawPhase.LABEL_ALPHA,[a]),this._brushes.set(o.WGLDrawPhase.HITTEST,[t,i,r,n]),this._brushes.set(o.WGLDrawPhase.HIGHLIGHT,[t,i,r,n]),this._brushes.set(o.WGLDrawPhase.CLIP,[l]),this._brushes.set(o.WGLDrawPhase.DEBUG,[s])}if(!this._brushes.has(e))throw new Error("WGLPainter: Tried to get brush for unknown phase: "+e);return this._brushes.get(e)},e.prototype.bindTextureManager=function(e){this.textureManager=e},e.prototype.draw=function(e,t,i,r){i[0]===o.WGLDrawPhase.LABEL_ALPHA&&i[0]===o.WGLDrawPhase.LABEL||this._drawClippingRects(e,t);var n=e.context;n.setBlendingEnabled(!0),n.setStencilWriteMask(0),n.setBlendFunctionSeparate(1,771,1,771),this._drawPhases(e,t,i,r),this._debugTiles(e,t)},e.prototype.setHighlightOptions=function(e){this._hlPainter.setHighlightOptions(e)},e.prototype.highlight=function(e,t){var i=e.context,r=i.getViewport();this._hlPainter.setup(i,r.width,r.height),this._hlPainter.startMaskDraw(i),this._drawClippingRects(e,t),i.setBlendingEnabled(!0),i.setStencilWriteMask(0),i.setBlendFunctionSeparate(1,771,1,771),this._drawPhases(e,t,[o.WGLDrawPhase.HIGHLIGHT]),this._hlPainter.draw(i)},e.prototype.hitTest=function(e,t){var i=l.C_HITTEST_SEARCH_SIZE,r=[0,0],n=[0,0],a=e.state;if(a.toMap(r,[0,0]),a.toMap(n,[i,i]),0===t.filter(function(e){return!(r[0]>e.bounds[2]||n[0]<e.bounds[0]||r[1]<e.bounds[1]||n[1]>e.bounds[3])}).length)return[];var s=e.context;this._hittestFBO||(this._hittestFBO=m.create(s,{colorTarget:0,depthStencilTarget:3,width:i,height:i}));var u=s.getViewport(),h=s.getBoundFramebufferObject();s.bindFramebuffer(this._hittestFBO),s.setViewport(0,0,i,i),this._drawClippingRects(e,t);var d=s.gl;s.setClearColor(1,1,1,1),s.clear(d.COLOR_BUFFER_BIT),s.setBlendingEnabled(!1),s.setStencilWriteMask(0),this._drawPhases(e,t,[o.WGLDrawPhase.HITTEST]),s.setBlendingEnabled(!0),this._hittestFBO.readPixels(0,0,i,i,6408,5121,y);for(var c=i*i,f=new Set,p=0;p<c;p++){var v=x[p];4294967295!==v&&f.add(v)}s.bindFramebuffer(h),s.setViewport(u.x,u.y,u.width,u.height);var _=[];return f.forEach(function(e){_.push(e)}),_},e.prototype._getPaintPass=function(e){if(this._passes||(this._passes=new Map),!this._passes.has(e))try{this._passes.set(e,new e)}catch(t){throw new Error("Tried to instantiate WGLPaintPass with unknown constructor: "+e+",\n"+t)}return this._passes.get(e)},e.prototype._getPaintPasses=function(e,t){var i=this;return t.getPaintPassTs(e).map(function(e){return i._getPaintPass(e)})},e.prototype._drawPhases=function(e,t,r,n){e.context.setStencilTestEnabled(!0);for(var o=0,a=r;o<a.length;o++){var s=a[o],l=n?this._getPaintPasses(s,n):[],u=i({},e,{drawPhase:s});l.forEach(function(t){return t.preRender(e,e.rendererInfo)});for(var h=0,d=t;h<d.length;h++)d[h].doRender(u);l.reverse().forEach(function(t){return t.postRender(e,e.rendererInfo)})}e.context.setStencilTestEnabled(!1)},e.prototype._debugTiles=function(e,t){r("esri-feature-tiles-debug")&&this._drawPhases(e,t,[o.WGLDrawPhase.DEBUG])},e.prototype._drawClippingRects=function(e,t){if(0!==t.length){var i=e.context;i.setDepthWriteEnabled(!1),i.setDepthTestEnabled(!1),i.setStencilTestEnabled(!0),i.setBlendingEnabled(!1),i.setColorMask(!1,!1,!1,!1),i.setStencilOp(7680,7680,7681),i.setClearStencil(0),i.clear(i.gl.STENCIL_BUFFER_BIT),i.setStencilWriteMask(255);for(var r=0,n=t.length;r<t.length;r++,n--){var a=t[r];a.attached&&(a.stencilRef=n)}this._drawPhases(e,t,[o.WGLDrawPhase.CLIP]),e.context.setColorMask(!0,!0,!0,!0)}},e}();t.default=S}.apply(null,r))||(e.exports=n)},1799:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){return function(e,t){return e.geometryType=7&t,t>>=3,e.sdf=0!=(4&t),e.vvSizeMinMaxValue=0!=(8&t),e.vvSizeScaleStops=0!=(16&t),e.vvSizeFieldStops=0!=(32&t),e.vvSizeUnitValue=0!=(64&t),e.vvColor=0!=(128&t),e.vvRotation=0!=(256&t),e.vvOpacity=0!=(512&t),e.visibility=0!=(1024&t),e.pattern=0!=(2048&t),e.heatmap=0!=(4096&t),e}}.apply(null,r))||(e.exports=n)},1800:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(483),i(1649),i(1886),i(1665)],void 0===(n=function(e,t,i,r,n,o){return function(){function e(e){this.xBucket=-1,this.yBucket=-1,this.xOverflow=-1,this.yOverflow=-1,this.id=e,this.displayRecords=[],this.metrics=[],this.anchor=null}return e.prototype.copy=function(){var t=new e(this.id);return t.set(this),t},e.prototype.set=function(e){this.id=e.id,this.displayRecords=e.displayRecords,this.metrics=e.metrics,this.anchor=e.anchor,this.xBucket=e.xBucket,this.yBucket=e.yBucket,this.xOverflow=e.xOverflow,this.yOverflow=e.yOverflow},e.prototype.addMetric=function(e,t,i,r){this.metrics.push(new n.default(e,{from:t,count:i},r))},e.prototype.serialize=function(e){return e.writeInt32(this.id),o.serializeList(e,this.metrics),o.serializeList(e,this.displayRecords),this.anchor?(e.writeF32(this.anchor[0]),e.writeF32(this.anchor[1]),e.writeInt32(this.xBucket),e.writeInt32(this.yBucket),e.writeInt32(this.xOverflow),e.writeInt32(this.yOverflow)):(e.writeF32(0),e.writeF32(0)),e},e.deserialize=function(t,a){var s=a.store,l=t.readInt32(),u=new e(l),h={id:l,store:s},d=o.deserializeList(t,n.default);d.length&&(u.metrics=d),u.displayRecords=o.deserializeList(t,r,h);var c=t.readF32(),f=t.readF32();return(c||f)&&(u.anchor=i.fromValues(c,f),u.xBucket=t.readInt32(),u.yBucket=t.readInt32(),u.xOverflow=t.readInt32(),u.yOverflow=t.readInt32()),u},e}()}.apply(null,r))||(e.exports=n)},1801:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(9),i(1641),i(479),i(1511),i(1511),i(1811),i(1644),i(1729),i(1527),i(1649),i(1681)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,h,d,c,f){Object.defineProperty(t,"__esModule",{value:!0});var p=r.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate"),v=l.allocTriangles(20),_=l.allocTriangles(20),m=[l.allocExtrudeVectors(),l.allocExtrudeVectors()],g=l.allocExtrudeVectors(),y=o.TILE_SIZE+8,x=new l.Tessellator({distanceAlongCorrection:!0}),S=new h.TileClipper(0,0,0,1,8);S.setExtent(512);var V=function(e){function t(t,i,r,n,o,s,l,u,h,d,c){var f=e.call(this)||this;f.capType=s,f.joinType=l,f.fillColor=u,f.tl=h,f.br=d,f.hasPattern=c,f.geometryType=a.WGLGeometryType.LINE;var p=1/o;return f.halfWidth=n>0?.5*(n+p):0,f._materialStore=t,f.vvFlags=i,f.materialId=f._materialStore.createSpriteMaterial(r,f.geometryType,i),f}return i(t,e),t.fromSimpleLine=function(e,i,r,o,a){var s=r.color,l=d.getCapType(r.cap||"round"),h=d.getJoinType(r.join||"round"),c=s&&"none"!==r.style&&n.premultiplyAlphaRGBA(s)||0;if("none"===r.style&&(c=0),!o)return new t(e,i,o,r.width,a,l,h,c,0,0,!1);var f=o.rect,p=o.width,v=o.height,_=f.x+1,m=f.y+1,g=f.x+1+p,y=f.y+1+v,x=u.i1616to32(_,m),S=u.i1616to32(g,y);return new t(e,i,o,r.width,a,l,h,c,x,S,!0)},t.fromPictureLineSymbol=function(e,t,i,r){return p.error("PictureLineSymbol support does not exist!"),null},t.prototype.writeMesh=function(e,t,i,r,n,o,a){if(this.vvFlags&s.WGLVVFlag.COLOR||0!==this.fillColor){var l=this._materialStore.get(this.materialId),u=t.indexVector,h=t.get("geometry"),d=this.halfWidth,f=new c(r,this.geometryType,this.materialId),v=this._getOffset(h,l);switch(f.vertexFrom=v,f.indexFrom=u.length,e.push(f),i){case"esriGeometryPolyline":var _=n.geometry.paths,m=this._clipLines(_);return void this._write(f,u,h,v,r,d,m,l,a);case"esriGeometryPolygon":var g=n.geometry.rings;m=this._clipLines(g);return void this._write(f,u,h,v,r,d,m,l,a);default:p.error("Unable to handle geometryType: "+i)}}},t.prototype._clipLines=function(e){for(var t=[],i=!1,r=0;r<e.length;){var n=[],o=e[r];S.reset(2);var a=o[0],s=a[0],l=a[1];if(i)S.moveTo(s,l);else{if(s<-8||s>y||l<-8||l>y){i=!0;continue}n.push({x:s,y:l})}for(var u=!1,h=o.length,d=1;d<h;++d)if(s+=o[d][0],l+=o[d][1],i)S.lineTo(s,l);else{if(s<-8||s>y||l<-8||l>y){u=!0;break}n.push({x:s,y:l})}if(u)i=!0;else{if(i){var c=S.resultWithStarts();if(c)for(var f=0,p=c;f<p.length;f++){var v=p[f];t.push(v)}}else t.push({line:n,start:0});r++,i=!1}}return t},t.prototype._getOffset=function(e,t){var i=t.materialKeyInfo.hasVV()?11:8;return e.length/i},t.prototype._write=function(e,t,i,r,n,o,a,s,u){for(var h=0,d=0,c=a;d<c.length;d++){var f=c[d],p=f.line,_=f.start;if(!(p.length<2))for(var y=p[0],S=p[p.length-1],V=S.x-y.x,I=S.y-y.y,b=V*V+I*I<1e-6,w=_%65535,M=m[1],T=0;T<p.length;T++){var E=p[T],L=M===m[T%2]?m[(T+1)%2]:m[T%2],D=0===T,F=T===p.length-1;if(F&&b&&!this.hasPattern?l.copyExtrudeVectors(L,g):(this._computeExtrudeVectors(L,T,p,b),h+=this._writeVertices(i,n,o,E.x,E.y,L,w,h,s,u),!L.capCenter||b&&F||this._writePieIndices(e,t,r,L),b&&D&&!this.hasPattern&&l.copyExtrudeVectors(g,L)),D||this._writeBridgeIndices(e,t,r,M,L),!F){var O=p[T+1],C=[O.x-E.x,O.y-E.y],A=l.length(C),z=[C[0]/A,C[1]/A],P=w+A;if(P>65535){var R=(65535-w)/(P-w),N=E.x+(O.x-E.x)*R,G=E.y+(O.y-E.y)*R,U=M;x.buttCap(U,z,z),h+=this._writeVertices(i,n,o,N,G,U,65535,h,s,u),x.bridge(v,L,U),this._writeBridgeIndices(e,t,r,L,U),x.buttCap(U,z,z),w=P-65535}else w=P,M=L}}}e.vertexCount=h},t.prototype._writeVertices=function(e,t,i,r,n,o,a,s,l,h){for(var d=0,c=u.i1616to32(r,n),f=o.vectors,p=f.items,v=f.count;d<v;++d){var _=p[d].vector,m=_[0],g=_[1],y=p[d].texCoords,x=y[0],S=y[1],V=p[d].direction,I=V[0],b=V[1],w=u.i1616to32(a,31*i),M=u.i8888to32(Math.round(31*m),Math.round(31*g),Math.round(31*x),Math.round(31*S)),T=u.i8888to32(Math.round(31*I),Math.round(31*b),0,0);e.push(c),e.push(t),e.push(this.fillColor),e.push(M),e.push(w),e.push(this.tl),e.push(this.br),e.push(T),this._writeVV(e,h,l),p[d].base={index:s+d,point:[r,n]}}return d},t.prototype._writeVV=function(e,t,i){i.materialKeyInfo.hasVV()&&(e.push(t[a.VVType.SIZE]),e.push(t[a.VVType.COLOR]),e.push(t[a.VVType.OPACITY]))},t.prototype._writeBridgeIndices=function(e,t,i,r,n){x.bridge(v,r,n);for(var o=0;o<v.count;++o){var a=v.items[o];t.push(i+a.v1.base.index),t.push(i+a.v2.base.index),t.push(i+a.v3.base.index),e.indexCount+=3}},t.prototype._writePieIndices=function(e,t,i,r){x.pie(_,r);for(var n=0;n<_.count;++n){var o=_.items[n];t.push(i+o.v1.base.index),t.push(i+o.v2.base.index),t.push(i+o.v3.base.index),e.indexCount+=3}},t.prototype._computeExtrudeVectors=function(e,t,i,r){var n=i[t],o=[void 0,void 0],a=[void 0,void 0];if(t>0&&t<i.length-1){var s=i[(t+i.length-1)%i.length],u=i[(t+1)%i.length];l.normalize(o,[n.x-s.x,n.y-s.y]),l.normalize(a,[u.x-n.x,u.y-n.y])}else if(0===t){u=i[(t+1)%i.length];if(l.normalize(a,[u.x-n.x,u.y-n.y]),r){var h=i[i.length-2];l.normalize(o,[n.x-h.x,n.y-h.y])}else o=a}else{if(t!==i.length-1)return void console.error("Vertex index 'i' out of range.");s=i[(t+i.length-1)%i.length];if(l.normalize(o,[n.x-s.x,n.y-s.y]),r){var d=i[1];l.normalize(a,[d.x-n.x,d.y-n.y])}else a=o}r||0!==t?r||t!==i.length-1?this._computeJoinExtrudeVectors(e,o,a):this._computeCapExtrudeVectors(e,o,a,l.CapPosition.END):this._computeCapExtrudeVectors(e,o,a,l.CapPosition.START)},t.prototype._computeCapExtrudeVectors=function(e,t,i,r){switch(this.capType){case a.CapType.BUTT:return void x.buttCap(e,t,i);case a.CapType.ROUND:var n=l.getNumberOfSlices(Math.PI),o=r===l.CapPosition.START?-1:1;return void x.roundCap(e,t,i,r,n,o);case a.CapType.SQUARE:return void x.squareCap(e,t,i,r);default:return p.error("Encountered unknown cap type: "+this.capType+", defaulting to BUTT"),void x.buttCap(e,t,i)}},t.prototype._computeJoinExtrudeVectors=function(e,t,i){var r=l.getRads(t,i);if(r>Math.PI-.05)x.rectJoin(e,t,i);else if(this.joinType===a.JoinType.MITER||r<.1)r<.05?x.fastMiterJoin(e,t,i):r<l.MITER_SAFE_RADS?x.miterJoin(e,t,i):x.bevelJoin(e,t,i,l.SYSTEM_MAG_LIMIT);else if(this.joinType===a.JoinType.BEVEL)x.bevelJoin(e,t,i,1);else if(this.joinType===a.JoinType.ROUND){var n=l.getNumberOfSlices(r);r<2.3?n<2||r<.5?x.bevelJoin(e,t,i,1):x.roundJoin(e,t,i,n):x.unitRoundJoin(e,t,i,n)}},t}(f.default);t.default=V}.apply(null,r))||(e.exports=n)},1802:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(9),i(32),i(496),i(483),i(1641),i(479),i(1511),i(1644),i(1649),i(1681)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,h,d,c){Object.defineProperty(t,"__esModule",{value:!0});var f=r.getLogger("esri.views.2d.engine.webgl.WGLMeshTemplate"),p=function(e){function t(t,i,r,n,s,l,d,c,f,p,v){var _=e.call(this)||this;_.geometryType=u.WGLGeometryType.MARKER;var m=a.create(),g=o.create(),y=v.sdf?.5:1;o.translate(g,g,new Float32Array([y*r,y*-n])),s&&o.rotate(g,g,3.14159265359/180*s),_._materialStore=t,_.vvFlags=i,_._materialId=t.createSpriteMaterial(v,_.geometryType,i),_._fillColor=l,_._outlineColor=f,_._sizeOutlineWidth=h.i8888to32(d,c,p,0);var x=Math.round(v.rect.x/4),S=Math.round(v.rect.y/4),V=x+Math.round(v.rect.width/4),I=S+Math.round(v.rect.height/4);return m.set([-.5*d,-.5*c]),a.transformMat2d(m,m,g),_._offsetAndTexUpperLeft=h.i8888to32(m[0],m[1],x,S),m.set([.5*d,-.5*c]),a.transformMat2d(m,m,g),_._offsetAndTexUpperRight=h.i8888to32(m[0],m[1],V,S),m.set([-.5*d,.5*c]),a.transformMat2d(m,m,g),_._offsetAndTexBottomLeft=h.i8888to32(m[0],m[1],x,I),m.set([.5*d,.5*c]),a.transformMat2d(m,m,g),_._offsetAndTexBottomRight=h.i8888to32(m[0],m[1],V,I),_.height=c,_.width=d,_.xOffset=r,_.yOffset=n,_}return i(t,e),t.fromPictureMarker=function(e,i,r,o,a){var s=Math.round(n.pt2px(r.width)),u=Math.round(n.pt2px(r.height)),h=l.PICTURE_FILL_COLOR;return new t(e,i,Math.round(n.pt2px(r.xoffset||0)),Math.round(n.pt2px(r.yoffset||0)),r.angle,h,s,u,0,0,o)},t.fromSimpleMarker=function(e,i,r,o,a){var l=s.premultiplyAlphaRGBA(r.color),u=Math.round(n.pt2px(r.size)),h=u,d=Math.round(n.pt2px(r.xoffset||0)),c=Math.round(n.pt2px(r.yoffset||0)),f=r.outline,p=0|(f&&f.color&&s.premultiplyAlphaRGBA(f.color)),v=0|(f&&f.width&&Math.round(n.pt2px(f.width)));return new t(e,i,d,c,r.angle,l,u,h,p,v,o)},t.prototype.writeMesh=function(e,t,i,r,n,o,a){var s=this._materialStore.get(this._materialId),l=t.indexVector,u=t.get("geometry"),h=new d(r,this.geometryType,this._materialId),c=this._getOffset(u,s);switch(e.push(h),h.vertexFrom=c,h.indexFrom=l.length,i){case"esriGeometryPoint":var p=n.geometry,v=p.x,_=p.y;return this._writeVertices(h,u,r,this._getPos(v,_),s,a),void this._writeIndices(h,l,c);case"esriGeometryPolyline":var m=n.geometry.paths;return void this._writeMany(h,l,u,c,r,m[0],s,a);case"esriGeometryPolygon":var g=n.centroid;if(g){v=g.x,_=g.y;this._writeVertices(h,u,r,this._getPos(v,_),s,a),this._writeIndices(h,l,c)}else f.error("Tried to render polygon geometries as markers, but found no centroid!");return;case"esriGeometryMultipoint":var y=n.geometry.points;return void this._writeMany(h,l,u,c,r,y,s,a);case"esriGeometryEnvelope":default:f.error("Unable to handle geometryType: "+i)}},t.prototype._getPos=function(e,t){return h.i1616to32(e,t)},t.prototype._writeMany=function(e,t,i,r,n,o,a,s){for(var l=0,u=0,h=0,d=0,c=o;d<c.length;d++){var f=c[d],p=f[0],v=f[1];this._writeVertices(e,i,n,this._getPos(p+l,v+u),a,s),this._writeIndices(e,t,r+h),l+=p,u+=v,h+=4}},t.prototype._getOffset=function(e,t){var i=t.materialKeyInfo.hasVV()?10:6;return e.length/i},t.prototype._writeVertices=function(e,t,i,r,n,o){t.push(r),t.push(this._offsetAndTexUpperLeft),t.push(i),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth),this._writeVV(t,o,n),t.push(r),t.push(this._offsetAndTexUpperRight),t.push(i),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth),this._writeVV(t,o,n),t.push(r),t.push(this._offsetAndTexBottomLeft),t.push(i),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth),this._writeVV(t,o,n),t.push(r),t.push(this._offsetAndTexBottomRight),t.push(i),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth),this._writeVV(t,o,n),e.vertexCount+=4},t.prototype._writeVV=function(e,t,i){i.materialKeyInfo.hasVV()&&(e.push(t[u.VVType.SIZE]),e.push(t[u.VVType.COLOR]),e.push(t[u.VVType.OPACITY]),e.push(t[u.VVType.ROTATION]))},t.prototype._writeIndices=function(e,t,i){var r=i;t.push(r+0),t.push(r+1),t.push(r+2),t.push(r+1),t.push(r+3),t.push(r+2),e.indexCount+=6},t}(c.default);t.default=p}.apply(null,r))||(e.exports=n)},1803:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(9),i(32),i(1641),i(479),i(1511),i(1666),i(1644),i(1728),i(1649),i(1723),i(1681),i(1816)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,h,d,c,f,p){Object.defineProperty(t,"__esModule",{value:!0});var v=r.getLogger("esri.views.2d.engine.webgl.WGLTextTemplate"),_=10,m=24,g=1.2*m,y=10*m,x=function(){function e(e,t,i,r,n,o,a,s,l){this.materialId=e,this.vertexOffsetUpperLeft=t,this.vertexOffsetUpperRight=i,this.vertexOffsetLowerLeft=r,this.vertexOffsetLowerRight=n,this.texFontSizeUpperLeft=o,this.texFontSizeUpperRight=a,this.texFontSizeLowerLeft=s,this.texFontSizeLowerRight=l}return e.from=function(t,i,r,n,o){var a,s,h=t.glyphMosaicItem,d=h.rect,c=h.metrics,f=Math.round(d.x/4),p=Math.round(d.y/4),v=f+Math.round(d.width/4),_=p+Math.round(d.height/4);if(t.codePoint){var m=t.x+0+c.left,g=t.y+-17-c.top;a=new l.Point(m-4,g-4),s=new l.Point(a.x+d.width,a.y+d.height)}else{m=t.x,g=t.y;a=new l.Point(m,g),s=new l.Point(a.x+c.width,a.y+c.height)}var y=new l.Point(a.x,s.y),x=new l.Point(s.x,a.y);if(r){var S=Math.cos(r),V=Math.sin(r);a.rotate(S,V),s.rotate(S,V),y.rotate(S,V),x.rotate(S,V)}return new e(i,u.i1616to32(8*a.x,8*a.y),u.i1616to32(8*x.x,8*x.y),u.i1616to32(8*y.x,8*y.y),u.i1616to32(8*s.x,8*s.y),u.i8888to32(f,p,n,o),u.i8888to32(v,p,n,o),u.i8888to32(f,_,n,o),u.i8888to32(v,_,n,o))},e}();t.ComputedGlyph=x;var S=function(e){function t(t,i,r){var l=e.call(this)||this;l.geometryType=s.WGLGeometryType.TEXT;var u=r.haloColor;l.color=0|(r.color&&o.premultiplyAlphaRGBA(r.color)),l.textSize=n.pt2px(r.font.size);var h=r.xoffset/r.font.size,d=r.yoffset/r.font.size;return l.shapingXOffset=h*m,l.shapingYOffset=d*m,l.haloColor=0|(u&&o.premultiplyAlphaRGBA(u)),l.haloSize=_*n.pt2px(n.toPt(r.haloSize||0)),l.textPropColor=l.color||a.PICTURE_FILL_COLOR,l.textPropSize=n.pt2px(r.font.size),l.textPropAngle=r.angle*Math.PI/180,l.xOffset=n.pt2px(r.xoffset),l.yOffset=n.pt2px(r.yoffset),l.textPropHAnchor="left"===r.horizontalAlignment?0:"right"===r.horizontalAlignment?1:.5,l.textPropVAnchor="top"===r.verticalAlignment?0:"bottom"===r.verticalAlignment?1:.5,l.textPropHaloColor=l.haloColor||4294967295,l.textPropHaloSize=n.pt2px(n.toPt(r.haloSize||0)),l._materialStore=t,l.vvFlags=i,l}return i(t,e),t.fromText=function(e,i,r,n,o){var a=new t(e,i,r);return a.computeGlyphs(o,r.text,!1),a},t.prototype.writeMesh=function(e,t,i,r,n,o,a){var s=t.indexVector,l=t.get("geometry"),u=t.get("visibility"),h=this._getOffset(l);switch(i){case"esriGeometryPoint":var d=n.geometry,c=d.x,f=d.y;return void this._writeVertices(e,s,l,u,h,r,c,f,a);case"esriGeometryPolygon":if(n.centroid){var p=n.centroid;c=p.x,f=p.y;return void this._writeVertices(e,s,l,u,h,r,c,f,a)}default:v.error("Unable to handle geometryType: "+i)}},t.prototype.computeGlyphs=function(e,t,i){if(!t||!t.length)return this._computedGlyphs=[],null;for(var r=this.shapingXOffset,n=this.shapingYOffset,o=this.textPropHAnchor,a=this.textPropVAnchor,l=this._computeShaping(e,y,g,0,r,n,o,a,.5),u=p.bidiText(t),d=u[0],f=u[1],v=l.getShaping(d,f),_=new Array(v.length),S=0;S<v.length;S++){var V=this.textPropAngle,I=this.textSize,b=this.haloSize,w=v[S].glyphMosaicItem,M=this._materialStore.createGlyphMaterial(w,s.WGLGeometryType.TEXT,this.vvFlags);_[S]=x.from(v[S],M,V,I,b)}if(this._computedGlyphs=_,!i)return null;var T=h.getBox(v);return T.width*=this.textSize/m,T.height*=this.textSize/m,new c.default(T.x,T.y,T.width,T.height)},t.prototype._computeShaping=function(e,t,i,r,n,o,a,s,l){return this._shaping=new h([e],y,g,0,[n,o],a,s,.5),this._shaping},t.prototype._getOffset=function(e){var t=!!this.vvFlags?9:5;return e.length/t},t.prototype._writeVertices=function(e,t,i,r,n,o,a,s,l){var h=this._computedGlyphs,c=a,f=s,p=u.i1616to32(2*c,2*f),v=u.i1616to32(2*c+1,2*f),_=0;if(this.haloSize)for(var m=0;m<h.length;m++,_+=4){var g=h[m].materialId,y=this._materialStore.get(g);(x=new d(o,this.geometryType,g)).vertexFrom=n+_,x.indexFrom=t.length,this._writeVertex(x,i,r,o,v,this.haloColor,h[m],y,l),this._writeIndices(x,t,n+_),e.push(x)}for(m=0;m<h.length;m++,_+=4){var x;g=h[m].materialId,y=this._materialStore.get(g);(x=new d(o,this.geometryType,g)).vertexFrom=n+_,x.indexFrom=t.length,this._writeVertex(x,i,r,o,p,this.color,h[m],y,l),this._writeIndices(x,t,n+_),e.push(x)}},t.prototype._writeVertex=function(e,t,i,r,n,o,a,s,l){t.push(n),t.push(r),t.push(o),t.push(a.vertexOffsetUpperLeft),t.push(a.texFontSizeUpperLeft),this._writeVV(t,l,s),t.push(n),t.push(r),t.push(o),t.push(a.vertexOffsetUpperRight),t.push(a.texFontSizeUpperRight),this._writeVV(t,l,s),t.push(n),t.push(r),t.push(o),t.push(a.vertexOffsetLowerLeft),t.push(a.texFontSizeLowerLeft),this._writeVV(t,l,s),t.push(n),t.push(r),t.push(o),t.push(a.vertexOffsetLowerRight),t.push(a.texFontSizeLowerRight),this._writeVV(t,l,s),i.push(4294967295),e.vertexCount+=4},t.prototype._writeVV=function(e,t,i){i.materialKeyInfo.hasVV()&&(e.push(t[s.VVType.SIZE]),e.push(t[s.VVType.COLOR]),e.push(t[s.VVType.OPACITY]),e.push(t[s.VVType.ROTATION]))},t.prototype._writeIndices=function(e,t,i){t.push(i+0),t.push(i+1),t.push(i+2),t.push(i+1),t.push(i+3),t.push(i+2),e.indexCount+=6},t}(f.default);t.default=S}.apply(null,r))||(e.exports=n)},1804:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1511),i(1731)],void 0===(n=function(e,t,i,r){function n(e,t){void 0===t&&(t=!1);var r=i.WGLVVFlag.SIZE_FIELD_STOPS|i.WGLVVFlag.SIZE_MINMAX_VALUE|i.WGLVVFlag.SIZE_SCALE_STOPS|i.WGLVVFlag.SIZE_UNIT_VALUE,n=(e&(i.WGLVVTarget.FIELD_TARGETS_OUTLINE|i.WGLVVTarget.MINMAX_TARGETS_OUTLINE|i.WGLVVTarget.SCALE_TARGETS_OUTLINE|i.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return t?r&n:r&~n}function o(e){var t=n(e,!1);return e&(i.WGLVVFlag.COLOR|i.WGLVVFlag.OPACITY|i.WGLVVFlag.ROTATION|t)}Object.defineProperty(t,"__esModule",{value:!0}),t.getVVFlags=function(e){if(!e)return i.WGLVVFlag.NONE;for(var t=0,n=0,o=e;n<o.length;n++){var a=o[n];if("size"===a.type){var s=r.getTypeOfSizeVisualVariable(a);t|=s,"outline"===a.target&&(t|=s<<4)}else"color"===a.type?t|=i.WGLVVFlag.COLOR:"opacity"===a.type?t|=i.WGLVVFlag.OPACITY:"rotation"===a.type&&(t|=i.WGLVVFlag.ROTATION)}return t},t.getSizeFlagsMask=n,t.getMarkerVVFlags=o,t.getFillVVFlags=function(e){return e&(i.WGLVVFlag.COLOR|i.WGLVVFlag.OPACITY)},t.getLineVVFlags=function(e,t){if(t)return e&n(e,!0);var r=n(e,!1);return e&(i.WGLVVFlag.COLOR|i.WGLVVFlag.OPACITY|r)},t.getTextVVFlags=function(e){return o(e)}}.apply(null,r))||(e.exports=n)},1811:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){function i(e){var t,i={items:new Array,count:0};for(t=0;t<e;++t)i.items.push(void 0);return i}function r(e,t){x.vector[0]=e.vector[0],x.vector[1]=e.vector[1],x.texCoords[0]=e.texCoords[0],x.texCoords[1]=e.texCoords[1],x.direction[0]=e.direction[0],x.direction[1]=e.direction[1],x.base=e.base,e.vector[0]=t.vector[0],e.vector[1]=t.vector[1],e.texCoords[0]=t.texCoords[0],e.texCoords[1]=t.texCoords[1],e.direction[0]=t.direction[0],e.direction[1]=t.direction[1],e.base=t.base,t.vector[0]=x.vector[0],t.vector[1]=x.vector[1],t.texCoords[0]=x.texCoords[0],t.texCoords[1]=x.texCoords[1],t.direction[0]=x.direction[0],t.direction[1]=x.direction[1],t.base=x.base}function n(e,t){return e[0]*t[0]+e[1]*t[1]}function o(e){return Math.sqrt(n(e,e))}function a(e,t){var i=o(t);return e[0]=t[0]/i,e[1]=t[1]/i,e}function s(e,t){return e[0]=-t[1],e[1]=t[0],e}function l(e,t){return e[0]*t[1]-e[1]*t[0]}function u(e,t){return e[0]=-t[0],e[1]=-t[1],e}function h(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e}function d(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e}function c(e,t,i){return function(e,t,i){return(t[0]-e[0])*(i[1]-e[1])-(i[0]-e[0])*(t[1]-e[1])}(e,t,i)<0}function f(e,t){var i=n(e,t);return i>.999?0:i<-.999?Math.PI:Math.acos(i)}function p(e,t,i,r,n){if(0!==r){var a,s=o(t),l=f(h(V[0],t,1/s),h(V[1],i,1/s)),u=(n?-1:1)*l/r,d=Math.cos(u),c=Math.sin(u),p=t[0],v=t[1];for(a=0;a<r-1;++a){var _=p;p=d*_-c*v,v=c*_+d*v,e.items[a][0]=p,e.items[a][1]=v}e.count=r-1}else e.count=0}function v(e){var t,i=e.count,r=Math.floor(i/2);for(t=0;t<r;++t){var n=e.items[t];e.items[t]=e.items[i-t-1],e.items[i-t-1]=n}}var _,m;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ENTRY=1]="ENTRY",e[e.EXIT=2]="EXIT",e[e.CAP=3]="CAP"}(_=t.VectorRole||(t.VectorRole={})),function(e){e[e.START=1]="START",e[e.END=2]="END"}(m=t.CapPosition||(t.CapPosition={})),t.SYSTEM_MAG_LIMIT=3.8,t.MITER_SAFE_RADS=2*Math.acos(1/t.SYSTEM_MAG_LIMIT);var g=t.SYSTEM_MAG_LIMIT*t.SYSTEM_MAG_LIMIT,y=16/(2*Math.PI);t.allocTriangles=function(e){var t,i={items:new Array,count:0};for(t=0;t<e;++t)i.items.push({v1:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v2:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v3:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]}});return i},t.allocExtrudeVectors=function(){var e=function(e){var t,i={items:new Array,count:0};for(t=0;t<e;++t)i.items.push({vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]});return i}(30),t={};return t[_.ENTRY]=i(20),t[_.EXIT]=i(20),t[_.CAP]=i(20),{vectors:e,lists:t}},t.copyExtrudeVectors=function(e,t){var i;for(i=0;i<t.vectors.count;++i)e.vectors.items[i].vector[0]=t.vectors.items[i].vector[0],e.vectors.items[i].vector[1]=t.vectors.items[i].vector[1],e.vectors.items[i].texCoords[0]=t.vectors.items[i].texCoords[0],e.vectors.items[i].texCoords[1]=t.vectors.items[i].texCoords[1],e.vectors.items[i].direction[0]=t.vectors.items[i].direction[0],e.vectors.items[i].direction[1]=t.vectors.items[i].direction[1],e.vectors.items[i].base=t.vectors.items[i].base;e.vectors.count=t.vectors.count;var r=t.lists[_.ENTRY],n=e.lists[_.ENTRY],o=t.lists[_.EXIT],a=e.lists[_.EXIT],s=t.lists[_.CAP],l=e.lists[_.CAP];for(i=0;i<r.count;++i)n.items[i]=r.items[i];for(n.count=r.count,i=0;i<o.count;++i)a.items[i]=o.items[i];for(a.count=o.count,i=0;i<s.count;++i)l.items[i]=s.items[i];l.count=s.count,e.capCenter=t.capCenter};var x={vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0],base:void 0};t.swapExtrudeVectors=r;var S,V=[];for(S=0;S<32;++S)V.push([void 0,void 0]);var I=function(e){var t,i={items:new Array,count:0};for(t=0;t<16;++t)i.items.push([void 0,void 0]);return i}();t.length=o,t.normalize=a,t.getNumberOfSlices=function(e){return Math.max(Math.round(e*y),1)},t.getRads=f,t.reverse=v;var b=[void 0,void 0],w=[void 0,void 0],M=[0,0],T=[0,0],E=[0,0],L=[0,0],D=Math.cos(Math.PI/4),F=Math.sin(Math.PI/4),O=Math.sqrt(2),C=function(){function e(e){this._distanceAlongCorrection=e.distanceAlongCorrection}return e.prototype.bridge=function(e,t,i){var n,o,a,s,l=t.vectors,u=t.lists[_.EXIT],h=i.vectors,d=i.lists[_.ENTRY];if(u.count===d.count+1)n=u.items,o=l.items,a=d.items,s=h.items;else if(d.count===u.count+1)n=d.items,o=h.items,a=u.items,s=l.items;else{if(u.count!==d.count)return console.error("Cannot bridge "+u.count+" to "+d.count+"."),void(e.count=0);n=d.items,o=h.items,a=u.items,s=l.items}var f,p=u.count+d.count-2;for(e.count=p,b[0]=n,b[1]=a,w[0]=o,w[1]=s,f=0;f<p;++f){var v=e.items[f],m=(f+0)%2,g=Math.floor((f+0)/2),y=w[m][b[m][g]];v.v1.vector[0]=y.vector[0],v.v1.vector[1]=y.vector[1],v.v1.texCoords[0]=y.texCoords[0],v.v1.texCoords[1]=y.texCoords[1],v.v1.direction[0]=y.direction[0],v.v1.direction[1]=y.direction[1],v.v1.base=y.base;var x=(f+1)%2,S=Math.floor((f+1)/2),V=w[x][b[x][S]];v.v2.vector[0]=V.vector[0],v.v2.vector[1]=V.vector[1],v.v2.texCoords[0]=V.texCoords[0],v.v2.texCoords[1]=V.texCoords[1],v.v2.direction[0]=V.direction[0],v.v2.direction[1]=V.direction[1],v.v2.base=V.base;var I=(f+2)%2,D=Math.floor((f+2)/2),F=w[I][b[I][D]];v.v3.vector[0]=F.vector[0],v.v3.vector[1]=F.vector[1],v.v3.texCoords[0]=F.texCoords[0],v.v3.texCoords[1]=F.texCoords[1],v.v3.direction[0]=F.direction[0],v.v3.direction[1]=F.direction[1],v.v3.base=F.base;var O=v.v1.base&&v.v1.base.point||M,C=v.v2.base&&v.v2.base.point||M,A=v.v3.base&&v.v3.base.point||M;T[0]=O[0]+v.v1.vector[0],T[1]=O[1]+v.v1.vector[1],E[0]=C[0]+v.v2.vector[0],E[1]=C[1]+v.v2.vector[1],L[0]=A[0]+v.v3.vector[0],L[1]=A[1]+v.v3.vector[1],c(T,E,L)||r(v.v2,v.v3)}},e.prototype.pie=function(e,t){if(0!==t.lists[_.CAP].count){if(1===t.lists[_.CAP].count)return console.error("A single vector is not enough to define a pie."),void(e.count=0);var i;for(e.count=t.lists[_.CAP].count-1,i=0;i<e.count;++i){var n=e.items[i],o=t.lists[_.CAP].items[i],a=t.vectors.items[o];n.v1.vector[0]=a.vector[0],n.v1.vector[1]=a.vector[1],n.v1.texCoords[0]=a.texCoords[0],n.v1.texCoords[1]=a.texCoords[1],n.v1.direction[0]=a.direction[0],n.v1.direction[1]=a.direction[1],n.v1.base=a.base;var s=t.lists[_.CAP].items[i+1],l=t.vectors.items[s];n.v2.vector[0]=l.vector[0],n.v2.vector[1]=l.vector[1],n.v2.texCoords[0]=l.texCoords[0],n.v2.texCoords[1]=l.texCoords[1],n.v2.direction[0]=l.direction[0],n.v2.direction[1]=l.direction[1],n.v2.base=l.base;var u=t.capCenter,h=t.vectors.items[u];n.v3.vector[0]=h.vector[0],n.v3.vector[1]=h.vector[1],n.v3.texCoords[0]=h.texCoords[0],n.v3.texCoords[1]=h.texCoords[1],n.v3.direction[0]=h.direction[0],n.v3.direction[1]=h.direction[1],n.v3.base=h.base;var d=n.v1.base&&n.v1.base.point||M,f=n.v2.base&&n.v2.base.point||M,p=n.v3.base&&n.v3.base.point||M;T[0]=d[0]+n.v1.vector[0],T[1]=d[1]+n.v1.vector[1],E[0]=f[0]+n.v2.vector[0],E[1]=f[1]+n.v2.vector[1],L[0]=p[0]+n.v3.vector[0],L[1]=p[1]+n.v3.vector[1],c(T,E,L)||r(n.v2,n.v3)}}else e.count=0},e.prototype.buttCap=function(e,t,i){this.fastMiterJoin(e,t,i)},e.prototype.roundCap=function(e,t,i,r,n,o){void 0===o&&(o=0),this.fastMiterJoin(e,t,i);var a=r===m.START?0:1,s=r===m.START?1:0;e.capCenter=e.vectors.count;var l=e.vectors.items[e.capCenter];l.vector[0]=0,l.vector[1]=0,l.texCoords[0]=0,l.texCoords[1]=0,l.direction[0]=0,l.direction[1]=0,++e.vectors.count,p(I,e.vectors.items[a].vector,e.vectors.items[s].vector,n,!1);var u=e.vectors.count,h=e.lists[_.CAP];h.items[0]=a;var d,c=e.vectors.items[a].texCoords[1],f=e.vectors.items[s].texCoords[1];for(d=0;d<I.count;++d){var v=o*(1-Math.abs(I.count/2-d)/(I.count/2)),g=c+d/(I.count-1)*(f-c),y=I.items[d],x=e.vectors.items[u+d];x.vector[0]=y[0],x.vector[1]=y[1],x.texCoords[0]=v,x.texCoords[1]=g,x.direction[0]=0,x.direction[1]=0,h.items[d+1]=u+d}h.items[I.count+1]=s,h.count=I.count+2,e.vectors.count=u+I.count},e.prototype.squareCap=function(e,t,i,r){this.fastMiterJoin(e,t,i);var n=r===m.START?0:1,o=r===m.START?1:0,a=V[0],s=V[1],l=V[2],u=V[3],d=V[4],c=e.vectors.items[n].vector;a[0]=D*c[0]-F*c[1],a[1]=F*c[0]+D*c[1],h(u,a,O),s[0]=D*a[0]-F*a[1],s[1]=F*a[0]+D*a[1],l[0]=D*s[0]-F*s[1],l[1]=F*s[0]+D*s[1],h(d,l,O);var f=e.vectors.items[n];f.vector[0]=u[0],f.vector[1]=u[1];var p=e.vectors.items[o];p.vector[0]=d[0],p.vector[1]=d[1]},e.prototype.fastMiterJoin=function(e,t,i){var r=s(V[0],i),n=r,o=u(V[1],r),a=e.vectors.items[0];a.vector[0]=n[0],a.vector[1]=n[1],a.texCoords[0]=0,a.texCoords[1]=-1,a.direction[0]=0,a.direction[1]=0;var l=e.vectors.items[1];l.vector[0]=o[0],l.vector[1]=o[1],l.texCoords[0]=0,l.texCoords[1]=1,l.direction[0]=0,l.direction[1]=0,e.vectors.count=2;var h=e.lists[_.ENTRY];h.items[0]=0,h.items[1]=1,h.count=2;var d=e.lists[_.EXIT];d.items[0]=0,d.items[1]=1,d.count=2,e.lists[_.CAP].count=0,e.capCenter=void 0},e.prototype.miterJoin=function(e,t,i){var r=s(V[0],t),o=s(V[1],i),l=V[2];l[0]=r[0]+o[0],l[1]=r[1]+o[1];var d=a(V[3],l),c=n(d,r);d=h(V[4],d,1/c);var f=u(V[5],d);if(this._distanceAlongCorrection){(m=e.vectors.items[0]).vector[0]=d[0],m.vector[1]=d[1],m.texCoords[0]=0,m.texCoords[1]=-1,m.direction[0]=t[0],m.direction[1]=t[1],(g=e.vectors.items[1]).vector[0]=f[0],g.vector[1]=f[1],g.texCoords[0]=0,g.texCoords[1]=1,g.direction[0]=t[0],g.direction[1]=t[1];var p=e.vectors.items[2];p.vector[0]=d[0],p.vector[1]=d[1],p.texCoords[0]=0,p.texCoords[1]=-1,p.direction[0]=i[0],p.direction[1]=i[1];var v=e.vectors.items[3];v.vector[0]=f[0],v.vector[1]=f[1],v.texCoords[0]=0,v.texCoords[1]=1,v.direction[0]=i[0],v.direction[1]=i[1],e.vectors.count=4,(y=e.lists[_.ENTRY]).items[0]=0,y.items[1]=1,y.count=2,(x=e.lists[_.EXIT]).items[0]=2,x.items[1]=3,x.count=2}else{var m,g,y,x;(m=e.vectors.items[0]).vector[0]=d[0],m.vector[1]=d[1],m.texCoords[0]=0,m.texCoords[1]=-1,m.direction[0]=0,m.direction[1]=0,(g=e.vectors.items[1]).vector[0]=f[0],g.vector[1]=f[1],g.texCoords[0]=0,g.texCoords[1]=1,g.direction[0]=0,g.direction[1]=0,e.vectors.count=2,(y=e.lists[_.ENTRY]).items[0]=0,y.items[1]=1,y.count=2,(x=e.lists[_.EXIT]).items[0]=0,x.items[1]=1,x.count=2}e.lists[_.CAP].count=0,e.capCenter=void 0},e.prototype.bevelJoin=function(e,t,i,r){var o=r*r,c=l(t,i),f=c>0?[-1,1]:[1,-1],p=f[0],m=f[1],y=c>0?u(V[0],s(V[1],t)):s(V[2],t),x=c>0?u(V[3],s(V[4],i)):s(V[5],i),S=V[6];S[0]=y[0]+x[0],S[1]=y[1]+x[1];var I=a(V[7],S),b=u(V[8],I),w=n(I,y),M=l(I,y),T=Math.abs(M/w),E=1+T*T,L=E<g?[T,this._distanceAlongCorrection]:[Math.sqrt(g-1),!0],D=L[0],F=L[1],O=E<o?[T,this._distanceAlongCorrection]:[Math.sqrt(o-1),!0],C=O[0],A=O[1];if(A&&F){d((G=e.vectors.items[0]).vector,u(V[9],y),h(V[10],u(V[11],t),D)),G.texCoords[0]=0,G.texCoords[1]=p,G.direction[0]=this._distanceAlongCorrection?t[0]:0,G.direction[1]=this._distanceAlongCorrection?t[1]:0,d((U=e.vectors.items[1]).vector,u(V[12],x),h(V[13],i,D)),U.texCoords[0]=0,U.texCoords[1]=p,U.direction[0]=this._distanceAlongCorrection?i[0]:0,U.direction[1]=this._distanceAlongCorrection?i[1]:0,(P=e.vectors.items[2]).vector[0]=0,P.vector[1]=0,P.texCoords[0]=0,P.texCoords[1]=0,P.direction[0]=0,P.direction[1]=0,d((R=e.vectors.items[3]).vector,y,h(V[14],t,C)),R.texCoords[0]=0,R.texCoords[1]=m,R.direction[0]=this._distanceAlongCorrection?t[0]:0,R.direction[1]=this._distanceAlongCorrection?t[1]:0;var z=e.vectors.items[4];if(d(z.vector,x,h(V[15],u(V[16],i),C)),z.texCoords[0]=0,z.texCoords[1]=m,z.direction[0]=this._distanceAlongCorrection?i[0]:0,z.direction[1]=this._distanceAlongCorrection?i[1]:0,e.vectors.count=5,(B=e.lists[_.ENTRY]).items[0]=0,B.items[1]=2,B.items[2]=3,B.count=3,(k=e.lists[_.EXIT]).items[0]=1,k.items[1]=2,k.items[2]=4,k.count=3,E<o)(N=e.lists[_.CAP]).count=0,e.capCenter=void 0;else(N=e.lists[_.CAP]).items[0]=3,N.items[1]=4,N.count=2,e.capCenter=2}else if(!A&&F){d((G=e.vectors.items[0]).vector,u(V[9],y),h(V[10],u(V[11],t),D)),G.texCoords[0]=0,G.texCoords[1]=p,G.direction[0]=this._distanceAlongCorrection?t[0]:0,G.direction[1]=this._distanceAlongCorrection?t[1]:0,d((U=e.vectors.items[1]).vector,u(V[12],x),h(V[13],i,D)),U.texCoords[0]=0,U.texCoords[1]=p,U.direction[0]=this._distanceAlongCorrection?i[0]:0,U.direction[1]=this._distanceAlongCorrection?i[1]:0,(P=e.vectors.items[2]).vector[0]=0,P.vector[1]=0,P.texCoords[0]=0,P.texCoords[1]=0,P.direction[0]=0,P.direction[1]=0,h((R=e.vectors.items[3]).vector,I,1/w),R.texCoords[0]=0,R.texCoords[1]=m,R.direction[0]=0,R.direction[1]=0,e.vectors.count=4,(B=e.lists[_.ENTRY]).items[0]=0,B.items[1]=2,B.items[2]=3,B.count=3,(k=e.lists[_.EXIT]).items[0]=1,k.items[1]=2,k.items[2]=3,k.count=3,e.lists[_.CAP].count=0,e.capCenter=void 0}else if(A&&!F){var P,R,N;if(h((G=e.vectors.items[0]).vector,b,1/w),G.texCoords[0]=0,G.texCoords[1]=p,G.direction[0]=0,G.direction[1]=0,(U=e.vectors.items[1]).vector[0]=0,U.vector[1]=0,U.texCoords[0]=0,U.texCoords[1]=0,U.direction[0]=0,U.direction[1]=0,d((P=e.vectors.items[2]).vector,y,h(V[9],t,C)),P.texCoords[0]=0,P.texCoords[1]=m,P.direction[0]=this._distanceAlongCorrection?t[0]:0,P.direction[1]=this._distanceAlongCorrection?t[1]:0,d((R=e.vectors.items[3]).vector,x,h(V[10],u(V[11],i),C)),R.texCoords[0]=0,R.texCoords[1]=m,R.direction[0]=this._distanceAlongCorrection?i[0]:0,R.direction[1]=this._distanceAlongCorrection?i[1]:0,e.vectors.count=4,(B=e.lists[_.ENTRY]).items[0]=0,B.items[1]=1,B.items[2]=2,B.count=3,(k=e.lists[_.EXIT]).items[0]=0,k.items[1]=1,k.items[2]=3,k.count=3,E<o)(N=e.lists[_.CAP]).count=0,e.capCenter=void 0;else(N=e.lists[_.CAP]).items[0]=2,N.items[1]=3,N.count=2,e.capCenter=1}else if(!A&&!F){var G,U,B,k;h((G=e.vectors.items[0]).vector,b,1/w),G.texCoords[0]=0,G.texCoords[1]=p,G.direction[0]=0,G.direction[1]=0,h((U=e.vectors.items[1]).vector,I,1/w),U.texCoords[0]=0,U.texCoords[1]=m,U.direction[0]=0,U.direction[1]=0,e.vectors.count=2,(B=e.lists[_.ENTRY]).items[0]=0,B.items[1]=1,B.count=2,(k=e.lists[_.EXIT]).items[0]=0,k.items[1]=1,k.count=2,e.lists[_.CAP].count=0,e.capCenter=void 0}c<0&&(v(e.lists[_.ENTRY]),v(e.lists[_.EXIT]))},e.prototype.roundJoin=function(e,t,i,r){var o=l(t,i),c=o>0?[-1,1]:[1,-1],f=c[0],m=c[1],y=o>0?u(V[0],s(V[1],t)):s(V[2],t),x=o>0?u(V[3],s(V[4],i)):s(V[5],i),S=V[6];S[0]=y[0]+x[0],S[1]=y[1]+x[1];var b=a(V[7],S),w=u(V[8],b),M=n(b,y),T=l(b,y),E=Math.abs(T/M),L=1+E*E<g?[E,this._distanceAlongCorrection]:[Math.sqrt(g-1),!0],D=L[0];if(L[1]){(O=e.vectors.items[0]).vector[0]=y[0],O.vector[1]=y[1],O.texCoords[0]=0,O.texCoords[1]=m,O.direction[0]=0,O.direction[1]=0,(C=e.vectors.items[1]).vector[0]=x[0],C.vector[1]=x[1],C.texCoords[0]=0,C.texCoords[1]=m,C.direction[0]=0,C.direction[1]=0,d((A=e.vectors.items[2]).vector,u(V[9],y),h(V[10],u(V[11],t),D)),A.texCoords[0]=0,A.texCoords[1]=f,A.direction[0]=this._distanceAlongCorrection?t[0]:0,A.direction[1]=this._distanceAlongCorrection?t[1]:0,d((z=e.vectors.items[3]).vector,u(V[12],x),h(V[13],i,D)),z.texCoords[0]=0,z.texCoords[1]=f,z.direction[0]=this._distanceAlongCorrection?i[0]:0,z.direction[1]=this._distanceAlongCorrection?i[1]:0;var F=e.vectors.items[4];F.vector[0]=0,F.vector[1]=0,F.texCoords[0]=0,F.texCoords[1]=0,F.direction[0]=0,F.direction[1]=0,e.vectors.count=5,(P=e.lists[_.ENTRY]).items[0]=2,P.items[1]=4,P.items[2]=0,P.count=3,(R=e.lists[_.EXIT]).items[0]=3,R.items[1]=4,R.items[2]=1,R.count=3,e.capCenter=4}else{var O,C,A,z,P,R;(O=e.vectors.items[0]).vector[0]=y[0],O.vector[1]=y[1],O.texCoords[0]=0,O.texCoords[1]=m,O.direction[0]=0,O.direction[1]=0,(C=e.vectors.items[1]).vector[0]=x[0],C.vector[1]=x[1],C.texCoords[0]=0,C.texCoords[1]=m,C.direction[0]=0,C.direction[1]=0,h((A=e.vectors.items[2]).vector,w,1/M),A.texCoords[0]=0,A.texCoords[1]=f,A.direction[0]=0,A.direction[1]=0,(z=e.vectors.items[3]).vector[0]=0,z.vector[1]=0,z.texCoords[0]=0,z.texCoords[1]=0,z.direction[0]=0,z.direction[1]=0,e.vectors.count=4,(P=e.lists[_.ENTRY]).items[0]=2,P.items[1]=3,P.items[2]=0,P.count=3,(R=e.lists[_.EXIT]).items[0]=2,R.items[1]=3,R.items[2]=1,R.count=3,e.capCenter=3}p(I,y,x,r,o<0);var N,G=e.vectors.count,U=e.lists[_.CAP];for(U.items[0]=0,N=0;N<I.count;++N){var B=I.items[N],k=e.vectors.items[G+N];k.vector[0]=B[0],k.vector[1]=B[1],k.texCoords[0]=0,k.texCoords[1]=m,k.direction[0]=0,k.direction[1]=0,U.items[N+1]=G+N}U.items[I.count+1]=1,U.count=I.count+2,e.vectors.count=G+I.count,o<0&&(v(e.lists[_.ENTRY]),v(e.lists[_.EXIT]))},e.prototype.unitRoundJoin=function(e,t,i,r){var n=l(t,i),o=n>0?[-1,1]:[1,-1],a=o[0],h=o[1],d=n>0?u(V[0],s(V[1],t)):s(V[2],t),c=n>0?u(V[3],s(V[4],i)):s(V[5],i),f=e.vectors.items[0];f.vector[0]=d[0],f.vector[1]=d[1],f.texCoords[0]=0,f.texCoords[1]=h,f.direction[0]=0,f.direction[1]=0;var m=e.vectors.items[1];m.vector[0]=c[0],m.vector[1]=c[1],m.texCoords[0]=0,m.texCoords[1]=h,m.direction[0]=0,m.direction[1]=0;var g=e.vectors.items[2];u(g.vector,d),g.texCoords[0]=0,g.texCoords[1]=a,g.direction[0]=0,g.direction[1]=0;var y=e.vectors.items[3];u(y.vector,c),y.texCoords[0]=0,y.texCoords[1]=a,y.direction[0]=0,y.direction[1]=0;var x=e.vectors.items[4];x.vector[0]=0,x.vector[1]=0,x.texCoords[0]=0,x.texCoords[1]=0,x.direction[0]=0,x.direction[1]=0,e.vectors.count=5;var S=e.lists[_.ENTRY];S.items[0]=2,S.items[1]=0,S.count=2;var b=e.lists[_.EXIT];b.items[0]=3,b.items[1]=1,b.count=2,e.capCenter=4,p(I,d,c,r,n<0);var w,M=e.vectors.count,T=e.lists[_.CAP];for(T.items[0]=0,w=0;w<I.count;++w){var E=I.items[w],L=e.vectors.items[M+w];L.vector[0]=E[0],L.vector[1]=E[1],L.texCoords[0]=0,L.texCoords[1]=h,L.direction[0]=0,L.direction[1]=0,T.items[w+1]=M+w}T.items[I.count+1]=1,T.count=I.count+2,e.vectors.count=M+I.count,n<0&&(v(e.lists[_.ENTRY]),v(e.lists[_.EXIT]))},e.prototype.rectJoin=function(e,t,i){var r=s(V[0],t),n=s(V[1],i),o=e.vectors.items[0];o.vector[0]=r[0],o.vector[1]=r[1],o.texCoords[0]=0,o.texCoords[1]=-1,o.direction[0]=0,o.direction[1]=0;var a=e.vectors.items[1];a.vector[0]=n[0],a.vector[1]=n[1],a.texCoords[0]=0,a.texCoords[1]=-1,a.direction[0]=0,a.direction[1]=0;var l=e.vectors.items[2];u(l.vector,r),l.texCoords[0]=0,l.texCoords[1]=1,l.direction[0]=0,l.direction[1]=0;var h=e.vectors.items[3];u(h.vector,n),h.texCoords[0]=0,h.texCoords[1]=1,h.direction[0]=0,h.direction[1]=0,e.vectors.count=4;var d=e.lists[_.ENTRY];d.items[0]=0,d.items[1]=2,d.count=2;var c=e.lists[_.EXIT];c.items[0]=1,c.items[1]=3,c.count=2,e.capCenter=void 0},e}();t.Tessellator=C}.apply(null,r))||(e.exports=n)},1813:function(e,t){e.exports='<snippets>\n  <snippet name="tileInfoVS">\n  <![CDATA[\n    attribute vec2 a_pos;\n\n    uniform highp mat4 u_transformMatrix;\n    uniform mediump vec2 u_normalized_origin;\n    uniform mediump float u_depth;\n    uniform mediump float u_coord_ratio;\n    uniform mediump vec2 u_delta; // in tile coordinates\n    uniform mediump vec2 u_dimensions; // in tile coordinates\n\n    varying mediump vec2 v_tex;\n\n    void main() {\n      mediump vec2 offests = u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n      gl_Position = vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(offests, 0.0, 1.0);\n\n      v_tex = a_pos;\n    }\n  ]]>\n  </snippet>\n\n  <snippet name="tileInfoFS">\n  <![CDATA[\n    uniform mediump sampler2D u_texture;\n    varying mediump vec2 v_tex;\n\n    void main(void) {\n      lowp vec4 color = texture2D(u_texture, v_tex);\n      gl_FragColor = 0.75 * color;\n    }\n  ]]>\n  </snippet>\n</snippets>\n'},1815:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(8),i(9),i(76),i(479),i(1511),i(1708),i(1527),i(1731),i(1800),i(1887),i(1888),i(1892),i(1801),i(1802),i(1893),i(1665),i(1804),i(1735)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,h,d,c,f,p,v,_,m,g,y,x){Object.defineProperty(t,"__esModule",{value:!0});var S=n.getLogger("esri.views.2d.engine.webgl.WGLMeshFactory"),V={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:null,esriGeometryMultipoint:null,esriGeometryEnvelope:null},I=function(){function e(){this._materials=[],this._materialsIndex=new Map}return e.prototype.insert=function(e){var t=this._materials.length;return this._materials.push(e),t},e.prototype._hashGlyph=function(e,t,i){return"G-"+t+"-"+i+"-"+e.page},e.prototype._hashSprite=function(e,t,i){return"S-"+t+"-"+i+"-"+(e?e.page:-1)},e.prototype.createSpriteMaterial=function(e,t,i){var r=this._hashSprite(e,t,i);if(this._materialsIndex.has(r))return this._materialsIndex.get(r);var n=this._materials.length,o=l.default.fromSprite(e,t,i);return this._materials.push(o),this._materialsIndex.set(r,n),n},e.prototype.createGlyphMaterial=function(e,t,i){var r=this._hashGlyph(e,t,i);if(this._materialsIndex.has(r))return this._materialsIndex.get(r);var n=this._materials.length,o=l.default.fromGlyph(e,t,i);return this._materials.push(o),this._materialsIndex.set(r,n),n},e.prototype.get=function(e){return this._materials[e]},e.prototype.serialize=function(e){return g.serializeList(e,this._materials),e},e.deserialize=function(t){var i=new e;return i._materials=g.deserializeList(t,l.default),i},e}();t.MaterialStore=I;var b=function(){function e(e){this._bucketSize=e,this._rowsLength=a.TILE_SIZE/e,this._colsLength=a.TILE_SIZE/e,this._grid=this._initGrid()}return e.prototype.checkOverlap=function(e,t){var i=Math.floor(e/this._bucketSize),r=Math.floor(t/this._bucketSize);return i<0||i>=this._rowsLength||r<0||r>=this._colsLength||!!this._grid[r][i]||(this._grid[r][i]=!0,!1)},e.prototype.reset=function(){this._grid=this._initGrid()},e.prototype._initGrid=function(){for(var e=[],t=0;t<this._rowsLength;t++)e.push(new Array(this._colsLength));return e},e}();t.LabelGrid=b;var w=function(){function e(e,t,i){this.displayObjects=e,this.vertexVectorsMap=t,this._materials=i}return e.prototype.get=function(e){return this.vertexVectorsMap[e]},e.prototype.pushDisplayObject=function(e){this.displayObjects.push(e)},e.prototype.encode=function(e,t){var i=g.serializeList(new x.default(Uint32Array,this._guessSize()),this.displayObjects).buffer(),r=this._materials.serialize(new x.default(Uint32Array)).buffer(),n={};for(var o in t.push(i),t.push(r),this.vertexVectorsMap){var a=this.vertexVectorsMap[o];n[o]={},a.transfer(n[o],t)}e.displayObjects=i,e.materialStore=r,e.vertexBuffersMap=n,this.destroy()},e.prototype.destroy=function(){this.vertexVectorsMap=null,this.displayObjects=null},e.prototype._guessSize=function(){for(var e=this.displayObjects,t=Math.min(e.length,4),i=0,r=0;r<t;r++)i=Math.max(i,e[r].displayRecords.length);return 2*(12*e.length+e.length*i*40)},e}(),M=function(){function e(){this._vvMap=new Map}return e.prototype.set=function(e,t){this._vvMap.set(e,t)},e.prototype.getValue=function(e,t,i){return this._vvMap.has(e)?this._vvMap.get(e)(t,i):0},e}(),T=function(){function e(e,t,i,n,o,a,s,l,u,h){var d=this;this._labelsDebugTemplate=null,this._matcher=e,this._materials=i,this._geometryType=n,this._idField=o,this._pixelRatio=u,this._vvMap=null,this._vvFlags=s,this._vvBuf=new ArrayBuffer(16),this._vvBufU32=new Uint32Array(this._vvBuf),this._vvBufF32=new Float32Array(this._vvBuf),this._createVVFunctionMap(a,t,l),h&&(this._validateLabelingInfo(h)?this._labelTemplates=h.map(function(e){return p.default.fromText(d._materials,0,e.symbol,u,e.labelPlacement)}):S.error(new r("mapview-labeling:unsupported-geometry","LabelingInfo failed validation - unable to create labels for layer.")))}return e.from=function(t,i,n,o,a,s,l,u){switch(t.type){case"simple":return e._fromSimpleRenderer(t,i,n,o,a,s,l,u);case"unique-value":case"uniqueValue":return e._fromUniqueValueRenderer(t,i,n,o,a,s,l,u);case"class-breaks":case"classBreaks":return e._fromClassBreaksRenderer(t,i,n,o,a,s,l,u);default:return S.error(new r("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),null}},Object.defineProperty(e.prototype,"materials",{get:function(){return this._materials},enumerable:!0,configurable:!0}),e.prototype.createMeshData=function(e){var t=new Array(5),i=this._matcher.getDefault(),r=new Array,n=!!y.getMarkerVVFlags(this._vvFlags),o=!!y.getFillVVFlags(this._vvFlags),a=!!y.getLineVVFlags(this._vvFlags,"esriGeometryPolyline"!==this._geometryType),l=!!y.getTextVVFlags(this._vvFlags);return!this._labelTemplates&&i&&1===i.length&&i[0]instanceof _.default?(t[s.WGLGeometryType.MARKER]=new c.VertexVectors(s.WGLGeometryType.MARKER,n,e),t[s.WGLGeometryType.FILL]=new c.VertexVectors(s.WGLGeometryType.FILL,o,0),t[s.WGLGeometryType.LINE]=new c.VertexVectors(s.WGLGeometryType.LINE,a,0),t[s.WGLGeometryType.TEXT]=new c.VertexVectors(s.WGLGeometryType.TEXT,l,0),t[s.WGLGeometryType.LABEL]=new c.VertexVectors(s.WGLGeometryType.LABEL,!1,0)):(t[s.WGLGeometryType.MARKER]=new c.VertexVectors(s.WGLGeometryType.MARKER,n,e),t[s.WGLGeometryType.FILL]=new c.VertexVectors(s.WGLGeometryType.FILL,o,e),t[s.WGLGeometryType.LINE]=new c.VertexVectors(s.WGLGeometryType.LINE,a,e),t[s.WGLGeometryType.TEXT]=new c.VertexVectors(s.WGLGeometryType.TEXT,l,e),t[s.WGLGeometryType.LABEL]=new c.VertexVectors(s.WGLGeometryType.LABEL,!1,this._labelTemplates&&this._labelTemplates.length>0?e:0)),new w(r,t,this._materials)},e.prototype.write=function(e,t,i,r,n){var o=e,a=1===this._matcher.size()&&this._matcher.getDefault()||this._matcher.match(t,i),s=t.attributes[this._idField],l=new d(s),u=!!r&&!!this._labelTemplates&&r.has(s);if(this._computeVV(t,i),a&&(t.geometry||t.centroid)){for(var h=l.displayRecords,c=0,f=a;c<f.length;c++){var p=f[c],v=o.get(p.geometryType);p.writeMesh(h,v,this._geometryType,s,t,this._pixelRatio,this._vvBufU32)}if(u){var _=this._getLabelReference(a);this._writeLabelMesh(l,o,s,t,n,r.get(s),_)}o.pushDisplayObject(l)}},e.prototype._hasBadLabelClass=function(e,t){var i=e.labelPlacement,n=V[t];if(!n)return S.error(new r("mapview-labeling:unsupported-geometry-type","Unable to create labels for WebGL Feature Layer, "+t+" is not supported")),!0;if(!n.some(function(e){return e===i})){var o=n[0];i&&S.warn("Found invalid label placement type "+i+" for "+t+". Defaulting to "+o),e.labelPlacement=o}return!1},e.prototype._validateLabelingInfo=function(e){var t=this;return!e.some(function(e){return t._hasBadLabelClass(e,t._geometryType)})},e.prototype._getLabelReference=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r instanceof _.default)return r}return null},e.prototype._writeLabelMesh=function(e,t,i,r,n,o,s){for(var l=e.displayRecords,u=0,h=0,d=-1,c=-1,f=0;f<o.labelingInfo.length;f++){var p=o.labelingInfo[f],v=o.text[f],_=this._labelTemplates[p],m=t.get(_.geometryType),g=n.get(_.symbolId).glyphMosaicItems,y=l.length;_.bindReferenceTemplate(s);var x=_.computeAnchor(this._geometryType,r);if(0===f&&(d=Math.floor(x[0]/a.COLLISION_BUCKET_SIZE),c=Math.floor(x[1]/a.COLLISION_BUCKET_SIZE)),!_.computeGlyphs(g,v)){var S=_.bounds;_.writeMesh(l,m,this._geometryType,i,r,this._pixelRatio,this._vvBufU32),e.anchor=x,e.addMetric(S,y,l.length-y,p);var V=S.center;u=Math.max(S.halfWidth+Math.abs(V[0]),u),h=Math.max(S.halfHeight+Math.abs(V[1]),h)}}if(e.metrics.length){var I=2.5*Math.max(u,h),b=I-e.anchor[0]%a.COLLISION_BUCKET_SIZE,w=I-e.anchor[1]%a.COLLISION_BUCKET_SIZE,M=Math.ceil(Math.abs(b/a.COLLISION_BUCKET_SIZE)),T=Math.ceil(Math.abs(w/a.COLLISION_BUCKET_SIZE));e.xBucket=d,e.yBucket=c,e.xOverflow=M,e.yOverflow=T}},e.prototype._debugLabels=function(e,t,i,r,n){var o=r[0]+n.center[0],a=r[1]+n.center[1],s={geometry:{paths:[[[o-n.width/2,a+n.height/2],[0,-n.height],[n.width,0],[0,n.height],[-n.width,0]]]},attributes:{}},l=this._getLabelDebugTemplate(),u=t.get(l.geometryType);l.writeMesh(e,u,"esriGeometryPolyline",i,s,this._pixelRatio,this._vvBufU32)},e.prototype._getLabelDebugTemplate=function(){return this._labelsDebugTemplate||(this._labelsDebugTemplate=this._createLabelsDebugTemplate()),this._labelsDebugTemplate},e.prototype._createLabelsDebugTemplate=function(){var e=new o({style:"solid",width:1,color:[255,0,0,1]});return v.default.fromSimpleLine(this._materials,0,e,null,this._pixelRatio)},e.prototype._isErrorVV=function(e){return null===e||isNaN(e)||e===1/0},e.prototype._computeVV=function(e,t){if(!this._vvMap)return 0;var i=this._vvMap.getValue(s.VVType.SIZE,e,t),r=this._vvMap.getValue(s.VVType.COLOR,e,t),n=this._vvMap.getValue(s.VVType.OPACITY,e,t),o=this._vvMap.getValue(s.VVType.ROTATION,e,t);return this._vvBufF32[s.VVType.SIZE]=this._isErrorVV(i)?NaN:i,this._vvBufF32[s.VVType.COLOR]=this._isErrorVV(r)?NaN:r,this._vvBufF32[s.VVType.OPACITY]=this._isErrorVV(n)?NaN:n,this._vvBufF32[s.VVType.ROTATION]=this._isErrorVV(o)?NaN:o,0},e.prototype._createVVFunctionMap=function(e,t,i){if(e&&e.length)for(var r=0,n=e;r<n.length;r++){var o=n[r],a=u.getVVType(o.type),s=this._createGetValueFunction(o,t,i);s&&(this._vvMap||(this._vvMap=new M),this._vvMap.set(a,s))}},e.prototype._createGetValueFunction=function(e,t,i){if(u.getVVType(e.type)===s.VVType.SIZE){var r=e,n=h.getTypeOfSizeVisualVariable(r);if(n===s.WGLVVFlag.SIZE_SCALE_STOPS)return null;var o=n===s.WGLVVFlag.SIZE_UNIT_VALUE&&function(e){return h.getVisualVariableSizeValueRepresentationRatio(e,r.valueRepresentation)};return this._createNormalizedFunction(e,t,i,o)}return this._createNormalizedFunction(e,t,i)},e.prototype._createNormalizedFunction=function(e,t,i,n){var o=e.field;if(o){if("string"==typeof o){var a=e.normalizationField;return a?function(e){if(e.attributes[o]&&e.attributes[a]){var t=e.attributes[o]/e.attributes[a];return n?n(t):t}}:n?function(e){return n(e.attributes[o])}:function(e){return e.attributes[o]}}return"function"==typeof o?(S.error(new r("mapview-rendering:unsupported-feature","Function field types are not currently supported. Please use a valueExpression instead")),function(e){}):(S.error(new r("mapview-rendering:invalid-type","The field for a vv must be a string or a number, but got "+typeof o)),function(e){})}if(e.valueExpression&&"$view.scale"!==e.valueExpression){var s={valueExpression:e.valueExpression,spatialReference:i,layer:t};return u.createArcadeFunction(s,n)}return S.error("Unable to create a normalized function for visual variable: "+e),function(e){}},e._fromSimpleRenderer=function(t,i,r,n,o,a,s,l){var u=t.getSymbols(),h=t.visualVariables,d=y.getVVFlags(h),c=new m.default,p=new I;if(u.length){var v=u[0];c.setDefault(f.createMeshTemplates([],p,v,r,d,s))}return new e(c,i,p,n,o,h,d,a,s,l)},e._fromUniqueValueRenderer=function(t,i,r,n,o,a,s,l){var u=t.uniqueValueInfos,h=t.visualVariables,d=y.getVVFlags(h),c=[t.field];t.field2&&c.push(t.field2),t.field3&&c.push(t.field3);for(var p=t.valueExpression,v=p?{valueExpression:p,spatialReference:a,layer:i}:null,_=new m.MapMatcher(c,t.fieldDelimiter,v),g=new I,x=t.backgroundFillSymbol,S=x&&f.createMeshTemplates([],g,x,r,d,s),V=0,b=u;V<b.length;V++){var w=b[V],M=f.createMeshTemplates([],g,w.symbol,r,d,s);_.add(w.value,S?S.concat(M):M)}var T=t.defaultSymbol;if(T){var E=f.createMeshTemplates([],g,T,r,d,s);_.setDefault(S?S.concat(E):E)}return new e(_,i,g,n,o,h,d,a,s,l)},e._fromClassBreaksRenderer=function(t,i,r,n,o,a,s,l){for(var u=t.isMaxInclusive,h=t.visualVariables,d=t.valueExpression,c=t.normalizationField,p=t.normalizationTotal,v=t.normalizationType,_=y.getVVFlags(h),g=t.field,x=d?{valueExpression:d,spatialReference:a,layer:i}:null,S={normalizationField:c,normalizationTotal:p,normalizationType:v},V=new m.IntervalMatcher(g,u,x,S),b=new I,w=t.backgroundFillSymbol,M=w&&f.createMeshTemplates([],b,w,r,_,s,!0),T=0,E=t.classBreakInfos;T<E.length;T++){var L=E[T],D=L.symbol,F=f.createMeshTemplates([],b,D,r,_,s),O={min:L.minValue,max:L.maxValue};V.add(O,M?M.concat(F):F)}var C=t.defaultSymbol;if(C){var A=f.createMeshTemplates([],b,C,r,_,s);V.setDefault(M?M.concat(A):A)}return new e(V,i,b,n,o,h,_,a,s,l)},e}();t.default=T}.apply(null,r))||(e.exports=n)},1816:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1744)],void 0===(n=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=new i;t.bidiText=function(e){return r.hasBidiChar(e)?(t="rtl"===r.checkContextual(e)?"IDNNN":"ICNNN",[r.bidiTransform(e,t,"VLYSN"),!0]):[e,!1];var t}}.apply(null,r))||(e.exports=n)},1817:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=8,r=-3;t.getFullyQualifiedFontName=function(e){var t=function(e){if(!e.weight)return"";switch(e.weight.toLowerCase()){case"bold":case"bolder":return"-bold"}return""}(e)+function(e){if(!e.style)return"";switch(e.style.toLowerCase()){case"italic":case"oblic":return"-italic"}return""}(e);return function(e){var t=e.toLowerCase().split(" ").join("-");switch(t){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return t}}(e.family)+(t.length>0?t:"-regular")},t.getFontDecorationOffset=function(e){switch(e.decoration.toLowerCase()){case"underline":return i;case"line-through":return r}return NaN}}.apply(null,r))||(e.exports=n)},1850:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(11),i(7),i(184),i(1851),i(1852),i(1511),i(1798),i(1692),i(112),i(92),i(101),i(475),i(1500),i(482),i(1498),i(1496),i(1672),i(1499)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,h,d,c,f,p,v,_,m,g,y,x){function S(e){return{state:e.state,pixelRatio:e.pixelRatio,stationary:e.stationary}}var V={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"};return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._clipData=new Float32Array(8),t._upperLeft=f.create(),t._upperRight=f.create(),t._lowerLeft=f.create(),t._lowerRight=f.create(),t._mat2=c.create(),t._clipRendererInitialized=!1,t._contextVersion=null,t._labelFader=new a.default(t),t}return i(t,e),Object.defineProperty(t.prototype,"glPainter",{get:function(){return this._painter},enumerable:!0,configurable:!0}),t.prototype.fadeInLabels=function(){this._labelFader.reset(),this.requestRender()},t.prototype.createElement=function(){var e=document.createElement("canvas");return e.setAttribute("class","esri-display-object"),e},t.prototype.setElement=function(e){this.element=e},t.prototype.useContextVersion=function(e){this._renderingContext||(this._contextVersion=e)},t.prototype.attach=function(t){if(this.attached)return!0;this._resizeCanvas(t);var i=_.createContextOrErrorHTML(this.element,{alpha:!0,antialias:!1,depth:!0,stencil:!0},this._contextVersion);return this._renderingContext=new y(i),this._contextVersion=this._renderingContext.contextVersion,this.attached=!0,this._cachedRenderParams=S(t),this._painter||(this._painter=new u.default,this._painter.initialize(this._renderingContext)),e.prototype.attach.call(this,t)},t.prototype.detach=function(t){e.prototype.detach.call(this,t),this._boundFBO=null,this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null),this._labelsFBO1&&(this._labelsFBO1.dispose(),this._labelsFBO1=null),this._labelsFBO2&&(this._labelsFBO2.dispose(),this._labelsFBO2=null),this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null),this._clipVAO&&(this._clipVAO.dispose(),this._clipVAO=null,this._clipVBO=null),this._painter&&(this._painter.dispose(),this._painter=null),this._clipStencilProgram&&(this._clipStencilProgram.dispose(),this._clipStencilProgram=null),this._renderingContext&&(this._renderingContext.dispose(),this._renderingContext=null),this._cachedRenderParams=null},t.prototype.renderChildren=function(e){var t=this.children;e.drawPhase=l.WGLDrawPhase.FILL|l.WGLDrawPhase.LINE|l.WGLDrawPhase.MARKER|l.WGLDrawPhase.TEXT;for(var i=t.length,n=0;n<i;n++){(u=t[n]).attached&&this.renderChild(u,e)}if(r("esri-featurelayer-webgl-labeling")){var o=e.context,a=o.getBoundFramebufferObject();o.bindFramebuffer(this._labelsFBO2);var s=e.stationary;if(o.setClearColor(0,0,0,s?0:1),o.clear(o.gl.COLOR_BUFFER_BIT),s){e.drawPhase=l.WGLDrawPhase.LABEL_ALPHA,e.labelFBO=this._labelsFBO1,e.labelStep=this._labelFader.step();for(n=0;n<i;n++){(u=t[n]).attached&&this.renderChild(u,e)}}else this._labelFader.reset();o.bindFramebuffer(a),e.labelFBO=this._labelsFBO2,e.drawPhase=l.WGLDrawPhase.LABEL;for(n=0;n<i;n++){var u;(u=t[n]).attached&&this.renderChild(u,e)}var h=this._labelsFBO2;this._labelsFBO2=this._labelsFBO1,this._labelsFBO1=h}},t.prototype.beforeRenderChildren=function(e,t){var i=t.context,n=t.state,o=t.pixelRatio,a=this._painter;if(a){i.enforceState(),a.update(n,o);var s=n.width,l=n.height,u=n.rotation;if(s=Math.round(s*o),l=Math.round(l*o),this._boundFBO=i.getBoundFramebufferObject(),!r("esri-featurelayer-webgl-labeling")||this._labelsFBO1&&this._labelsFBO1.width===s&&this._labelsFBO1.height===l||(this._labelsFBO1&&(this._labelsFBO1.dispose(),this._labelsFBO2.dispose()),this._labelsFBO1=m.createWithAttachments(i,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:s,height:l},{colorTarget:0,depthStencilTarget:0}),i.bindFramebuffer(this._labelsFBO1),i.setDepthWriteEnabled(!0),i.setStencilWriteMask(255),i.setClearColor(0,0,0,0),i.setClearDepth(1),i.setClearStencil(0),i.clear(i.gl.COLOR_BUFFER_BIT|i.gl.DEPTH_BUFFER_BIT|i.gl.STENCIL_BUFFER_BIT),i.setDepthWriteEnabled(!1),i.bindFramebuffer(this._boundFBO),this._labelsFBO2=m.createWithAttachments(i,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:s,height:l},{colorTarget:0,depthStencilTarget:0})),!(n.spatialReference&&(n.spatialReference._isWrappable?n.spatialReference._isWrappable():n.spatialReference.isWrappable)))return void(this._clipFrame=!1);var h=d.toRadian(u),p=Math.abs(Math.cos(h)),v=Math.abs(Math.sin(h)),_=Math.round(s*p+l*v),g=Math.round(n.worldScreenWidth);if(_<=g)return void(this._clipFrame=!1);this._clipFBO&&this._clipFBO.width===s&&this._clipFBO.height===l||(this._clipFBO=new m(i,{colorTarget:0,depthStencilTarget:3,width:s,height:l}));var y=.5*s,x=.5*l,S=1/s,V=1/l,I=.5*g*o,b=.5*(s*v+l*p),w=this._upperLeft,M=this._upperRight,T=this._lowerLeft,E=this._lowerRight;f.set(w,-I,-b),f.set(M,I,-b),f.set(T,-I,b),f.set(E,I,b),c.identity(this._mat2),c.translate(this._mat2,this._mat2,[y,x]),0!==u&&c.rotate(this._mat2,this._mat2,h),f.transformMat2d(w,w,this._mat2),f.transformMat2d(M,M,this._mat2),f.transformMat2d(T,T,this._mat2),f.transformMat2d(E,E,this._mat2);var L=this._clipData;L.set([2*T[0]*S-1,2*(l-T[1])*V-1,2*E[0]*S-1,2*(l-E[1])*V-1,2*w[0]*S-1,2*(l-w[1])*V-1,2*M[0]*S-1,2*(l-M[1])*V-1]),this._clipRendererInitialized||this._initializeClipRenderer(i),this._clipVBO.setData(L),this._boundFBO=i.getBoundFramebufferObject(),i.bindFramebuffer(this._clipFBO),i.setDepthWriteEnabled(!0),i.setStencilWriteMask(255),i.setClearColor(0,0,0,0),i.setClearDepth(1),i.setClearStencil(0),i.clear(i.gl.COLOR_BUFFER_BIT|i.gl.DEPTH_BUFFER_BIT|i.gl.STENCIL_BUFFER_BIT),i.setDepthWriteEnabled(!1),this._clipFrame=!0}},t.prototype.afterRenderChildren=function(e,t){if(this._clipFrame&&this._clipRendererInitialized){var i=this._renderingContext;i.bindFramebuffer(this._boundFBO),this._boundFBO=null,i.bindVAO(this._clipVAO),i.bindProgram(this._clipStencilProgram),i.setDepthWriteEnabled(!1),i.setDepthTestEnabled(!1),i.setStencilTestEnabled(!0),i.setBlendingEnabled(!1),i.setColorMask(!1,!1,!1,!1),i.setStencilOp(7680,7680,7681),i.setStencilWriteMask(255),i.setStencilFunction(519,1,255),i.drawElements(4,6,5123,0),i.bindVAO(),i.setColorMask(!0,!0,!0,!0),i.setBlendingEnabled(!0),i.setStencilFunction(514,1,255),this._blitRenderer.render(i,this._clipFBO.colorTexture,9728,1),i.setStencilTestEnabled(!1)}},t.prototype.doRender=function(t){var i=this.element.style;this.visible?(i.display="block",i.opacity=""+this.opacity,this._resizeCanvas(t),e.prototype.doRender.call(this,t),this._cachedRenderParams=S(t)):i.display="none"},t.prototype.takeScreenshot=function(e){if(void 0===e&&(e={}),!this._cachedRenderParams)return n.reject();var t=e.pixelRatio||1;this._cachedRenderParams.pixelRatio=t;var i=Math.round(t*this._cachedRenderParams.state.width),r=Math.round(t*this._cachedRenderParams.state.height),o={x:0,y:0,width:i,height:r},a={x:0,y:0,width:i,height:r},s=e.area;if(s&&(o.x=Math.round(t*s.x),o.y=Math.round(t*s.y),o.width=Math.round(t*s.width),o.height=Math.round(t*s.height)),void 0!==e.width&&void 0!==e.height){var l=e.width/e.height;if(o.height*l<o.width){var u=o.height*l;o.x+=Math.floor((o.width-u)/2),o.width=Math.floor(u)}else{var h=o.width/l;o.y+=Math.floor((o.height-h)/2),o.height=Math.floor(h)}a.width=e.width,a.height=e.height}else a.width=o.width,a.height=o.height;var d=document.createElement("canvas");d.width=a.width,d.height=a.height;var c=d.getContext("2d"),f=new Uint8Array(o.width*o.height*4),v=this._renderingContext,_=m.create(v,{colorTarget:1,depthStencilTarget:3,width:i,height:r});v.bindFramebuffer(_),v.setViewport(0,0,i,r);var g=this._cachedRenderParams,y=this._renderingContext.gl;if(this._renderingContext.setClearColor(0,0,0,0),this._renderingContext.setClearDepth(1),this._renderingContext.setClearStencil(0),this._renderingContext.clear(y.COLOR_BUFFER_BIT|y.DEPTH_BUFFER_BIT|y.STENCIL_BUFFER_BIT),g.context=this._renderingContext,g.painter=this._painter,this.beforeRenderChildren(g,g),void 0!==e.rotation&&null!==e.rotation){var x=g.state,S=x.clone();S.viewpoint.rotation=e.rotation,g.state=S,this.renderChildren(g),g.state=x}else this.renderChildren(g);this.afterRenderChildren(g,g),_.readPixels(o.x,r-(o.y+o.height),o.width,o.height,6408,5121,f),v.bindFramebuffer();var I=c.getImageData(a.x,a.y,a.width,a.height);if(0!==o.x||0!==o.y||o.width!==i||o.height!==r||0!==a.x||0!==a.y||a.width!==i||a.height!==r)p.resampleHermite(f,o.width,o.height,I.data,a.width,a.height,!0);else{for(var b=o.height-1,w=0,M=4*o.width,T=void 0,E=void 0,L=void 0,D=void 0,F=void 0,O=void 0,C=void 0;w<b;){for(O=w*M,C=b*M,T=0;T<M;T+=4)E=f[O+T],L=f[O+T+1],D=f[O+T+2],F=f[O+T+3],f[O+T]=f[C+T],f[O+T+1]=f[C+T+1],f[O+T+2]=f[C+T+2],f[O+T+3]=f[C+T+3],f[C+T]=E,f[C+T+1]=L,f[C+T+2]=D,f[C+T+3]=F;w++,b--}for(var A=I.data,z=f.length,P=0;P<z;P++)A[P]=f[P]}var R=I.data,N=R.length;for(P=0;P<N;P+=4){if((F=R[P+3])>0){var G=F/255;E=Math.floor(R[P+0]/G),L=Math.floor(R[P+1]/G),D=Math.floor(R[P+2]/G);R[P+0]=E<=255?E:255,R[P+1]=L<=255?L:255,R[P+2]=D<=255?D:255}}c.putImageData(I,a.x,a.y);var U=V[e.format?e.format.toLowerCase():"png"],B={dataURL:d.toDataURL(U,null!=e.quality?e.quality/100:1),x:a.x,y:a.y,width:a.width,height:a.height};return e.returnByteBuffer&&(B.data=f),n.resolve(B)},t.prototype.prepareChildrenRenderParameters=function(e){if(!this.attached||!this._renderingContext)return null;var t=S(e),i=this._renderingContext,r=i.gl;return i.setDepthWriteEnabled(!0),i.setStencilWriteMask(255),i.setClearColor(0,0,0,0),i.setClearDepth(1),i.setClearStencil(0),i.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT|r.STENCIL_BUFFER_BIT),i.setViewport(0,0,this.element.width,this.element.height),i.setDepthWriteEnabled(!1),t.context=i,t.painter=this._painter,t},t.prototype.attachChild=function(e,t){return e.attach(t)},t.prototype.detachChild=function(e,t){return e.detach(t)},t.prototype.renderChild=function(e,t){return e.processRender(t)},t.prototype._resizeCanvas=function(e){var t=this.element,i=t.style,r=e.state,n=e.pixelRatio,o=Math.round(r.width*n),a=Math.round(r.height*n);t.width===o&&t.height===a||(t.width=o,t.height=a),i.width=r.width+"px",i.height=r.height+"px"},t.prototype._initializeClipRenderer=function(e){if(this._clipRendererInitialized)return!0;this._blitRenderer=new s;var t={a_pos:0},i=new g(e,h.stencilVS,h.stencilFS,t);if(!i)return!1;var r=v.createVertex(e,35040,32),n=new Uint16Array([0,1,2,2,1,3]),o=v.createIndex(e,35044,n),a=new x(e,t,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:r},o);return this._clipStencilProgram=i,this._clipVBO=r,this._clipVAO=a,this._clipRendererInitialized=!0,!0},t}(o)}.apply(null,r))||(e.exports=n)},1851:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){void 0===t&&(t=250),this.duration=t,this._lastTime=0,this._startTime=0,this._parent=e}return e.prototype.reset=function(){this._lastTime,this._startTime=performance.now()},e.prototype.step=function(){var e=performance.now();if(0===this._lastTime)return this._lastTime=e,this._parent.requestRender(),0;var t=e-this._lastTime;this._lastTime=e;var i=2*this.duration;return e-this._startTime<i&&this._parent.requestRender(),t/this.duration},e}();t.default=i}.apply(null,r))||(e.exports=n)},1852:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1692),i(1500),i(1496),i(1499)],void 0===(n=function(e,t,i,r,n,o){return function(){function e(){this._initialized=!1}return e.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null),this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)},e.prototype.render=function(e,t,i,r){e&&(this._initialized||this._initialize(e),e.setBlendFunctionSeparate(1,771,1,771),e.bindVAO(this._vertexArrayObject),e.bindProgram(this._program),t.setSamplingMode(i),e.bindTexture(t,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",r),e.drawArrays(5,0,4),e.bindVAO())},e.prototype._initialize=function(e){if(this._initialized)return!0;var t={a_pos:0,a_tex:1},a=new n(e,i.bitblitVS,i.bitblitFS,t);if(!a)return!1;var s=new Int8Array(16);s[0]=-1,s[1]=-1,s[2]=0,s[3]=0,s[4]=1,s[5]=-1,s[6]=1,s[7]=0,s[8]=-1,s[9]=1,s[10]=0,s[11]=1,s[12]=1,s[13]=1,s[14]=1,s[15]=1;var l=new o(e,t,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:r.createVertex(e,35044,s)});return this._program=a,this._vertexArrayObject=l,this._initialized=!0,!0},e}()}.apply(null,r))||(e.exports=n)},1853:function(e,t){e.exports='<snippets>\n  <snippet name="backgroundVS">\n  <![CDATA[\n    attribute vec2 a_pos;\n\n    uniform highp mat4 u_transformMatrix;\n    uniform mediump vec2 u_normalized_origin;\n    uniform mediump float u_coord_range;\n    uniform mediump float u_depth;\n\n    void main() {\n      gl_Position = vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(u_coord_range * a_pos, 0.0, 1.0);\n    }\n  ]]>\n  </snippet>\n\n  <snippet name="backgroundFS">\n  <![CDATA[\n    uniform lowp vec4 u_color;\n    void main() {\n      gl_FragColor = u_color;\n    }\n  ]]>\n  </snippet>\n</snippets>\n'},1854:function(e,t){e.exports='<snippets>\n  <snippet name="bitblitVS">\n  <![CDATA[\n    attribute vec2 a_pos;\n    attribute vec2 a_tex;\n\n    varying mediump vec2 v_uv;\n\n    void main(void) {\n      gl_Position = vec4(a_pos, 0.0, 1.0);\n      v_uv = a_tex;\n    }\n  ]]>\n  </snippet>\n\n  <snippet name="bitblitFS">\n  <![CDATA[\n    \tuniform lowp sampler2D u_tex;\n      uniform lowp float u_opacity;\n\n      varying mediump vec2 v_uv;\n\n      void main() {\n        lowp vec4 color = texture2D(u_tex, v_uv);\n\n        // Note: output in pre-multiplied alpha for correct alpha compositing\n        gl_FragColor = color *  u_opacity;\n      }\n  ]]>\n  </snippet>\n</snippets>\n'},1855:function(e,t){e.exports='<snippets>\n  <snippet name="stencilVS">\n  <![CDATA[\n    attribute vec2 a_pos;\n\n    void main() {\n      gl_Position = vec4(a_pos, 0.0, 1.0);\n    }\n  ]]>\n  </snippet>\n\n  <snippet name="stencilFS">\n  <![CDATA[\n    void main() {\n      gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n    }\n  ]]>\n  </snippet>\n</snippets>\n'},1856:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(1667),i(1720),i(1692),i(1536),i(1500),i(1496),i(1493),i(1499)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,h){Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){function t(){var t=e.call(this)||this;return t._initialized=!1,t._maxWidth=0,t._color=new Float32Array([1,0,0,1]),t}return i(t,e),t.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null),this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null),this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null),this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null),this._canvas=null},t.prototype.draw=function(e,t){var i=e.context;if(t.status!==a.TileStatus.INITIALIZED){this._initialized||this._initialize(i),i.bindVAO(this._outlineVertexArrayObject),i.bindProgram(this._outlineProgram),this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),this._outlineProgram.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),this._outlineProgram.setUniform1f("u_coord_range",512),this._outlineProgram.setUniform1f("u_depth",0),this._outlineProgram.setUniform4fv("u_color",this._color),i.setLineWidth(2),i.drawArrays(3,0,4),i.bindVAO();var r=this._getTexture(i,t);r&&(i.bindVAO(this._tileInfoVertexArrayObject),i.bindProgram(this._tileInfoProgram),i.bindTexture(r,0),this._tileInfoProgram.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),this._tileInfoProgram.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform1f("u_coord_ratio",1),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",r.descriptor.width,r.descriptor.height),i.drawArrays(5,0,4),i.bindVAO())}},t.prototype._initialize=function(e){if(this._initialized)return!0;var t={a_pos:0},i=new l(e,o.backgroundVS,o.backgroundFS,t),r=new l(e,o.tileInfoVS,o.tileInfoFS,t),n={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},a=new Int8Array([0,0,1,0,1,1,0,1]),u=s.createVertex(e,35044,a),d=new h(e,t,n,{geometry:u}),c=new Int8Array([0,0,1,0,0,1,1,1]),f=s.createVertex(e,35044,c),p=new h(e,t,n,{geometry:f});return this._outlineProgram=i,this._tileInfoProgram=r,this._outlineVertexArrayObject=d,this._tileInfoVertexArrayObject=p,this._initialized=!0,!0},t.prototype._getTexture=function(e,t){if(t.texture)return t.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var i=t.key.id,n=this._canvas.getContext("2d");n.font="24px sans-serif",n.textAlign="left",n.textBaseline="middle";var o=n.measureText(i),a=Math.pow(2,Math.ceil(r.log2(o.width+2)));return a>this._maxWidth&&(this._maxWidth=a),n.clearRect(0,0,this._maxWidth,32),n.fillStyle="blue",n.fillText(i,0,16),t.texture=new u(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},this._canvas),t.texture},t}(n.default);t.default=d}.apply(null,r))||(e.exports=n)},1857:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1511),i(1721),i(1860),i(1858),i(1862),i(1864),i(1866),i(1678)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u){return function(){function e(){this._programRep=new Map,this.isInitialize=!1}return e.prototype.dispose=function(){this._fillShaderVariations&&(this._fillShaderVariations.dispose(),this._fillShaderVariations=null),this._lineShaderVariations&&(this._lineShaderVariations.dispose(),this._lineShaderVariations=null),this._iconShaderVariations&&(this._iconShaderVariations.dispose(),this._iconShaderVariations=null),this._textShaderVariations&&(this._textShaderVariations.dispose(),this._textShaderVariations=null),0!==this._programRep.size&&(this._programRep.forEach(function(e){return e.dispose()}),this._programRep.clear())},e.prototype.initialize=function(e){if(!this.isInitialize){var t=new u("label",["labelVS","labelFS"],[],a,e);t.addDefine("ID","ID",[!0,!0],"ID"),t.addDefine("HIGHLIGHT","HIGHLIGHT",[!1,!1],"HIGHLIGHT"),t.addDefine("SDF","SDF",[!1,!1],"SDF"),t.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!1,!1],"VV_SIZE_MIN_MAX_VALUE"),t.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!1,!1],"VV_SIZE_SCALE_STOPS"),t.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!1,!1],"VV_SIZE_FIELD_STOPS"),t.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!1,!1],"VV_SIZE_UNIT_VALUE"),t.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR"),t.addDefine("VV_ROTATION","VV_ROTATION",[!1,!1],"VV_ROTATION"),t.addDefine("VV_OPACITY","VV_OPACITY",[!0,!1],"VV_OPACITY"),t.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY"),t.addDefine("PATTERN","PATTERN",[!1,!1],"PATTERN"),t.addDefine("HEATMAP","HEATMAP",[!1,!1],"HEATMAP");var i=new u("text",["textVS","textFS"],[],l,e);i.addDefine("ID","ID",[!0,!0],"ID"),i.addDefine("HIGHLIGHT","HIGHLIGHT",[!1,!1],"HIGHLIGHT"),i.addDefine("SDF","SDF",[!1,!1],"SDF"),i.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!0,!1],"VV_SIZE_MIN_MAX_VALUE"),i.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!0,!1],"VV_SIZE_SCALE_STOPS"),i.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!0,!1],"VV_SIZE_FIELD_STOPS"),i.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!0,!1],"VV_SIZE_UNIT_VALUE"),i.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR"),i.addDefine("VV_ROTATION","VV_ROTATION",[!0,!1],"VV_ROTATION"),i.addDefine("VV_OPACITY","VV_OPACITY",[!0,!1],"VV_OPACITY"),i.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY"),i.addDefine("PATTERN","PATTERN",[!1,!1],"PATTERN"),i.addDefine("HEATMAP","HEATMAP",[!1,!1],"HEATMAP");var r=new u("icon",["iconVS","iconFS"],[],o,e);r.addDefine("ID","ID",[!0,!0],"ID"),r.addDefine("HIGHLIGHT","HIGHLIGHT",[!0,!0],"HIGHLIGHT"),r.addDefine("SDF","SDF",[!0,!0],"SDF"),r.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!0,!1],"VV_SIZE_MIN_MAX_VALUE"),r.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!0,!1],"VV_SIZE_SCALE_STOPS"),r.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!0,!1],"VV_SIZE_FIELD_STOPS"),r.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!0,!1],"VV_SIZE_UNIT_VALUE"),r.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR"),r.addDefine("VV_ROTATION","VV_ROTATION",[!0,!1],"VV_ROTATION"),r.addDefine("VV_OPACITY","VV_OPACITY",[!0,!1],"VV_OPACITY"),r.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY"),r.addDefine("PATTERN","PATTERN",[!0,!0],"PATTERN"),r.addDefine("HEATMAP","HEATMAP",[!0,!0],"HEATMAP");var h=new u("fill",["fillVS","fillFS"],[],n,e);h.addDefine("ID","ID",[!0,!0],"ID"),h.addDefine("HIGHLIGHT","HIGHLIGHT",[!0,!0],"HIGHLIGHT"),h.addDefine("SDF","SDF",[!1,!1],"SDF"),h.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!1,!1],"VV_SIZE_MIN_MAX_VALUE"),h.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!1,!1],"VV_SIZE_SCALE_STOPS"),h.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!1,!1],"VV_SIZE_FIELD_STOPS"),h.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!1,!1],"VV_SIZE_UNIT_VALUE"),h.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR"),h.addDefine("VV_ROTATION","VV_ROTATION",[!1,!1],"VV_ROTATION"),h.addDefine("VV_OPACITY","VV_OPACITY",[!0,!1],"VV_OPACITY"),h.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY"),h.addDefine("PATTERN","PATTERN",[!0,!0],"PATTERN"),h.addDefine("HEATMAP","HEATMAP",[!1,!1],"HEATMAP");var d=new u("line",["lineVS","lineFS"],[],s,e);d.addDefine("ID","ID",[!0,!0],"ID"),d.addDefine("HIGHLIGHT","HIGHLIGHT",[!0,!0],"HIGHLIGHT"),d.addDefine("SDF","SDF",[!0,!0],"SDF"),d.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!0,!1],"VV_SIZE_MIN_MAX_VALUE"),d.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!0,!1],"VV_SIZE_SCALE_STOPS"),d.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!0,!1],"VV_SIZE_FIELD_STOPS"),d.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!0,!1],"VV_SIZE_UNIT_VALUE"),d.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR"),d.addDefine("VV_ROTATION","VV_ROTATION",[!0,!1],"VV_ROTATION"),d.addDefine("VV_OPACITY","VV_OPACITY",[!0,!1],"VV_OPACITY"),d.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY"),d.addDefine("PATTERN","PATTERN",[!0,!0],"PATTERN"),d.addDefine("HEATMAP","HEATMAP",[!1,!1],"HEATMAP"),this._labelShaderVariations=t,this._textShaderVariations=i,this._fillShaderVariations=h,this._iconShaderVariations=r,this._lineShaderVariations=d,this.isInitialize=!0}},e.prototype.getProgram=function(e,t,n){if(e|=t===i.WGLDrawPhase.HITTEST?8:0,e|=t===i.WGLDrawPhase.HIGHLIGHT?16:0,this._programRep[e])return this._programRep[e];if(!(this._iconShaderVariations&&this._fillShaderVariations&&this._lineShaderVariations&&this._labelShaderVariations))return null;var o,a=r.getMaterialVariations(e);switch(a.geometryType){case i.WGLGeometryType.MARKER:o=this._iconShaderVariations.getProgram(a.variations,null,null,n);break;case i.WGLGeometryType.TEXT:o=this._textShaderVariations.getProgram(a.variations,null,null,n);break;case i.WGLGeometryType.LABEL:o=this._labelShaderVariations.getProgram(a.variations,null,null,n);break;case i.WGLGeometryType.FILL:o=this._fillShaderVariations.getProgram(a.variations,null,null,n);break;case i.WGLGeometryType.LINE:o=this._lineShaderVariations.getProgram(a.variations,null,null,n)}return o&&(this._programRep[e]=o),o},e}()}.apply(null,r))||(e.exports=n)},1858:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1859),i(1637)],void 0===(n=function(e,t,i,r){var n=new r;return r.parse(i,n),n}.apply(null,r))||(e.exports=n)},1859:function(e,t){e.exports='<?xml version="1.0" encoding="UTF-8"?>\n\x3c!--\n  Add your GLSL snippets to this file. You should start from\n  importing your old GLSL files. For instance, if you have a\n  file such as myShader.vs.glsl you should create a new <snippet name="myShaderVS">\n  and then copy and paste the GLSL source as the content. You will then convert your\n  code to use the {@link esri/views/2d/engine/webgl/glShaderSnippets glShaderSnippets}\n  instance to access the GLSL code, instead of importing it directly with require("dojo/text!...").\n--\x3e\n<snippets>\n\n  <snippet name="rgba2float"><![CDATA[\n    // TODO consider moving this snippet into a util.xml file\n\n    // Factors to convert rgba back to float\n    const vec4 rgba2float_factors = vec4(\n        255.0 / (256.0),\n        255.0 / (256.0 * 256.0),\n        255.0 / (256.0 * 256.0 * 256.0),\n        255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n      );\n\n    float rgba2float(vec4 rgba) {\n      // Convert components from 0->1 back to 0->255 and then\n      // add the components together with their corresponding\n      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n      return dot(rgba, rgba2float_factors);\n    }\n  ]]></snippet>\n\n  <snippet name="iconVVUniformsVS">\n    <![CDATA[\n  #if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n    attribute vec4 a_vv;\n  #endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY || VV_ROTATION\n\n  #ifdef VV_COLOR\n    uniform float u_vvColorValues[8];\n    uniform vec4 u_vvColors[8];\n  #endif // VV_COLOR\n\n  #ifdef VV_SIZE_MIN_MAX_VALUE\n    uniform vec4 u_vvSizeMinMaxValue;\n  #endif // VV_SIZE_MIN_MAX_VALUE\n\n  #ifdef VV_SIZE_SCALE_STOPS\n    uniform float u_vvSizeScaleStopsValue;\n  #endif // VV_SIZE_SCALE_STOPS\n\n  #ifdef VV_SIZE_FIELD_STOPS\n    uniform float u_vvSizeFieldStopsValues[6];\n    uniform float u_vvSizeFieldStopsSizes[6];\n  #endif // VV_SIZE_FIELD_STOPS\n\n  #ifdef VV_SIZE_UNIT_VALUE\n    uniform float u_vvSizeUnitValueWorldToPixelsRatio;\n  #endif // VV_SIZE_UNIT_VALUE\n\n  #ifdef VV_OPACITY\n    uniform float u_vvOpacityValues[8];\n    uniform float u_vvOpacities[8];\n  #endif // VV_OPACITY\n\n  #ifdef VV_ROTATION\n    uniform lowp float u_vvRotationType;\n  #endif // VV_ROTATION\n\n    ]]>\n  </snippet>\n\n  <snippet name="iconVVFunctions">\n    <![CDATA[\n    bool isNan(float val) {\n      return !( val < 0.0 || 0.0 < val || val == 0.0 );\n    }\n\n  #ifdef VV_SIZE_MIN_MAX_VALUE\n    float getVVMinMaxSize(float sizeValue, float fallback) {\n      if (isNan(sizeValue)) {\n        return fallback;\n      }\n\n      // we need to multiply by 8 in order to translate to tile coordinates\n      float interpolationRatio = (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n      interpolationRatio = clamp(interpolationRatio, 0.0, 1.0);\n      return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n    }\n  #endif // VV_SIZE_MIN_MAX_VALUE\n\n  #ifdef VV_SIZE_FIELD_STOPS\n    const int VV_SIZE_N = 6;\n    float getVVStopsSize(float sizeValue, float fallback) {\n      if (isNan(sizeValue)) {\n        return fallback;\n      }\n\n      if (sizeValue <= u_vvSizeFieldStopsValues[0]) {\n        return u_vvSizeFieldStopsSizes[0];\n      }\n\n      for (int i = 1; i < VV_SIZE_N; ++i) {\n        if (u_vvSizeFieldStopsValues[i] >= sizeValue) {\n          float f = (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n          return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n        }\n      }\n\n      return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n    }\n  #endif // VV_SIZE_FIELD_STOPS\n\n  #ifdef VV_SIZE_UNIT_VALUE\n    float getVVUnitValue(float sizeValue, float fallback) {\n      if (isNan(sizeValue)) {\n        return fallback;\n      }\n\n      return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n    }\n  #endif // VV_SIZE_UNIT_VALUE\n\n  #ifdef VV_OPACITY\n    const int VV_OPACITY_N = 8;\n    float getVVOpacity(float opacityValue) {\n      if (isNan(opacityValue)) {\n        return 1.0;\n      }\n\n      if (opacityValue <= u_vvOpacityValues[0]) {\n        return u_vvOpacities[0];\n      }\n\n      for (int i = 1; i < VV_OPACITY_N; ++i) {\n        if (u_vvOpacityValues[i] >= opacityValue) {\n          float f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n          return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n        }\n      }\n\n      return u_vvOpacities[VV_OPACITY_N - 1];\n    }\n  #endif // VV_OPACITY\n\n  #ifdef VV_ROTATION\n    mat4 getVVRotation(float rotationValue) {\n      // YF TODO: if the symbol has rotation we need to combine the symbo\'s rotation with the VV one\n      if (isNan(rotationValue)) {\n        return mat4(1, 0, 0, 0,\n                    0, 1, 0, 0,\n                    0, 0, 1, 0,\n                    0, 0, 0, 1);\n      }\n\n      float rotation = rotationValue;\n      if (u_vvRotationType == 1.0) {\n        rotation = 90.0 - rotation;\n      }\n\n      float angle = C_DEG_TO_RAD * rotation;\n\n      float sinA = sin(angle);\n      float cosA = cos(angle);\n\n      return mat4(cosA, sinA, 0, 0,\n                  -sinA,  cosA, 0, 0,\n                  0,     0, 1, 0,\n                  0,     0, 0, 1);\n    }\n  #endif // VV_ROTATION\n\n  #ifdef VV_COLOR\n    const int VV_COLOR_N = 8;\n\n    vec4 getVVColor(float colorValue, vec4 fallback) {\n      if (isNan(colorValue)) {\n        return fallback;\n      }\n\n      if (colorValue <= u_vvColorValues[0]) {\n        return u_vvColors[0];\n      }\n\n      for (int i = 1; i < VV_COLOR_N; ++i) {\n        if (u_vvColorValues[i] >= colorValue) {\n          float f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n          return mix(u_vvColors[i-1], u_vvColors[i], f);\n        }\n      }\n\n      return u_vvColors[VV_COLOR_N - 1];\n    }\n  #endif // VV_COLOR\n    ]]>\n  </snippet>\n\n\n  <snippet name="iconVS">\n  <![CDATA[\n    precision mediump float;\n\n    //const float C_256_TO_RAD = 3.14159265359 / 128.0;\n    const float C_DEG_TO_RAD = 3.14159265359 / 180.0;\n\n    // per quad (instance) attributes (20 bytes ==> equivalent of 5 bytes per vertex)\n    attribute vec2 a_pos;\n    attribute vec4 a_vertexOffsetAndTex;\n    attribute vec4 a_id; // since we need to render the Id as a color we need to break it into RGBA components. so just like a color, the Id is normalized.\n    attribute vec4 a_color;\n    attribute vec4 a_outlineColor;\n    attribute vec4 a_sizeAndOutlineWidth;\n\n    // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n    // relative to the tile\'s upper left corner\n    // the extrusion vector.\n    uniform highp mat4 u_transformMatrix;\n    // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\n    uniform highp mat4 u_extrudeMatrix;\n    // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\n    uniform highp vec2 u_normalized_origin;\n\n    // the size of the mosaic given in pixels\n    uniform vec2 u_mosaicSize;\n\n    // the opacity of the layer given by the painter\n    uniform mediump float u_opacity;\n\n    // the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\n    varying mediump vec2 v_tex;\n    // the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n    // opacity of the layer given by the painter\n    varying lowp float v_transparency;\n    // the of the icon given in pixels\n    varying mediump vec2 v_size;\n\n    // icon color. If is a picture-marker it is used to tint the texture color\n    varying lowp vec4 v_color;\n\n #ifdef SDF\n    varying lowp vec4 v_outlineColor;\n    varying mediump float v_outlineWidth;\n #endif // SDF\n\n #ifdef ID\n    varying highp vec4 v_id;\n #endif // ID\n\n #ifdef HEATMAP\n    attribute float a_heatmapWeight;\n    varying mediump float v_heatmapWeight;\n #endif // HEATMAP\n\n    // import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\n    $iconVVUniformsVS\n    $iconVVFunctions\n\n    void main()\n    {\n      vec2 a_offset = a_vertexOffsetAndTex.xy;\n      vec2 a_tex = a_vertexOffsetAndTex.zw;\n      vec2 a_size = a_sizeAndOutlineWidth.xy;\n\n      // default values (we need them for the variations to come)\n      float a_angle = 0.0;\n      float delta_z = 0.0;\n      float depth = 0.0;\n      v_transparency = 1.0;\n\n  #if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n  #ifdef VV_SIZE_MIN_MAX_VALUE\n      // vv size override the original symbol\'s size\n      float h = getVVMinMaxSize(a_vv.x, a_size.y);\n  #endif // VV_SIZE_MIN_MAX_VALUE\n\n  #ifdef VV_SIZE_SCALE_STOPS\n      float h = u_vvSizeScaleStopsValue;\n  #endif // VV_SIZE_SCALE_STOPS\n\n  #ifdef VV_SIZE_FIELD_STOPS\n      float h = getVVStopsSize(a_vv.x, a_size.y);\n  #endif // VV_SIZE_FIELD_STOPS\n\n  #ifdef VV_SIZE_UNIT_VALUE\n      float h = getVVUnitValue(a_vv.x, a_size.y);\n  #endif // VV_SIZE_UNIT_VALUE\n\n      // make sure to preserve the aspect ratio of the symbol\n      vec2 size = vec2(h * a_size.x / a_size.y, h);\n      vec2 offset = a_offset * size / a_size;\n      v_size = size;\n  #else\n  #ifdef HEATMAP\n      // reconstruct the kernel size\n      a_size = 9.0 * a_size + 1.0;\n  #endif // HEATMAP\n\n      vec2 offset = a_offset;\n      v_size = a_size;\n  #endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n  #ifdef SDF\n    offset *= 2.0;\n  #endif // SDF\n\n  #ifdef VV_ROTATION\n      gl_Position = vec4(u_normalized_origin, depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * getVVRotation(a_vv.w) * vec4(offset, delta_z, 0.0);\n  #else\n      gl_Position = vec4(u_normalized_origin, depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offset, delta_z, 0.0);\n  #endif // VV_ROTATION\n\n  #ifdef VV_OPACITY\n      v_transparency = getVVOpacity(a_vv.z);\n  #else\n      v_transparency = u_opacity;\n  #endif // VV_OPACITY\n\n  #ifdef VV_COLOR\n      v_color = getVVColor(a_vv.y, a_color);\n  #else\n      v_color = a_color;\n  #endif // VV_COLOR\n\n      // output the texture coordinates and the transparency\n      v_tex = a_tex / u_mosaicSize;\n\n #ifdef SDF\n      v_outlineColor = a_outlineColor;\n      v_outlineWidth = a_sizeAndOutlineWidth.z;\n #endif // SDF\n\n #ifdef ID\n      v_id = a_id;\n #endif // ID\n\n #ifdef HEATMAP\n    v_heatmapWeight = a_heatmapWeight;\n #endif // HEATMAP\n    }\n  ]]>\n  </snippet>\n\n  <snippet name="iconFS">\n   <![CDATA[\n    precision mediump float;\n\n    uniform lowp sampler2D u_texture;\n\n    varying lowp vec2 v_tex;\n    varying lowp float v_transparency;\n    varying mediump vec2 v_size;\n    varying lowp vec4 v_color;\n\n #ifdef SDF\n    varying lowp vec4 v_outlineColor;\n    varying mediump float v_outlineWidth;\n\n    // we need the conversion function from RGBA to float\n    $rgba2float\n #endif // SDF\n\n #ifdef ID\n    varying highp vec4 v_id;\n #endif // ID\n\n #ifdef HEATMAP\n    varying mediump float v_heatmapWeight;\n #endif // HEATMAP\n\n    const float softEdgeRatio = 1.0; // use blur here if needed\n\n    void main()\n    {\n #ifdef SDF\n      lowp vec4 fillPixelColor = v_color;\n\n      // calculate the distance from the edge [-0.5, 0.5]\n      float d = 0.5 - rgba2float(texture2D(u_texture, v_tex));\n\n      // the soft edge ratio is about 1.5 pixels allocated for the soft edge.\n      float size = max(v_size.x, v_size.y);\n      float dist = d * size * softEdgeRatio;\n\n      // set the fragment\'s transparency according to the distance from the edge\n      fillPixelColor *= clamp(0.5 - dist, 0.0, 1.0);\n\n      // count for the outline\n      // therefore tint the entire icon area.\n      if (v_outlineWidth > 0.25) {\n        lowp vec4 outlinePixelColor = v_outlineColor;\n\n        // outlines can\'t be larger than the size of the symbol\n        float clampedOutlineSize = min(v_outlineWidth, size);\n\n        outlinePixelColor *= clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n\n        // finally combine the outline and the fill colors (outline draws on top of fill)\n        gl_FragColor = v_transparency * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n      }\n      else {\n        gl_FragColor = v_transparency * fillPixelColor;\n      }\n #else // not an SDF\n      lowp vec4 texColor = texture2D(u_texture, v_tex);\n\n #ifdef HEATMAP\n      texColor.r *= v_heatmapWeight;\n #endif // HEATMAP\n\n      gl_FragColor = v_transparency * texColor;\n #endif // SDF\n\n #ifdef HIGHLIGHT\n      gl_FragColor.a = step(1.0 / 255.0, gl_FragColor.a);\n #endif // HIGHLIGHT\n\n #ifdef ID\n      if (gl_FragColor.a < 1.0 / 255.0) {\n        discard;\n      }\n      gl_FragColor = v_id;\n #endif // ID\n    }\n   ]]>\n  </snippet>\n</snippets>\n\n'},1860:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1861),i(1637)],void 0===(n=function(e,t,i,r){var n=new r;return r.parse(i,n),n}.apply(null,r))||(e.exports=n)},1861:function(e,t){e.exports='<?xml version="1.0" encoding="UTF-8"?>\n\x3c!--\n  // YF TODO: (doc)\n--\x3e\n<snippets>\n  <snippet name="fillVVUniformsVS">\n    <![CDATA[\n  #if defined(VV_COLOR)|| defined(VV_OPACITY)\n    attribute vec4 a_vv;\n  #endif // VV_COLOR || VV_OPACITY\n\n  #ifdef VV_COLOR\n    uniform float u_vvColorValues[8];\n    uniform vec4 u_vvColors[8];\n  #endif // VV_COLOR\n\n  #ifdef VV_OPACITY\n    uniform float u_vvOpacityValues[8];\n    uniform float u_vvOpacities[8];\n  #endif // VV_OPACITY\n\n    ]]>\n  </snippet>\n\n  <snippet name="fillVVFunctions">\n    <![CDATA[\n    bool isNan(float val) {\n      return !( val < 0.0 || 0.0 < val || val == 0.0 );\n    }\n    \n  #ifdef VV_OPACITY\n    const int VV_OPACITY_N = 8;\n\n    float getVVOpacity(float opacityValue) {\n      if (isNan(opacityValue)) { \n        return 1.0;\n      }\n\n      if (opacityValue <= u_vvOpacityValues[0]) {\n        return u_vvOpacities[0];\n      }\n\n      for (int i = 1; i < VV_OPACITY_N; ++i) {\n        if (u_vvOpacityValues[i] >= opacityValue) {\n          float f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n          return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n        }\n      }\n\n      return u_vvOpacities[VV_OPACITY_N - 1];\n    }\n  #endif // VV_OPACITY\n\n  #ifdef VV_COLOR\n    const int VV_COLOR_N = 8;\n\n    vec4 getVVColor(float colorValue, vec4 fallback) {\n      if (isNan(colorValue)) { \n        return fallback;\n      }\n      \n      if (colorValue <= u_vvColorValues[0]) {\n        return u_vvColors[0];\n      }\n\n      for (int i = 1; i < VV_COLOR_N; ++i) {\n        if (u_vvColorValues[i] >= colorValue) {\n          float f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n          return mix(u_vvColors[i-1], u_vvColors[i], f);\n        }\n      }\n\n      return u_vvColors[VV_COLOR_N - 1];\n    }\n  #endif // VV_COLOR\n    ]]>\n  </snippet>\n\n  <snippet name="fillVS">\n    <![CDATA[\n      precision mediump float;\n\n      attribute vec2 a_pos;\n      attribute vec4 a_id; // since we need to render the Id as a color we need to break it into RGBA components. so just like a color, the Id is normalized.\n      attribute vec4 a_color;\n      attribute vec4 a_tlbr;\n      attribute vec4 a_aux;\n\n      uniform highp mat4 u_transformMatrix;\n      uniform highp vec2 u_normalized_origin;\n\n      varying lowp vec4 v_color;\n      varying lowp float v_opacity;\n\n      // import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\n      $fillVVUniformsVS\n      $fillVVFunctions\n\n  #ifdef PATTERN\n    uniform mediump float u_zoomFactor;\n    uniform mediump vec2 u_mosaicSize;\n\n    varying mediump vec4 v_tlbr;\n    varying mediump vec2 v_tileTextureCoord;\n  #endif // PATTERN\n\n  #ifdef ID\n    varying highp vec4 v_id;\n  #endif // ID\n\n      void main()\n      {\n  #ifdef VV_OPACITY\n        v_opacity = getVVOpacity(a_vv.y);\n  #else\n        v_opacity = 1.0;\n  #endif\n\n  #ifdef VV_COLOR\n       v_color = getVVColor(a_vv.x, a_color);\n  #else\n       v_color = a_color;\n  #endif // VV_COLOR\n\n  #ifdef ID\n      v_id = a_id;\n  #endif // ID\n\n  #ifdef PATTERN\n       // calculate the pattern matrix\n       mat3 patternMatrix = mat3(1.0, 0.0, 0.0,\n                                 0.0, 1.0, 0.0,\n                                 0.0, 0.0, 1.0);\n       patternMatrix[0][0] = 1.0 / (u_zoomFactor * a_aux.x);\n       patternMatrix[1][1] = 1.0 / (u_zoomFactor * a_aux.y);\n\n       // calculate the texture coordinates of the current vertex. It will of course get interpolated.\n       // The pattern matrix is a 3x3 scale matrix which \'tiles\' the texture inside the tile, translating from\n       // tile coordinates to texture coordinates.\n       v_tileTextureCoord = (patternMatrix * vec3(a_pos, 1.0)).xy;\n       v_tlbr = vec4(a_tlbr.x / u_mosaicSize.x, a_tlbr.y / u_mosaicSize.y, a_tlbr.z / u_mosaicSize.x, a_tlbr.w / u_mosaicSize.y);\n  #endif // PATTERN\n\n        gl_Position = vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(a_pos, 0, 1.0);\n      }\n    ]]>\n  </snippet>\n\n  <snippet name="fillFS">\n    <![CDATA[\n      precision lowp float;\n      uniform lowp float u_opacity;\n\n  #ifdef PATTERN\n      uniform lowp sampler2D u_texture;\n\n      varying mediump vec4 v_tlbr;\n      varying mediump vec2 v_tileTextureCoord;\n  #endif // PATTERN\n\n  #ifdef ID\n    varying highp vec4 v_id;\n  #endif // ID\n\n      varying lowp vec4 v_color;\n      varying lowp float v_opacity;\n\n      void main()\n      {\n  #ifdef PATTERN\n         // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\n         mediump vec2 normalizedTextureCoord = mod(v_tileTextureCoord, 1.0);\n         // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\n         // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\n         // we need to only sample from area that has our sprite in the mosaic.\n         mediump vec2 samplePos = mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n         // sample the sprite mosaic\n         lowp vec4 color = texture2D(u_texture, samplePos);\n         gl_FragColor = u_opacity * v_opacity * v_color * color;\n  #else\n        gl_FragColor = u_opacity * v_opacity * v_color;\n  #endif // PATTERN\n\n  #ifdef HIGHLIGHT\n        gl_FragColor.a = step(1.0 / 255.0, gl_FragColor.a);\n  #endif // HIGHLIGHT\n\n  #ifdef ID\n      //if (gl_FragColor.a < 1.0 / 255.0) {\n      //  discard;\n      //}\n      gl_FragColor = v_id;\n  #endif // ID\n      }\n    ]]>\n  </snippet>\n</snippets>\n'},1862:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1863),i(1637)],void 0===(n=function(e,t,i,r){var n=new r;return r.parse(i,n),n}.apply(null,r))||(e.exports=n)},1863:function(e,t){e.exports='<?xml version="1.0" encoding="UTF-8"?>\n\x3c!--\n  Add your GLSL snippets to this file. You should start from\n  importing your old GLSL files. For instance, if you have a\n  file such as myShader.vs.glsl you should create a new <snippet name="myShaderVS">\n  and then copy and paste the GLSL source as the content. You will then convert your\n  code to use the {@link esri/views/2d/engine/webgl/glShaderSnippets glShaderSnippets}\n  instance to access the GLSL code, instead of importing it directly with require("dojo/text!...").\n--\x3e\n<snippets>\n\n  <snippet name="labelVS">\n  <![CDATA[\n    precision mediump float;\n\n      attribute vec2 a_pos;                  // 2 * 2 (2 x signed 16)\n      attribute vec4 a_color;                // 4 (4 x unsigned byte)\n      attribute vec2 a_vertexOffset;         // 2 * 2 // (2 x signed 16) offset from the anchor point of the string\n      attribute vec4 a_texAndSize;          // 4 (4 x unsigned byte) texture coordinatesm and font size. w is for the halo size\n      attribute vec4 a_refSymbolAndPlacementOffset; // 4 (4 x unsigned byte) the offset of the reference symbol of the feature (x,y) and the placement offset (z, w) all given in pixels\n\n      attribute lowp float  a_visible; // a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\n\n      attribute mediump vec2 a_visibilityRange; // 2 x unsigned byte;\n\n      // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n      // relative to the tile\'s upper left corner\n      // the extrusion vector.\n      uniform highp mat4 u_transformMatrix;\n      // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\n      uniform highp mat4 u_extrudeMatrix;\n      // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\n      uniform highp vec2 u_normalized_origin;\n      // the size of the mosaic given in pixels\n      uniform vec2 u_mosaicSize;\n      uniform float u_pixelRatio;\n\n      // the opacity of the layer\n      uniform mediump float u_opacity;\n\n      // the curent zoom\n      uniform mediump float u_zoomLevel; // the current zoom level X 10\n      uniform lowp float u_mapRotation;\n      uniform lowp float u_mapAligned;\n\n      varying mediump float v_antialiasingWidth;\n      varying mediump float v_edgeDistanceOffset;\n\n      // the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\n      varying mediump vec2 v_tex;\n      // the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n      // opacity of the layer given by the painter\n      varying lowp float v_transparency;\n\n    #ifdef ID\n       uniform mediump float u_fadeStep;\n       varying mediump float v_fadeStep;\n    #else\n       varying mediump vec4 v_color;\n    #endif // ID\n\n      // the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\n      // by 16 and then at the shader devide by the same number\n      const float offsetPrecision = 1.0 / 8.0;\n      const float outlineScale = 1.0 / 10.0;\n      const float sdfFontSize = 24.0;\n\n      // maximum SDF distance of 8 pixels represent the distance values that range from -2 inside the geometry to 6 on the outside.\n      // 6 is actually the maximum distance outside the glyph, therefore it is the limitation of the halo which is 1/4 of the geometry size.\n      const float maxSdfDistance = 8.0;\n\n      const float C_DEG_TO_RAD = 3.14159265359 / 180.0;\n\n      void main()\n      {\n        // make sure to clip the vertices in case that given record is marked as invisible\n        float z = 2.0 * (1.0 - a_visible);\n\n        // clip the vertex if we are beyond the visibility range of the vertex\n        // please note: min value of 0 is regarded infinity. max value of 255 is regarded infinity\n        z += 1.0 + sign(a_visibilityRange.x - u_zoomLevel);\n        z += 1.0 + sign(u_zoomLevel - a_visibilityRange.y);\n\n        // we use the list significant bit of the position in order to store the indication whethe the vertex is of a halow of a glyph\n        mediump float halo = mod(a_pos, 2.0).x;\n\n        float fontSize = a_texAndSize.z;\n\n        float fontScale = fontSize / sdfFontSize;\n        // we need to scale the extrude matrix by the font-scale in order to get the right text size\n        mat4 extrudeMatrix = fontScale * u_extrudeMatrix;\n\n        float mapRotation = u_mapAligned * C_DEG_TO_RAD * -u_mapRotation;\n        float sinA = sin(mapRotation);\n        float cosA = cos(mapRotation);\n\n        mat4 mapRotationMat = mat4(cosA, sinA, 0.0, 0.0,\n                                  -sinA, cosA, 0.0, 0.0,\n                                    0.0,  0.0, 1.0, 0.0,\n                                    0.0,  0.0, 0.0, 1.0);\n\n        vec4 refSymbolOffset = mapRotationMat *  vec4(a_refSymbolAndPlacementOffset.xy, 0.0, 0.0);\n\n        gl_Position = vec4(u_normalized_origin, 0.0, 0.0) +\n                      u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) +\n                      u_extrudeMatrix * vec4(refSymbolOffset.xy + a_refSymbolAndPlacementOffset.zw, 0.0, 0.0) +\n                      extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\n\n        v_tex = a_texAndSize.xy / u_mosaicSize;\n        v_antialiasingWidth = 0.106 * sdfFontSize / fontSize / u_pixelRatio;\n        // if halo.x is zero (not a halo) v_edgeDistanceOffset will end up being zero as well.\n        v_edgeDistanceOffset = halo * outlineScale * a_texAndSize.w / fontScale / maxSdfDistance;\n\n        v_transparency = u_opacity;\n\n      #ifdef ID\n        v_fadeStep = u_fadeStep;\n      #else\n        v_color = a_color;\n      #endif // ID\n      }\n  ]]>\n  </snippet>\n\n  <snippet name="labelFS">\n   <![CDATA[\n      precision lowp float;\n\n      uniform mediump sampler2D u_referenceTex;\n      uniform mediump vec2 u_screenSize;\n      uniform mediump float u_pixelRatio;\n\n      varying mediump float v_antialiasingWidth;\n      varying mediump float v_edgeDistanceOffset;\n      varying mediump vec2 v_tex;\n      varying lowp float v_transparency;\n\n    #ifdef ID\n      varying mediump float v_fadeStep;\n    #else\n      uniform lowp sampler2D u_texture;\n      varying mediump vec4 v_color;\n    #endif // ID\n\n    const vec3 epsilon = vec3(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);\n\n      void main()\n      {\n        mediump vec2 refTextPos = gl_FragCoord.xy / (u_pixelRatio * u_screenSize.xy);\n        mediump vec4 referenceFragment = texture2D(u_referenceTex, refTextPos);\n    #ifdef ID\n        mediump float alpha = clamp(referenceFragment.a + v_fadeStep, 0.0, 1.0);\n        // fill the whole quad\n        gl_FragColor = vec4(alpha);\n    #else\n        // read the fade alpha\n        lowp float fadeAlpha = referenceFragment.a;\n\n        // read the distance from the SDF texture\n        lowp float dist = texture2D(u_texture, v_tex).a;\n\n        // the edge distance if a factor of the outline width\n        float glyphEdgeDistance = 0.75 - v_edgeDistanceOffset;\n\n        // use a smooth-step in order to calculate the geometry of the shape given by the distance field\n        lowp float sdfAlpha = smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_transparency;\n\n        gl_FragColor = fadeAlpha * sdfAlpha * v_transparency * v_color;\n    #endif\n      }\n   ]]>\n  </snippet>\n</snippets>\n\n'},1864:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1865),i(1637)],void 0===(n=function(e,t,i,r){var n=new r;return r.parse(i,n),n}.apply(null,r))||(e.exports=n)},1865:function(e,t){e.exports='<?xml version="1.0" encoding="UTF-8"?>\n\x3c!--\n  // YF TODO: (doc)\n--\x3e\n<snippets>\n  <snippet name="thinLineParams">\n     <![CDATA[\n    float thinLineHalfWidth = 1.0; // meaning that a 2 pixels line width is considered a thin line\n    float thinLineWidthFactor = 1.1;\n     ]]>\n  </snippet>\n\n  <snippet name="lineVVUniformsVS">\n    <![CDATA[\n  #if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY)\n    attribute vec3 a_vv;\n  #endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY\n\n  #ifdef VV_COLOR\n    uniform float u_vvColorValues[8];\n    uniform vec4 u_vvColors[8];\n  #endif // VV_COLOR\n\n  #ifdef VV_SIZE_MIN_MAX_VALUE\n    uniform vec4 u_vvSizeMinMaxValue;\n  #endif // VV_SIZE_MIN_MAX_VALUE\n\n  #ifdef VV_SIZE_SCALE_STOPS\n    uniform float u_vvSizeScaleStopsValue;\n  #endif\n\n  #ifdef VV_SIZE_FIELD_STOPS\n    uniform float u_vvSizeFieldStopsValues[6];\n    uniform float u_vvSizeFieldStopsSizes[6];\n  #endif // VV_SIZE_FIELD_STOPS\n\n  #ifdef VV_SIZE_UNIT_VALUE\n    uniform float u_vvSizeUnitValueWorldToPixelsRatio;\n  #endif // VV_SIZE_UNIT_VALUE\n\n  #ifdef VV_OPACITY\n    uniform float u_vvOpacityValues[8];\n    uniform float u_vvOpacities[8];\n  #endif // VV_OPACITY\n    ]]>\n  </snippet>\n\n  <snippet name="lineVVFunctions">\n    <![CDATA[\n    bool isNan(float val) {\n      return !( val < 0.0 || 0.0 < val || val == 0.0 );\n    }\n    \n  #ifdef VV_SIZE_MIN_MAX_VALUE\n    float getVVMinMaxSize(float sizeValue, float fallback) {\n      if (isNan(sizeValue)) { \n        return fallback;\n      }\n\n      float f = (sizeValue - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n      return clamp(mix(u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w, f), u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w);\n    }\n  #endif // VV_SIZE_MIN_MAX_VALUE\n\n  #ifdef VV_SIZE_FIELD_STOPS\n    const int VV_SIZE_N = 6;\n    float getVVStopsSize(float sizeValue, float fallback) {\n      if (isNan(sizeValue)) { \n        return fallback;\n      }\n\n      if (sizeValue <= u_vvSizeFieldStopsValues[0]) {\n        return u_vvSizeFieldStopsSizes[0];\n      }\n\n      for (int i = 1; i < VV_SIZE_N; ++i) {\n        if (u_vvSizeFieldStopsValues[i] >= sizeValue) {\n          float f = (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n          return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n        }\n      }\n\n      return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n    }\n  #endif // VV_SIZE_FIELD_STOPS\n\n  #ifdef VV_SIZE_UNIT_VALUE\n    float getVVUnitValue(float sizeValue, float fallback) {\n      if (isNan(sizeValue)) { \n        return fallback;\n      }\n\n      return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n    }\n  #endif // VV_SIZE_UNIT_VALUE\n\n  #ifdef VV_OPACITY\n    const int VV_OPACITY_N = 8;\n    float getVVOpacity(float opacityValue) {\n      if (isNan(opacityValue)) { \n        return 1.0;\n      }\n\n      if (opacityValue <= u_vvOpacityValues[0]) {\n        return u_vvOpacities[0];\n      }\n\n      for (int i = 1; i < VV_OPACITY_N; ++i) {\n        if (u_vvOpacityValues[i] >= opacityValue) {\n          float f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n          return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n        }\n      }\n\n      return u_vvOpacities[VV_OPACITY_N - 1];\n    }\n  #endif // VV_OPACITY\n\n  #ifdef VV_COLOR\n    const int VV_COLOR_N = 8;\n\n    vec4 getVVColor(float colorValue, vec4 fallback) {\n      if (isNan(colorValue)) { \n        return fallback;\n      }\n\n      if (colorValue <= u_vvColorValues[0]) {\n        return u_vvColors[0];\n      }\n\n      for (int i = 1; i < VV_COLOR_N; ++i) {\n        if (u_vvColorValues[i] >= colorValue) {\n          float f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n          return mix(u_vvColors[i-1], u_vvColors[i], f);\n        }\n      }\n\n      return u_vvColors[VV_COLOR_N - 1];\n    }\n  #endif // VV_COLOR\n    ]]>\n  </snippet>\n\n  <snippet name="lineVS">\n    <![CDATA[\n     precision mediump float;\n\n     attribute vec2 a_pos;\n     attribute vec4 a_id;\n     attribute vec4 a_color;\n     attribute vec4 a_offsetAndNormal;\n     attribute vec2 a_accumulatedDistanceAndHalfWidth;\n     attribute vec4 a_tlbr;\n     attribute vec4 a_segmentDirection;\n\n     // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n     // relative to the tile\'s upper left corner\n     // the extrusion vector.\n     uniform highp mat4 u_transformMatrix;\n     // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\n     uniform highp mat4 u_extrudeMatrix;\n     // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\n     uniform highp vec2 u_normalized_origin;\n     uniform lowp float u_opacity; // the layer\'s opacity\n     uniform mediump float u_zoomFactor;\n     uniform mediump float u_antialiasing;\n\n     // the interpolated normal to the line. the information is packed into the two LSBs of the vertex coordinate\n     varying mediump vec2 v_normal;\n     varying mediump float v_lineHalfWidth;\n     varying lowp vec4 v_color;\n     varying lowp float v_transparency;\n\n     const float scale = 1.0 / 31.0;\n#ifdef SDF\n     const float widthFactor = 2.0;\n#else\n     const float widthFactor = 1.0;\n#endif\n\n\n#ifdef PATTERN\n     uniform mediump vec2 u_mosaicSize;\n\n     varying mediump vec4 v_tlbr; // normalized pattern coordinates [0, 1]\n     varying mediump vec2 v_patternSize;\n#endif // PATTERN\n\n// we need to accumulated distance only if it is a pattern or an SDF line\n#if defined(PATTERN) || defined(SDF)\n     varying highp float v_accumulatedDistance;\n#endif // PATTERN SDF\n\n#ifdef ID\n     varying highp vec4 v_id;\n#endif // ID\n\n     // import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\n     $lineVVUniformsVS\n     $lineVVFunctions\n\n     void main()\n     {\n     // size VV block\n#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\n       mediump float lineHalfWidth = 0.5 * getVVMinMaxSize(a_vv.x, 2.0 * a_accumulatedDistanceAndHalfWidth.y * scale);\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_SCALE_STOPS\n       mediump float lineHalfWidth = 0.5 * u_vvSizeScaleStopsValue;\n#endif // VV_SIZE_SCALE_STOPS\n\n#ifdef VV_SIZE_FIELD_STOPS\n       mediump float lineHalfWidth = 0.5 * getVVStopsSize(a_vv.x, 2.0 * a_accumulatedDistanceAndHalfWidth.y * scale);\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\n       mediump float lineHalfWidth = 0.5 * getVVUnitValue(a_vv.x, 2.0 * a_accumulatedDistanceAndHalfWidth.y * scale);\n#endif // VV_SIZE_UNIT_VALUE\n\n#else // no VV\n       mediump float lineHalfWidth = a_accumulatedDistanceAndHalfWidth.y * scale;\n#endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n#ifdef VV_OPACITY\n      v_transparency = u_opacity * getVVOpacity(a_vv.z);\n#else\n      v_transparency = u_opacity;\n#endif // VV_OPACITY\n\n#ifdef VV_COLOR\n      v_color = getVVColor(a_vv.y, a_color);\n#else\n      v_color = a_color;\n#endif // VV_COLOR\n\n       // make sure to clip the vertices in case that the width of the line is 0 (or negative)\n       float z = 2.0 * step(lineHalfWidth, 0.0);\n\n       // add an antialiasing distance. We use 0.2 rather than 0.5 in order to match the SVG renderer\n       // also limit the total line width to 1.3 pixels. Below this value lines don\'t look good compared to the SVG renderer\n       lineHalfWidth = max(lineHalfWidth, 0.45) + 0.2 * u_antialiasing;\n\n       // include the thin line parameters (thinLineHalfWidth and thinLineWidthFactor)\n       $thinLineParams\n       // for now assume that a thin line is a line which is under 2 pixels (1 pixels on either sides of the centerline)\n       // in practice, a thin line is a line who\'s half width vary from 0.45px to the value of thinLineHalfWidth, as the value\n       // is claped in line 221 above\n       mediump float thinLineFactor = max(thinLineWidthFactor * step(lineHalfWidth, thinLineHalfWidth), 1.0);\n\n       v_lineHalfWidth = lineHalfWidth;\n\n       // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\n       // sake of using less attribute memory, we need to scale it back to the original range of ~ [0, 1])\n       // in a case of a thin line we move each vertex twice as far\n       mediump vec2 dist = thinLineFactor * widthFactor * lineHalfWidth * a_offsetAndNormal.xy * scale;\n\n       // transform the vertex\n       gl_Position = vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(a_pos, z, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\n       v_normal = a_offsetAndNormal.zw * scale;\n\n#if defined(PATTERN) || defined(SDF)\n       v_accumulatedDistance = a_accumulatedDistanceAndHalfWidth.x + dot(scale * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif // PATTERN || SDF\n\n#ifdef PATTERN\n      v_tlbr = vec4(a_tlbr.x / u_mosaicSize.x, a_tlbr.y / u_mosaicSize.y, a_tlbr.z / u_mosaicSize.x, a_tlbr.w / u_mosaicSize.y);\n      v_patternSize = vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif // PATTERN\n\n#ifdef ID\n      v_id = a_id;\n#endif // ID\n     }\n    ]]>\n  </snippet>\n\n  <snippet name="lineFS">\n    <![CDATA[\n       precision lowp float;\n\n       uniform lowp float u_blur;\n       uniform mediump float u_antialiasing;\n\n       varying mediump vec2 v_normal;\n       varying mediump float v_lineHalfWidth;\n       varying lowp vec4 v_color;\n       varying lowp float v_transparency;\n\n#if defined(PATTERN) || defined(SDF)\n      uniform sampler2D u_texture;\n      uniform mediump float u_zoomFactor;\n\n      varying mediump vec4 v_tlbr; // normalized pattern coordinates [0, 1]\n      varying mediump vec2 v_patternSize;\n      varying highp float v_accumulatedDistance;\n#endif // PATTERN SDF\n\n#ifdef SDF\n      const float sdfPatternHalfWidth = 15.5; // YF: assumed that the width will be set to 31\n     const float widthFactor = 2.0;\n\n    // Factors to convert rgba back to float\n    const vec4 rgba2float_factors = vec4(\n        255.0 / (256.0),\n        255.0 / (256.0 * 256.0),\n        255.0 / (256.0 * 256.0 * 256.0),\n        255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n      );\n\n    float rgba2float(vec4 rgba) {\n      // Convert components from 0->1 back to 0->255 and then\n      // add the components together with their corresponding\n      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n      return dot(rgba, rgba2float_factors);\n    }\n#endif // SDF\n\n#ifdef ID\n     varying highp vec4 v_id;\n#endif // ID\n\n       void main()\n       {\n         // include the thin line parameters (thinLineHalfWidth and thinLineWidthFactor)\n         $thinLineParams\n\n         // for now assume that a thin line is a line which is under 2 pixels (1 pixels on either sides of the centerline)\n         mediump float thinLineFactor = max(thinLineWidthFactor * step(v_lineHalfWidth, thinLineHalfWidth), 1.0);\n\n         // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\n         // and any value in between will be inside the line (the sign represent the direction - right or left).\n         // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\n         mediump float fragDist = length(v_normal) * v_lineHalfWidth;\n\n         // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\n         // when it is a thin line then use a slightly shallower slope in order to add more feathering\n         lowp float alpha = clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n\n#if defined(SDF)\n         mediump float lineHalfWidth = widthFactor * v_lineHalfWidth;\n         mediump float lineWidthRatio = lineHalfWidth / sdfPatternHalfWidth;\n         mediump float relativeTexX = mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n         mediump float relativeTexY = 0.5 + 0.5 * v_normal.y;\n\n          // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\n         mediump vec2 texCoord = mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n\n         // calculate the distance from the edge [-0.5, 0.5]\n         mediump float d = rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n\n         // the distance is a proportional to the line width\n         float dist = d * lineHalfWidth;\n\n         lowp vec4 fillPixelColor = v_transparency * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n        gl_FragColor = fillPixelColor;\n#elif defined(PATTERN)\n         // we need to calculate the relative portion of the line texture along the line given the accumulated distance along the line\n         // The computed value should is anumber btween 0 and 1 which will later be used to interpolate btween the BR and TL values\n         mediump float relativeTexX = mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / v_patternSize.x, 1.0);\n\n         // in order to calculate the texture coordinates prependicular to the line (Y axis), we use the interpolated normal values\n         // which range from -1.0 to 1.0. On the line\'s centerline, the value of the interpolated normal is 0.0, however the relative\n         // texture value shpould be 0.5 (given that at the bottom of the line, the texture coordinate must be equal to 0.0)\n         // (TL) ---------------------------      --\x3e left edge of line. Interpolatedf normal is 1.0\n         //              | -> line-width / 2\n         //      - - - - - - - - - - - - - -\n         //              | -> line-width / 2\n         //      ---------------------------- (BR)--\x3e right edge of line. Interpolatedf normal is -1.0\n\n         mediump float relativeTexY = 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\n\n         // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\n         mediump vec2 texCoord = mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n\n         // get the color from the texture\n         lowp vec4 color = texture2D(u_texture, texCoord);\n\n         gl_FragColor = v_transparency * alpha * v_color * color;\n#else // solid line (no texture, no pattern)\n         // output the fragment color\n         gl_FragColor = v_transparency * alpha * v_color;\n#endif // SDF\n\n#ifdef HIGHLIGHT\n         gl_FragColor.a = step(1.0 / 255.0, gl_FragColor.a);\n#endif // HIGHLIGHT\n\n #ifdef ID\n         if (gl_FragColor.a < 1.0 / 255.0) {\n           discard;\n         }\n         gl_FragColor = v_id;\n #endif // ID\n       }\n    ]]>\n  </snippet>\n\n</snippets>\n'},1866:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1867),i(1637)],void 0===(n=function(e,t,i,r){var n=new r;return r.parse(i,n),n}.apply(null,r))||(e.exports=n)},1867:function(e,t){e.exports='<?xml version="1.0" encoding="UTF-8"?>\n\x3c!--\n  Add your GLSL snippets to this file. You should start from\n  importing your old GLSL files. For instance, if you have a\n  file such as myShader.vs.glsl you should create a new <snippet name="myShaderVS">\n  and then copy and paste the GLSL source as the content. You will then convert your\n  code to use the {@link esri/views/2d/engine/webgl/glShaderSnippets glShaderSnippets}\n  instance to access the GLSL code, instead of importing it directly with require("dojo/text!...").\n--\x3e\n<snippets>\n\n<snippet name="textVVUniformsVS">\n    <![CDATA[\n  #if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n    attribute vec4 a_vv;\n  #endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY || VV_ROTATION\n\n  #ifdef VV_COLOR\n    uniform float u_vvColorValues[8];\n    uniform vec4 u_vvColors[8];\n  #endif // VV_COLOR\n\n  #ifdef VV_SIZE_MIN_MAX_VALUE\n    uniform vec4 u_vvSizeMinMaxValue;\n  #endif // VV_SIZE_MIN_MAX_VALUE\n\n  #ifdef VV_SIZE_SCALE_STOPS\n    uniform float u_vvSizeScaleStopsValue;\n  #endif // VV_SIZE_SCALE_STOPS\n\n  #ifdef VV_SIZE_FIELD_STOPS\n    uniform float u_vvSizeFieldStopsValues[6];\n    uniform float u_vvSizeFieldStopsSizes[6];\n  #endif // VV_SIZE_FIELD_STOPS\n\n  #ifdef VV_SIZE_UNIT_VALUE\n    uniform float u_vvSizeUnitValueWorldToPixelsRatio;\n  #endif // VV_SIZE_UNIT_VALUE\n\n  #ifdef VV_OPACITY\n    uniform float u_vvOpacityValues[8];\n    uniform float u_vvOpacities[8];\n  #endif // VV_OPACITY\n\n  #ifdef VV_ROTATION\n    uniform lowp float u_vvRotationType;\n  #endif // VV_ROTATION\n    ]]>\n  </snippet>\n\n  <snippet name="textVVFunctions">\n    <![CDATA[\n    bool isNan(float val) {\n      return !( val < 0.0 || 0.0 < val || val == 0.0 );\n    }\n\n  #ifdef VV_SIZE_MIN_MAX_VALUE\n    float getVVMinMaxSize(float sizeValue, float fallback) {\n      if (isNan(sizeValue)) {\n        return fallback;\n      }\n\n      // we need to multiply by 8 in order to translate to tile coordinates\n      float interpolationRatio = (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n      return clamp(u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z), u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w);\n    }\n  #endif // VV_SIZE_MIN_MAX_VALUE\n\n  #ifdef VV_SIZE_FIELD_STOPS\n    const int VV_SIZE_N = 6;\n    float getVVStopsSize(float sizeValue, float fallback) {\n      if (isNan(sizeValue)) {\n        return fallback;\n      }\n\n      if (sizeValue <= u_vvSizeFieldStopsValues[0]) {\n        return u_vvSizeFieldStopsSizes[0];\n      }\n\n      for (int i = 1; i < VV_SIZE_N; ++i) {\n        if (u_vvSizeFieldStopsValues[i] >= sizeValue) {\n          float f = (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n          return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n        }\n      }\n\n      return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n    }\n  #endif // VV_SIZE_FIELD_STOPS\n\n  #ifdef VV_SIZE_UNIT_VALUE\n    float getVVUnitValue(float sizeValue, float fallback) {\n      if (isNan(sizeValue)) {\n        return fallback;\n      }\n\n      return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n    }\n  #endif // VV_SIZE_UNIT_VALUE\n\n  #ifdef VV_OPACITY\n    const int VV_OPACITY_N = 8;\n    float getVVOpacity(float opacityValue) {\n      if (isNan(opacityValue)) {\n        return 1.0;\n      }\n\n      if (opacityValue <= u_vvOpacityValues[0]) {\n        return u_vvOpacities[0];\n      }\n\n      for (int i = 1; i < VV_OPACITY_N; ++i) {\n        if (u_vvOpacityValues[i] >= opacityValue) {\n          float f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n          return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n        }\n      }\n\n      return u_vvOpacities[VV_OPACITY_N - 1];\n    }\n  #endif // VV_OPACITY\n\n  #ifdef VV_ROTATION\n    mat4 getVVRotation(float rotationValue) {\n      // YF TODO: if the symbol has rotation we need to combine the symbo\'s rotation with the VV one\n      if (isNan(rotationValue)) {\n        return mat4(1, 0, 0, 0,\n                    0, 1, 0, 0,\n                    0, 0, 1, 0,\n                    0, 0, 0, 1);\n      }\n\n      float rotation = rotationValue;\n      if (u_vvRotationType == 1.0) {\n        rotation = 90.0 - rotation;\n      }\n\n      float angle = C_DEG_TO_RAD * rotation;\n\n      float sinA = sin(angle);\n      float cosA = cos(angle);\n\n      return mat4(cosA, sinA, 0, 0,\n                  -sinA,  cosA, 0, 0,\n                  0,     0, 1, 0,\n                  0,     0, 0, 1);\n    }\n  #endif // VV_ROTATION\n\n  #ifdef VV_COLOR\n    const int VV_COLOR_N = 8;\n\n    vec4 getVVColor(float colorValue, vec4 fallback) {\n      if (isNan(colorValue)) {\n        return fallback;\n      }\n\n      if (colorValue <= u_vvColorValues[0]) {\n        return u_vvColors[0];\n      }\n\n      for (int i = 1; i < VV_COLOR_N; ++i) {\n        if (u_vvColorValues[i] >= colorValue) {\n          float f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n          return mix(u_vvColors[i-1], u_vvColors[i], f);\n        }\n      }\n\n      return u_vvColors[VV_COLOR_N - 1];\n    }\n  #endif // VV_COLOR\n    ]]>\n  </snippet>\n\n  <snippet name="textVS">\n    <![CDATA[\n      precision mediump float;\n\n      const float C_DEG_TO_RAD = 3.14159265359 / 180.0;\n\n      attribute vec2 a_pos;           // 2 * 2 (2 x signed 16)\n      attribute vec4 a_id;            // 4 (4 x unsigned byte)\n      attribute vec4 a_color;         // 4 (4 x unsigned byte)\n      attribute vec2 a_vertexOffset; // 2 * 2 // (2 x signed 16) offset from the anchor point of the string\n      attribute vec4 a_texFontSize; // 4 (4 x unsigned byte) texture coordinatesm and font size\n\n      attribute lowp float  a_visible; // a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\n\n      // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n      // relative to the tile\'s upper left corner\n      // the extrusion vector.\n      uniform highp mat4 u_transformMatrix;\n      // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\n      uniform highp mat4 u_extrudeMatrix;\n      // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\n      uniform highp vec2 u_normalized_origin;\n      // the size of the mosaic given in pixels\n      uniform vec2 u_mosaicSize;\n      uniform float u_pixelRatio;\n\n      // the opacity of the layer\n      uniform mediump float u_opacity;\n\n      varying mediump vec4 v_color;\n      varying mediump float v_antialiasingWidth;\n      varying mediump float v_edgeDistanceOffset;\n\n      // the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\n      varying mediump vec2 v_tex;\n      // the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n      // opacity of the layer given by the painter\n      varying lowp float v_transparency;\n\n      // the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\n      // by 16 and then at the shader devide by the same number\n      const float offsetPrecision = 1.0 / 8.0;\n      const float outlineScale = 1.0 / 10.0;\n      const float sdfFontSize = 24.0;\n\n      // maximum SDF distance of 8 pixels represent the distance values that range from -2 inside the geometry to 6 on the outside.\n      // 6 is actually the maximum distance outside the glyph, therefore it is the limitation of the halo which is 1/4 of the geometry size.\n      const float maxSdfDistance = 8.0;\n\n  #ifdef ID\n    varying highp vec4 v_id;\n  #endif // ID\n\n      // import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\n      $textVVUniformsVS\n      $textVVFunctions\n\n      void main()\n      {\n        // make sure to clip the vertices in case that given record is marked as invisible\n        float z = 2.0 * (1.0 - a_visible);\n\n        // we use the list significant bit of the position in order to store the indication whethe the vertex is of a halow of a glyph\n        mediump float halo = mod(a_pos, 2.0).x;\n\n  #if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n  #ifdef VV_SIZE_MIN_MAX_VALUE\n        // vv size override the original symbol\'s size\n        vec2 size = vec2(getVVMinMaxSize(a_vv.x, a_texFontSize.z));\n  #endif // VV_SIZE_MIN_MAX_VALUE\n\n  #ifdef VV_SIZE_SCALE_STOPS\n        vec2 size = vec2(u_vvSizeScaleStopsValue);\n  #endif // VV_SIZE_SCALE_STOPS\n\n  #ifdef VV_SIZE_FIELD_STOPS\n        vec2 size = vec2(getVVStopsSize(a_vv.x, a_texFontSize.z));\n  #endif // VV_SIZE_FIELD_STOPS\n\n  #ifdef VV_SIZE_UNIT_VALUE\n        vec2 size = vec2(getVVUnitValue(a_vv.x, a_texFontSize.z));\n  #endif // VV_SIZE_UNIT_VALUE\n\n        float fontSize = size.x;\n  #else // this generic case, no VV\n        float fontSize = a_texFontSize.z;\n  #endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n        float fontScale = fontSize / sdfFontSize;\n        // we need to scale the extrude matrix by the font-scale in order to get the right text size\n        mat4 extrudeMatrix = fontScale * u_extrudeMatrix;\n\n        // If the label rotates with the map, and if the rotated label is upside down, hide it\n        //gl_Position = vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) + extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\n\n    #ifdef VV_ROTATION\n        gl_Position = vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) + extrudeMatrix * getVVRotation(a_vv.w) * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\n    #else\n        gl_Position = vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) + extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\n    #endif // VV_ROTATION\n\n        v_tex = a_texFontSize.xy / u_mosaicSize;\n        v_antialiasingWidth = 0.105 * sdfFontSize / fontSize / u_pixelRatio;\n        // if halo.x is zero (not a halo) v_edgeDistanceOffset will end up being zero as well.\n        v_edgeDistanceOffset = halo * outlineScale * a_texFontSize.w / fontScale / maxSdfDistance;\n\n    #ifdef VV_OPACITY\n        v_transparency = getVVOpacity(a_vv.z);\n    #else\n        v_transparency = u_opacity;\n    #endif // VV_OPACITY\n\n    #ifdef VV_COLOR\n       // we don\'t want to override the halo color\n       v_color = halo * a_color + (1.0 - halo) * getVVColor(a_vv.y, a_color);\n    #else\n        v_color = a_color;\n    #endif // VV_COLOR\n\n  #ifdef ID\n        v_id = a_id;\n  #endif // ID\n      }\n    ]]>\n  </snippet>\n\n  <snippet name="textFS">\n    <![CDATA[\n      precision lowp float;\n\n      uniform lowp sampler2D u_texture;\n\n      varying mediump vec4 v_color;\n      varying mediump float v_antialiasingWidth;\n      varying mediump float v_edgeDistanceOffset;\n      varying mediump vec2 v_tex;\n      varying lowp float v_transparency;\n\n  #ifdef ID\n      varying highp vec4 v_id;\n  #endif // ID\n\n      void main()\n      {\n        // read the distance from the SDF texture\n        lowp float dist = texture2D(u_texture, v_tex).a;\n\n        // the edge distance if a factor of the outline width\n        float glyphEdgeDistance = 0.75 - v_edgeDistanceOffset;\n\n        // use a smooth-step in order to calculate the geometry of the shape given by the distance field\n        lowp float alpha = smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_transparency;\n\n        gl_FragColor = alpha * v_color;\n\n  #ifdef ID\n        if (gl_FragColor.a < 1.0 / 255.0) {\n          discard;\n        }\n        gl_FragColor = v_id;\n  #endif // ID\n      }\n    ]]>\n  </snippet>\n</snippets>\n'},1868:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(5),i(1492)],void 0===(n=function(e,t,i,r){return function(){function e(e,t,i){var n;"string"==typeof e?n=e:(n=e.programNamePrefix,t=e.shaderSnippetPrefixes,i=e.baseDefines),r.assert(t,"you must specify shader snippet prefixes"),r.assert(2===t.length,"you must specify shader snippet prefixes for vertex and fragment shaders"),i&&0!==i.length||(i=[]),this.programNamePrefix=n,this.shaderSnippetPrefixes=t,this.baseDefines=i,this.variables=[],this.sealed=!1}return e.prototype.addDefine=function(e,t,i,n){r.assert(!this.sealed,"you cannot add another variable after the first program has been generated"),r.assert(e,"you must specify a program name suffix"),this.variables.push({programNameSuffixes:["",e],shaderNameSuffixes:n||e,defineStr:t,affectsShaderTypes:i||[!0,!0]})},e.prototype.addBinaryShaderSnippetSuffix=function(e,t,i){r.assert(!this.sealed,"you cannot add another variable after the first program has been generated"),r.assert(e,"you must specify a program name suffix"),this.variables.push({programNameSuffixes:["",e],shaderSnippetSuffixes:["",t],affectsShaderTypes:i||[!0,!0]})},e.prototype.addNaryShaderSnippetSuffix=function(e,t){r.assert(!this.sealed,"you cannot add another variable after the first program has been generated");var i=e.map(function(e){return r.assert(null!=e.value,"value must always be specified"),e.value});this.variables.push({values:i,programNameSuffixes:e.map(function(e,t){return null!=e.programNameSuffix?e.programNameSuffix:i[t]}),shaderSnippetSuffixes:e.map(function(e,t){return null!=e.shaderSnippetSuffix?e.shaderSnippetSuffix:i[t]}),affectsShaderTypes:t||[!0,!0]})},e.prototype.getShaderVariation=function(e){r.assert(e.length===this.variables.length,"you must specify a value for each variable");for(var t=this.programNamePrefix,n=i.clone(this.shaderSnippetPrefixes),o=i.clone(this.shaderSnippetPrefixes),a=i.clone(this.baseDefines),s=0;s<this.variables.length;s++){var l=this.variables[s],u=e[s],h=void 0;l.values?(h=l.values.indexOf(u),r.assert(h>=0,"invalid value "+u+" for variable "+s)):h=u?1:0,t+=l.programNameSuffixes[h];for(var d=0;d<2;d++)l.affectsShaderTypes[d]&&(l.shaderSnippetSuffixes&&(n[d]+=l.shaderSnippetSuffixes[h],o[d]+=l.shaderSnippetSuffixes[h]),l.defineStr&&h&&(a.push(l.defineStr),o[d]+=l.shaderNameSuffixes))}return{programName:t,shaderSnippetNames:n,shaderNames:o,defines:a}},e}()}.apply(null,r))||(e.exports=n)},1869:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(1693),i(1720),i(1692),i(1500),i(1496),i(1499)],void 0===(n=function(e,t,i,r,n,o,a,s,l){Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(){var t=e.call(this)||this;return t._color=r.create(),t._initialized=!1,t._color.set([1,0,0,1]),t}return i(t,e),t.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null),this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)},t.prototype.draw=function(e,t){var i=e.context;this._initialized||this._initialize(i),i.setStencilFunctionSeparate(1032,519,t.stencilRef,255),i.bindVAO(this._solidVertexArrayObject),i.bindProgram(this._solidProgram),this._solidProgram.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),this._solidProgram.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),this._solidProgram.setUniform1f("u_coord_range",512),this._solidProgram.setUniform1f("u_depth",0),this._solidProgram.setUniform4fv("u_color",this._color),i.drawArrays(5,0,4),i.bindVAO()},t.prototype._initialize=function(e){if(this._initialized)return!0;var t={a_pos:0},i=new s(e,o.backgroundVS,o.backgroundFS,t);if(!i)return!1;var r=new Int8Array([0,0,1,0,0,1,1,1]),n=a.createVertex(e,35044,r),u=new l(e,t,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:n});return this._solidProgram=i,this._solidVertexArrayObject=u,this._initialized=!0,!0},t}(n.default);t.default=u}.apply(null,r))||(e.exports=n)},1870:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(1511),i(1527),i(1679),i(1499)],void 0===(n=function(e,t,i,r,n,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isInitialized=!1,t._fillAttributeLocations={a_pos:0,a_id:1,a_color:2,a_tlbr:3,a_aux:4},t._fillAttributeLocationsVV={a_pos:0,a_id:1,a_color:2,a_tlbr:3,a_aux:4,a_vv:5},t._spritesTextureSize=new Float32Array(2),t}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return r.WGLGeometryType.FILL},t.prototype.drawGeometry=function(e,t,i,r){var n=e.context,o=e.painter,a=e.rendererInfo,s=e.requiredLevel,l=e.stationary,u=i.indexCount,h=i.indexFrom;this._initialize();var d=i.materialInfo.materialKeyInfo,c=d.hasVV()?this._fillAttributeLocationsVV:this._fillAttributeLocations,f=e.painter.materialManager.getProgram(i.materialInfo.materialKey,e.drawPhase,c);if(f){n.bindProgram(f);var p=this._getVAO(n,t,d.hasVV());if(n.bindVAO(p),i.materialInfo.texBindingInfo.length>0){var v=i.materialInfo.texBindingInfo[0],_=v.pageId,m=e.painter.textureManager.sprites;this._spritesTextureSize[0]=m.getWidth(_),this._spritesTextureSize[1]=m.getHeight(_);var g=1/Math.pow(2,s-t.key.level)/e.pixelRatio;f.setUniform1f("u_zoomFactor",g);var y=l?9728:9729;o.textureManager.bindSpritePage(n,_,v.unit,y),f.setUniform1i(v.semantic,v.unit),f.setUniform2fv("u_mosaicSize",this._spritesTextureSize)}f.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),f.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),f.setUniform1f("u_opacity",1),d.vvColor&&(f.setUniform1fv("u_vvColorValues",a.vvColorValues),f.setUniform4fv("u_vvColors",a.vvColors)),d.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),f.setUniform1fv("u_vvOpacities",a.vvOpacities)),n.drawElements(4,u,5125,4*h),n.bindVAO(null)}},t.prototype._initialize=function(){if(this._isInitialized)return!0;this._fillVertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:24,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:24,normalized:!0,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_aux",count:4,type:5121,offset:20,stride:24,normalized:!1,divisor:0}]},this._fillVertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:32,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:32,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:32,normalized:!0,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:12,stride:32,normalized:!1,divisor:0},{name:"a_aux",count:4,type:5121,offset:20,stride:32,normalized:!1,divisor:0},{name:"a_vv",count:2,type:5126,offset:24,stride:32,normalized:!1,divisor:0}]},this._isInitialized=!0},t.prototype._getVAO=function(e,t,i){if(t.fillGeometry.vao)return t.fillGeometry.vao;var r=t.fillGeometry.vertexBufferMap[n.C_VBO_GEOMETRY],o=t.fillGeometry.indexBuffer;return r&&o?(t.fillGeometry.vao=i?new a(e,this._fillAttributeLocationsVV,this._fillVertexAttributeLayoutVV,{geometry:r},o):new a(e,this._fillAttributeLocations,this._fillVertexAttributeLayout,{geometry:r},o),t.fillGeometry.vao):null},t}(o.default);t.default=s}.apply(null,r))||(e.exports=n)},1871:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(1511),i(1527),i(1679),i(1499)],void 0===(n=function(e,t,i,r,n,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._attributeLocations={a_pos:0,a_color:1,a_vertexOffset:2,a_texAndSize:3,a_refSymbolAndPlacementOffset:4,a_visible:5,a_visibilityRange:6},t._vertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:20,normalized:!0,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_texAndSize",count:4,type:5121,offset:12,stride:20,normalized:!1,divisor:0},{name:"a_refSymbolAndPlacementOffset",count:4,type:5120,offset:16,stride:20,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}],visibilityRange:[{name:"a_visibilityRange",count:2,type:5121,offset:0,stride:2,normalized:!1,divisor:0}]},t._glyphsTextureSize=new Float32Array(2),t}return i(t,e),t.prototype.dispose=function(){},t.prototype.drawGeometry=function(e,t,i,n){if(e.requiredLevel===t.key.level){var o=e.context,a=e.painter,s=e.drawPhase,l=i.materialInfo,u=i.indexCount,h=i.indexFrom,d=this._attributeLocations,c=e.drawPhase===r.WGLDrawPhase.LABEL_ALPHA,f=l.materialKey;c&&(f|=8);var p=a.materialManager.getProgram(f,s,d);if(p){o.setStencilTestEnabled(!1),o.bindProgram(p);var v=this._getVAO(o,t);if(o.bindVAO(v),c)o.setBlendingEnabled(!1),p.setUniform1f("u_fadeStep",e.labelStep);else{var _=l.texBindingInfo[0],m=_.pageId;a.textureManager.bindGlyphsPage(o,m,_.unit),p.setUniform1i(_.semantic,_.unit)}var g=a.textureManager.glyphs;this._glyphsTextureSize[0]=g.width/4,this._glyphsTextureSize[1]=g.height/4;var y=a.extrudeNoRotationMatrix;o.bindTexture(e.labelFBO.colorTexture,3),p.setUniform1i("u_referenceTex",3),p.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),p.setUniformMatrix4fv("u_extrudeMatrix",y),p.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),p.setUniform2fv("u_mosaicSize",this._glyphsTextureSize),p.setUniform1f("u_pixelRatio",e.pixelRatio),p.setUniform1f("u_opacity",1),p.setUniform1f("u_zoomLevel",10*e.displayLevel),p.setUniform1f("u_mapRotation",e.state.rotation),p.setUniform1f("u_mapAligned",0),p.setUniform2fv("u_screenSize",e.state.size),o.drawElements(4,u,5125,4*h),o.bindVAO(null),o.setStencilTestEnabled(!0),o.setBlendingEnabled(!0)}}},t.prototype.getGeometryType=function(){return r.WGLGeometryType.LABEL},t.prototype._getVAO=function(e,t){var i=t.labelGeometry;if(i&&i.vao)return i.vao;var r=i.vertexBufferMap[n.C_VBO_GEOMETRY],o=i.vertexBufferMap[n.C_VBO_VISIBILITY],s=i.vertexBufferMap[n.C_VBO_VISIBILITY_RANGE],l=i.indexBuffer;return r&&l&&s?(i.vao=new a(e,this._attributeLocations,this._vertexAttributeLayout,{geometry:r,visibility:o,visibilityRange:s},l),i.vao):null},t}(o.default);t.default=s}.apply(null,r))||(e.exports=n)},1872:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(1511),i(1527),i(1679),i(1499)],void 0===(n=function(e,t,i,r,n,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._lineAttributeLocations={a_pos:0,a_id:1,a_color:2,a_offsetAndNormal:3,a_accumulatedDistanceAndHalfWidth:4,a_tlbr:5,a_segmentDirection:6},t._lineAttributeLocationsVV={a_pos:0,a_id:1,a_color:2,a_offsetAndNormal:3,a_accumulatedDistanceAndHalfWidth:4,a_tlbr:5,a_segmentDirection:6,a_vv:7},t._lineVertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:32,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:32,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:32,normalized:!0,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:12,stride:32,normalized:!1,divisor:0},{name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123,offset:16,stride:32,normalized:!1,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:20,stride:32,normalized:!1,divisor:0},{name:"a_segmentDirection",count:4,type:5120,offset:28,stride:32,normalized:!1,divisor:0}]},t._lineVertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:44,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:44,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:44,normalized:!0,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:12,stride:44,normalized:!1,divisor:0},{name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123,offset:16,stride:44,normalized:!1,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:20,stride:44,normalized:!1,divisor:0},{name:"a_segmentDirection",count:4,type:5120,offset:28,stride:44,normalized:!1,divisor:0},{name:"a_vv",count:3,type:5126,offset:32,stride:44,normalized:!1,divisor:0}]},t._spritesTextureSize=new Float32Array(2),t}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return r.WGLGeometryType.LINE},t.prototype.drawGeometry=function(e,t,i,r){var n=e.context,o=e.painter,a=e.rendererInfo,s=e.requiredLevel,l=e.drawPhase,u=i.indexFrom,h=i.indexCount,d=i.materialInfo,c=d.materialKeyInfo,f=c.hasVV()?this._lineAttributeLocationsVV:this._lineAttributeLocations,p=o.materialManager.getProgram(d.materialKey,l,f);if(p){n.bindProgram(p);var v=this._getVAO(n,t,c.hasVV());n.bindVAO(v);var _=1/e.pixelRatio;if(d.texBindingInfo.length>0){var m=d.texBindingInfo[0],g=m.pageId,y=o.textureManager.sprites;this._spritesTextureSize[0]=y.getWidth(g),this._spritesTextureSize[1]=y.getHeight(g),o.textureManager.bindSpritePage(n,g,m.unit),p.setUniform1i(m.semantic,m.unit),p.setUniform2fv("u_mosaicSize",this._spritesTextureSize)}var x=Math.pow(2,s-t.key.level)/e.pixelRatio;p.setUniform1f("u_zoomFactor",x),p.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),p.setUniformMatrix4fv("u_extrudeMatrix",o.extrudeMatrix),p.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),p.setUniform1f("u_opacity",1),p.setUniform1f("u_blur",0+_),p.setUniform1f("u_antialiasing",_),p.setUniform1f("u_zoomFactor",x),c.vvSizeMinMaxValue&&p.setUniform4fv("u_vvSizeMinMaxValue",a.vvSizeMinMaxValue),c.vvSizeScaleStops&&p.setUniform1f("u_vvSizeScaleStopsValue",a.vvSizeScaleStopsValue),c.vvSizeFieldStops&&(p.setUniform1fv("u_vvSizeFieldStopsValues",a.vvSizeFieldStopsValues),p.setUniform1fv("u_vvSizeFieldStopsSizes",a.vvSizeFieldStopsSizes)),c.vvSizeUnitValue&&p.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",a.vvSizeUnitValueToPixelsRatio),c.vvColor&&(p.setUniform1fv("u_vvColorValues",a.vvColorValues),p.setUniform4fv("u_vvColors",a.vvColors)),c.vvOpacity&&(p.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),p.setUniform1fv("u_vvOpacities",a.vvOpacities)),n.setFaceCullingEnabled(!0),n.setFrontFace(2305),n.setCullFace(1029),n.drawElements(4,h,5125,4*u),n.setFaceCullingEnabled(!1),n.bindVAO(null)}},t.prototype._getVAO=function(e,t,i){if(t.lineGeometry.vao)return t.lineGeometry.vao;var r=t.lineGeometry.vertexBufferMap[n.C_VBO_GEOMETRY],o=t.lineGeometry.indexBuffer;return r&&o?(t.lineGeometry.vao=i?new a(e,this._lineAttributeLocationsVV,this._lineVertexAttributeLayoutVV,{geometry:r},o):new a(e,this._lineAttributeLocations,this._lineVertexAttributeLayout,{geometry:r},o),t.lineGeometry.vao):null},t}(o.default);t.default=s}.apply(null,r))||(e.exports=n)},1873:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(1511),i(1527),i(1679),i(1493),i(1499)],void 0===(n=function(e,t,i,r,n,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._iconAttributeLocations={a_pos:0,a_vertexOffsetAndTex:1,a_id:2,a_color:3,a_outlineColor:4,a_sizeAndOutlineWidth:5},t._iconAttributeLocationsVV={a_pos:0,a_vertexOffsetAndTex:1,a_id:2,a_color:3,a_outlineColor:4,a_sizeAndOutlineWidth:5,a_vv:6},t._iconAttributeLocationsHeatmap={a_pos:0,a_vertexOffsetAndTex:1,a_id:2,a_color:3,a_outlineColor:4,a_sizeAndOutlineWidth:5,a_weight:6},t._iconVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffsetAndTex",count:4,type:5120,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:8,stride:24,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:24,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:20,stride:24,normalized:!1,divisor:0}]},t._iconVertexAttributesWithVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:40,normalized:!1,divisor:0},{name:"a_vertexOffsetAndTex",count:4,type:5120,offset:4,stride:40,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:8,stride:40,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:40,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:16,stride:40,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:20,stride:40,normalized:!1,divisor:0},{name:"a_vv",count:4,type:5126,offset:24,stride:40,normalized:!1,divisor:0}]},t._iconVertexAttributesWithHeatmap={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:28,normalized:!1,divisor:0},{name:"a_vertexOffsetAndTex",count:4,type:5120,offset:4,stride:28,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:8,stride:28,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:28,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:16,stride:28,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:20,stride:28,normalized:!1,divisor:0},{name:"a_weight",count:1,type:5126,offset:24,stride:28,normalized:!1,divisor:0}]},t._spritesTextureSize=new Float32Array(2),t}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return r.WGLGeometryType.MARKER},t.prototype.drawGeometry=function(e,t,i,r){var n=e.context,o=e.painter,a=e.rendererInfo,s=e.drawPhase,l=i.indexCount,u=i.indexFrom,h=i.materialInfo,d=h.materialKeyInfo,c=d.heatmap,f=d.hasVV()?this._iconAttributeLocationsVV:this._iconAttributeLocations,p=o.materialManager.getProgram(h.materialKey,s,f);if(p){n.bindProgram(p);var v=this._getVAO(n,t,d.hasVV(),c);if(n.bindVAO(v),c){var _=this._getIntensityTexture(n,a.heatmapParameters);n.bindTexture(_,1),p.setUniform1i("u_texture",1),this._spritesTextureSize[0]=Math.round(a.heatmapParameters.radius),this._spritesTextureSize[1]=Math.round(a.heatmapParameters.radius)}else{var m=h.texBindingInfo[0],g=m.pageId;o.textureManager.bindSpritePage(n,g,m.unit),p.setUniform1i(m.semantic,m.unit);var y=o.textureManager.sprites;this._spritesTextureSize[0]=y.getWidth(g)/4,this._spritesTextureSize[1]=y.getHeight(g)/4}var x=a.vvMaterialParameters.vvRotationEnabled&&"geographic"===a.vvMaterialParameters.vvRotationType?o.extrudeMatrix:o.extrudeNoRotationMatrix;p.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),p.setUniformMatrix4fv("u_extrudeMatrix",x),p.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),p.setUniform2fv("u_mosaicSize",this._spritesTextureSize),p.setUniform1f("u_opacity",1),d.vvSizeMinMaxValue&&p.setUniform4fv("u_vvSizeMinMaxValue",a.vvSizeMinMaxValue),d.vvSizeScaleStops&&p.setUniform1f("u_vvSizeScaleStopsValue",a.vvSizeScaleStopsValue),d.vvSizeFieldStops&&(p.setUniform1fv("u_vvSizeFieldStopsValues",a.vvSizeFieldStopsValues),p.setUniform1fv("u_vvSizeFieldStopsSizes",a.vvSizeFieldStopsSizes)),d.vvSizeUnitValue&&p.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",a.vvSizeUnitValueToPixelsRatio),d.vvColor&&(p.setUniform1fv("u_vvColorValues",a.vvColorValues),p.setUniform4fv("u_vvColors",a.vvColors)),d.vvOpacity&&(p.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),p.setUniform1fv("u_vvOpacities",a.vvOpacities)),d.vvRotation&&p.setUniform1f("u_vvRotationType","geographic"===a.vvMaterialParameters.vvRotationType?0:1),n.drawElements(4,l,5125,4*u),n.bindVAO(null)}},t.prototype._getVAO=function(e,t,i,r){if(t.iconGeometry.vao)return t.iconGeometry.vao;var o=t.iconGeometry.vertexBufferMap[n.C_VBO_GEOMETRY],a=t.iconGeometry.indexBuffer;return o&&a?(t.iconGeometry.vao=i?new s(e,this._iconAttributeLocationsVV,this._iconVertexAttributesWithVV,{geometry:o},a):r?new s(e,this._iconAttributeLocationsHeatmap,this._iconVertexAttributesWithHeatmap,{geometry:o},a):new s(e,this._iconAttributeLocations,this._iconVertexAttributes,{geometry:o},a),t.iconGeometry.vao):null},t.prototype._getIntensityTexture=function(e,t){if(t.intensityKernel&&!t.refreshIntensityKernel)return t.intensityKernel;t.intensityKernel&&(t.intensityKernel.dispose(),t.intensityKernel=null);for(var i=t.radius,r=t.kernelSize,n=t.blurRadius,o=i*i,s=[],l=-1;++l<r;)s[l]=Math.exp(-Math.pow(l-n,2)/(2*o))/(Math.sqrt(2*Math.PI)*(i/2));for(var u,h,d,c=[],f=0;f<r;f++)for(h=s[f],l=0;l<r;l++)d=f*r+l,u=s[l],c[4*d+0]=h*u,c[4*d+1]=0,c[4*d+2]=0,c[4*d+3]=1;var p=new a(e,{target:3553,pixelFormat:6408,internalFormat:e.capabilities.colorBufferFloat.RGBA32F,dataType:5126,samplingMode:e.capabilities.textureFloatLinear?9729:9728,wrapMode:33071,width:r,height:r},new Float32Array(c));return t.intensityKernel=p,t.refreshIntensityKernel=!1,p},t}(o.default);t.default=l}.apply(null,r))||(e.exports=n)},1874:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(1511),i(1527),i(1679),i(1499)],void 0===(n=function(e,t,i,r,n,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._attributeLocations={a_pos:0,a_id:1,a_color:2,a_vertexOffset:3,a_texFontSize:4,a_visible:5},t._attributeLocationsVV={a_pos:0,a_id:1,a_color:2,a_vertexOffset:3,a_texFontSize:4,a_vv:5,a_visible:6},t._vertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:20,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:20,normalized:!0,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:12,stride:20,normalized:!1,divisor:0},{name:"a_texFontSize",count:4,type:5120,offset:16,stride:20,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._vertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:36,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:36,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:36,normalized:!0,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:12,stride:36,normalized:!1,divisor:0},{name:"a_texFontSize",count:4,type:5120,offset:16,stride:36,normalized:!1,divisor:0},{name:"a_vv",count:4,type:5126,offset:20,stride:36,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]},t._glyphsTextureSize=new Float32Array(2),t}return i(t,e),t.prototype.dispose=function(){},t.prototype.getGeometryType=function(){return r.WGLGeometryType.TEXT},t.prototype.drawGeometry=function(e,t,i,r){var n=e.context,o=e.painter,a=e.rendererInfo,s=e.drawPhase,l=i.materialInfo,u=i.indexCount,h=i.indexFrom,d=l.materialKeyInfo,c=d.vvSizeMinMaxValue||d.vvSizeScaleStops||d.vvSizeFieldStops||d.vvSizeUnitValue||d.vvColor||d.vvRotation||d.vvOpacity,f=c?this._attributeLocationsVV:this._attributeLocations,p=o.materialManager.getProgram(l.materialKey,s,f);if(p){n.bindProgram(p);var v=this._getVAO(n,t,c,this.getGeometryType());n.bindVAO(v);var _=l.texBindingInfo[0],m=_.pageId;o.textureManager.bindGlyphsPage(n,m,_.unit),p.setUniform1i(_.semantic,_.unit);var g=o.textureManager.glyphs;this._glyphsTextureSize[0]=g.width/4,this._glyphsTextureSize[1]=g.height/4;var y=a.vvMaterialParameters.vvRotationEnabled&&"geographic"===a.vvMaterialParameters.vvRotationType?o.extrudeMatrix:o.extrudeNoRotationMatrix;p.setUniformMatrix4fv("u_transformMatrix",t.tileTransform.transform),p.setUniformMatrix4fv("u_extrudeMatrix",y),p.setUniform2fv("u_normalized_origin",t.tileTransform.displayCoord),p.setUniform2fv("u_mosaicSize",this._glyphsTextureSize),p.setUniform1f("u_pixelRatio",1),p.setUniform1f("u_opacity",1),d.vvSizeMinMaxValue&&p.setUniform4fv("u_vvSizeMinMaxValue",a.vvSizeMinMaxValue),d.vvSizeScaleStops&&p.setUniform1f("u_vvSizeScaleStopsValue",a.vvSizeScaleStopsValue),d.vvSizeFieldStops&&(p.setUniform1fv("u_vvSizeFieldStopsValues",a.vvSizeFieldStopsValues),p.setUniform1fv("u_vvSizeFieldStopsSizes",a.vvSizeFieldStopsSizes)),d.vvSizeUnitValue&&p.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",a.vvSizeUnitValueToPixelsRatio),d.vvColor&&(p.setUniform1fv("u_vvColorValues",a.vvColorValues),p.setUniform4fv("u_vvColors",a.vvColors)),d.vvOpacity&&(p.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),p.setUniform1fv("u_vvOpacities",a.vvOpacities)),d.vvRotation&&p.setUniform1f("u_vvRotationType","geographic"===a.vvMaterialParameters.vvRotationType?0:1),n.drawElements(4,u,5125,4*h),n.bindVAO(null)}},t.prototype._getVAO=function(e,t,i,r){var o=t.getGeometry(r);if(o&&o.vao)return o.vao;var s=o.vertexBufferMap[n.C_VBO_GEOMETRY],l=o.vertexBufferMap[n.C_VBO_VISIBILITY],u=o.indexBuffer;return s&&u?(o.vao=i?new a(e,this._attributeLocationsVV,this._vertexAttributeLayoutVV,{geometry:s,visibility:l},u):new a(e,this._attributeLocations,this._vertexAttributeLayout,{geometry:s,visibility:l},u),o.vao):null},t}(o.default);t.default=s}.apply(null,r))||(e.exports=n)},1875:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(11),i(1876),i(1879)],void 0===(n=function(e,t,i,r,n){return function(){function e(){this._hlRenderer=new r,this._hlSurfaces=new n,this._width=void 0,this._height=void 0}return e.prototype.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose(),this._hlRenderer&&this._hlRenderer.dispose(),this._boundFBO=null},e.prototype.setup=function(e,t,i){var r=t%4,n=i%4;t+=r<2?-r:4-r,i+=n<2?-n:4-n,this._width=t,this._height=i,this._boundFBO=e.getBoundFramebufferObject();var o=Math.round(.75*t),a=Math.round(.75*i);this._hlRenderer.setup(e,o,a),this._hlSurfaces.setup(e,o,a)},e.prototype.setHighlightOptions=function(e){this._hlRenderer.setHighlightOptions({fillColor:e.fillColor,outlineColor:e.outlineColor,outlineWidth:.75*e.outlineWidth,outerHaloWidth:.75*e.outerHaloWidth,innerHaloWidth:.75*e.innerHaloWidth,outlinePosition:.75*e.outlinePosition})},e.prototype.startMaskDraw=function(e){e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),e.setClearColor(0,0,0,0),e.setClearStencil(0),e.clear(e.gl.COLOR_BUFFER_BIT|e.gl.STENCIL_BUFFER_BIT),e.setViewport(0,0,.75*this._width,.75*this._height)},e.prototype.draw=function(e){e.setStencilTestEnabled(!1),e.setBlendingEnabled(!1),e.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo),e.setClearColor(0,0,0,0),e.clear(e.gl.COLOR_BUFFER_BIT),this._hlRenderer.preBlur(e,this._hlSurfaces.sharedBlur1Tex),i("esri-feature-highlight-debug")?(e.bindFramebuffer(null),e.clear(e.gl.COLOR_BUFFER_BIT),this._hlRenderer.finalBlur(e,this._hlSurfaces.sharedBlur2Tex)):(e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),e.setClearColor(0,0,0,0),e.clear(e.gl.COLOR_BUFFER_BIT),this._hlRenderer.finalBlur(e,this._hlSurfaces.sharedBlur2Tex),e.bindFramebuffer(this._boundFBO),e.setBlendingEnabled(!0),e.setViewport(0,0,this._width,this._height),this._hlRenderer.renderHighlight(e,this._hlSurfaces.sharedBlur1Tex),this._boundFBO=null)},e}()}.apply(null,r))||(e.exports=n)},1876:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1877),i(1500),i(1678),i(1493),i(1499)],void 0===(n=function(e,t,i,r,n,o,a){var s=[void 0,void 0,void 0,1],l=[3,4],u=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return function(){function e(){this._width=void 0,this._height=void 0,this._highlightOptions={fillColor:[.2,.6,.9,.75],outlineColor:[.2,.6,.9,.9],outlinePosition:0,outlineWidth:3.4,innerHaloWidth:2,outerHaloWidth:3.3},this._resources=null}return e.prototype.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources.shadeTex.dispose(),this._resources=null)},e.prototype.preBlur=function(e,t){e.bindTexture(t,l[0]),e.bindProgram(this._resources.blurProgram),this._resources.blurProgram.setUniform4fv("u_direction",[1,0,1/this._width,0]),this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",u),e.bindVAO(this._resources.quadVAO),e.drawArrays(5,0,4),e.bindVAO()},e.prototype.finalBlur=function(e,t){e.bindTexture(t,l[0]),e.bindProgram(this._resources.blurProgram),this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]),this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",h),e.bindVAO(this._resources.quadVAO),e.drawArrays(5,0,4),e.bindVAO()},e.prototype.renderHighlight=function(e,t){e.bindTexture(t,l[0]),e.bindTexture(this._resources.shadeTex,l[1]),e.bindProgram(this._resources.highlightProgram),e.bindVAO(this._resources.quadVAO),e.drawArrays(5,0,4),e.bindVAO()},e.prototype._initialize=function(e,t,u){this._width=t,this._height=u;var h=new r(e,34962,35044,new Int8Array([-128,-128,0,0,127,-128,255,0,-128,127,0,255,127,127,255,255]).buffer),d=new a(e,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",count:2,type:5120,offset:0,stride:4,normalized:!0},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!0}]},{geometry:h}),c=new n("hl",["texturedVS","highlightFS"],[],i,e,{a_position:0,a_texcoord:1}).getProgram([]),f=new n("hl",["texturedVS","blurFS"],[],i,e,{a_position:0,a_texcoord:1}).getProgram([]);c.setUniform1i("u_texture",l[0]),c.setUniform1i("u_shade",l[1]),c.setUniform4fv("u_sigmas",s),f.setUniform1i("u_texture",l[0]),f.setUniform4fv("u_sigmas",s);var p=new o(e,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:256,height:1,samplingMode:9728});this._resources={quadGeometry:h,quadVAO:d,highlightProgram:c,blurProgram:f,shadeTex:p}},e.prototype.setHighlightOptions=function(e){function t(e,t,i){c[0]=(1-i)*e[0]+i*t[0],c[1]=(1-i)*e[1]+i*t[1],c[2]=(1-i)*e[2]+i*t[2],c[3]=(1-i)*e[3]+i*t[3]}if(this._highlightOptions=e,this._resources){var i=e.outlinePosition-e.outlineWidth/2-e.outerHaloWidth,r=e.outlinePosition-e.outlineWidth/2,n=e.outlinePosition+e.outlineWidth/2,o=e.outlinePosition+e.outlineWidth/2+e.innerHaloWidth,a=Math.sqrt(Math.PI/2)*s[3],l=Math.abs(i)>a?Math.round(10*(Math.abs(i)-a))/10:0,u=Math.abs(o)>a?Math.round(10*(Math.abs(o)-a))/10:0;l&&!u?console.warn("The outer rim of the highlight is "+l+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!l&&u?console.warn("The inner rim of the highlight is "+u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):l&&u&&console.warn("The highlight is "+Math.max(l,u)+"px away from the edge of the feature; consider reducing some width values.");for(var h,d=new Uint8Array(1024),c=[void 0,void 0,void 0,void 0],f=0;f<256;++f)(h=i+f/255*(o-i))<i?(d[4*f+0]=0,d[4*f+1]=0,d[4*f+2]=0,d[4*f+3]=0):h<r?t([0,0,0,0],e.outlineColor,(h-i)/(r-i)):h<n?(c[0]=e.outlineColor[0],c[1]=e.outlineColor[1],c[2]=e.outlineColor[2],c[3]=e.outlineColor[3]):h<o?t(e.outlineColor,e.fillColor,(h-n)/(o-n)):(d[4*f+0]=e.fillColor[0],d[4*f+1]=e.fillColor[1],d[4*f+2]=e.fillColor[2],d[4*f+3]=e.fillColor[3]),d[4*f+0]=255*c[0]*c[3],d[4*f+1]=255*c[1]*c[3],d[4*f+2]=255*c[2]*c[3],d[4*f+3]=255*c[3];this._resources.highlightProgram.setUniform2fv("u_minMaxDistance",[i,o]),this._resources.shadeTex.updateData(0,0,0,256,1,d)}},e.prototype.setup=function(e,t,i){this._resources?(this._width=t,this._height=i):(this._initialize(e,t,i),this.setHighlightOptions(this._highlightOptions))},e}()}.apply(null,r))||(e.exports=n)},1877:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1878),i(1637)],void 0===(n=function(e,t,i,r){var n=new r;return r.parse(i,n),n}.apply(null,r))||(e.exports=n)},1878:function(e,t){e.exports='<?xml version="1.0" encoding="UTF-8"?>\n\x3c!--\n  Highlight generation and rendering shaders.\n\n  These shader sources are loaded by hlShaderSnippets.ts which in turn\n  is used by HighlightRenderer to instantiate the programs needed for\n  generating and rendering the highlights.\n\n  These shaders are intended to be used with full screen quads.\n--\x3e\n<snippets>\n  \x3c!--\n    Vertex shader: texturedVS\n\n    Identity vertex shader that outputs an untransformed 2-D vertex\n    and passes its texture coordinates unchanged to the interpolator.\n  --\x3e\n  <snippet name="texturedVS">\n    <![CDATA[\n    // Vertex position.\n    attribute mediump vec2 a_position;\n\n    // Texture coordinates.\n    attribute mediump vec2 a_texcoord;\n\n    // Texture coordinates to be interpolated.\n    varying mediump vec2 v_texcoord;\n\n    void main(void) {\n      // Pass the position unchanged.\n      gl_Position = vec4(a_position, 0.0, 1.0);\n\n      // Pass the texture coordinates unchanged.\n      v_texcoord = a_texcoord;\n    }\n    ]]>\n  </snippet>\n\n  \x3c!--\n    Fragment shader: blurFS\n\n    A gaussian blur shader. It blurs the alpha channel of its input\n    according to 4 different sigma and stores the results into the\n    four channel of the target framebuffer.\n\n    It is intended to be called twice; the first time to perform an\n    horizontal blur, and a second time to perform a vertical blur.\n\n    This shader is used to turn the highlight mask into a highlight\n    map. The highlight map is an approximation of the signed distance\n    field of the mask.\n  --\x3e\n  <snippet name="blurFS">\n    <![CDATA[\n    // Interpolated texture coordinates.\n    varying mediump vec2 v_texcoord;\n\n    // Blur direction information. There are two possible\n    // configurations that the host code can use.\n    //  - [1, 0, 1/WIDTH, 0] Used when blurring horizontally. In this\n    //    case u_direction[0] = 1 is expressed in pixel and is fed to\n    //    the gauss function to produce the value of the gaussian weight\n    //    for that pixel, while u_direction[2] = 1/WIDTH is in texel units\n    //    and is used to sample the right texel from the texture map.\n    //  - [0, 1, 0, 1/HEIGHT] Used when blurring vertically. In this\n    //    case u_direction[1] = 1 is expressed in pixel and is fed to\n    //    the gauss function to produce the value of the gaussian weight\n    //    for that pixel, while u_direction[3] = 1/HEIGHT is in texel units\n    //    and is used to sample the right texel from the texture map.\n    uniform mediump vec4 u_direction;\n\n    // Source to destination channel selection matrix.\n    uniform mediump mat4 u_channelSelector;\n\n    // The highlight map is obtained by blurring the alpha channel of the highlight\n    // mask accroding to these 4 values of the gaussian\'s sigma parameter.\n    uniform mediump vec4 u_sigmas;\n\n    // This is the highlight mask if we have not blurred horizontally yet, otherwise\n    // it is the horizontally blurred highlight map and blurring it one more time\n    // vertically will complete the process.\n    uniform sampler2D u_texture;\n\n    // The gaussian kernel. Note that it lacks the normalization constant, because\n    // we want to store it unnormalized in the highlight map (i.e. having a peak\n    // value of 1). Note also that we are using the SIMD (single instruction, multiple\n    // data) capabilities of the GPU to compute four different gaussian kernels, one\n    // for each sigma.\n    mediump vec4 gauss(mediump vec2 dir) {\n      return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n    }\n\n    mediump vec4 selectChannel(mediump vec4 sample) {\n      return u_channelSelector * sample;\n    }\n\n    // Sample the input texture and accumulated its gaussian weighted value and the\n    // total weight.\n    void accumGauss(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n      // Computes the gaussian weights, one for each sigma.\n      // Note that u_direction.xy is [1, 0] when blurring horizontally and [0, 1] when blurring vertically.\n      mediump vec4 w = gauss(i * u_direction.xy);\n\n      // Accumumates the values.\n      // Note that u_direction.xy is [1/WIDTH, 0] when blurring horizontally and [0, 1/HEIGHT] when blurring vertically.\n      tot += selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n\n      // Accumulates the weights.\n      weight += w;\n    }\n\n    void main(void) {\n      // Initialize accumulated values and weights to zero.\n      mediump vec4 tot = vec4(0.0, 0.0, 0.0, 0.0);\n      mediump vec4 weight = vec4(0.0, 0.0, 0.0, 0.0);\n\n      // Accumulates enough samples. These will be taken\n      // horizontally or vertically depending on the value\n      // of u_direction.\n      accumGauss(-5.0, tot, weight);\n      accumGauss(-4.0, tot, weight);\n      accumGauss(-3.0, tot, weight);\n      accumGauss(-2.0, tot, weight);\n      accumGauss(-1.0, tot, weight);\n      accumGauss(0.0, tot, weight);\n      accumGauss(1.0, tot, weight);\n      accumGauss(2.0, tot, weight);\n      accumGauss(3.0, tot, weight);\n      accumGauss(4.0, tot, weight);\n      accumGauss(5.0, tot, weight);\n\n      // Compute blurred values.\n      mediump vec4 rgba = tot / weight;\n\n      // Return the values. Note that each channel will contain\n      // the result of a different blur operation, one for each\n      // of the four chosen sigma.\n      gl_FragColor = vec4(rgba);\n    }\n    ]]>\n  </snippet>\n\n  \x3c!--\n    Fragment shader: highlightFS\n\n    Takes as input the highlight map, estimated the signed distance field,\n    and shades the fragments according to their estimated distance from the\n    edge of the highlighted feature.\n\n    A shade texture is used to turn distance values into colors; the shade\n    texture is basically a color gradient and is recomputed on the host\n    every time that the user alters the highlight options.\n  --\x3e\n  <snippet name="highlightFS">\n    <![CDATA[\n    // Interpolated texture coordinates.\n    varying mediump vec2 v_texcoord;\n\n    // The highlight map. Each channel is a blurred\n    // version of the alpha channel of the highlight mask.\n    //  - Channel 0 (red) corresponds to a gaussian blur with sigma = u_sigmas[0];\n    //  - Channel 1 (green) corresponds to a gaussian blur with sigma = u_sigmas[1];\n    //  - Channel 2 (blue) corresponds to a gaussian blur with sigma = u_sigmas[2];\n    //  - Channel 3 (alpha) corresponds to a gaussian blur with sigma = u_sigmas[3];\n    // As of today, only channel 3 is used for distance estimation.\n    // But the availability of different amounts of blur leaves the\n    // door open to multi-scale approaches.\n    uniform sampler2D u_texture;\n\n    // The highlight map was obtained by blurring the alpha channel of the highlight\n    // mask accroding to these 4 values of the gaussian\'s sigma parameter.\n    uniform mediump vec4 u_sigmas;\n\n    // A 1-D texture used to shade the highlight.\n    uniform sampler2D u_shade;\n\n    // The 1-D shade texture is spreaded between u_minMaxDistance[0] and u_minMaxDistance[1].\n    uniform mediump vec2 u_minMaxDistance;\n\n    // Signed distance estimation.\n    mediump float estimateDistance() {\n      // Use the largest sigma and the corresponding distance value stored in the\n      // last channel of the highlight map.\n      mediump float sigma = u_sigmas[3];\n      mediump float y = texture2D(u_texture, v_texcoord)[3];\n\n      // Estimates the distance by linearization and local inversion around\n      // the inflection point. The inflection point is in x = 0.\n      const mediump float y0 = 0.5;                           // Value of the convolution at the inflection point.\n      mediump float m0 = 1.0 / (sqrt(2.0 * 3.1415) * sigma);  // Slope of the convolution at the inflection point.\n      mediump float d = (y - y0) / m0;                        // Inversion of a local linearization.\n\n      // Return the estimated distance.\n      return d;\n    }\n\n    // Shading based on estimated distance.\n    mediump vec4 shade(mediump float d) {\n      // Maps the sampled distance from the [A, D] range (see HighlightRenderer::setHighlightOptions) to [0, 1].\n      mediump float mappedDistance = (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n\n      // Force to [0, 1]; it should not be necessary because the shade texture uses the CLAMP address mode, so\n      // this should happen anyway internally to the sampler, but in practice it is needed to avoid weird\n      // banding artifacts.\n      // We don\'t really know if we need this or not.\n      mappedDistance = clamp(mappedDistance, 0.0, 1.0);\n\n      // Sample the 1-D shade texture on its center line (i.e. on t=0.5).\n      return texture2D(u_shade, vec2(mappedDistance, 0.5));\n    }\n\n    void main(void) {\n      // Estimate the distance.\n      mediump float d = estimateDistance();\n\n      // Shade the distance.\n      gl_FragColor = shade(d);\n    }\n    ]]>\n  </snippet>\n</snippets>\n'},1879:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1498),i(1493)],void 0===(n=function(e,t,i,r){function n(e,t,n){var o=new r(e,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:t,height:n,samplingMode:9729});return[o,i.createWithAttachments(e,o,{colorTarget:0,depthStencilTarget:2})]}return function(){function e(){this._width=void 0,this._height=void 0,this._resources=null}return e.prototype.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)},e.prototype._initialize=function(e,t,i){this._width=t,this._height=i;var r=n(e,t,i),o=r[0],a=r[1],s=n(e,t,i),l=s[0],u=s[1];this._resources={sharedBlur1Tex:o,sharedBlur1Fbo:a,sharedBlur2Tex:l,sharedBlur2Fbo:u}},e.prototype.setup=function(e,t,i){!this._resources||this._width===t&&this._height===i||this.dispose(),this._resources||this._initialize(e,t,i)},Object.defineProperty(e.prototype,"sharedBlur1Tex",{get:function(){return this._resources.sharedBlur1Tex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},enumerable:!0,configurable:!0}),e}()}.apply(null,r))||(e.exports=n)},1885:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(){this.vertexData=new Map,this.vertexCount=0,this.indexData=[]}return e.prototype.clear=function(){this.vertexData.clear(),this.vertexCount=0,this.indexData=[]},e.prototype.update=function(e,t,i){for(var r in e)this.vertexData.set(r,e[r]);for(var r in this.vertexData)null===e[r]&&this.vertexData.delete(r);this.vertexCount=t,this.indexData=i},e}()}.apply(null,r))||(e.exports=n)},1886:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1723)],void 0===(n=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,i,r,n){void 0===r&&(r=255),void 0===n&&(n=0),this.bounds=e,this.range=t,this.index=i,this.minZoom=r,this.maxZoom=n}return e.prototype.serialize=function(e){return this.bounds.serialize(e),e.writeInt32(this.range.from),e.writeInt32(this.range.count),e.writeInt32(this.index),e},e.deserialize=function(t){return new e(i.default.deserialize(t),{from:t.readInt32(),count:t.readInt32()},t.readInt32())},e}();t.default=r}.apply(null,r))||(e.exports=n)},1887:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1527),i(1735)],void 0===(n=function(e,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.data=e,this.stride=t,this.vertexCount=0}return e.prototype.transfer=function(e,t){var i=this.data.buffer();e.vertexCount=this.vertexCount,e.data=i,e.stride=this.stride,t.push(i)},e}();t.default=n;var o=function(){function e(e,t,o){this.geometryType=e,this.indexVector=new r.default(Uint32Array,o),this.namedVectors={};var a=i.getStrides(e,t);for(var s in a){var l=a[s],u=l/4,h=new r.default(Uint32Array,u*o);this.namedVectors[s]=new n(h,l)}}return e.prototype.get=function(e){return this.namedVectors[e].data},e.prototype.transfer=function(e,t){var i=this.indexVector.buffer(),r={};for(var n in t.push(i),this.namedVectors){var o=this.namedVectors[n];r[n]={},o.transfer(r[n],t)}e.geometryType=this.geometryType,e.indexBuffer=i,e.namedBuffers=r,this.destroy()},e.prototype.destroy=function(){this.indexVector=null,this.namedVectors=null},e}();t.VertexVectors=o}.apply(null,r))||(e.exports=n)},1888:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(9),i(1511),i(1889),i(1801),i(1802),i(1803),i(1804)],void 0===(n=function(e,t,i,r,n,o,a,s,l){Object.defineProperty(t,"__esModule",{value:!0});var u=i.getLogger("esri.views.2d.engine.webgl.mesh.templates.meshTemplateUtils");t.createMeshTemplates=function(e,t,i,h,d,c,f){if(void 0===f&&(f=!1),-1!==i.type.indexOf("3d"))return u.error("3D symbols are not supported with MapView"),e;var p=h.get(i.id);switch(p||u.error("Couldn't find texture resources for symbol: "+i.id+"!"),i.type){case r.EsriSymbolTypeKebab.SIMPLE_MARKER:return e.push(a.default.fromSimpleMarker(t,l.getMarkerVVFlags(d),i,p.spriteMosaicItem,c)),e;case r.EsriSymbolTypeKebab.PICTURE_MARKER:return e.push(a.default.fromPictureMarker(t,l.getMarkerVVFlags(d),i,p.spriteMosaicItem,c)),e;case r.EsriSymbolTypeKebab.SIMPLE_FILL:var v=i;if(e.push(n.default.fromSimpleFill(t,l.getFillVVFlags(d),v,p.spriteMosaicItem,c,f)),v.outline){var _=h.get(v.outline.id);e.push(o.default.fromSimpleLine(t,l.getLineVVFlags(d,!0),v.outline,_&&_.spriteMosaicItem,c))}return e;case r.EsriSymbolTypeKebab.PICTURE_FILL:var m=i;return e.push(n.default.fromPictureFill(t,l.getFillVVFlags(d),m,p.spriteMosaicItem,c,f)),m.outline&&(_=h.get(m.outline.id),e.push(o.default.fromSimpleLine(t,l.getLineVVFlags(d,!0),m.outline,_&&_.spriteMosaicItem,c))),e;case r.EsriSymbolTypeKebab.SIMPLE_LINE:return e.push(o.default.fromSimpleLine(t,l.getLineVVFlags(d,!1),i,p.spriteMosaicItem,c)),e;case r.EsriSymbolTypeKebab.TEXT:return e.push(s.default.fromText(t,l.getTextVVFlags(d),i,c,p.glyphMosaicItems)),e;default:return u.error("Unable to create mesh template for unknown symbol type: "+i.type),e}}}.apply(null,r))||(e.exports=n)},1889:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(11),i(9),i(484),i(1641),i(479),i(1511),i(1511),i(1644),i(1729),i(1649),i(1890),i(1681)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,h,d,c,f,p){Object.defineProperty(t,"__esModule",{value:!0});var v=n.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLFillTemplate"),_=[],m=[],g=function(e){function t(t,i,n,o,a,s,u,h){var c=e.call(this)||this;c.fillColor=o,c.tl=a,c.br=s,c.aux=u,c.isBFS=h,c.geometryType=l.WGLGeometryType.FILL,c.useLibtess=!1;var p=r("esri-featurelayer-webgl");return c.useLibtess="libtess"===((p||{}).tesselator||"libtess"),c.useLibtess&&(c._tesselator=new f.default),c.vvFlags=i,c._materialStore=t,c.materialId=c._materialStore.createSpriteMaterial(n,c.geometryType,i),c._tileClipper=new d.TileClipper(0,0,0,1,8),c._tileClipper.setExtent(512),c}return i(t,e),t.fromSimpleFill=function(e,i,r,n,o,s){void 0===s&&(s=!1);var l=r.color,u=l&&"none"!==r.style&&a.premultiplyAlphaRGBA(l)||0;if(!n)return new t(e,i,null,u,0,0,0,s);var d=n.rect,c=n.width,f=n.height,p=d.x+1,v=d.y+1,_=d.x+1+c,m=d.y+1+f;return new t(e,i,n,u,h.i1616to32(p,v),h.i1616to32(_,m),h.i8888to32(h.nextHighestPowerOfTwo(_-p),h.nextHighestPowerOfTwo(m-v),0,0),s)},t.fromPictureFill=function(e,i,r,n,o,a){void 0===a&&(a=!1);var l=s.PICTURE_FILL_COLOR,u=n.rect,d=n.width,c=n.height,f=u.x+1,p=u.y+1,v=u.x+1+d,_=u.y+1+c;return new t(e,i,n,l,h.i1616to32(f,p),h.i1616to32(v,_),h.i8888to32(h.nextHighestPowerOfTwo(r.width),h.nextHighestPowerOfTwo(r.height),0,0),a)},t.prototype.writeMesh=function(e,t,i,r,n,o,a){if(_.length=0,this.vvFlags&u.WGLVVFlag.COLOR||0!==this.fillColor){if("esriGeometryPolygon"!==i)return void v.error("Unable to handle geometryType: "+i);var s=n.geometry,l=this._isClippingRequired(s),h=l?this._clip(s,!this.useLibtess):s.rings;return this.useLibtess?this._writeMeshLibtess(e,t,i,r,h,l,o,a):this._writeMeshEarcut(e,t,i,r,h,l,o,a)}},t.prototype._isClippingRequired=function(e){for(var t=0,i=e.rings;t<i.length;t++){var r=i[t],n=r.length;if(!(n<3)){var o=r[0][0],a=r[0][1];if(o<-8||o>520||a<-8||a>520)return!0;for(var s=1;s<n;++s)if(o+=r[s][0],a+=r[s][1],o<-8||o>520||a<-8||a>520)return!0}}return!1},t.prototype._clip=function(e,t){var i,r;this._tileClipper.reset(3);for(var n=0,o=e.rings;n<o.length;n++){var a=o[n],s=a.length;if(!(s<3)){i=a[0][0],r=a[0][1],this._tileClipper.moveTo(i,r);for(var l=1;l<s;++l)i+=a[l][0],r+=a[l][1],this._tileClipper.lineTo(i,r);this._tileClipper.close()}}return this._tileClipper.result(t)},t.prototype._writeMeshLibtess=function(e,t,i,r,n,o,a,s){if(n&&n.length){var l=this._materialStore.get(this.materialId),u=[],h=t.indexVector,d=t.get("geometry"),f=new c(r,this.geometryType,this.materialId),p=this._getOffset(d,l),v=o;f.vertexFrom=p,f.indexFrom=h.length,e.push(f),this._tesselator.beginPolygon(_,u);for(var m=0,g=n;m<g.length;m++){var y=g[m];if(!(y.length<3)){this._tesselator.beginContour();var x=void 0,S=void 0;v?(x=y[0].x,S=y[0].y):(x=y[0][0],S=y[0][1]);var V=[x,S,0];this._tesselator.addVertex(V,V);for(var I=1;I<y.length-1;I++){v?(x=y[I].x,S=y[I].y):(x+=y[I][0],S+=y[I][1]);var b=[x,S,0];this._tesselator.addVertex(b,b)}this._tesselator.endContour()}}this._tesselator.endPolygon(),this._writeVerticesLibTess(f,d,r,_,l,s),this._writeIndicesLibTess(f,h,p,u)}},t.prototype._writeMeshEarcut=function(e,t,i,r,n,o,a,s){if(n&&n.length){var l=this._materialStore.get(this.materialId),u=t.indexVector,h=t.get("geometry"),d=new c(r,this.geometryType,this.materialId),f=this._getOffset(h,l);d.vertexFrom=f,d.indexFrom=u.length,e.push(d);for(var p=0,v=0,g=o,y=0,x=n;y<x.length;y++){var S=x[y],V=v,I=void 0,b=void 0;g?(I=S[0].x,b=S[0].y):(I=S[0][0],b=S[0][1]),_[v++]=I,_[v++]=b;for(var w=0,M=1;M<S.length;++M){var T=void 0,E=void 0;if(g){var L=I,D=b;T=(I=S[M].x)-L,E=(b=S[M].y)-D}else I+=T=S[M][0],b+=E=S[M][1];w-=T*(b+b+E),_[v++]=I,_[v++]=b}w>0?(V-p>0&&(this._write(d,u,h,f,r,_,m,p,V,l,s),p=V),m.length=0):w<0&&V-p>0?m.push(.5*(V-p)):v=V}v-p>0&&this._write(d,u,h,f,r,_,m,p,v,l,s),_.length=m.length=0}},t.prototype._write=function(e,t,i,r,n,a,s,l,u,h,d){var c=o(a.slice(l,u),s,2);if(c.length){var f=this._getOffset(i,h);this._writeVertices(e,i,n,a,s,h,d),this._writeIndices(e,t,f,c)}},t.prototype._getOffset=function(e,t){var i=t.materialKeyInfo.hasVV()?8:6;return e.length/i},t.prototype._writeVertices=function(e,t,i,r,n,o,a){for(var s=0;s<r.length;s+=2){var l=h.i1616to32(r[s],r[s+1]);t.push(l),t.push(i),t.push(this.fillColor),t.push(this.tl),t.push(this.br),t.push(this.aux),this._writeVV(t,a,o),e.vertexCount++}},t.prototype._writeIndices=function(e,t,i,r){for(var n=i,o=0;o<r.length;o+=3)t.push(n+r[o]),t.push(n+r[o+1]),t.push(n+r[o+2]),e.indexCount+=3},t.prototype._writeVerticesLibTess=function(e,t,i,r,n,o){for(var a=0;a<r.length;a+=2){var s=h.i1616to32(r[a],r[a+1]);t.push(s),t.push(i),t.push(this.fillColor),t.push(this.tl),t.push(this.br),t.push(this.aux),this._writeVV(t,o,n),e.vertexCount++}},t.prototype._writeIndicesLibTess=function(e,t,i,r){for(var n=i,o=0;o<r.length;o++)t.push(n+r[o]),e.indexCount++},t.prototype._writeVV=function(e,t,i){i.materialKeyInfo.hasVV()&&(this.isBFS?(e.push(4294967295),e.push(4294967295)):(e.push(t[l.VVType.COLOR]),e.push(t[l.VVType.OPACITY])))},t}(p.default);t.default=g}.apply(null,r))||(e.exports=n)},1890:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(9),i(1891)],void 0===(n=function(e,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var n=i.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator"),o=function(){function e(){this._currentVertexIndex=0,this._indexCounter=0,this._triangleIndices=[-1,-1,-1],this.glu=new r.GluTesselator,this.glu.gluTessCallback(r.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this)),this.glu.gluTessCallback(r.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this)),this.glu.gluTessCallback(r.gluEnum.GLU_TESS_END,this._endcallback.bind(this)),this.glu.gluTessCallback(r.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this)),this.glu.gluTessCallback(r.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this)),this.glu.gluTessCallback(r.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this)),this.glu.gluTessProperty(r.gluEnum.GLU_TESS_WINDING_RULE,r.windingRule.GLU_TESS_WINDING_ODD)}return e.prototype.beginPolygon=function(e,t){this._triangleIndices[0]=-1,this._triangleIndices[1]=-1,this._triangleIndices[2]=-1,this._currentVertexIndex=0,this._indexCounter=0,this.glu.gluTessBeginPolygon(e),this._indices=t},e.prototype.endPolygon=function(){this.glu.gluTessEndPolygon()},e.prototype.beginContour=function(){this.glu.gluTessBeginContour()},e.prototype.endContour=function(){this.glu.gluTessEndContour()},e.prototype.addVertex=function(e,t){this.glu.gluTessVertex(e,t)},e.prototype._vertexCallback=function(e,t){if(t[t.length]=e[0],t[t.length]=e[1],this._triangleIndices[this._currentVertexIndex]=-1,this._currentVertexIndex>=2){for(var i=0;i<3;i++)-1===this._triangleIndices[i]&&(this._triangleIndices[i]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[i];this._currentVertexIndex=0}else this._currentVertexIndex++},e.prototype._begincallback=function(e){this._triangleIndices[0]=-1,this._triangleIndices[1]=-1,this._triangleIndices[2]=-1,this._currentVertexIndex=0},e.prototype._endcallback=function(){this._currentVertexIndex=0},e.prototype._errorcallback=function(e){n.error("Encountered error during tesselation: "+e)},e.prototype._combinecallback=function(e,t,i){return[e[0],e[1],e[2]]},e.prototype._edgeCallback=function(e){},e}();t.default=o}.apply(null,r))||(e.exports=n)},1891:function(e,t,i){var r;
/**
   * @license
   * Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
   * Copyright 2015, Google Inc. All Rights Reserved.
   *
   * Permission is hereby granted, free of charge, to any person obtaining a copy
   * of this software and associated documentation files (the "Software"), to
   * deal in the Software without restriction, including without limitation the
   * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
   * sell copies of the Software, and to permit persons to whom the Software is
   * furnished to do so, subject to the following conditions:
   *
   * The above copyright notice including the dates of first publication and
   * either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
   * shall be included in all copies or substantial portions of the Software.
   *
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
   * SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
   * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
   * IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
   *
   * Original Code. The Original Code is: OpenGL Sample Implementation,
   * Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
   * Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
   * Copyright in any portions created by third parties is as indicated
   * elsewhere herein. All Rights Reserved.
   */void 0===(r=function(){"use strict";var e={DEBUG:!1,assert:function(t,i){if(e.DEBUG&&!t)throw new Error("Assertion failed"+(i?": "+i:""))},GLU_TESS_MAX_COORD:1e150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901}};return e.PQHandle,e.geom={},e.geom.vertEq=function(e,t){return e.s===t.s&&e.t===t.t},e.geom.vertLeq=function(e,t){return e.s<t.s||e.s===t.s&&e.t<=t.t},e.geom.edgeEval=function(t,i,r){e.assert(e.geom.vertLeq(t,i)&&e.geom.vertLeq(i,r));var n=i.s-t.s,o=r.s-i.s;return n+o>0?n<o?i.t-t.t+(t.t-r.t)*(n/(n+o)):i.t-r.t+(r.t-t.t)*(o/(n+o)):0},e.geom.edgeSign=function(t,i,r){e.assert(e.geom.vertLeq(t,i)&&e.geom.vertLeq(i,r));var n=i.s-t.s,o=r.s-i.s;return n+o>0?(i.t-r.t)*n+(i.t-t.t)*o:0},e.geom.transLeq=function(e,t){return e.t<t.t||e.t===t.t&&e.s<=t.s},e.geom.transEval=function(t,i,r){e.assert(e.geom.transLeq(t,i)&&e.geom.transLeq(i,r));var n=i.t-t.t,o=r.t-i.t;return n+o>0?n<o?i.s-t.s+(t.s-r.s)*(n/(n+o)):i.s-r.s+(r.s-t.s)*(o/(n+o)):0},e.geom.transSign=function(t,i,r){e.assert(e.geom.transLeq(t,i)&&e.geom.transLeq(i,r));var n=i.t-t.t,o=r.t-i.t;return n+o>0?(i.s-r.s)*n+(i.s-t.s)*o:0},e.geom.edgeGoesLeft=function(t){return e.geom.vertLeq(t.dst(),t.org)},e.geom.edgeGoesRight=function(t){return e.geom.vertLeq(t.org,t.dst())},e.geom.vertL1dist=function(e,t){return Math.abs(e.s-t.s)+Math.abs(e.t-t.t)},e.geom.vertCCW=function(e,t,i){return e.s*(t.t-i.t)+t.s*(i.t-e.t)+i.s*(e.t-t.t)>=0},e.geom.interpolate_=function(e,t,i,r){return(e=e<0?0:e)<=(i=i<0?0:i)?0===i?(t+r)/2:t+e/(e+i)*(r-t):r+i/(e+i)*(t-r)},e.geom.edgeIntersect=function(t,i,r,n,o){var a,s,l;e.geom.vertLeq(t,i)||(l=t,t=i,i=l),e.geom.vertLeq(r,n)||(l=r,r=n,n=l),e.geom.vertLeq(t,r)||(l=t,t=r,r=l,l=i,i=n,n=l),e.geom.vertLeq(r,i)?e.geom.vertLeq(i,n)?((a=e.geom.edgeEval(t,r,i))+(s=e.geom.edgeEval(r,i,n))<0&&(a=-a,s=-s),o.s=e.geom.interpolate_(a,r.s,s,i.s)):((a=e.geom.edgeSign(t,r,i))+(s=-e.geom.edgeSign(t,n,i))<0&&(a=-a,s=-s),o.s=e.geom.interpolate_(a,r.s,s,n.s)):o.s=(r.s+i.s)/2,e.geom.transLeq(t,i)||(l=t,t=i,i=l),e.geom.transLeq(r,n)||(l=r,r=n,n=l),e.geom.transLeq(t,r)||(l=t,t=r,r=l,l=i,i=n,n=l),e.geom.transLeq(r,i)?e.geom.transLeq(i,n)?((a=e.geom.transEval(t,r,i))+(s=e.geom.transEval(r,i,n))<0&&(a=-a,s=-s),o.t=e.geom.interpolate_(a,r.t,s,i.t)):((a=e.geom.transSign(t,r,i))+(s=-e.geom.transSign(t,n,i))<0&&(a=-a,s=-s),o.t=e.geom.interpolate_(a,r.t,s,n.t)):o.t=(r.t+i.t)/2},e.mesh={},e.mesh.makeEdge=function(t){var i=e.mesh.makeEdgePair_(t.eHead);return e.mesh.makeVertex_(i,t.vHead),e.mesh.makeVertex_(i.sym,t.vHead),e.mesh.makeFace_(i,t.fHead),i},e.mesh.meshSplice=function(t,i){var r=!1,n=!1;t!==i&&(i.org!==t.org&&(n=!0,e.mesh.killVertex_(i.org,t.org)),i.lFace!==t.lFace&&(r=!0,e.mesh.killFace_(i.lFace,t.lFace)),e.mesh.splice_(i,t),n||(e.mesh.makeVertex_(i,t.org),t.org.anEdge=t),r||(e.mesh.makeFace_(i,t.lFace),t.lFace.anEdge=t))},e.mesh.deleteEdge=function(t){var i=t.sym,r=!1;t.lFace!==t.rFace()&&(r=!0,e.mesh.killFace_(t.lFace,t.rFace())),t.oNext===t?e.mesh.killVertex_(t.org,null):(t.rFace().anEdge=t.oPrev(),t.org.anEdge=t.oNext,e.mesh.splice_(t,t.oPrev()),r||e.mesh.makeFace_(t,t.lFace)),i.oNext===i?(e.mesh.killVertex_(i.org,null),e.mesh.killFace_(i.lFace,null)):(t.lFace.anEdge=i.oPrev(),i.org.anEdge=i.oNext,e.mesh.splice_(i,i.oPrev())),e.mesh.killEdge_(t)},e.mesh.addEdgeVertex=function(t){var i=e.mesh.makeEdgePair_(t),r=i.sym;return e.mesh.splice_(i,t.lNext),i.org=t.dst(),e.mesh.makeVertex_(r,i.org),i.lFace=r.lFace=t.lFace,i},e.mesh.splitEdge=function(t){var i=e.mesh.addEdgeVertex(t).sym;return e.mesh.splice_(t.sym,t.sym.oPrev()),e.mesh.splice_(t.sym,i),t.sym.org=i.org,i.dst().anEdge=i.sym,i.sym.lFace=t.rFace(),i.winding=t.winding,i.sym.winding=t.sym.winding,i},e.mesh.connect=function(t,i){var r=!1,n=e.mesh.makeEdgePair_(t),o=n.sym;return i.lFace!==t.lFace&&(r=!0,e.mesh.killFace_(i.lFace,t.lFace)),e.mesh.splice_(n,t.lNext),e.mesh.splice_(o,i),n.org=t.dst(),o.org=i.org,n.lFace=o.lFace=t.lFace,t.lFace.anEdge=o,r||e.mesh.makeFace_(n,t.lFace),n},e.mesh.zapFace=function(t){var i,r=t.anEdge,n=r.lNext;do{if(n=(i=n).lNext,i.lFace=null,null===i.rFace()){i.oNext===i?e.mesh.killVertex_(i.org,null):(i.org.anEdge=i.oNext,e.mesh.splice_(i,i.oPrev()));var o=i.sym;o.oNext===o?e.mesh.killVertex_(o.org,null):(o.org.anEdge=o.oNext,e.mesh.splice_(o,o.oPrev())),e.mesh.killEdge_(i)}}while(i!==r);var a=t.prev,s=t.next;s.prev=a,a.next=s},e.mesh.meshUnion=function(e,t){var i=e.fHead,r=e.vHead,n=e.eHead,o=t.fHead,a=t.vHead,s=t.eHead;return o.next!==o&&(i.prev.next=o.next,o.next.prev=i.prev,o.prev.next=i,i.prev=o.prev),a.next!==a&&(r.prev.next=a.next,a.next.prev=r.prev,a.prev.next=r,r.prev=a.prev),s.next!==s&&(n.sym.next.sym.next=s.next,s.next.sym.next=n.sym.next,s.sym.next.sym.next=n,n.sym.next=s.sym.next),e},e.mesh.deleteMesh=function(e){},e.mesh.makeEdgePair_=function(t){var i=new e.GluHalfEdge,r=new e.GluHalfEdge,n=t.sym.next;return r.next=n,n.sym.next=i,i.next=t,t.sym.next=r,i.sym=r,i.oNext=i,i.lNext=r,r.sym=i,r.oNext=r,r.lNext=i,i},e.mesh.splice_=function(e,t){var i=e.oNext,r=t.oNext;i.sym.lNext=t,r.sym.lNext=e,e.oNext=r,t.oNext=i},e.mesh.makeVertex_=function(t,i){var r=i.prev,n=new e.GluVertex(i,r);r.next=n,i.prev=n,n.anEdge=t;var o=t;do{o.org=n,o=o.oNext}while(o!==t)},e.mesh.makeFace_=function(t,i){var r=i.prev,n=new e.GluFace(i,r);r.next=n,i.prev=n,n.anEdge=t,n.inside=i.inside;var o=t;do{o.lFace=n,o=o.lNext}while(o!==t)},e.mesh.killEdge_=function(e){var t=e.next,i=e.sym.next;t.sym.next=i,i.sym.next=t},e.mesh.killVertex_=function(e,t){var i=e.anEdge,r=i;do{r.org=t,r=r.oNext}while(r!==i);var n=e.prev,o=e.next;o.prev=n,n.next=o},e.mesh.killFace_=function(e,t){var i=e.anEdge,r=i;do{r.lFace=t,r=r.lNext}while(r!==i);var n=e.prev,o=e.next;o.prev=n,n.next=o},e.normal={},e.normal.S_UNIT_X_=1,e.normal.S_UNIT_Y_=0,e.normal.projectPolygon=function(t,i,r,n){var o=!1,a=[i,r,n];0===i&&0===r&&0===n&&(e.normal.computeNormal_(t,a),o=!0);var s,l=e.normal.longAxis_(a),u=t.mesh.vHead;if(e.TRUE_PROJECT){e.normal.normalize_(a);var h=[0,0,0],d=[0,0,0];h[l]=0,h[(l+1)%3]=e.normal.S_UNIT_X_,h[(l+2)%3]=e.normal.S_UNIT_Y_;var c=e.normal.dot_(h,a);for(h[0]-=c*a[0],h[1]-=c*a[1],h[2]-=c*a[2],e.normal.normalize_(h),d[0]=a[1]*h[2]-a[2]*h[1],d[1]=a[2]*h[0]-a[0]*h[2],d[2]=a[0]*h[1]-a[1]*h[0],e.normal.normalize_(d),s=u.next;s!==u;s=s.next)s.s=e.normal.dot_(s.coords,h),s.t=e.normal.dot_(s.coords,d)}else{var f=(l+1)%3,p=(l+2)%3,v=a[l]>0?1:-1;for(s=u.next;s!==u;s=s.next)s.s=s.coords[f],s.t=v*s.coords[p]}o&&e.normal.checkOrientation_(t)},e.normal.dot_=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.normal.normalize_=function(t){var i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];e.assert(i>0),i=Math.sqrt(i),t[0]/=i,t[1]/=i,t[2]/=i},e.normal.longAxis_=function(e){var t=0;return Math.abs(e[1])>Math.abs(e[0])&&(t=1),Math.abs(e[2])>Math.abs(e[t])&&(t=2),t},e.normal.computeNormal_=function(t,i){var r,n=[-2*e.GLU_TESS_MAX_COORD,-2*e.GLU_TESS_MAX_COORD,-2*e.GLU_TESS_MAX_COORD],o=[2*e.GLU_TESS_MAX_COORD,2*e.GLU_TESS_MAX_COORD,2*e.GLU_TESS_MAX_COORD],a=[],s=[],l=t.mesh.vHead;for(r=l.next;r!==l;r=r.next)for(var u=0;u<3;++u){var h=r.coords[u];h<o[u]&&(o[u]=h,s[u]=r),h>n[u]&&(n[u]=h,a[u]=r)}var d=0;if(n[1]-o[1]>n[0]-o[0]&&(d=1),n[2]-o[2]>n[d]-o[d]&&(d=2),o[d]>=n[d])return i[0]=0,i[1]=0,void(i[2]=1);var c=0,f=s[d],p=a[d],v=[0,0,0],_=[f.coords[0]-p.coords[0],f.coords[1]-p.coords[1],f.coords[2]-p.coords[2]],m=[0,0,0];for(r=l.next;r!==l;r=r.next){m[0]=r.coords[0]-p.coords[0],m[1]=r.coords[1]-p.coords[1],m[2]=r.coords[2]-p.coords[2],v[0]=_[1]*m[2]-_[2]*m[1],v[1]=_[2]*m[0]-_[0]*m[2],v[2]=_[0]*m[1]-_[1]*m[0];var g=v[0]*v[0]+v[1]*v[1]+v[2]*v[2];g>c&&(c=g,i[0]=v[0],i[1]=v[1],i[2]=v[2])}c<=0&&(i[0]=i[1]=i[2]=0,i[e.normal.longAxis_(_)]=1)},e.normal.checkOrientation_=function(e){for(var t=0,i=e.mesh.fHead,r=i.next;r!==i;r=r.next){var n=r.anEdge;if(!(n.winding<=0))do{t+=(n.org.s-n.dst().s)*(n.org.t+n.dst().t),n=n.lNext}while(n!==r.anEdge)}if(t<0)for(var o=e.mesh.vHead,a=o.next;a!==o;a=a.next)a.t=-a.t},e.render={},e.render.renderMesh=function(t,i,r){for(var n=!1,o=-1,a=i.fHead.prev;a!==i.fHead;a=a.prev)if(a.inside){n||(t.callBeginCallback(e.primitiveType.GL_TRIANGLES),n=!0);var s=a.anEdge;e.assert(s.lNext.lNext.lNext===s,"renderMesh called with non-triangulated mesh");do{if(r){var l=s.rFace().inside?0:1;o!==l&&(o=l,t.callEdgeFlagCallback(!!o))}t.callVertexCallback(s.org.data),s=s.lNext}while(s!==a.anEdge)}n&&t.callEndCallback()},e.render.renderBoundary=function(t,i){for(var r=i.fHead.next;r!==i.fHead;r=r.next)if(r.inside){t.callBeginCallback(e.primitiveType.GL_LINE_LOOP);var n=r.anEdge;do{t.callVertexCallback(n.org.data),n=n.lNext}while(n!==r.anEdge);t.callEndCallback()}},e.sweep={},e.sweep.SENTINEL_COORD_=4*e.GLU_TESS_MAX_COORD,e.sweep.TOLERANCE_NONZERO_=!1,e.sweep.computeInterior=function(t){t.fatalError=!1,e.sweep.removeDegenerateEdges_(t),e.sweep.initPriorityQ_(t),e.sweep.initEdgeDict_(t);for(var i;null!==(i=t.pq.extractMin());){for(;;){var r=t.pq.minimum();if(null===r||!e.geom.vertEq(r,i))break;r=t.pq.extractMin(),e.sweep.spliceMergeVertices_(t,i.anEdge,r.anEdge)}e.sweep.sweepEvent_(t,i)}var n=t.dict.getMin().getKey();t.event=n.eUp.org,e.sweep.doneEdgeDict_(t),e.sweep.donePriorityQ_(t),e.sweep.removeDegenerateFaces_(t.mesh),t.mesh.checkMesh()},e.sweep.addWinding_=function(e,t){e.winding+=t.winding,e.sym.winding+=t.sym.winding},e.sweep.edgeLeq_=function(t,i,r){var n=t.event,o=i.eUp,a=r.eUp;return o.dst()===n?a.dst()===n?e.geom.vertLeq(o.org,a.org)?e.geom.edgeSign(a.dst(),o.org,a.org)<=0:e.geom.edgeSign(o.dst(),a.org,o.org)>=0:e.geom.edgeSign(a.dst(),n,a.org)<=0:a.dst()===n?e.geom.edgeSign(o.dst(),n,o.org)>=0:e.geom.edgeEval(o.dst(),n,o.org)>=e.geom.edgeEval(a.dst(),n,a.org)},e.sweep.deleteRegion_=function(t,i){i.fixUpperEdge&&e.assert(0===i.eUp.winding),i.eUp.activeRegion=null,t.dict.deleteNode(i.nodeUp),i.nodeUp=null},e.sweep.fixUpperEdge_=function(t,i){e.assert(t.fixUpperEdge),e.mesh.deleteEdge(t.eUp),t.fixUpperEdge=!1,t.eUp=i,i.activeRegion=t},e.sweep.topLeftRegion_=function(t){var i=t.eUp.org;do{t=t.regionAbove()}while(t.eUp.org===i);if(t.fixUpperEdge){var r=e.mesh.connect(t.regionBelow().eUp.sym,t.eUp.lNext);e.sweep.fixUpperEdge_(t,r),t=t.regionAbove()}return t},e.sweep.topRightRegion_=function(e){var t=e.eUp.dst();do{e=e.regionAbove()}while(e.eUp.dst()===t);return e},e.sweep.addRegionBelow_=function(t,i,r){var n=new e.ActiveRegion;return n.eUp=r,n.nodeUp=t.dict.insertBefore(i.nodeUp,n),r.activeRegion=n,n},e.sweep.isWindingInside_=function(t,i){switch(t.windingRule){case e.windingRule.GLU_TESS_WINDING_ODD:return 0!=(1&i);case e.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==i;case e.windingRule.GLU_TESS_WINDING_POSITIVE:return i>0;case e.windingRule.GLU_TESS_WINDING_NEGATIVE:return i<0;case e.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return i>=2||i<=-2}return e.assert(!1),!1},e.sweep.computeWinding_=function(t,i){i.windingNumber=i.regionAbove().windingNumber+i.eUp.winding,i.inside=e.sweep.isWindingInside_(t,i.windingNumber)},e.sweep.finishRegion_=function(t,i){var r=i.eUp,n=r.lFace;n.inside=i.inside,n.anEdge=r,e.sweep.deleteRegion_(t,i)},e.sweep.finishLeftRegions_=function(t,i,r){for(var n=i,o=i.eUp;n!==r;){n.fixUpperEdge=!1;var a=n.regionBelow(),s=a.eUp;if(s.org!==o.org){if(!a.fixUpperEdge){e.sweep.finishRegion_(t,n);break}s=e.mesh.connect(o.lPrev(),s.sym),e.sweep.fixUpperEdge_(a,s)}o.oNext!==s&&(e.mesh.meshSplice(s.oPrev(),s),e.mesh.meshSplice(o,s)),e.sweep.finishRegion_(t,n),o=a.eUp,n=a}return o},e.sweep.addRightEdges_=function(t,i,r,n,o,a){var s=!0,l=r;do{e.assert(e.geom.vertLeq(l.org,l.dst())),e.sweep.addRegionBelow_(t,i,l.sym),l=l.oNext}while(l!==n);null===o&&(o=i.regionBelow().eUp.rPrev());for(var u,h=i,d=o;(l=(u=h.regionBelow()).eUp.sym).org===d.org;)l.oNext!==d&&(e.mesh.meshSplice(l.oPrev(),l),e.mesh.meshSplice(d.oPrev(),l)),u.windingNumber=h.windingNumber-l.winding,u.inside=e.sweep.isWindingInside_(t,u.windingNumber),h.dirty=!0,!s&&e.sweep.checkForRightSplice_(t,h)&&(e.sweep.addWinding_(l,d),e.sweep.deleteRegion_(t,h),e.mesh.deleteEdge(d)),s=!1,h=u,d=l;h.dirty=!0,e.assert(h.windingNumber-l.winding===u.windingNumber),a&&e.sweep.walkDirtyRegions_(t,h)},e.sweep.callCombine_=function(t,i,r,n,o){var a=[i.coords[0],i.coords[1],i.coords[2]];i.data=null,i.data=t.callCombineCallback(a,r,n),null===i.data&&(o?t.fatalError||(t.callErrorCallback(e.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),t.fatalError=!0):i.data=r[0])},e.sweep.spliceMergeVertices_=function(t,i,r){var n=[null,null,null,null];n[0]=i.org.data,n[1]=r.org.data,e.sweep.callCombine_(t,i.org,n,[.5,.5,0,0],!1),e.mesh.meshSplice(i,r)},e.sweep.vertexWeights_=function(t,i,r,n,o){var a=e.geom.vertL1dist(i,t),s=e.geom.vertL1dist(r,t),l=o,u=o+1;n[l]=.5*s/(a+s),n[u]=.5*a/(a+s),t.coords[0]+=n[l]*i.coords[0]+n[u]*r.coords[0],t.coords[1]+=n[l]*i.coords[1]+n[u]*r.coords[1],t.coords[2]+=n[l]*i.coords[2]+n[u]*r.coords[2]},e.sweep.getIntersectData_=function(t,i,r,n,o,a){var s=[0,0,0,0],l=[r.data,n.data,o.data,a.data];i.coords[0]=i.coords[1]=i.coords[2]=0,e.sweep.vertexWeights_(i,r,n,s,0),e.sweep.vertexWeights_(i,o,a,s,2),e.sweep.callCombine_(t,i,l,s,!0)},e.sweep.checkForRightSplice_=function(t,i){var r=i.regionBelow(),n=i.eUp,o=r.eUp;if(e.geom.vertLeq(n.org,o.org)){if(e.geom.edgeSign(o.dst(),n.org,o.org)>0)return!1;e.geom.vertEq(n.org,o.org)?n.org!==o.org&&(t.pq.remove(n.org.pqHandle),e.sweep.spliceMergeVertices_(t,o.oPrev(),n)):(e.mesh.splitEdge(o.sym),e.mesh.meshSplice(n,o.oPrev()),i.dirty=r.dirty=!0)}else{if(e.geom.edgeSign(n.dst(),o.org,n.org)<0)return!1;i.regionAbove().dirty=i.dirty=!0,e.mesh.splitEdge(n.sym),e.mesh.meshSplice(o.oPrev(),n)}return!0},e.sweep.checkForLeftSplice_=function(t,i){var r,n=i.regionBelow(),o=i.eUp,a=n.eUp;if(e.assert(!e.geom.vertEq(o.dst(),a.dst())),e.geom.vertLeq(o.dst(),a.dst())){if(e.geom.edgeSign(o.dst(),a.dst(),o.org)<0)return!1;i.regionAbove().dirty=i.dirty=!0,r=e.mesh.splitEdge(o),e.mesh.meshSplice(a.sym,r),r.lFace.inside=i.inside}else{if(e.geom.edgeSign(a.dst(),o.dst(),a.org)>0)return!1;i.dirty=n.dirty=!0,r=e.mesh.splitEdge(a),e.mesh.meshSplice(o.lNext,a.sym),r.rFace().inside=i.inside}return!0},e.sweep.checkForIntersect_=function(t,i){var r=i.regionBelow(),n=i.eUp,o=r.eUp,a=n.org,s=o.org,l=n.dst(),u=o.dst(),h=new e.GluVertex;if(e.assert(!e.geom.vertEq(u,l)),e.assert(e.geom.edgeSign(l,t.event,a)<=0),e.assert(e.geom.edgeSign(u,t.event,s)>=0),e.assert(a!==t.event&&s!==t.event),e.assert(!i.fixUpperEdge&&!r.fixUpperEdge),a===s)return!1;if(Math.min(a.t,l.t)>Math.max(s.t,u.t))return!1;if(e.geom.vertLeq(a,s)){if(e.geom.edgeSign(u,a,s)>0)return!1}else if(e.geom.edgeSign(l,s,a)<0)return!1;e.geom.edgeIntersect(l,a,u,s,h),e.assert(Math.min(a.t,l.t)<=h.t),e.assert(h.t<=Math.max(s.t,u.t)),e.assert(Math.min(u.s,l.s)<=h.s),e.assert(h.s<=Math.max(s.s,a.s)),e.geom.vertLeq(h,t.event)&&(h.s=t.event.s,h.t=t.event.t);var d=e.geom.vertLeq(a,s)?a:s;if(e.geom.vertLeq(d,h)&&(h.s=d.s,h.t=d.t),e.geom.vertEq(h,a)||e.geom.vertEq(h,s))return e.sweep.checkForRightSplice_(t,i),!1;if(!e.geom.vertEq(l,t.event)&&e.geom.edgeSign(l,t.event,h)>=0||!e.geom.vertEq(u,t.event)&&e.geom.edgeSign(u,t.event,h)<=0){if(u===t.event)return e.mesh.splitEdge(n.sym),e.mesh.meshSplice(o.sym,n),n=(i=e.sweep.topLeftRegion_(i)).regionBelow().eUp,e.sweep.finishLeftRegions_(t,i.regionBelow(),r),e.sweep.addRightEdges_(t,i,n.oPrev(),n,n,!0),!0;if(l===t.event){e.mesh.splitEdge(o.sym),e.mesh.meshSplice(n.lNext,o.oPrev()),r=i;var c=(i=e.sweep.topRightRegion_(i)).regionBelow().eUp.rPrev();return r.eUp=o.oPrev(),o=e.sweep.finishLeftRegions_(t,r,null),e.sweep.addRightEdges_(t,i,o.oNext,n.rPrev(),c,!0),!0}return e.geom.edgeSign(l,t.event,h)>=0&&(i.regionAbove().dirty=i.dirty=!0,e.mesh.splitEdge(n.sym),n.org.s=t.event.s,n.org.t=t.event.t),e.geom.edgeSign(u,t.event,h)<=0&&(i.dirty=r.dirty=!0,e.mesh.splitEdge(o.sym),o.org.s=t.event.s,o.org.t=t.event.t),!1}return e.mesh.splitEdge(n.sym),e.mesh.splitEdge(o.sym),e.mesh.meshSplice(o.oPrev(),n),n.org.s=h.s,n.org.t=h.t,n.org.pqHandle=t.pq.insert(n.org),e.sweep.getIntersectData_(t,n.org,a,l,s,u),i.regionAbove().dirty=i.dirty=r.dirty=!0,!1},e.sweep.walkDirtyRegions_=function(t,i){for(var r=i.regionBelow();;){for(;r.dirty;)i=r,r=r.regionBelow();if(!i.dirty&&(r=i,null===(i=i.regionAbove())||!i.dirty))return;i.dirty=!1;var n=i.eUp,o=r.eUp;if(n.dst()!==o.dst()&&e.sweep.checkForLeftSplice_(t,i)&&(r.fixUpperEdge?(e.sweep.deleteRegion_(t,r),e.mesh.deleteEdge(o),o=(r=i.regionBelow()).eUp):i.fixUpperEdge&&(e.sweep.deleteRegion_(t,i),e.mesh.deleteEdge(n),n=(i=r.regionAbove()).eUp)),n.org!==o.org)if(n.dst()===o.dst()||i.fixUpperEdge||r.fixUpperEdge||n.dst()!==t.event&&o.dst()!==t.event)e.sweep.checkForRightSplice_(t,i);else if(e.sweep.checkForIntersect_(t,i))return;n.org===o.org&&n.dst()===o.dst()&&(e.sweep.addWinding_(o,n),e.sweep.deleteRegion_(t,i),e.mesh.deleteEdge(n),i=r.regionAbove())}},e.sweep.connectRightVertex_=function(t,i,r){var n,o=r.oNext,a=i.regionBelow(),s=i.eUp,l=a.eUp,u=!1;(s.dst()!==l.dst()&&e.sweep.checkForIntersect_(t,i),e.geom.vertEq(s.org,t.event)&&(e.mesh.meshSplice(o.oPrev(),s),o=(i=e.sweep.topLeftRegion_(i)).regionBelow().eUp,e.sweep.finishLeftRegions_(t,i.regionBelow(),a),u=!0),e.geom.vertEq(l.org,t.event)&&(e.mesh.meshSplice(r,l.oPrev()),r=e.sweep.finishLeftRegions_(t,a,null),u=!0),u)?e.sweep.addRightEdges_(t,i,r.oNext,o,o,!0):(n=e.geom.vertLeq(l.org,s.org)?l.oPrev():s,n=e.mesh.connect(r.lPrev(),n),e.sweep.addRightEdges_(t,i,n,n.oNext,n.oNext,!1),n.sym.activeRegion.fixUpperEdge=!0,e.sweep.walkDirtyRegions_(t,i))},e.sweep.connectLeftDegenerate_=function(t,i,r){var n=i.eUp;if(e.geom.vertEq(n.org,r))return e.assert(e.sweep.TOLERANCE_NONZERO_),void(e.sweep.TOLERANCE_NONZERO_&&e.sweep.spliceMergeVertices_(t,n,r.anEdge));if(!e.geom.vertEq(n.dst(),r))return e.mesh.splitEdge(n.sym),i.fixUpperEdge&&(e.mesh.deleteEdge(n.oNext),i.fixUpperEdge=!1),e.mesh.meshSplice(r.anEdge,n),void e.sweep.sweepEvent_(t,r);if(e.assert(e.sweep.TOLERANCE_NONZERO_),e.sweep.TOLERANCE_NONZERO_){var o=(i=e.sweep.topRightRegion_(i)).regionBelow(),a=o.eUp.sym,s=a.oNext,l=s;o.fixUpperEdge&&(e.assert(s!==a),e.sweep.deleteRegion_(t,o),e.mesh.deleteEdge(a),a=s.oPrev()),e.mesh.meshSplice(r.anEdge,a),e.geom.edgeGoesLeft(s)||(s=null),e.sweep.addRightEdges_(t,i,a.oNext,l,s,!0)}},e.sweep.connectLeftVertex_=function(t,i){var r=new e.ActiveRegion;r.eUp=i.anEdge.sym;var n=t.dict.search(r).getKey(),o=n.regionBelow(),a=n.eUp,s=o.eUp;if(0!==e.geom.edgeSign(a.dst(),i,a.org)){var l,u=e.geom.vertLeq(s.dst(),a.dst())?n:o;n.inside||u.fixUpperEdge?(l=u===n?e.mesh.connect(i.anEdge.sym,a.lNext):e.mesh.connect(s.dNext(),i.anEdge).sym,u.fixUpperEdge?e.sweep.fixUpperEdge_(u,l):e.sweep.computeWinding_(t,e.sweep.addRegionBelow_(t,n,l)),e.sweep.sweepEvent_(t,i)):e.sweep.addRightEdges_(t,n,i.anEdge,i.anEdge,null,!0)}else e.sweep.connectLeftDegenerate_(t,n,i)},e.sweep.sweepEvent_=function(t,i){t.event=i;for(var r=i.anEdge;null===r.activeRegion;)if((r=r.oNext)===i.anEdge)return void e.sweep.connectLeftVertex_(t,i);var n=e.sweep.topLeftRegion_(r.activeRegion),o=n.regionBelow(),a=o.eUp,s=e.sweep.finishLeftRegions_(t,o,null);s.oNext===a?e.sweep.connectRightVertex_(t,n,s):e.sweep.addRightEdges_(t,n,s.oNext,a,a,!0)},e.sweep.addSentinel_=function(t,i){var r=new e.ActiveRegion,n=e.mesh.makeEdge(t.mesh);n.org.s=e.sweep.SENTINEL_COORD_,n.org.t=i,n.dst().s=-e.sweep.SENTINEL_COORD_,n.dst().t=i,t.event=n.dst(),r.eUp=n,r.windingNumber=0,r.inside=!1,r.fixUpperEdge=!1,r.sentinel=!0,r.dirty=!1,r.nodeUp=t.dict.insert(r)},e.sweep.initEdgeDict_=function(t){t.dict=new e.Dict(t,e.sweep.edgeLeq_),e.sweep.addSentinel_(t,-e.sweep.SENTINEL_COORD_),e.sweep.addSentinel_(t,e.sweep.SENTINEL_COORD_)},e.sweep.doneEdgeDict_=function(t){for(var i,r=0;null!==(i=t.dict.getMin().getKey());)i.sentinel||(e.assert(i.fixUpperEdge),e.assert(1==++r)),e.assert(0===i.windingNumber),e.sweep.deleteRegion_(t,i);t.dict=null},e.sweep.removeDegenerateEdges_=function(t){for(var i,r=t.mesh.eHead,n=r.next;n!==r;n=i){i=n.next;var o=n.lNext;e.geom.vertEq(n.org,n.dst())&&n.lNext.lNext!==n&&(e.sweep.spliceMergeVertices_(t,o,n),e.mesh.deleteEdge(n),o=(n=o).lNext),o.lNext===n&&(o!==n&&(o!==i&&o!==i.sym||(i=i.next),e.mesh.deleteEdge(o)),n!==i&&n!==i.sym||(i=i.next),e.mesh.deleteEdge(n))}},e.sweep.initPriorityQ_=function(t){var i=new e.PriorityQ;t.pq=i;var r,n=t.mesh.vHead;for(r=n.next;r!==n;r=r.next)r.pqHandle=i.insert(r);i.init()},e.sweep.donePriorityQ_=function(e){e.pq.deleteQ(),e.pq=null},e.sweep.removeDegenerateFaces_=function(t){for(var i,r=t.fHead.next;r!==t.fHead;r=i){i=r.next;var n=r.anEdge;e.assert(n.lNext!==n),n.lNext.lNext===n&&(e.sweep.addWinding_(n.oNext,n),e.mesh.deleteEdge(n))}},e.tessmono={},e.tessmono.tessellateMonoRegion_=function(t){var i=t.anEdge;for(e.assert(i.lNext!==i&&i.lNext.lNext!==i);e.geom.vertLeq(i.dst(),i.org);i=i.lPrev());for(;e.geom.vertLeq(i.org,i.dst());i=i.lNext);for(var r=i.lPrev();i.lNext!==r;)if(e.geom.vertLeq(i.dst(),r.org)){for(;r.lNext!==i&&(e.geom.edgeGoesLeft(r.lNext)||e.geom.edgeSign(r.org,r.dst(),r.lNext.dst())<=0);)r=e.mesh.connect(r.lNext,r).sym;r=r.lPrev()}else{for(;r.lNext!==i&&(e.geom.edgeGoesRight(i.lPrev())||e.geom.edgeSign(i.dst(),i.org,i.lPrev().org)>=0);)i=e.mesh.connect(i,i.lPrev()).sym;i=i.lNext}for(e.assert(r.lNext!==i);r.lNext.lNext!==i;)r=e.mesh.connect(r.lNext,r).sym},e.tessmono.tessellateInterior=function(t){for(var i,r=t.fHead.next;r!==t.fHead;r=i)i=r.next,r.inside&&e.tessmono.tessellateMonoRegion_(r)},e.tessmono.discardExterior=function(t){for(var i,r=t.fHead.next;r!==t.fHead;r=i)i=r.next,r.inside||e.mesh.zapFace(r)},e.tessmono.setWindingNumber=function(t,i,r){for(var n,o=t.eHead.next;o!==t.eHead;o=n)n=o.next,o.rFace().inside!==o.lFace.inside?o.winding=o.lFace.inside?i:-i:r?e.mesh.deleteEdge(o):o.winding=0},e.Dict=function(t,i){this.head_=new e.DictNode,this.frame_=t,this.leq_=i},e.Dict.prototype.deleteDict_=function(){},e.Dict.prototype.insertBefore=function(t,i){do{t=t.prev}while(null!==t.key&&!this.leq_(this.frame_,t.key,i));var r=new e.DictNode(i,t.next,t);return t.next.prev=r,t.next=r,r},e.Dict.prototype.insert=function(e){return this.insertBefore(this.head_,e)},e.Dict.prototype.deleteNode=function(e){e.next.prev=e.prev,e.prev.next=e.next},e.Dict.prototype.search=function(e){var t=this.head_;do{t=t.next}while(null!==t.key&&!this.leq_(this.frame_,e,t.key));return t},e.Dict.prototype.getMin=function(){return this.head_.next},e.Dict.prototype.getMax=function(){return this.head_.prev},e.DictNode=function(e,t,i){this.key=e||null,this.next=t||this,this.prev=i||this},e.DictNode.prototype.getKey=function(){return this.key},e.DictNode.prototype.getSuccessor=function(){return this.next},e.DictNode.prototype.getPredecessor=function(){return this.prev},e.GluTesselator=function(){this.state_=e.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null,this.errorCallback_=null,this.normal_=[0,0,0],this.windingRule=e.windingRule.GLU_TESS_WINDING_ODD,this.fatalError=!1,this.dict=null,this.pq=null,this.event=null,this.combineCallback_=null,this.boundaryOnly_=!1,this.beginCallback_=null,this.edgeFlagCallback_=null,this.vertexCallback_=null,this.endCallback_=null,this.meshCallback_=null,this.polygonData_=null},e.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2},e.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(e.GluTesselator.tessState_.T_DORMANT)},e.GluTesselator.prototype.gluTessProperty=function(t,i){switch(t){case e.gluEnum.GLU_TESS_TOLERANCE:return;case e.gluEnum.GLU_TESS_WINDING_RULE:var r=i;switch(r){case e.windingRule.GLU_TESS_WINDING_ODD:case e.windingRule.GLU_TESS_WINDING_NONZERO:case e.windingRule.GLU_TESS_WINDING_POSITIVE:case e.windingRule.GLU_TESS_WINDING_NEGATIVE:case e.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return void(this.windingRule=r)}break;case e.gluEnum.GLU_TESS_BOUNDARY_ONLY:return void(this.boundaryOnly_=!!i);default:return void this.callErrorCallback(e.gluEnum.GLU_INVALID_ENUM)}this.callErrorCallback(e.gluEnum.GLU_INVALID_VALUE)},e.GluTesselator.prototype.gluGetTessProperty=function(t){switch(t){case e.gluEnum.GLU_TESS_TOLERANCE:return 0;case e.gluEnum.GLU_TESS_WINDING_RULE:var i=this.windingRule;return e.assert(i===e.windingRule.GLU_TESS_WINDING_ODD||i===e.windingRule.GLU_TESS_WINDING_NONZERO||i===e.windingRule.GLU_TESS_WINDING_POSITIVE||i===e.windingRule.GLU_TESS_WINDING_NEGATIVE||i===e.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),i;case e.gluEnum.GLU_TESS_BOUNDARY_ONLY:return e.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(e.gluEnum.GLU_INVALID_ENUM)}return!1},e.GluTesselator.prototype.gluTessNormal=function(e,t,i){this.normal_[0]=e,this.normal_[1]=t,this.normal_[2]=i},e.GluTesselator.prototype.gluTessCallback=function(t,i){var r=i||null;switch(t){case e.gluEnum.GLU_TESS_BEGIN:case e.gluEnum.GLU_TESS_BEGIN_DATA:return void(this.beginCallback_=r);case e.gluEnum.GLU_TESS_EDGE_FLAG:case e.gluEnum.GLU_TESS_EDGE_FLAG_DATA:return void(this.edgeFlagCallback_=r);case e.gluEnum.GLU_TESS_VERTEX:case e.gluEnum.GLU_TESS_VERTEX_DATA:return void(this.vertexCallback_=r);case e.gluEnum.GLU_TESS_END:case e.gluEnum.GLU_TESS_END_DATA:return void(this.endCallback_=r);case e.gluEnum.GLU_TESS_ERROR:case e.gluEnum.GLU_TESS_ERROR_DATA:return void(this.errorCallback_=r);case e.gluEnum.GLU_TESS_COMBINE:case e.gluEnum.GLU_TESS_COMBINE_DATA:return void(this.combineCallback_=r);case e.gluEnum.GLU_TESS_MESH:return void(this.meshCallback_=r);default:return void this.callErrorCallback(e.gluEnum.GLU_INVALID_ENUM)}},e.GluTesselator.prototype.gluTessVertex=function(t,i){var r=!1,n=[0,0,0];this.requireState_(e.GluTesselator.tessState_.T_IN_CONTOUR);for(var o=0;o<3;++o){var a=t[o];a<-e.GLU_TESS_MAX_COORD&&(a=-e.GLU_TESS_MAX_COORD,r=!0),a>e.GLU_TESS_MAX_COORD&&(a=e.GLU_TESS_MAX_COORD,r=!0),n[o]=a}r&&this.callErrorCallback(e.errorType.GLU_TESS_COORD_TOO_LARGE),this.addVertex_(n,i)},e.GluTesselator.prototype.gluTessBeginPolygon=function(t){this.requireState_(e.GluTesselator.tessState_.T_DORMANT),this.state_=e.GluTesselator.tessState_.T_IN_POLYGON,this.mesh=new e.GluMesh,this.polygonData_=t},e.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(e.GluTesselator.tessState_.T_IN_POLYGON),this.state_=e.GluTesselator.tessState_.T_IN_CONTOUR,this.lastEdge_=null},e.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(e.GluTesselator.tessState_.T_IN_CONTOUR),this.state_=e.GluTesselator.tessState_.T_IN_POLYGON},e.GluTesselator.prototype.gluTessEndPolygon=function(){if(this.requireState_(e.GluTesselator.tessState_.T_IN_POLYGON),this.state_=e.GluTesselator.tessState_.T_DORMANT,e.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]),e.sweep.computeInterior(this),!this.fatalError){var t=this.mesh;if(this.boundaryOnly_?e.tessmono.setWindingNumber(t,1,!0):e.tessmono.tessellateInterior(t),this.mesh.checkMesh(),this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)if(this.boundaryOnly_)e.render.renderBoundary(this,this.mesh);else{var i=!!this.edgeFlagCallback_;e.render.renderMesh(this,this.mesh,i)}if(this.meshCallback_)return e.tessmono.discardExterior(this.mesh),this.meshCallback_(this.mesh),this.mesh=null,void(this.polygonData_=null)}e.mesh.deleteMesh(this.mesh),this.polygonData_=null,this.mesh=null},e.GluTesselator.prototype.requireState_=function(e){this.state_!==e&&this.gotoState_(e)},e.GluTesselator.prototype.gotoState_=function(t){for(;this.state_!==t;)if(this.state_<t)switch(this.state_){case e.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_BEGIN_POLYGON),this.gluTessBeginPolygon(null);break;case e.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case e.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_END_CONTOUR),this.gluTessEndContour();break;case e.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}},e.GluTesselator.prototype.addVertex_=function(t,i){var r=this.lastEdge_;null===r?(r=e.mesh.makeEdge(this.mesh),e.mesh.meshSplice(r,r.sym)):(e.mesh.splitEdge(r),r=r.lNext),r.org.data=i,r.org.coords[0]=t[0],r.org.coords[1]=t[1],r.org.coords[2]=t[2],r.winding=1,r.sym.winding=-1,this.lastEdge_=r},e.GluTesselator.prototype.callBeginCallback=function(e){this.beginCallback_&&this.beginCallback_(e,this.polygonData_)},e.GluTesselator.prototype.callVertexCallback=function(e){this.vertexCallback_&&this.vertexCallback_(e,this.polygonData_)},e.GluTesselator.prototype.callEdgeFlagCallback=function(e){this.edgeFlagCallback_&&this.edgeFlagCallback_(e,this.polygonData_)},e.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)},e.GluTesselator.prototype.callCombineCallback=function(e,t,i){return this.combineCallback_&&this.combineCallback_(e,t,i,this.polygonData_)||null},e.GluTesselator.prototype.callErrorCallback=function(e){this.errorCallback_&&this.errorCallback_(e,this.polygonData_)},e.GluFace=function(e,t){this.next=e||this,this.prev=t||this,this.anEdge=null,this.inside=!1},e.GluHalfEdge=function(e){this.next=e||this,this.sym=null,this.oNext=null,this.lNext=null,this.org=null,this.lFace=null,this.activeRegion=null,this.winding=0},e.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace},e.GluHalfEdge.prototype.dst=function(){return this.sym.org},e.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext},e.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym},e.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym},e.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext},e.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym},e.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym},e.GluMesh=function(){this.vHead=new e.GluVertex,this.fHead=new e.GluFace,this.eHead=new e.GluHalfEdge,this.eHeadSym=new e.GluHalfEdge,this.eHead.sym=this.eHeadSym,this.eHeadSym.sym=this.eHead},e.GluMesh.prototype.checkMesh=function(){if(e.DEBUG){var t,i,r=this.fHead,n=this.vHead,o=this.eHead,a=r;for(a=r;(i=a.next)!==r;a=i){e.assert(i.prev===a),t=i.anEdge;do{e.assert(t.sym!==t),e.assert(t.sym.sym===t),e.assert(t.lNext.oNext.sym===t),e.assert(t.oNext.sym.lNext===t),e.assert(t.lFace===i),t=t.lNext}while(t!==i.anEdge)}e.assert(i.prev===a&&null===i.anEdge);var s,l=n;for(l=n;(s=l.next)!==n;l=s){e.assert(s.prev===l),t=s.anEdge;do{e.assert(t.sym!==t),e.assert(t.sym.sym===t),e.assert(t.lNext.oNext.sym===t),e.assert(t.oNext.sym.lNext===t),e.assert(t.org===s),t=t.oNext}while(t!==s.anEdge)}e.assert(s.prev===l&&null===s.anEdge&&null===s.data);var u=o;for(u=o;(t=u.next)!==o;u=t)e.assert(t.sym.next===u.sym),e.assert(t.sym!==t),e.assert(t.sym.sym===t),e.assert(null!==t.org),e.assert(null!==t.dst()),e.assert(t.lNext.oNext.sym===t),e.assert(t.oNext.sym.lNext===t);e.assert(t.sym.next===u.sym&&t.sym===this.eHeadSym&&t.sym.sym===t&&null===t.org&&null===t.dst()&&null===t.lFace&&null===t.rFace())}},e.GluVertex=function(e,t){this.next=e||this,this.prev=t||this,this.anEdge=null,this.data=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0},e.PriorityQ=function(){this.verts_=[],this.order_=null,this.size_=0,this.initialized_=!1,this.heap_=new e.PriorityQHeap},e.PriorityQ.prototype.deleteQ=function(){this.heap_=null,this.order_=null,this.verts_=null},e.PriorityQ.prototype.init=function(){this.order_=[];for(var t=0;t<this.size_;t++)this.order_[t]=t;var i=function(t){return function(i,r){return e.geom.vertLeq(t[i],t[r])?1:-1}}(this.verts_);if(this.order_.sort(i),this.initialized_=!0,this.heap_.init(),e.DEBUG){var r=0+this.size_-1;for(t=0;t<r;++t)e.assert(e.geom.vertLeq(this.verts_[this.order_[t+1]],this.verts_[this.order_[t]]))}},e.PriorityQ.prototype.insert=function(e){if(this.initialized_)return this.heap_.insert(e);var t=this.size_++;return this.verts_[t]=e,-(t+1)},e.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var t=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var i=this.heap_.minimum();if(e.geom.vertLeq(i,t))return this.heap_.extractMin()}do{--this.size_}while(this.size_>0&&null===this.verts_[this.order_[this.size_-1]]);return t},e.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var t=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var i=this.heap_.minimum();if(e.geom.vertLeq(i,t))return i}return t},e.PriorityQ.prototype.remove=function(t){if(t>=0)this.heap_.remove(t);else for(t=-(t+1),e.assert(t<this.verts_.length&&null!==this.verts_[t]),this.verts_[t]=null;this.size_>0&&null===this.verts_[this.order_[this.size_-1]];)--this.size_},e.PriorityQHeap=function(){this.heap_=e.PriorityQHeap.reallocNumeric_([0],e.PriorityQHeap.INIT_SIZE_+1),this.verts_=[null,null],this.handles_=[0,0],this.size_=0,this.max_=e.PriorityQHeap.INIT_SIZE_,this.freeList_=0,this.initialized_=!1,this.heap_[1]=1},e.PriorityQHeap.INIT_SIZE_=32,e.PriorityQHeap.reallocNumeric_=function(e,t){for(var i=new Array(t),r=0;r<e.length;r++)i[r]=e[r];for(;r<t;r++)i[r]=0;return i},e.PriorityQHeap.prototype.init=function(){for(var e=this.size_;e>=1;--e)this.floatDown_(e);this.initialized_=!0},e.PriorityQHeap.prototype.insert=function(t){var i,r=++this.size_;return 2*r>this.max_&&(this.max_*=2,this.handles_=e.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1)),0===this.freeList_?i=r:(i=this.freeList_,this.freeList_=this.handles_[this.freeList_]),this.verts_[i]=t,this.handles_[i]=r,this.heap_[r]=i,this.initialized_&&this.floatUp_(r),i},e.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_},e.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]},e.PriorityQHeap.prototype.extractMin=function(){var e=this.heap_,t=this.verts_,i=this.handles_,r=e[1],n=t[r];return this.size_>0&&(e[1]=e[this.size_],i[e[1]]=1,t[r]=null,i[r]=this.freeList_,this.freeList_=r,--this.size_>0&&this.floatDown_(1)),n},e.PriorityQHeap.prototype.remove=function(t){var i=this.heap_,r=this.verts_,n=this.handles_;e.assert(t>=1&&t<=this.max_&&null!==r[t]);var o=n[t];if(i[o]=i[this.size_],n[i[o]]=o,o<=--this.size_)if(o<=1)this.floatDown_(o);else{var a=r[i[o]],s=r[i[o>>1]];e.geom.vertLeq(s,a)?this.floatDown_(o):this.floatUp_(o)}r[t]=null,n[t]=this.freeList_,this.freeList_=t},e.PriorityQHeap.prototype.floatDown_=function(t){for(var i=this.heap_,r=this.verts_,n=this.handles_,o=t,a=i[o];;){var s=o<<1;s<this.size_&&e.geom.vertLeq(r[i[s+1]],r[i[s]])&&(s+=1),e.assert(s<=this.max_);var l=i[s];if(s>this.size_||e.geom.vertLeq(r[a],r[l]))return i[o]=a,void(n[a]=o);i[o]=l,n[l]=o,o=s}},e.PriorityQHeap.prototype.floatUp_=function(t){for(var i=this.heap_,r=this.verts_,n=this.handles_,o=t,a=i[o];;){var s=o>>1,l=i[s];if(0===s||e.geom.vertLeq(r[l],r[a]))return i[o]=a,void(n[a]=o);i[o]=l,n[l]=o,o=s}},e.ActiveRegion=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},e.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()},e.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()},e}.apply(null,[]))||(e.exports=r)},1892:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(9),i(32),i(496),i(483),i(478),i(1641),i(1511),i(1817),i(1644),i(1728),i(1649),i(1723),i(1681),i(1803)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,h,d,c,f,p,v,_){Object.defineProperty(t,"__esModule",{value:!0});var m=r.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),g=24,y=10,x=1.2*g,S=10*g,V=d.i8888to32(255,255,255,255),I={xOffset:0,yOffset:0,width:0,height:0},b=function(e){function t(t,i,r){var o=e.call(this)||this;o.geometryType=u.WGLGeometryType.LABEL,o.vvFlags=0,o._textBoxVerticalOffset=0,o._textBoxHorizontalOffset=0,o._refTemplate=I,o._xOffset=i.xoffset,o._yOffset=-i.yoffset,o._decorationOffset=h.getFontDecorationOffset(i.font);var s=i.haloColor;o._color=0|(i.color&&l.premultiplyAlphaRGBA(i.color));var d=i.xoffset/i.font.size,c=i.yoffset/i.font.size;o._shapingXOffset=d*g,o._shapingYOffset=c*g,o._haloColor=0|(s&&l.premultiplyAlphaRGBA(s)),o._haloSize=y*n.pt2px(n.toPt(i.haloSize||0)),o._textPropSize=n.pt2px(i.font.size),o._textPropAngle=i.angle*Math.PI/180,o._textPropHJustification="left"===i.horizontalAlignment?0:"right"===i.horizontalAlignment?1:.5;var f=0,p=.5;switch(r){case"above-center":case"above-left":case"above-right":f=-.5,p=0;break;case"below-center":case"below-left":case"below-right":f=.5,p=1}var v=0,_=.5;switch(r){case"above-left":case"center-left":case"below-left":v=-.5,_=1;break;case"above-right":case"center-right":case"below-right":v=.5,_=0}return o._textPropHAnchorPlacement=_,o._textPropVAnchorPlacement=p,o._placementDirection=[v,f],o._materialStore=t,o.symbolId=i.id,o.anchor=a.create(),o}return i(t,e),t.fromText=function(e,i,r,n,o,a){return new t(e,r,o)},Object.defineProperty(t.prototype,"bounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0}),t.prototype.computeGlyphs=function(e,t){var i=t.text;if(!i||!i.length)return this._computedGlyphs=[],1;var r=this._shapingXOffset,n=this._shapingYOffset,s=this._computeShaping(e,S,x,0,r,n,this._textPropHAnchorPlacement,this._textPropVAnchorPlacement,this._textPropHJustification).getShaping(i,t.rtl);isNaN(this._decorationOffset)||c.addDecoration(s,this._decorationOffset);for(var l=new Array(s.length),h=0;h<s.length;h++){var d=this._textPropAngle,f=this._textPropSize,v=this._haloSize,m=s[h].glyphMosaicItem,y=this._materialStore.createGlyphMaterial(m,u.WGLGeometryType.LABEL,this.vvFlags);l[h]=_.ComputedGlyph.from(s[h],y,d,f,v)}if(this._computedGlyphs=l,!s||0===s.length)return 2;var V=c.getBox(s),I=this._textPropSize/g;V.width*=I,V.height*=I,V.x*=I,V.y*=I,this._placementDirection[0]<0?this._textBoxHorizontalOffset=-V.x-V.width:this._placementDirection[0]>0&&(this._textBoxHorizontalOffset=-V.x),this._placementDirection[1]<0?this._textBoxVerticalOffset=-V.y:this._placementDirection[1]>0&&(this._textBoxVerticalOffset=-V.y+V.height);var b=V.width/2,w=V.height/2;if(this._textPropAngle){var M=a.fromValues(-b,-w),T=a.fromValues(b,w),E=o.create();o.rotate(E,E,this._textPropAngle),a.transformMat2d(M,M,E),a.transformMat2d(T,T,E);var L=Math.abs(T[0]-M[0]),D=Math.abs(T[1]-M[1]);V.width=L,V.height=D}var F=new p.default(V.x,V.y,V.width+10,V.height+10);this._bounds=F;var O=this._placementDirection[0]*(this._refTemplate.width+this._bounds.width),C=this._placementDirection[1]*(this._refTemplate.height+this._bounds.height);return this._bounds.center[0]=O+this._xOffset,this._bounds.center[1]=C+this._yOffset,0},t.prototype.bindReferenceTemplate=function(e){this._refTemplate=e||I},t.prototype.computeAnchor=function(e,t){var i=this._refTemplate.xOffset,r=this._refTemplate.yOffset;switch(e){case"esriGeometryPoint":var n=t.geometry,o=n.x,s=n.y;this._setAnchor(o,s);break;case"esriGeometryMultipoint":var l=t.geometry,u=this._computeAnchorMultipoint(l.points);o=u.x,s=u.y;this._setAnchor(o,s);break;case"esriGeometryPolygon":if(t.centroid){var h=t.centroid,d=h.x,c=h.y;this._setAnchor(d,c);break}l=t.geometry;if(!(f=this._computeAnchorRings(l.rings)))break;o=f.x,s=f.y;this._setAnchor(o,s);break;case"esriGeometryPolyline":var f;l=t.geometry;if(!(f=this._computeAnchorRings(l.paths)))break;o=f.x,s=f.y;this._setAnchor(o,s);break;default:m.error("Unable to handle geometryType: "+e)}return a.fromValues(this.anchor[0]+i,this.anchor[1]+r)},t.prototype.writeMesh=function(e,t,i,r,n,o,a){var s=t.indexVector,l=t.get("geometry"),u=t.get("visibility"),h=t.get("visibilityRange"),c=this._getOffset(l),f=this._placementDirection[0]*(this._refTemplate.width+10)+this._textBoxHorizontalOffset,p=this._placementDirection[1]*(this._refTemplate.height+10)+this._textBoxVerticalOffset,v=d.i8888to32(this._refTemplate.xOffset,-this._refTemplate.yOffset,f,p);this._writeVertices(e,s,l,u,h,r,c,v,this.anchor[0],this.anchor[1])},t.prototype._setAnchor=function(e,t){this.anchor[0]=e,this.anchor[1]=t},t.prototype._computeAnchorMultipoint=function(e){return e.length&&e[0].length?{x:e[0][0],y:e[0][1]}:null},t.prototype._computeAnchorRings=function(e){if(!e.length||!e[0].length||!e[0][0].length)return null;var t=s.ringsCentroid(e,!1);return{x:t[0],y:t[1]}},t.prototype._computeShaping=function(e,t,i,r,n,o,a,s,l){return this._shaping=new c([e],S,x,0,[n,o],a,s,l),this._shaping},t.prototype._getOffset=function(e){return e.length/5},t.prototype._writeVertices=function(e,t,i,r,n,o,a,s,l,u){var h=this._computedGlyphs,c=l,p=u,v=d.i1616to32(2*c,2*p),_=d.i1616to32(2*c+1,2*p),m=0,g=(16711680&o)>>16,y=(65280&o)>>8,x=255&o,S=d.i8888to32(0,g,y,x);if(this._haloSize)for(var V=0;V<h.length;V++,m+=4){var I=h[V].materialId,b=this._materialStore.get(I);(w=new f(o,this.geometryType,I)).vertexFrom=a+m,w.indexFrom=t.length,this._writeGlyph(w,i,r,n,S,_,this._haloColor,s,h[V],b),this._writeIndices(w,t,a+m),e.push(w)}for(V=0;V<h.length;V++,m+=4){var w;I=h[V].materialId,b=this._materialStore.get(I);(w=new f(o,this.geometryType,I)).vertexFrom=a+m,w.indexFrom=t.length,this._writeGlyph(w,i,r,n,S,v,this._color,s,h[V],b),this._writeIndices(w,t,a+m),e.push(w)}},t.prototype._writeGlyph=function(e,t,i,r,n,o,a,s,l,u){t.push(o),t.push(a),t.push(l.vertexOffsetUpperLeft),t.push(l.texFontSizeUpperLeft),t.push(s),t.push(o),t.push(a),t.push(l.vertexOffsetUpperRight),t.push(l.texFontSizeUpperRight),t.push(s),t.push(o),t.push(a),t.push(l.vertexOffsetLowerLeft),t.push(l.texFontSizeLowerLeft),t.push(s),t.push(o),t.push(a),t.push(l.vertexOffsetLowerRight),t.push(l.texFontSizeLowerRight),t.push(s),i.push(4294967295),r.push(V),r.push(V),e.vertexCount+=4},t.prototype._writeIndices=function(e,t,i){t.push(i+0),t.push(i+1),t.push(i+2),t.push(i+1),t.push(i+3),t.push(i+2),e.indexCount+=6},t}(v.default);t.default=b}.apply(null,r))||(e.exports=n)},1893:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(9),i(1527)],void 0===(n=function(e,t,i,r,n){Object.defineProperty(t,"__esModule",{value:!0});var o=r.getLogger("esri/views/2d/engine/webgl/util/Matcher"),a=function(){function e(){this._defaultResult=null}return e.prototype.size=function(){return 1},e.prototype.getDefault=function(){return this._defaultResult},e.prototype.setDefault=function(e){this._defaultResult=e},e.prototype.match=function(e,t){return this.getDefault()},e}();t.default=a;var s=function(e){function t(t,i,r,o){var a=e.call(this)||this;return a._intervals=[],a._isMaxInclusive=i,r?a._getValue=n.createArcadeFunction(r):t&&t.length?"function"==typeof t?(a._field=null,a._getValue=t):(a._field=t,a._normalizationInfo=o,a._getValue=a._getValueFromField.bind(a)):a._field=null,a}return i(t,e),t.prototype.add=function(e,t){this._intervals.push({interval:e,result:t}),this._intervals.sort(function(e,t){return e.interval.min-t.interval.min})},t.prototype.size=function(){return e.prototype.size.call(this)+this._intervals.length},t.prototype.match=function(e,t){if(!this._getValue)return this.getDefault();var i=this._getValue(e,t);if(!i&&(null===i||void 0===i||isNaN(i)))return this.getDefault();for(var r=0;r<this._intervals.length;r++){var n=this._intervals[r],o=n.interval,a=n.result,s=i>=o.min,l=this._isMaxInclusive?i<=o.max:i<o.max;if(s&&l)return a}return this.getDefault()},t.prototype._needsNormalization=function(){var e=this._normalizationInfo;return e&&(e.normalizationField||e.normalizationTotal||e.normalizationType)},t.prototype._getValueFromField=function(e){var t=e.attributes[this._field];if(!this._needsNormalization())return t;var i=this._normalizationInfo,r=i.normalizationField,n=i.normalizationTotal,a=i.normalizationType,s=!!r&&e.attributes[r];if(a)switch(a){case"field":return s?t/s:void 0;case"log":return Math.log(t)*Math.LOG10E;case"percent-of-total":return t/n*100;default:return void o.error("Found unknown normalization type: "+a)}else o.error("Normalization is required, but no type was set!")},t}(a);t.IntervalMatcher=s;var l=function(e){function t(t,i,r){var o=e.call(this)||this;return o._resultsMap=new Map,r?o._getValue=n.createArcadeFunction(r):t&&t.length?"function"==typeof t[0]?(o._fields=null,o._getValue=t[0]):(o._fields=t,o._seperator=i||"",o._getValue=o._getValueFromFields.bind(o)):o._fields=null,o}return i(t,e),t.prototype.add=function(e,t){this._resultsMap.set(e.toString(),t)},t.prototype.size=function(){return e.prototype.size.call(this)+this._resultsMap.size},t.prototype.match=function(e,t){if(!this._getValue)return this.getDefault();var i=this._getValue(e,t);if(!i&&(null===i||void 0===i))return this.getDefault();var r=i.toString();return this._resultsMap.has(r)?this._resultsMap.get(r):this.getDefault()},t.prototype._getValueFromFields=function(e){for(var t=[],i=0,r=this._fields;i<r.length;i++){var n=r[i],o=e.attributes[n];t.push(o)}return t.join(this._seperator)},t}(a);t.MapMatcher=l}.apply(null,r))||(e.exports=n)},1894:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1516),i(9),i(1511),i(1708),i(1527),i(1665)],void 0===(n=function(e,t,i,r,n,o,a,s){var l=r.getLogger("esri.views.2d.engine.webgl.WGLDisplayList"),u=function(){function e(){this.symbolLevels=[]}return Object.defineProperty(e.prototype,"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!0,configurable:!0}),e.prototype.addToList=function(e){var t=this;Array.isArray(e)?e.forEach(function(e){t._addToList(e)}):this._addToList(e)},e.prototype.removeFromList=function(e){var t=this;Array.isArray(e)||(e=[e]),e.forEach(function(e){t._removeFromList(e)})},e.prototype.ofType=function(e){var t,r,n,o,a,s,l,u,h,d;return i(this,function(i){switch(i.label){case 0:t=0,r=this.symbolLevels,i.label=1;case 1:if(!(t<r.length))return[3,8];n=r[t],o=0,a=n.zLevels,i.label=2;case 2:if(!(o<a.length))return[3,7];if(s=a[o],l=s.geometryDPInfo,u=this._getDPInfoType(e),!l[u])return[3,6];h=0,d=l[u],i.label=3;case 3:return h<d.length?[4,d[h]]:[3,6];case 4:i.sent(),i.label=5;case 5:return h++,[3,3];case 6:return o++,[3,2];case 7:return t++,[3,1];case 8:return[2]}})},e.prototype.clone=function(){for(var t=new e,i=0,r=this.symbolLevels;i<r.length;i++){var n=r[i];t.symbolLevels.push(n.clone())}return t},e.prototype._addToList=function(e){var t=e.symbolLevel,i=e.zOrder,r=this._getDisplayList(t,i,e.geometryType),n=r.length>0?r[r.length-1]:null;if(null!==n&&a.isSameMaterialInfo(n.materialInfo,e.materialInfo)&&n.indexFrom+n.indexCount===e.indexFrom)n.indexCount+=e.indexCount;else{var o=new h;o.indexFrom=e.indexFrom,o.indexCount=e.indexCount,o.materialInfo=e.materialInfo,o.geometryType=e.geometryType,r.push(o)}},e.prototype._removeFromList=function(e){for(var t=e.symbolLevel,i=e.zOrder,r=this._getDisplayList(t,i,e.geometryType),n=r.length,a=void 0,s=0;s<n;++s){var l=r[s];e.indexFrom+e.indexCount>l.indexFrom&&e.indexFrom<l.indexFrom+l.indexCount&&(a=s)}if(void 0!==a){l=r[a];if(e.indexFrom===l.indexFrom)l.indexCount-=e.indexCount,l.indexFrom+=e.indexCount,0===l.indexCount&&r.splice(a,1);else if(e.indexFrom+e.indexCount===l.indexFrom+l.indexCount)l.indexCount-=e.indexCount,0===l.indexCount&&r.splice(a,1);else{var u=l.indexFrom,d=e.indexFrom-l.indexFrom,c=e.indexCount,f=l.indexFrom+l.indexCount-(e.indexFrom+e.indexCount);l.indexCount=d;var p=new h;p.geometryType=l.geometryType,p.materialInfo=new o.default,p.materialInfo.copy(l.materialInfo),p.indexFrom=u+d+c,p.indexCount=f,r.splice(a+1,0,p)}}},e.prototype._getDisplayList=function(e,t,i){for(var r,o=this.symbolLevels.length,a=0;a<o;a++)if(this.symbolLevels[a].symbolLevel===e){r=this.symbolLevels[a];break}r||((r=new f).symbolLevel=e,this.symbolLevels.push(r));for(var s,l=r.zLevels.length,u=0;u<l;u++)if(r.zLevels[u].zLevel===t){s=r.zLevels[u];break}var h;switch(s||((s=new c).geometryDPInfo=new d,s.zLevel=t,r.zLevels.push(s)),i){case n.WGLGeometryType.FILL:s.geometryDPInfo.fill||(s.geometryDPInfo.fill=[]),h=s.geometryDPInfo.fill;break;case n.WGLGeometryType.LINE:s.geometryDPInfo.line||(s.geometryDPInfo.line=[]),h=s.geometryDPInfo.line;break;case n.WGLGeometryType.MARKER:s.geometryDPInfo.marker||(s.geometryDPInfo.marker=[]),h=s.geometryDPInfo.marker;break;case n.WGLGeometryType.TEXT:s.geometryDPInfo.text||(s.geometryDPInfo.text=[]),h=s.geometryDPInfo.text;break;case n.WGLGeometryType.LABEL:s.geometryDPInfo.label||(s.geometryDPInfo.label=[]),h=s.geometryDPInfo.label;break;default:console.error("Trying to add a record with geometry type '"+i+"'.")}return h},e.prototype.serialize=function(e){return s.serializeList(e,this.symbolLevels),e},e.deserialize=function(t){var i=new e;return i.symbolLevels=s.deserializeList(t,f),i},e.prototype._getDPInfoType=function(e){switch(e){case n.WGLGeometryType.FILL:return"fill";case n.WGLGeometryType.LINE:return"line";case n.WGLGeometryType.MARKER:return"marker";case n.WGLGeometryType.TEXT:return"text";case n.WGLGeometryType.LABEL:return"label";default:l.error("DisplayList: Tried to convert unknown geometryType: "+e)}},e}(),h=function(){function e(){this.materialInfo=null,this.indexFrom=0,this.indexCount=0}return e.prototype.clone=function(){var t=new e;return t.geometryType=this.geometryType,t.materialInfo=new o.default,t.materialInfo.copy(this.materialInfo),t.indexFrom=this.indexFrom,t.indexCount=this.indexCount,t},e.prototype.serialize=function(e){return this.materialInfo.serialize(e),e.writeInt32(this.indexFrom),e.writeInt32(this.indexCount),e},e.deserialize=function(t,i){var r=new e;return r.geometryType=i.geometryType,r.materialInfo=o.default.deserialize(t),r.indexFrom=t.readInt32(),r.indexCount=t.readInt32(),r},e}(),d=function(){function e(){this.fill=null,this.line=null,this.marker=null,this.text=null,this.label=null}return e.prototype.clone=function(){var t=new e;return t.fill=this.fill&&this.fill.map(function(e){return e.clone()}),t.line=this.line&&this.line.map(function(e){return e.clone()}),t.marker=this.marker&&this.marker.map(function(e){return e.clone()}),t.text=this.text&&this.text.map(function(e){return e.clone()}),t.label=this.label&&this.label.map(function(e){return e.clone()}),t},e.prototype.serialize=function(e){return s.serializeList(e,this.fill),s.serializeList(e,this.line),s.serializeList(e,this.marker),s.serializeList(e,this.text),s.serializeList(e,this.label),e},e.deserialize=function(t){var i=new e,r={geometryType:n.WGLGeometryType.FILL},o=s.deserializeList(t,h,r);o.length&&(i.fill=o),r.geometryType=n.WGLGeometryType.LINE;var a=s.deserializeList(t,h,r);a.length&&(i.line=a),r.geometryType=n.WGLGeometryType.MARKER;var l=s.deserializeList(t,h,r);l.length&&(i.marker=l),r.geometryType=n.WGLGeometryType.TEXT;var u=s.deserializeList(t,h,r);u.length&&(i.text=u),r.geometryType=n.WGLGeometryType.LABEL;var d=s.deserializeList(t,h,r);return d.length&&(i.label=d),i},e}(),c=function(){function e(){this.geometryDPInfo=new d}return e.prototype.clone=function(){var t=new e;return t.zLevel=this.zLevel,t.geometryDPInfo=this.geometryDPInfo.clone(),t},e.prototype.serialize=function(e){return e.writeInt32(this.zLevel),this.geometryDPInfo.serialize(e),e},e.deserialize=function(t){var i=new e;return i.zLevel=t.readInt32(),i.geometryDPInfo=d.deserialize(t),i},e}(),f=function(){function e(){this.zLevels=[]}return e.prototype.clone=function(){var t=new e;t.symbolLevel=this.symbolLevel;for(var i=0,r=this.zLevels;i<r.length;i++){var n=r[i];t.zLevels.push(n.clone())}return t},e.prototype.serialize=function(e){return e.writeInt32(this.symbolLevel),s.serializeList(e,this.zLevels),e},e.deserialize=function(t){var i=new e;return i.symbolLevel=t.readInt32(),i.zLevels=s.deserializeList(t,c),i},e}();return u}.apply(null,r))||(e.exports=n)},1895:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(0),i(4),i(1680),i(1),i(1536)],void 0===(n=function(e,t,i,r,n,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var i=e.call(this)||this;return i.tiles=new Map,i.layer=null,i}return i(t,e),t.prototype.destroy=function(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.highlightOptions=this.configuration=this.tiles=null},Object.defineProperty(t.prototype,"updating",{get:function(){return this.isUpdating()},enumerable:!0,configurable:!0}),t.prototype.acquireTile=function(e){var t=this,i=this.createTile(e);return i.once("attach",function(){return t.notifyChange("updating")}),this.tiles.set(e.id,i),i},t.prototype.forEachTile=function(e){this.tiles.forEach(e)},t.prototype.releaseTile=function(e){this.tiles.delete(e.key.id),this.disposeTile(e)},t.prototype.isUpdating=function(){var e=!0;return this.tiles.forEach(function(t){e=e&&t.status!==s.TileStatus.INITIALIZED}),!e},t.prototype.requestUpdate=function(){this.layerView.requestUpdate()},r([a.property()],t.prototype,"configuration",void 0),r([a.property()],t.prototype,"highlightOptions",void 0),r([a.property()],t.prototype,"layer",void 0),r([a.property()],t.prototype,"layerView",void 0),r([a.property()],t.prototype,"tileInfoView",void 0),r([a.property()],t.prototype,"updating",null),r([a.subclass()],t)}(a.declared(n,o));t.default=l}.apply(null,r))||(e.exports=n)},1950:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1666),i(1698),i(1490)],void 0===(n=function(e,t,i,r,n){function o(e,t,i){n.packFloatRGBA(e,t,i)}Object.defineProperty(t,"__esModule",{value:!0}),t.packFloat=o;var a=function(){function e(){}return e.checkSDF=function(e){return!0},e.prototype._extractGeometry=function(e){if(!e)return null;var t=e.symbolLayers;if(!t||1!==t.length)return null;var r=t[0];if(!r)return null;var n=r.markerGraphics;if(!n||1!==n.length)return null;var o=n[0];if(!o)return null;var a=o.geometry;if(!a||!a.rings)return null;for(var s=[],l=0,u=a.rings;l<u.length;l++){for(var h=[],d=0,c=u[l];d<c.length;d++){var f=c[d];h.push(new i.Point(f[0],f[1]))}s.push(h)}return s},e.prototype._getEnvelope=function(e){for(var t=1/0,i=-1/0,n=1/0,o=-1/0,a=0,s=e;a<s.length;a++)for(var l=0,u=s[a];l<u.length;l++){var h=u[l];h.x<t&&(t=h.x),h.x>i&&(i=h.x),h.y<n&&(n=h.y),h.y>o&&(o=h.y)}return new r(t,n,i-t,o-n)},e.prototype.buildSDF=function(e){var t=this._extractGeometry(e);if(!t)return null;var i=this._getEnvelope(t);if(i.width<=0||i.height<=0)return null;for(var r=Math.floor(31.5),n=(128-2*(r+0+1))/Math.max(i.width,i.height),o=Math.round(i.width*n),a=Math.round(i.height*n),s=o+2*r,l=a+2*r,u=0,h=t;u<h.length;u++)for(var d=0,c=h[u];d<c.length;d++){var f=c[d];f.x-=i.x,f.y-=i.y,f.x*=n,f.y*=n,f.x+=r-.5,f.y+=r-.5}var p=this._dist_map(t,s,l,r);return this._sign_dist_map(t,s,l,r,p),[this._encodeDistMap(p,r),s,l,o,a,n]},e.prototype._dist_map=function(e,t,i,r){for(var n=t*i,o=new Float32Array(n),a=r*r+1,s=0;s<n;++s)o[s]=a;for(var l=0,u=e;l<u.length;l++){var h=u[l],d=h.length;for(s=1;s<d;++s){var c=h[s-1],f=h[s],p=void 0,v=void 0;c.x<f.x?(p=c.x,v=f.x):(p=f.x,v=c.x);var _=void 0,m=void 0;c.y<f.y?(_=c.y,m=f.y):(_=f.y,m=c.y);var g=Math.floor(p)-r,y=Math.floor(v)+r,x=Math.floor(_)-r,S=Math.floor(m)+r;g<0&&(g=0),y>t&&(y=t),x<0&&(x=0),S>i&&(S=i);for(var V=f.x-c.x,I=f.y-c.y,b=V*V+I*I,w=g;w<y;w++)for(var M=x;M<S;M++){var T=(w-c.x)*V+(M-c.y)*I,E=void 0,L=void 0;T<0?(E=c.x,L=c.y):T>b?(E=f.x,L=f.y):(T/=b,E=c.x+T*V,L=c.y+T*I);var D=(w-E)*(w-E)+(M-L)*(M-L),F=(i-M-1)*t+w;D<o[F]&&(o[F]=D)}}}for(s=0;s<n;++s)o[s]=Math.sqrt(o[s]);return o},e.prototype._sign_dist_map=function(e,t,i,r,n){for(var o=0,a=e;o<a.length;o++)for(var s=a[o],l=s.length,u=1;u<l;++u){var h=s[u-1],d=s[u],c=void 0,f=void 0;h.x<d.x?(c=h.x,f=d.x):(c=d.x,f=h.x);var p=void 0,v=void 0;h.y<d.y?(p=h.y,v=d.y):(p=d.y,v=h.y);var _=Math.floor(c),m=Math.floor(f)+1,g=Math.floor(p),y=Math.floor(v)+1;_<r&&(_=r),m>t-r&&(m=t-r),g<r&&(g=r),y>i-r&&(y=i-r);for(var x=g;x<y;++x)if(h.y>x!=d.y>x){for(var S=(i-x-1)*t,V=_;V<m;++V)V<(d.x-h.x)*(x-h.y)/(d.y-h.y)+h.x&&(n[S+V]=-n[S+V]);for(V=r;V<_;++V)n[S+V]=-n[S+V]}}},e.prototype._encodeDistMap=function(e,t){for(var i=2*t,r=e.length,n=new Uint8Array(4*r),a=0;a<r;++a)o(.5-e[a]/i,n,4*a);return n},e}();t.SDFHelper=a}.apply(null,r))||(e.exports=n)},1951:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1698)],void 0===(n=function(e,t,i){return function(){function e(e,t){this._width=0,this._height=0,this._free=[],this._width=e,this._height=t,this._free.push(new i(0,0,e,t))}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.allocate=function(e,t){if(e>this._width||t>this._height)return new i;for(var r=null,n=-1,o=0;o<this._free.length;++o){var a=this._free[o];e<=a.width&&t<=a.height&&(null===r||a.y<=r.y&&a.x<=r.x)&&(r=a,n=o)}return null===r?new i:(this._free.splice(n,1),r.width<r.height?(r.width>e&&this._free.push(new i(r.x+e,r.y,r.width-e,t)),r.height>t&&this._free.push(new i(r.x,r.y+t,r.width,r.height-t))):(r.width>e&&this._free.push(new i(r.x+e,r.y,r.width-e,r.height)),r.height>t&&this._free.push(new i(r.x,r.y+t,e,r.height-t))),new i(r.x,r.y,e,t))},e.prototype.release=function(e){for(var t=0;t<this._free.length;++t){var i=this._free[t];if(i.y===e.y&&i.height===e.height&&i.x+i.width===e.x)i.width+=e.width;else if(i.x===e.x&&i.width===e.width&&i.y+i.height===e.y)i.height+=e.height;else if(e.y===i.y&&e.height===i.height&&e.x+e.width===i.x)i.x=e.x,i.width+=e.width;else{if(e.x!==i.x||e.width!==i.width||e.y+e.height!==i.y)continue;i.y=e.y,i.height+=e.height}this._free.splice(t,1),this.release(e)}this._free.push(e)},e}()}.apply(null,r))||(e.exports=n)},2342:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(0),i(492),i(4),i(1),i(57),i(497),i(1748),i(1731),i(2343),i(2357),i(1895)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,h,d,c,f){Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){function t(t){return e.call(this)||this}return i(t,e),t.prototype.initialize=function(){},t.prototype.createTile=function(e){var t=s.create();return this.tileInfoView.getTileBounds(t,e),new c(e,t)},t.prototype.disposeTile=function(e){this.featuresView.removeChild(e)},t.prototype.highlight=function(e){return this.featuresView.highlight(e)},t.prototype.hitTest=function(e,t){return this.featuresView.hitTest(e,t)},t.prototype.supportsRenderer=function(e){return null!=e&&u.isRendererWebGLCompatible(e)&&-1!==["simple","class-breaks","unique-value"].indexOf(e.type)},t.prototype.getProcessorConfiguration=function(){var e=this.layer;return{type:"symbol",renderer:e.renderer.toJSON(),devicePixelRatio:window.devicePixelRatio||1,definitionExpression:e.definitionExpression,outFields:e.outFields.slice().sort(),gdbVersion:e.gdbVersion,historicMoment:e.historicMoment&&e.historicMoment.getTime(),labelingInfo:e.labelingInfo&&e.labelingInfo.map(function(e){return e.toJSON()})}},t.prototype.needsProcessorReconfiguration=function(e){var t=this.configuration;if(!t||t.definitionExpression!==e.definitionExpression||t.outFields.join()!==e.outFields.join()||l.diff(t.labelingInfo,e.labelingInfo))return!0;var i=this.configuration&&n.fromJSON(this.configuration.renderer)||null,r=e&&n.fromJSON(e.renderer)||null,o=l.diff(i,r);if(!o)return!1;switch(o.type){case"complete":return!0;case"partial":if(function(e){for(var t in e.diff){var i=e.diff[t];if("collection"===i.type){if(0!==i.changed.length||0!==i.added.length||0!==i.removed.length)return!0}else if("visualVariables"!==t&&"authoringInfo"!==t)return!0}return!1}(o))return!0;if(o.diff.visualVariables){var a=this.featuresView.visualVariablesInfo,s=this.tileInfoView.tileInfo.spatialReference,d={fields:this.layer.fields.map(function(e){return e.toJSON()})},c=u.getNormalizedRenderer(r,s,d),f=h.convertVisualVariables(c.visualVariables).vvFields;return!!l.diff(a.vvFields,f)}}},t.prototype.applyConfiguration=function(e,t){var i=n.fromJSON(e.renderer),r={fields:this.layer.fields.map(function(e){return e.toJSON()})},o=u.getNormalizedRenderer(i,this.tileInfoView.tileInfo.spatialReference,r);this.configuration=e,this.featuresView.visualVariablesInfo=h.convertVisualVariables(o.visualVariables),t&&this.featuresView.disposeWebGLResources()},t.prototype.install=function(e){var t=new d.default({highlightOptions:this.highlightOptions,tileInfoView:this.tileInfoView,layer:this.layer,layerView:this.layerView});this.featuresView=t,t.install(e)},t.prototype.uninstall=function(e){this.featuresView.uninstall(e)},t.prototype.onTileData=function(e){var t=this.tiles.get(e.tileKey);t&&(this.featuresView.onTileData(t,e.data),this.requestUpdate())},t.prototype.onTileError=function(e){var t=this.tiles.get(e.tileKey);t&&(this.featuresView.onTileError(t),this.requestUpdate())},t.prototype.getMaterialItems=function(e){return this.featuresView.getMaterialItems(e)},r([a.subclass()],t)}(a.declared(o,f.default));t.default=p}.apply(null,r))||(e.exports=n)},2343:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(10),i(12),i(7),i(7),i(1661),i(1710),i(23),i(184),i(1850),i(2344),i(1511),i(1667),i(2350),i(1527),i(1798),i(2356)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,h,d,c,f,p,v,_,m){Object.defineProperty(t,"__esModule",{value:!0});var g=function(e){function t(t){var i=e.call(this)||this;return i._rendererInfo=new m,i._stage=new h,i._container=null,i._tileCoordinateScale=s.create(),i._orientationVec=s.fromValues(0,0,1),i._displayScale=s.create(),i._defaultTransform=a.create(),i._pointToCallbacks=new Map,i._highlightIDs=new Set,i._displayWidth=0,i._displayHeight=0,i._highlightOptionsUpToDate=!1,i.layer=null,i.textureManager=new p,i.highlightOptions=t.highlightOptions,i.tileInfoView=t.tileInfoView,i._stage.useContextVersion("webgl"),i.layer=t.layer,i._layerView=t.layerView,i}return r(t,e),t.prototype.fadeInLabels=function(){this._stage.fadeInLabels()},t.prototype.dispose=function(){this.textureManager&&(this.textureManager.dispose(),this.textureManager=null),this.removeAllChildren();for(var e=0,t=this.children;e<t.length;e++)t[e].dispose()},t.prototype.disposeWebGLResources=function(){for(var e=0,t=this.children;e<t.length;e++)t[e].clear()},t.prototype.displayWidth=function(){return this._displayWidth},Object.defineProperty(t.prototype,"displayHeight",{get:function(){return this._displayHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(e){this._highlightOptions=e,this._highlightOptionsUpToDate=!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visualVariablesInfo",{get:function(){return this._visualVariablesInfo},set:function(e){this._visualVariablesInfo=e,this.requestRender()},enumerable:!0,configurable:!0}),t.prototype.install=function(e){e.addChild(this._stage),this._stage.addChild(this),this._container=e},t.prototype.uninstall=function(e){e.removeChild(this._stage),this._stage.removeChild(this),this.dispose(),this._container=null},t.prototype.hitTest=function(e,t){var i=this,r=[e,t];return n.create(function(e,t){i._pointToCallbacks.set(r,{resolve:e,reject:t}),i.requestRender()},function(){i._pointToCallbacks.has(r)&&i._pointToCallbacks.delete(r)})},t.prototype.highlight=function(e){var t=this;return t.addHighlight(e),{remove:function(){t.removeHighlight(e)}}},t.prototype.setHighlight=function(e){this._highlightIDs.clear(),this.addHighlight(e)},t.prototype.setVisibility=function(e,t){for(var i=0,r=this.children;i<r.length;i++){!function(i){if(i.data){var r=i.data.tileDisplayData.displayObjectRegistry,n=e.filter(function(e){return r.has(e.id)});i.setVisibility(n,t)}}(r[i])}},t.prototype.setVisibilityRange=function(e,t,i,r){for(var n=0,o=this.children;n<o.length;n++){var a=o[n];a.data&&a.data.tileDisplayData.displayObjectRegistry.has(e)&&a.setVisibilityRange(e,t,i,r)}},t.prototype.addHighlight=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];this._highlightIDs.add(r)}this._buildHLList()},t.prototype.removeHighlight=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];this._highlightIDs.delete(r)}this._buildHLList()},t.prototype.getMaterialItems=function(e){var t=e;if(t&&0!==t.length){for(var i=[],r=0,n=t;r<n.length;r++){var a=n[r];i.push(this.textureManager.rasterizeItem(a.symbol,a.glyphIds))}return o.all(i).then(function(e){return e.map(function(e,t){return{id:t,mosaicItem:e}})})}},t.prototype.onTileData=function(e,t){var i=null;t.addOrUpdate&&(i=d.decode(t.addOrUpdate)),i?t.clear||!e.hasData?e.setData(i,this.layer.labelsVisible):e.patchData({remove:t.remove,addOrUpdate:i},this.layer.labelsVisible):e.hasData?t.clear?e.clear():t.remove&&e.patchData({remove:t.remove,addOrUpdate:null},this.layer.labelsVisible):e.setData(null,!1),this._layerView&&this._layerView.view.labelManager.requestUpdate(),e.buildHLList(this._highlightIDs),this.contains(e)||this.addChild(e),this.fadeInLabels(),this.requestRender()},t.prototype.onTileError=function(e){e.clear(),e.buildHLList(this._highlightIDs),this.contains(e)||this.addChild(e),this.requestRender()},t.prototype.addChild=function(t){var i=e.prototype.addChild.call(this,t);return this.layer.labelingInfo&&this._layerView&&this._layerView.view.labelManager.addTile(this.layer.uid,t),this._buildHLList(),i},t.prototype.removeChild=function(t){var i=e.prototype.removeChild.call(this,t);return this.layer.labelingInfo&&this._layerView&&this._layerView.view.labelManager.removeTile(this.layer.uid,t.key.id),this._buildHLList(),i},t.prototype.prepareChildrenRenderParameters=function(e){this._rendererInfo.updateVisualVariables(this._visualVariablesInfo.vvRanges,e.state);var t=this.tileInfoView.getClosestInfoForScale(e.state.scale).level,r=this.tileInfoView.tileInfo.scaleToZoom(e.state.scale);return i({},e,{rendererInfo:this._rendererInfo,requiredLevel:t,displayLevel:r})},t.prototype.renderChildren=function(e){var t=this,i=e.painter;i.bindTextureManager(this.textureManager),this._rendererInfo.updateVisualVariables(this._visualVariablesInfo.vvRanges,e.state),this.sortChildren(function(e,t){return e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col});var r=_.default.toWGLDrawPhases(e.drawPhase);if(r.length>0&&r[0]===c.WGLDrawPhase.LABEL||r[0]===c.WGLDrawPhase.LABEL_ALPHA){var n=this.layer;if(!(n.labelsVisible&&n.labelingInfo&&n.labelingInfo.length>0))return;this._updateTilesTransform(e.state,e.requiredLevel),i.update(e.state,e.pixelRatio)}i.draw(e,this.children,r,this._painterOptions),this._highlightIDs.size>0&&i.highlight(e,this.children),0!==this._pointToCallbacks.size&&(this._pointToCallbacks.forEach(function(i,r){i.resolve(t._hitTest(e,r[0],r[1]))}),this._pointToCallbacks.clear())},t.prototype.attachChild=function(e,t){return e.attach(t)},t.prototype.detachChild=function(e,t){e.detach(t)},t.prototype.renderChild=function(e,t){e.doRender(t)},t.prototype.beforeRenderChildren=function(e,t){this._updateTilesTransform(e.state,this.tileInfoView.getClosestInfoForScale(e.state.scale).level),this._updateHighlightOptions(),this._stage.opacity=this._container.opacity},t.prototype._hitTest=function(e,t,i){var r=e.painter,n=e.requiredLevel,o=[0,0];e.state.toMap(o,[t,i]);var a=e.state.clone(),s=a.viewpoint.clone();return s.targetGeometry=new l(o[0],o[1],e.state.spatialReference),a.viewpoint=s,a.size=[v.C_HITTEST_SEARCH_SIZE,v.C_HITTEST_SEARCH_SIZE],this._updateTilesTransform(a,n),r.update(a,e.pixelRatio),r.hitTest({context:e.context,drawPhase:c.WGLDrawPhase.HITTEST,painter:r,pixelRatio:e.pixelRatio,displayLevel:e.displayLevel,rendererInfo:this._rendererInfo,requiredLevel:n,state:a,stationary:e.stationary},this.children)},t.prototype._updateTilesTransform=function(e,t){var i=1/e.width,r=1/e.height,n=[0,0];this._calculateRelativeViewProjMat(this.tileInfoView.tileInfo.lods[t].resolution,e.resolution,e.rotation,this.tileInfoView.tileInfo.size[0],e.width,e.height,this._defaultTransform);for(var o=0,a=this.children;o<a.length;o++){var s=a[o];e.toScreen(n,s.coords),n[1]=e.height-n[1],s.tileTransform.displayCoord[0]=2*n[0]*i-1,s.tileTransform.displayCoord[1]=2*n[1]*r-1,s.key.level===t?s.tileTransform.transform.set(this._defaultTransform):this._calculateRelativeViewProjMat(this.tileInfoView.tileInfo.lods[s.key.level].resolution,e.resolution,e.rotation,this.tileInfoView.tileInfo.size[0],e.width,e.height,s.tileTransform.transform)}},t.prototype._calculateRelativeViewProjMat=function(e,t,i,r,n,o,s){var l=e/t;this._tileCoordinateScale.set([l,l,1]),n===this._displayWidth&&o===this._displayHeight||(this._displayScale.set([2/n,-2/o,1]),this._displayWidth=n,this._displayHeight=o),a.identity(s),a.scale(s,s,this._tileCoordinateScale),a.rotate(s,s,-i*f.C_DEG_TO_RAD,this._orientationVec),a.scale(s,s,this._displayScale),a.transpose(s,s)},t.prototype._updateHighlightOptions=function(){if(!this._highlightOptionsUpToDate&&this.parent){var e=this.parent.glPainter,t=this._highlightOptions;if(e){var i=t.color.toRgba();i[0]/=255,i[1]/=255,i[2]/=255;var r=i.slice();i[3]*=t.fillOpacity,r[3]*=t.haloOpacity,e.setHighlightOptions({fillColor:i,outlineColor:r,outlineWidth:2,outerHaloWidth:.3,innerHaloWidth:.3,outlinePosition:0})}}},t.prototype._buildHLList=function(){for(var e=0,t=this.children;e<t.length;e++)t[e].buildHLList(this._highlightIDs);this.requestRender()},t}(u);t.default=g}.apply(null,r))||(e.exports=n)},2344:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2345),i(2346),i(2347),i(1527),i(1894),i(1800),i(1649),i(2348),i(1815),i(2349),i(1665),i(1735)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,h,d,c,f){function p(e,t){var i={};for(var r in e){var n={data:new Uint32Array(t*e[r]/4),stride:e[r]};i[r]=n}return i}var v=new i.default,_=new i.default;return function(){function e(){this.tileDisplayData=null,this.tileBufferData=null}return e.prototype.reshuffle=function(){v.reset();var t=this._collectDisplayRecords();for(var i in t)for(var n=0,s=S=t[i];n<s.length;n++){var l=s[n];v.needMore(l.geometryType,l.meshData?l.meshData.vertexCount:l.vertexCount,l.meshData?l.meshData.indexData.length:l.indexCount)}var u=t.length,h=new r;for(i=0;i<u;++i){h.geometries[i].indexBuffer=new Uint32Array(Math.round(1.15*v.indicesFor(i)));var d=[];for(var c in this.tileBufferData.geometries[i].vertexBuffer)d.push(this.tileBufferData.geometries[i].vertexBuffer[c].stride);var f=e._computeVertexAlignment(d),p=Math.round(1.15*v.verticesFor(i)),m=e._align(p,f);for(var g in this.tileBufferData.geometries[i].vertexBuffer){var y=this.tileBufferData.geometries[i].vertexBuffer[g].stride,x=Math.round(m*y/4);h.geometries[i].vertexBuffer[g]={stride:y,data:new Uint32Array(x)}}}_.reset(),this.tileDisplayData.displayList=new a;for(i=0;i<u;++i){for(var S,V=0,I=S=t[i];V<I.length;V++){if((l=I[V]).meshData)l.writeMeshDataToBuffers(_.verticesFor(i),h.geometries[i].vertexBuffer,_.indicesFor(i),h.geometries[i].indexBuffer),l.meshData=null;else{var b=this.tileBufferData.geometries[i].vertexBuffer,w=this.tileBufferData.geometries[i].indexBuffer,M=h.geometries[i].vertexBuffer,T=h.geometries[i].indexBuffer,E=_.verticesFor(i),L=_.indicesFor(i);o.copyMeshData(E,L,M,T,l,b,w),l.vertexFrom=E,l.indexFrom=L}_.needMore(i,l.vertexCount,l.indexCount)}this.tileDisplayData.displayList.addToList(S)}this.tileBufferData=h},e.prototype.getStrides=function(){for(var e=[],t=0;t<this.tileBufferData.geometries.length;++t){var i=this.tileBufferData.geometries[t];for(var r in e[t]={},i.vertexBuffer)e[t][r]=i.vertexBuffer[r].stride}return e},e.prototype._guessSize=function(){for(var e=this.tileDisplayData.displayObjects,t=Math.min(e.length,4),i=0,r=0;r<t;r++)i=Math.max(i,e[r].displayRecords.length);return 2*(12*e.length+e.length*i*40)},e.prototype.serialize=function(){var e=this.tileBufferData.serialize(),t=this.tileBufferData.getBuffers(),i=this.tileDisplayData.serialize(new f.default(Int32Array,this._guessSize())).buffer();return t.push(i),{result:{displayData:i,bufferData:e},transferList:t}},e.decode=function(t){var i=h.MaterialStore.deserialize(new d.default(t.materialStore)),o=c.deserializeList(new d.default(t.displayObjects),s,{store:i}),a={};for(var l in t.vertexBuffersMap)a[l]=u.VertexBuffers.decode(t.vertexBuffersMap[l]);var f=new e,p=new n,v=new r;for(var _ in p.displayObjects=o,a){var m=a[_];v.geometries[_].indexBuffer=m.indexBuffer,v.geometries[_].vertexBuffer=m.namedBuffers}return f.tileDisplayData=p,f.tileBufferData=v,f},e.bind=function(t,i){var r=new e;return r.tileDisplayData=t,r.tileBufferData=i,r},e.create=function(t,i){var o=new e;o.tileDisplayData=new n,o.tileDisplayData.displayObjects=t;for(var a=[0,0,0,0,0],s=[0,0,0,0,0],u=[[],[],[],[],[]],h=0,d=t;h<d.length;h++)for(var c=0,f=d[h].displayRecords;c<f.length;c++){var v=f[c];u[v.geometryType].push(v),a[v.geometryType]+=v.meshData.vertexCount,s[v.geometryType]+=v.meshData.indexData.length}for(var _=new r,m=function(e){return[e.fill||{},e.line||{},e.icon||{},e.text||{},e.label||{}]}(i),g=0;g<5;g++){var y=new Uint32Array(s[g]),x=p(m[g],a[g]);l.writeAllMeshDataToBuffers(u[g],x,y),_.geometries[g]={indexBuffer:y,vertexBuffer:x}}return o.tileBufferData=_,o},e._align=function(e,t){var i=e%t;return 0===i?e:e+(t-i)},e._computeVertexAlignment=function(e){for(var t=!1,i=!1,r=0,n=e;r<n.length;r++){var o=n[r];o%4==2?t=!0:o%4!=0&&(i=!0)}return i?4:t?2:1},e.prototype._collectDisplayRecords=function(){for(var e=[[],[],[],[],[]],t=0,i=this.tileDisplayData.displayObjects;t<i.length;t++)for(var r=0,n=i[t].displayRecords;r<n.length;r++){var o=n[r];e[o.geometryType].push(o)}return e},e}()}.apply(null,r))||(e.exports=n)},2345:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._byGeometryType=null}return Object.defineProperty(e.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._byGeometryType=null},e.prototype.verticesFor=function(e){return this._byGeometryType?this._byGeometryType[e].vertices:0},e.prototype.indicesFor=function(e){return this._byGeometryType?this._byGeometryType[e].indices:0},e.prototype.needMore=function(e,t,i){if(t||i){this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]);var r=this._byGeometryType[e];r.vertices+=t,r.indices+=i}},e}();t.default=i}.apply(null,r))||(e.exports=n)},2346:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}return e.deserialize=function(t){for(var i=new e,r=0;r<5;++r)for(var n in i.geometries[r].indexBuffer=new Uint32Array(t.geometries[r].indexBuffer),i.geometries[r].vertexBuffer={},t.geometries[r].vertexBuffer)i.geometries[r].vertexBuffer[n]={data:new Uint32Array(t.geometries[r].vertexBuffer[n].data),stride:t.geometries[r].vertexBuffer[n].stride};return i},e.prototype.serialize=function(){for(var e={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},t=0;t<5;++t)for(var i in this.geometries[t].vertexBuffer)e.geometries[t].vertexBuffer[i]={data:this.geometries[t].vertexBuffer[i].data.buffer,stride:this.geometries[t].vertexBuffer[i].stride};return e},e.prototype.getBuffers=function(){for(var e=[],t=0;t<5;++t)for(var i in e.push(this.geometries[t].indexBuffer.buffer),this.geometries[t].vertexBuffer)e.push(this.geometries[t].vertexBuffer[i].data.buffer);return e},e}()}.apply(null,r))||(e.exports=n)},2347:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1894),i(1800),i(1815),i(1665)],void 0===(n=function(e,t,i,r,n,o){return function(){function e(){}return Object.defineProperty(e.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var e=0,t=this.displayObjects;e<t.length;e++){var i=t[e];this._displayObjectRegistry.set(i.id,i)}}return this._displayObjectRegistry},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayList",{get:function(){if(!this._displayList){this._displayList=new i;for(var e=0,t=this.displayObjects;e<t.length;e++)for(var r=0,n=t[e].displayRecords;r<n.length;r++){var o=n[r];this._displayList.addToList(o)}}return this._displayList},set:function(e){this._displayList=e},enumerable:!0,configurable:!0}),e.prototype.serialize=function(e){return this.materialStore.serialize(e),o.serializeList(e,this.displayObjects),e},e.prototype._deserializeObjects=function(e){for(var t=e.readInt32(),n=new Array(t),o=new i,a=new Map,s={store:this.materialStore},l=0;l<n.length;++l){var u=r.deserialize(e,s);n[l]=u,a.set(u.id,u);for(var h=0,d=u.displayRecords;h<d.length;h++){var c=d[h];o.addToList(c)}}this.displayObjects=n,this._displayList=o,this._displayObjectRegistry=a},e.deserialize=function(t){var i=new e;return i.materialStore=n.MaterialStore.deserialize(t),i._deserializeObjects(t),i},e}()}.apply(null,r))||(e.exports=n)},2348:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i){this.data=e,this.stride=t,this.vertexCount=i}return e.decode=function(t){return new e(new Uint32Array(t.data),t.stride,t.vertexCount)},e}();t.default=i;var r=function(){function e(e,t,i){this.geometryType=e,this.indexBuffer=new Uint32Array(t),this.namedBuffers=i}return e.decode=function(t){var r=t.geometryType,n=t.indexBuffer,o={};for(var a in t.namedBuffers)o[a]=i.decode(t.namedBuffers[a]);return new e(r,n,o)},e}();t.VertexBuffers=r}.apply(null,r))||(e.exports=n)},2349:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._pos=0,this._buffer=e,this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer)}return e.prototype.readInt32=function(){return this._i32View[this._pos++]},e.prototype.readF32=function(){return this._f32View[this._pos++]},e}();t.default=i}.apply(null,r))||(e.exports=n)},2350:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(50),i(8),i(9),i(7),i(2351),i(1817),i(2353),i(2354),i(1950),i(2355),i(1527),i(1525)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,h,d,c,f){var p=n.getLogger("esri.views.2d.engine.webgl.TextureManager");return function(){function e(){this._invalidFontsMap=new Map,this._spriteMosaic=new d(1024,1024,250),this._glyphSource=new u(i.fontsUrl+"/{fontstack}/{range}.pbf"),this._glyphMosaic=new l(1024,1024,this._glyphSource)}return Object.defineProperty(e.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glyphs",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._spriteMosaic.dispose(),this._glyphMosaic.dispose(),this._rasterizationCanvas=null},e.prototype.rasterizeItem=function(e,t){return void 0===t&&(t=null),e?e.type&&-1!==e.type.toLowerCase().indexOf("3d")?(p.error(new r("mapview-invalid-type","MapView does not support 3d symbol type: "+e.type,e)),o.resolve({glyphMosaicItems:[],spriteMosaicItem:null})):!e.type||"text"!==e.type&&"esriTS"!==e.type?this._rasterizeSpriteSymbol(e).then(function(e){return{spriteMosaicItem:e}}):this._rasterizeTextSymbol(e,t).then(function(e){return{glyphMosaicItems:e}}):(p.error(new r("mapview-null-resource","Unable to rasterize null resource")),o.resolve(null))},e.prototype.bindSpritePage=function(e,t,i,r){r||(r=9729),this._spriteMosaic.bind(e,r,t,i)},e.prototype.bindGlyphsPage=function(e,t,i){this._glyphMosaic.bind(e,9729,t,i)},e.prototype._rasterizeTextSymbol=function(e,t){var i=this,n=s.getFullyQualifiedFontName(e.font),o=this._invalidFontsMap.has(n);return this._glyphMosaic.getGlyphItems(o?"arial-unicode-ms-regular":n,t).catch(function(e){return p.error(new r("mapview-invalid-resource","Couldn't find font "+n+". Falling back to Arial Unicode MS Regular")),i._invalidFontsMap.set(n,!0),i._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",t)})},e.prototype._rasterizeSpriteSymbol=function(e){var t=this;if(e&&(c.isFillSymbol(e)||c.isLineSymbol(e))&&"style"in e&&("solid"===e.style||"esriSFSSolid"===e.style||"esriSLSSolid"===e.style||"none"===e.style||"esriSFSNull"===e.style||"esriSLSNull"===e.style))return o.resolve(null);var i=function(e){if(e.type){switch(c.normalizeSymbolType(e.type)){case"simple-marker":return"simple-marker"+e.style;case"simple-line":return"simple-line"+e.style}if(c.isPictureSymbol(e))return e.url?e.url:e.imageData+""+e.width+e.height}return JSON.stringify(e)}(e);if(this._spriteMosaic.has(i))return o.resolve(this._spriteMosaic.getSpriteItem(i));if(e.url||e.imageData){var r=e.imageData?"data:"+e.contentType+";base64,"+e.imageData:e.url;return f.requestImage(r).then(function(r){var n=t._rasterizeResource(r);return t._addItemToMosaic(i,n.size,n.anchor,n.image,!c.isMarkerSymbol(e),n.sdf)})}var n=this._rasterizeResource(e);return o.resolve(this._addItemToMosaic(i,n.size,n.anchor,n.image,!c.isMarkerSymbol(e),n.sdf))},e.prototype._rasterizeResource=function(e){if(e instanceof HTMLImageElement){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));var t=e;this._rasterizationCanvas.width=t.width,this._rasterizationCanvas.height=t.height;var i=this._rasterizationCanvas.getContext("2d");i.drawImage(t,0,0,t.width,t.height);for(var r=i.getImageData(0,0,t.width,t.height),n=new Uint8Array(r.data),o=void 0,a=0;a<n.length;a+=4)o=n[a+3]/255,n[a]=n[a]*o,n[a+1]=n[a+1]*o,n[a+2]=n[a+2]*o;return{size:[t.width,t.height],anchor:[0,0],image:new Uint32Array(n.buffer),sdf:!1}}return this._rasterizeJSON(e)},e.prototype._addItemToMosaic=function(e,t,i,r,n,o){return this._spriteMosaic.addSpriteItem(e,t,i,r,n,o)},e.prototype._rasterizeJSON=function(e){if(this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),"simple-fill"===e.type||"esriSFS"===e.type){var t=a.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,e.style),i=t[0];return{size:[t[1],t[2]],anchor:[0,0],image:new Uint32Array(i.buffer),sdf:!1}}if("simple-line"===e.type||"esriSLS"===e.type){var r=a.SymbolHelper.rasterizeSimpleLine(this._rasterizationCanvas,e.style);i=r[0];return{size:[r[1],r[2]],anchor:[0,0],image:new Uint32Array(i.buffer),sdf:!0}}var n,o;if("simple-marker"===e.type||"esriSMS"===e.type?(n=a.CIMSymbolHelper.fromSimpleMarker(e),o=!0):(n=e,o=h.SDFHelper.checkSDF(n)),o){var s=(new h.SDFHelper).buildSDF(n);i=s[0];return{size:[s[1],s[2]],anchor:[0,0],image:new Uint32Array(i.buffer),sdf:!0}}var l=a.CIMSymbolHelper.rasterize(this._rasterizationCanvas,n);i=l[0];return{size:[l[1],l[2]],anchor:[l[3],l[4]],image:new Uint32Array(i.buffer),sdf:!1}},e}()}.apply(null,r))||(e.exports=n)},2351:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(9),i(2352),i(1950),i(254)],void 0===(n=function(e,t,i,r,n,o){Object.defineProperty(t,"__esModule",{value:!0});var a=i.getLogger("esri/views/2d/engine/webgl/CIMSymbolHelper"),s=function(){function e(){}return e.getEnvelope=function(e){if("CIMPointSymbol"!==e.type)return null;var t=new r.EnvDrawHelper;return t.drawSymbol(e,{type:"point",x:0,y:0}),t.envelope()},e.rasterize=function(e,t){var i=this.getEnvelope(t);if(!i||i.width<=0||i.height<=0)return[null,0,0,0,0];var n=(i.x+.5*i.width)*(96/72),o=-(i.y+.5*i.height)*(96/72);e.width=i.width*(96/72)+2,e.height=i.height*(96/72)+2;var a=e.getContext("2d"),s=r.Transformation.createScale(96/72,-96/72);s.translate(.5*e.width-n,.5*e.height-o);new r.CanvasDrawHelper(a,s).drawSymbol(t,{type:"point",x:0,y:0});for(var l,u=a.getImageData(0,0,e.width,e.height),h=new Uint8Array(u.data),d=0;d<h.length;d+=4)l=h[d+3]/255,h[d]=h[d]*l,h[d+1]=h[d+1]*l,h[d+2]=h[d+2]*l;return[h,e.width,e.height,n/e.width,o/e.height]},e.fromSimpleMarker=function(e){var t,i,r,n=e.style;if("circle"===n||"esriSMSCircle"===n){var a=Math.acos(.995),s=Math.ceil(o.C_PI/a/4);0===s&&(s=1),a=o.C_PI_BY_2/s,s*=4;var l=[];l.push([50,0]);for(var u=1;u<s;u++)l.push([50*Math.cos(u*a),-50*Math.sin(u*a)]);l.push([50,0]),t={rings:[l]},i={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===n||"esriSMSCross"===n){t={rings:[[[h=0,50],[h,h],[50,h],[50,-h],[h,-h],[h,-50],[-h,-50],[-h,-h],[-50,-h],[-50,h],[-h,h],[-h,50],[h,50]]]},i={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("diamond"===n||"esriSMSDiamond"===n)t={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},i={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("square"===n||"esriSMSSquare"===n)t={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},i={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===n||"esriSMSX"===n){var h;t={rings:[[[0,h=0],[50-h,50],[50,50-h],[h,0],[50,h-50],[50-h,-50],[0,-h],[h-50,-50],[-50,h-50],[-h,0],[-50,50-h],[h-50,50],[0,h]]]},i={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("triangle"===n||"esriSMSTriangle"===n){var d=57.735026918962575,c=-d,f=2/3*100-100;t={rings:[[[c,f],[0,2/3*100],[d,f],[c,f]]]},i={xmin:c,ymin:f,xmax:d,ymax:2/3*100}}if(t&&i){var p=[{type:"CIMSolidFill",enable:!0,color:e.color}];e.outline&&p.push({type:"CIMSolidStroke",enable:!0,width:e.outline.width,color:e.outline.color});var v={type:"CIMPolygonSymbol",symbolLayers:p};r={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:e.angle,size:e.size,offsetX:e.xoffset,offsetY:e.yoffset,frame:i,markerGraphics:[{type:"CIMMarkerGraphic",geometry:t,symbol:v}]}]}}return r},e}();t.CIMSymbolHelper=s;var l=function(){function e(){}return e.rasterizeSimpleFill=function(e,t){"solid"!==t&&"none"!==t&&"esriSFSSolid"!==t&&"esriSFSNull"!==t||console.error("Unexpected: style does not require rasterization"),e.width=8,e.height=8;var i=e.getContext("2d");i.strokeStyle="#FFFFFF",i.beginPath(),"vertical"!==t&&"cross"!==t&&"esriSFSCross"!==t&&"esriSFSVertical"!==t||(i.moveTo(0,0),i.lineTo(0,8)),"horizontal"!==t&&"cross"!==t&&"esriSFSCross"!==t&&"esriSFSHorizontal"!==t||(i.moveTo(0,0),i.lineTo(8,0)),"forward-diagonal"!==t&&"diagonal-cross"!==t&&"esriSFSDiagonalCross"!==t&&"esriSFSForwardDiagonal"!==t||(i.moveTo(0,0),i.lineTo(8,8)),"backward-diagonal"!==t&&"diagonal-cross"!==t&&"esriSFSBackwardDiagonal"!==t&&"esriSFSDiagonalCross"!==t||(i.moveTo(8,0),i.lineTo(0,8)),i.stroke();for(var r,n=i.getImageData(0,0,e.width,e.height),o=new Uint8Array(n.data),a=0;a<o.length;a+=4)r=o[a+3]/255,o[a]=o[a]*r,o[a+1]=o[a+1]*r,o[a+2]=o[a+2]*r;return[o,e.width,e.height]},e.rasterizeSimpleLine=function(e,t){var i;switch(t){case"dash":case"esriSLSDash":i=[3,2];break;case"dash-dot":case"esriSLSDashDot":i=[2,2,0,2];break;case"dot":case"esriSLSDot":i=[0,3];break;case"long-dash":case"esriSLSLongDash":i=[6,3];break;case"long-dash-dot":case"esriSLSLongDashDot":i=[6,3,0,3];break;case"long-dash-dot-dot":case"esriSLSDashDotDot":i=[2,2,0,2,0,2];break;case"short-dash":case"esriSLSShortDash":i=[2,2];break;case"short-dash-dot":case"esriSLSShortDashDot":i=[2,2,0,2];break;case"short-dash-dot-dot":case"esriSLSShortDashDotDot":i=[2,2,0,2,0,2];break;case"short-dot":case"esriSLSShortDot":i=[0,2];break;case"solid":case"esriSLSSolid":case"none":a.error("Unexpected: style does not require rasterization"),i=[0,0];break;default:a.error("Tried to rasterize SLS, but found an unexpected style: "+t+"!"),i=[0,0]}for(var r=0,o=0,s=i;o<s.length;o++){r+=s[o]}for(var l=16*r,u=31*l,h=new Float32Array(u),d=0;d<u;++d)h[d]=257;for(var c=.5,f=.5,p=!0,v=0,_=i;v<_.length;v++){c=f,f+=16*_[v];for(var m=c;m<f;){for(var g=.5;g<31;){var y=(g-15.5)*(g-15.5);h[d=(31-g+.5+1)*l+m-.5]=p?y:Math.min((m-c)*(m-c)+y,(m-f)*(m-f)+y),g++}m++}p=!p}var x=h.length,S=new Uint8Array(4*x);for(d=0;d<x;++d){var V=Math.sqrt(h[d])/15;n.packFloat(V,S,4*d)}return[S,l,31]},e}();t.SymbolHelper=l}.apply(null,r))||(e.exports=n)},2352:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(0),i(1667),i(1698)],void 0===(n=function(e,t,i,r,n,o){Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e){this._t=e}return e.createIdentity=function(){return new e([1,0,0,0,1,0])},e.prototype.clone=function(){return new e(this._t.slice())},e.prototype.transform=function(e){var t=this._t;return[t[0]*e[0]+t[1]*e[1]+t[2],t[3]*e[0]+t[4]*e[1]+t[5]]},e.createScale=function(t,i){return new e([t,0,0,0,i,0])},e.prototype.scale=function(e,t){var i=this._t;return i[0]*=e,i[1]*=e,i[2]*=e,i[3]*=t,i[4]*=t,i[5]*=t,this},e.prototype.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])},e.createTranslate=function(t,i){return new e([0,0,t,0,0,i])},e.prototype.translate=function(e,t){var i=this._t;return i[2]+=e,i[5]+=t,this},e.createRotate=function(t){var i=Math.cos(t),r=Math.sin(t);return new e([i,-r,0,r,i,0])},e.prototype.rotate=function(t){return this.multiply(e.createRotate(t))},e.prototype.multiply=function(e){var t=this._t,i=e._t,r=t[0]*i[0]+t[3]*i[1],n=t[1]*i[0]+t[4]*i[1],o=t[2]*i[0]+t[5]*i[1]+i[2],a=t[0]*i[3]+t[3]*i[4],s=t[1]*i[3]+t[4]*i[4],l=t[2]*i[3]+t[5]*i[4]+i[5];return t[0]=r,t[1]=n,t[2]=o,t[3]=a,t[4]=s,t[5]=l,this},e}();t.Transformation=a;var s=function(){function e(e){this._transfos=[],this._sizeTransfos=[],this._transfos.push(e||a.createIdentity()),this._sizeTransfos.push(e?e.scaleRatio():1)}return e.prototype.transformPt=function(e){return this._transfos[this._transfos.length-1].transform(e)},e.prototype.transformSize=function(e){return e*this._sizeTransfos[this._sizeTransfos.length-1]},e.prototype.back=function(){return this._transfos[this._transfos.length-1]},e.prototype.push=function(e){var t=e.scaleRatio();e.multiply(this.back()),this._transfos.push(e),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*t)},e.prototype.pop=function(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)},e.prototype.drawSolidFill=function(e,t){},e.prototype.drawSolidStroke=function(e,t,i){},e.prototype.drawSymbol=function(e,t){if(e)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(e,t)}},e.prototype.drawMultiLayerSymbol=function(e,t){if(e){var i=e.symbolLayers;if(i)for(var r=i.length;r--;){var n=i[r];if(n&&n.enable)switch(n.type){case"CIMSolidFill":this.drawSolidFill(t,n.color);break;case"CIMSolidStroke":this.drawSolidStroke(t,n.color,n.width);break;case"CIMVectorMarker":this.drawVectorMarker(n,t)}}}},e.prototype.drawVectorMarker=function(e,t){if(e){var i=e.markerGraphics;if(i){var r=e.size,o=e.frame,s=o?o.ymax-o.ymin:0,l=r&&s?r/s:1,u=a.createIdentity();o&&u.translate(.5*-(o.xmax+o.xmin),.5*-(o.ymax+o.ymin));var h=e.anchorPt;if(h){var d=h.x,c=h.y;"relative"===e.anchorPtUnits&&o&&(d*=(o.xmax-o.xmin)*l,c*=r),u.translate(-d,-c)}1!==l&&u.scale(l,l),e.rotation&&u.rotate(e.rotation*n.C_DEG_TO_RAD),u.translate(e.offsetX||0,e.offsetY||0),u.translate(t.x,t.y),this.push(u);for(var f=0,p=i;f<p.length;f++){var v=p[f];v&&this.drawSymbol(v.symbol,v.geometry)}this.pop()}}},e}();t.CIMSymbolDrawHelper=s;var l=function(e){function t(){var t=e.call(this)||this;return t._xmin=t._ymin=1/0,t._xmax=t._ymax=-1/0,t}return i(t,e),t.prototype.envelope=function(){return new o(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)},t.prototype._merge=function(e,t){e[0]-t<this._xmin&&(this._xmin=e[0]-t),e[0]+t>this._xmax&&(this._xmax=e[0]+t),e[1]-t<this._ymin&&(this._ymin=e[1]-t),e[1]+t>this._ymax&&(this._ymax=e[1]+t)},t.prototype.drawSolidFill=function(e,t){for(var i=0,r=e.rings;i<r.length;i++){var n=r[i],o=n?n.length:0;if(o>2){this._merge(this.transformPt(n[0]),0);for(var a=1;a<o;++a)this._merge(this.transformPt(n[a]),0)}}},t.prototype.drawSolidStroke=function(e,t,i){for(var r=.5*this.transformSize(i),n=0,o=e.rings||e.paths;n<o.length;n++){var a=o[n],s=a?a.length:0;if(s>1){this._merge(this.transformPt(a[0]),r);for(var l=1;l<s;++l)this._merge(this.transformPt(a[l]),r)}}},t}(s);t.EnvDrawHelper=l;var u=function(e){function t(t,i){var r=e.call(this,i)||this;return r._ctx=t,r}return i(t,e),t.prototype.drawSolidFill=function(e,t){var i=this._ctx;i.fillStyle="rgba("+Math.round(t[0])+","+Math.round(t[1])+","+Math.round(t[2])+","+t[3]/255+")",i.beginPath();for(var r=0,n=e.rings;r<n.length;r++){var o=n[r],a=o?o.length:0;if(a>2){var s=this.transformPt(o[0]);i.moveTo(s[0],s[1]);for(var l=1;l<a;++l)s=this.transformPt(o[l]),i.lineTo(s[0],s[1]);i.closePath()}}i.fill("evenodd")},t.prototype.drawSolidStroke=function(e,t,i){var r=this._ctx;r.strokeStyle="rgba("+Math.round(t[0])+","+Math.round(t[1])+","+Math.round(t[2])+","+t[3]/255+")",r.lineWidth=this.transformSize(i)+.5,r.beginPath();for(var n=!!e.rings,o=0,a=e.rings||e.paths;o<a.length;o++){var s=a[o],l=s?s.length:0;if(l>1){var u=this.transformPt(s[0]);r.moveTo(u[0],u[1]);for(var h=1;h<l;++h)u=this.transformPt(s[h]),r.lineTo(u[0],u[1]);n&&r.closePath()}}r.stroke()},t}(s);t.CanvasDrawHelper=u}.apply(null,r))||(e.exports=n)},2353:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(11),i(84),i(1698),i(1951),i(1493)],void 0===(n=function(e,t,i,r,n,o,a){var s;return i("stable-symbol-rendering")&&(s=new Set),function(){function e(e,t,i){this.width=0,this.height=0,this._dirties=[],this._glyphData=[],this._currentPage=0,this._glyphIndex={},this._textures=[],this._rangePromises=new Map,(e<=0||t<=0)&&console.error("Glyph mosaic width and height must be greater than zero!"),this.width=e,this.height=t,this._glyphSource=i,this._binPack=new o(e-4,t-4),this._glyphData.push(new Uint8Array(e*t)),this._dirties.push(!0),this._textures.push(void 0),this._addDecorationGlyph()}return e.prototype.getGlyphItems=function(e,t){for(var n=this,o=[],a=this._glyphSource,l=new Set,u=0,h=t;u<h.length;u++){var d=h[u],c=Math.floor(d*(1/256));l.add(c)}var f=[];return l.forEach(function(t){if(t<=256){var i=e+t;if(n._rangePromises.has(i))f.push(n._rangePromises.get(i));else{var r=a.getRange(e,t).then(function(){n._rangePromises.delete(i)}).catch(function(){throw n._rangePromises.delete(i),Error("Unable to query resource")});n._rangePromises.set(i,r),f.push(r)}}}),r(f).then(function(r){var u,h=n._glyphIndex[e];if(h||(h={},n._glyphIndex[e]=h),i("stable-symbol-rendering")){s.clear();for(var d=0,c=t;d<c.length;d++){var f=c[d];s.add(f)}var p=[];l.forEach(function(e){p.push(e)}),p.sort(),u=[];for(var v=0,_=p;v<_.length;v++)for(var m=_[v],g=0;g<256;++g)u.push(256*m+g)}else u=t;for(var y=0,x=u;y<x.length;y++){var S=h[f=x[y]];if(S)i("stable-symbol-rendering")&&!s.has(f)||(o[f]={rect:S.rect,metrics:S.metrics,page:S.page});else{var V=a.getGlyph(e,f);if(V&&V.metrics){var I=n._recordGlyph(V,f);h[f]={rect:I,metrics:V.metrics,tileIDs:null,page:n._currentPage},i("stable-symbol-rendering")&&!s.has(f)||(o[f]={rect:I,metrics:V.metrics,page:n._currentPage}),n._dirties[n._currentPage]=!0}}}return o})},e.prototype._recordGlyph=function(e,t){var i,r=e.metrics;if(0===r.width)i=new n(0,0,0,0);else{var a=r.width+6,s=r.height+6,l=a%4?4-a%4:4,u=s%4?4-s%4:4;1===l&&(l=5),1===u&&(u=5),(i=this._binPack.allocate(a+l,s+u)).isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(void 0),this._binPack=new o(this.width-4,this.height-4),i=this._binPack.allocate(a+l,s+u));var h=this._glyphData[this._currentPage],d=e.bitmap,c=void 0,f=void 0;if(d)for(var p=0;p<s;p++){c=a*p,f=this.width*(i.y+p+1)+i.x;for(var v=0;v<a;v++)h[f+v+1]=d[c+v]}}return i},e.prototype._addDecorationGlyph=function(){for(var e=[117,149,181,207,207,181,149,117],t=[],i=0;i<e.length;i++)for(var r=e[i],n=0;n<11;n++)t.push(r);var o={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(t)};this._recordGlyph(o,0)},e.prototype.bind=function(e,t,i,r){this._textures[i]||(this._textures[i]=new a(e,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));var n=this._textures[i];n.setSamplingMode(t),this._dirties[i]&&n.setData(this._glyphData[i]),e.bindTexture(n,r),this._dirties[i]=!1},e.prototype.dispose=function(){this._binPack=null;for(var e=0,t=this._textures;e<t.length;e++){var i=t[e];i&&i.dispose()}this._textures.length=0,this._glyphData.length=0},e}()}.apply(null,r))||(e.exports=n)},2354:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(21),i(511),i(7)],void 0===(n=function(e,t,i,r,n){var o=function(){function e(e){for(this._metrics=[],this._bitmaps=[];e.next();)switch(e.tag()){case 1:for(var t=e.getMessage();t.next();)switch(t.tag()){case 3:for(var i=t.getMessage(),r=void 0,n=void 0,o=void 0,a=void 0,s=void 0,l=void 0,u=void 0;i.next();)switch(i.tag()){case 1:r=i.getUInt32();break;case 2:n=i.getBytes();break;case 3:o=i.getUInt32();break;case 4:a=i.getUInt32();break;case 5:s=i.getSInt32();break;case 6:l=i.getSInt32();break;case 7:u=i.getUInt32();break;default:i.skip()}r&&(this._metrics[r]={width:o,height:a,left:s,top:l,advance:u},this._bitmaps[r]=n);break;default:t.skip()}break;default:e.skip()}}return e.prototype.getMetrics=function(e){return this._metrics[e]},e.prototype.getBitmap=function(e){return this._bitmaps[e]},e}(),a=function(){function e(){this._ranges=[]}return e.prototype.getRange=function(e){return this._ranges[e]},e.prototype.addRange=function(e,t){this._ranges[e]=t},e}();return function(){function e(e){this._glyphInfo={},this._baseURL=e}return e.prototype.getRange=function(e,t){var a=this._getFontStack(e);if(a.getRange(t))return n.resolve();var s=256*t,l=s+255,u=this._baseURL.replace("{fontstack}",e).replace("{range}",s+"-"+l);return i(u,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(e){a.addRange(t,new o(new r(new Uint8Array(e.data),new DataView(e.data))))})},e.prototype.getGlyph=function(e,t){var i=this._getFontStack(e);if(i){var r=Math.floor(t/256);if(!(r>256)){var n=i.getRange(r);if(n)return{metrics:n.getMetrics(t),bitmap:n.getBitmap(t)}}}},e.prototype._getFontStack=function(e){var t=this._glyphInfo[e];return t||(t=this._glyphInfo[e]=new a),t},e}()}.apply(null,r))||(e.exports=n)},2355:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1667),i(1698),i(1951),i(1493)],void 0===(n=function(e,t,i,r,n,o){return function(){function e(e,t,i){void 0===i&&(i=0),this._size=[],this._mosaicsData=[],this._textures=[],this._dirties=[],this._maxItemSize=0,this._currentPage=0,this._pageWidth=0,this._pageHeight=0,this._mosaicRects=new Map,this._spriteCopyQueue=[],this.pixelRatio=1,(e<=0||t<=0)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!"),this._pageWidth=e,this._pageHeight=t,i>0&&(this._maxItemSize=i),this.pixelRatio=1|window.devicePixelRatio,this._binPack=new n(this._pageWidth,this._pageHeight);var r=Math.floor(this._pageWidth),o=Math.floor(this._pageHeight);this._mosaicsData[0]=new Uint32Array(r*o),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0)}return e.prototype.getWidth=function(e){return e>=this._size.length?-1:this._size[e][0]},e.prototype.getHeight=function(e){return e>=this._size.length?-1:this._size[e][1]},e.prototype.getPage=function(e){return e<this._textures.length?this._textures[e]:null},e.prototype.has=function(e){return this._mosaicRects.has(e)},Object.defineProperty(e.prototype,"itemCount",{get:function(){return this._mosaicRects.size},enumerable:!0,configurable:!0}),e.prototype.getSpriteItem=function(e){return this._mosaicRects.get(e)},e.prototype.addSpriteItem=function(e,t,i,r,n,o){if(this._mosaicRects.has(e))return this._mosaicRects.get(e);var a=this._allocateImage(t[0],t[1]),s=a[0],l=a[1],u=a[2];if(s.width<=0||s.height<=0)return null;var h={rect:s,width:t[0],height:t[1],anchorX:i[0],anchorY:i[1],sdf:o,pixelRatio:1,page:l};return this._mosaicRects.set(e,h),this._copy({rect:s,spriteSize:t,spriteData:r,page:l,pageSize:u,repeat:n,sdf:o}),h},e.prototype.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length},e.prototype.processNextItem=function(){var e=this._spriteCopyQueue.pop();e&&this._copy(e)},e.prototype.getSpriteItems=function(e){for(var t={},i=0,r=e;i<r.length;i++){var n=r[i];t[n]=this.getSpriteItem(n)}return t},e.prototype.getMosaicItemPosition=function(e,t){var i=this.getSpriteItem(e),r=i&&i.rect;if(!r)return null;r.width=i.width,r.height=i.height;var n=i.width,o=i.height;return{size:[i.width,i.height],tl:[(r.x+1)/this._size[i.page][0],(r.y+1)/this._size[i.page][1]],br:[(r.x+1+n)/this._size[i.page][0],(r.y+1+o)/this._size[i.page][1]],page:i.page}},e.prototype.bind=function(e,t,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._textures[i]||(this._textures[i]=new o(e,{pixelFormat:6408,dataType:5121,width:this._size[i][0],height:this._size[i][1]},new Uint8Array(this._mosaicsData[i].buffer)));var n=this._textures[i];n.setSamplingMode(t),this._dirties[i]&&(n.setData(new Uint8Array(this._mosaicsData[i].buffer)),n.generateMipmap()),e.bindTexture(n,r),this._dirties[i]=!1},e._copyBits=function(e,t,i,r,n,o,a,s,l,u,h){var d=r*t+i,c=s*o+a;if(h){c-=o;for(var f=-1;f<=u;d=((++f+u)%u+r)*t+i,c+=o)for(var p=-1;p<=l;p++)n[c+p]=e[d+(p+l)%l]}else for(f=0;f<u;f++){for(p=0;p<l;p++)n[c+p]=e[d+p];d+=t,c+=o}},e.prototype._copy=function(t){if(!(t.page>=this._mosaicsData.length)){var i=t.spriteData,r=this._mosaicsData[t.page];r&&i||console.error("Source or target images are uninitialized!"),e._copyBits(i,t.spriteSize[0],0,0,r,t.pageSize[0],t.rect.x+1,t.rect.y+1,t.spriteSize[0],t.spriteSize[1],t.repeat),this._dirties[t.page]=!0}},e.prototype._allocateImage=function(e,t){e+=2,t+=2;var o=Math.max(e,t);if(this._maxItemSize&&this._maxItemSize<o){var a=Math.pow(2,Math.ceil(i.log2(e))),s=Math.pow(2,Math.ceil(i.log2(t))),l=new r(0,0,e,t);return this._mosaicsData.push(new Uint32Array(a*s)),this._dirties.push(!0),this._size.push([a,s]),this._textures.push(void 0),[l,this._mosaicsData.length-1,[a,s]]}var u=e%4?4-e%4:0,h=t%4?4-t%4:0,d=this._binPack.allocate(e+u,t+h);return d.width<=0?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new n(this._pageWidth,this._pageHeight),this._allocateImage(e,t)):[d,this._currentPage,[this._pageWidth,this._pageHeight]]},e.prototype.dispose=function(){this._binPack=null;for(var e=0,t=this._textures;e<t.length;e++){var i=t[e];i&&i.dispose()}this._textures.length=0,this._mosaicsData.length=0,this._mosaicRects.clear()},e}()}.apply(null,r))||(e.exports=n)},2356:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(32),i(68),i(481),i(1641),i(1527)],void 0===(n=function(e,t,i,r,n,o,a){function s(e,t){var i=t.length;if(e<t[0].value||1===i)return t[0].size;for(var r=1;r<i;r++)if(e<t[r].value){var n=(e-t[r-1].value)/(t[r].value-t[r-1].value);return t[r-1].size+n*(t[r].size-t[r-1].size)}return t[i-1].size}return function(){function e(){this.symbolLevels=[],this.vvColorValues=new Float32Array(8),this.vvColors=new Float32Array(32),this.vvOpacityValues=new Float32Array(8),this.vvOpacities=new Float32Array(8),this.vvSizeMinMaxValue=new Float32Array(4),this.vvSizeFieldStopsValues=new Float32Array(6),this.vvSizeFieldStopsSizes=new Float32Array(6),this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1},this.symbolLevels.push(0)}return Object.defineProperty(e.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heatmapParameters",{get:function(){return this._heatmapParameters},enumerable:!0,configurable:!0}),e.prototype.updateHeatmapParameters=function(e){var t=e.blurRadius,i=Math.round(4.5*e.blurRadius),r=2*i+1;this._heatmapParameters||(this._heatmapParameters={radius:t,blurRadius:i,kernelSize:r,refreshIntensityKernel:!0,intensityKernel:null,color:null,maxPixelIntensity:e.maxPixelIntensity,minPixelIntensity:e.minPixelIntensity});var n=this._heatmapParameters;n.color=function(e){for(var t,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0;n<16;n++){var a=e[Math.min(n,e.length-1)];i[n]=a.ratio,r[0+(t=4*n)]=a.color[0]/255,r[t+1]=a.color[1]/255,r[t+2]=a.color[2]/255,r[t+3]=a.color[3]>1?a.color[3]/255:a.color[3],o.premultiplyAlpha(r,t,!0)}return{values:i,colors:r,refreshColorRamp:!0}}(e.colorStops),Math.abs(n.radius-e.radius)>1e-6&&(n.radius=t,n.blurRadius=i,n.kernelSize=r,n.refreshIntensityKernel=!0),n.maxPixelIntensity=e.maxPixelIntensity,n.minPixelIntensity=e.minPixelIntensity},e.prototype.updateVisualVariables=function(e,t){var o=this._vvMaterialParameters;if(o.vvOpacityEnabled=!1,o.vvSizeEnabled=!1,o.vvColorEnabled=!1,o.vvRotationEnabled=!1,e){var l=e.size;if(l){if(o.vvSizeEnabled=!0,l.minMaxValue){var u=l.minMaxValue,h=void 0,d=void 0;if(a.isDefined(u.minSize)&&a.isDefined(u.maxSize))if(a.isNumber(u.minSize)&&a.isNumber(u.maxSize))h=i.pt2px(u.minSize),d=i.pt2px(u.maxSize);else{var c=t.scale;h=i.pt2px(s(c,u.minSize.stops)),d=i.pt2px(s(c,u.maxSize.stops))}this.vvSizeMinMaxValue.set([u.minDataValue,u.maxDataValue,h,d])}if(l.scaleStops&&(this.vvSizeScaleStopsValue=i.pt2px(s(t.scale,l.scaleStops.stops))),l.unitValue){var f=r.getMetersPerUnitForSR(t.spatialReference)/n.meterIn[l.unitValue.unit];this.vvSizeUnitValueToPixelsRatio=f/t.resolution}l.fieldStops&&(this.vvSizeFieldStopsValues.set(l.fieldStops.values),this.vvSizeFieldStopsSizes.set(l.fieldStops.sizes))}var p=e.color;p&&(o.vvColorEnabled=!0,this.vvColorValues.set(p.values),this.vvColors.set(p.colors));var v=e.opacity;v&&(o.vvOpacityEnabled=!0,this.vvOpacityValues.set(v.values),this.vvOpacities.set(v.opacities));var _=e.rotation;_&&(o.vvRotationEnabled=!0,o.vvRotationType=_.type)}},e}()}.apply(null,r))||(e.exports=n)},2357:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(12),i(496),i(1661),i(483),i(257),i(479),i(2360),i(2358),i(1511),i(1644),i(1527),i(2361),i(1894),i(1536),i(183)],void 0===(n=function(e,t,i,r,n,o,a,s,l,u,h,d,c,f,p,v,_){function m(e,t){return e.sortKey-t.sortKey}return function(e){function t(t,i){var a=e.call(this)||this;return a.status=v.TileStatus.INITIALIZED,a._data=null,a.hlDisplayList=null,a._displayList=null,a._wglBuffers=null,a._dirtyMap=new l.default,a.coords=[0,0],a.bounds=[0,0,0,0],a.tileTransform={transform:Float32Array[16],screenTransform:Float32Array[16],displayCoord:Float32Array[2],screenCoord:Float32Array[2]},a._labelIndex=null,a.tileTransform.screenTransform=r.create(),a.tileTransform.transform=n.create(),a.tileTransform.displayCoord=o.create(),a.tileTransform.screenCoord=o.create(),a.key=_.pool.acquire(t),a.coords[0]=i[0],a.coords[1]=i[3],a.bounds=i,a}return i(t,e),Object.defineProperty(t.prototype,"iconGeometry",{get:function(){return this.getGeometry(h.WGLGeometryType.MARKER)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textGeometry",{get:function(){return this.getGeometry(h.WGLGeometryType.TEXT)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillGeometry",{get:function(){return this.getGeometry(h.WGLGeometryType.FILL)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineGeometry",{get:function(){return this.getGeometry(h.WGLGeometryType.LINE)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelGeometry",{get:function(){return this.getGeometry(h.WGLGeometryType.LABEL)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayObjects",{get:function(){return this._data.tileDisplayData.displayObjects},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canDisplay",{get:function(){return!!this.attached&&!!this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDirty",{get:function(){return this.status===v.TileStatus.MODIFIED},set:function(e){e&&this.status===v.TileStatus.READY?this.setStatus(v.TileStatus.MODIFIED):e||this.status!==v.TileStatus.MODIFIED||this.setStatus(v.TileStatus.READY),this.requestRender()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasData",{get:function(){return this.status===v.TileStatus.MODIFIED||this.status===v.TileStatus.READY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!0,configurable:!0}),t.prototype.getGeometry=function(e){return this._wglBuffers&&this._wglBuffers.has(e)?this._wglBuffers.get(e):null},t.prototype.getDisplayList=function(e){switch(e){case h.WGLDrawPhase.HIGHLIGHT:return this.hlDisplayList;default:return this._data&&this._displayList}},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),t.prototype.setData=function(e,t){if(this.status!==v.TileStatus.INITIALIZED&&this.clear(),!e||!e.tileDisplayData)return this.clear(),void this.setStatus(v.TileStatus.NO_DATA);this._dispRecStore=u.default.fromTileData(e,this._dirtyMap),this._data=e,e.tileBufferData.geometries[4].indexBuffer.length?(this.setStatus(t?v.TileStatus.MODIFIED:v.TileStatus.READY),this._rebuildLabelIndex()):this.setStatus(v.TileStatus.READY),this._dirtyMap.markAllDirty(),this._displayList=e.tileDisplayData.displayList.clone()},t.prototype.patchData=function(e,t){this._patchData(e)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=u.default.fromTileData(this._data,this._dirtyMap)),e.addOrUpdate&&e.addOrUpdate.tileBufferData.geometries[4].indexBuffer.length?(this.setStatus(t?v.TileStatus.MODIFIED:v.TileStatus.READY),this._rebuildLabelIndex()):this.setStatus(v.TileStatus.READY)},t.prototype.commitChanges=function(e){this._data&&this.status===v.TileStatus.READY&&(this._wglBuffers||(this._wglBuffers=new f.default(e.context)),this._displayList=this._data.tileDisplayData.displayList.clone(),this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._dirtyMap.markAllClean())},t.prototype.setVisibility=function(e,t){for(var i=this._data.tileBufferData.geometries.map(function(e){return{vertexFrom:void 0,vertexTo:void 0,geometry:e}}),r=0,n=e;r<n.length;r++)for(var o=n[r],a=0,s=this._data.tileDisplayData.displayObjectRegistry.get(o.id).displayRecords;a<s.length;a++){var l=s[a];if(null==t||t===l.geometryType){var u=(m=i[l.geometryType]).geometry.vertexBuffer[c.C_VBO_VISIBILITY];if(u){m.vertexFrom=null==m.vertexFrom?l.vertexFrom:Math.min(m.vertexFrom,l.vertexFrom),m.vertexTo=null==m.vertexTo?l.vertexFrom+l.vertexCount:Math.max(m.vertexTo,l.vertexFrom+l.vertexCount);for(var h=l.vertexFrom*u.stride/4,d=l.vertexCount*u.stride/4,f=0;f<d;++f)u.data[h+f]=o.visibility?4294967295:0}}}for(var p=!1,_=0;_<i.length;++_){var m;if(null!=(m=i[_]).vertexFrom&&null!=m.vertexTo){var g=m.vertexTo?m.vertexTo-m.vertexFrom:0;this.setStatus(v.TileStatus.MODIFIED),this._dirtyMap.markDirtyVertices(_,c.C_VBO_VISIBILITY,m.vertexFrom,g),p=!0}}p&&this.requestRender()},t.prototype.setVisibilityRange=function(e,t,i,r){for(var n=d.i8888to32(i,r,i,r),o=void 0,a=void 0,s=this._data.tileBufferData.geometries[h.WGLGeometryType.LABEL].vertexBuffer[c.C_VBO_VISIBILITY_RANGE],l=this._data.tileDisplayData.displayObjectRegistry.get(e),u=l.metrics[t],f=u.range.from,p=f+u.range.count,v=f;v<p;++v){var _=l.displayRecords[v];if(_.geometryType===h.WGLGeometryType.LABEL){o=null==o?_.vertexFrom:Math.min(o,_.vertexFrom),a=null==a?_.vertexFrom+_.vertexCount:Math.max(a,_.vertexFrom+_.vertexCount);for(var m=_.vertexFrom*s.stride/4,g=_.vertexCount*s.stride/4,y=0;y<g;++y)s.data[m+y]=n}}var x=a?a-o:0;this._dirtyMap.markDirtyVertices(h.WGLGeometryType.LABEL,c.C_VBO_VISIBILITY_RANGE,o,x)},t.prototype.setStatus=function(e){this.status=e,e!==v.TileStatus.READY&&e!==v.TileStatus.NO_DATA||(this.attached=!0)},t.prototype.clear=function(){this._data=null,this.setStatus(v.TileStatus.INVALID),this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null),this.hlDisplayList&&(this.hlDisplayList=null)},t.prototype.dispose=function(){this.clear()},t.prototype.attach=function(e){return this.canDisplay},t.prototype.detach=function(t){e.prototype.detach.call(this,t)},t.prototype.doRender=function(e){var t=this;this.attached&&(this.commitChanges(e),e.context.setStencilFunction(514,this.stencilRef,255),e.painter.getBrushes(e.drawPhase).forEach(function(i){return i.draw(e,t)}))},t.prototype.buildHLList=function(e){var t=this;this.hlDisplayList=new p;e.forEach(function(e){t._addToHLDisplayList(t.hlDisplayList,e)})},t.prototype._addToHLDisplayList=function(e,t){if(this._data){var i=this._data.tileDisplayData.displayObjectRegistry.get(t);if(i){for(var r=[],n=0,o=i.displayRecords;n<o.length;n++){var a=o[n].copy();a.meshData=null,a.symbolLevel=0,a.zOrder=0,r.push(a)}r.sort(m),e.addToList(r)}}},t.prototype._rebuildLabelIndex=function(){this._labelIndex=this._initLabelIndex();for(var e=0,t=this.displayObjects;e<t.length;e++){var i=t[e];this._insertIntoLabelIndex(i)}},t.prototype._insertIntoLabelIndex=function(e){var t=e.anchor;-1!==e.xBucket&&t&&this.labelIndex[e.yBucket][e.xBucket].push(e)},t.prototype._initLabelIndex=function(){for(var e=[],t=0;t<s.TILE_SIZE/s.COLLISION_BUCKET_SIZE;t++){e.push([]);for(var i=0;i<s.TILE_SIZE/s.COLLISION_BUCKET_SIZE;i++)e[t].push([])}return e},t.prototype._patchData=function(e){for(var t=!0,i=0,r=e.remove||[];i<r.length;i++){var n=r[i];if(d=this._data.tileDisplayData.displayObjectRegistry.get(n)){this._data.tileDisplayData.displayList.removeFromList(d.displayRecords);for(var o=0,a=d.displayRecords;o<a.length;o++){var s=a[o];this._dispRecStore.delete(s)}this._data.tileDisplayData.displayObjectRegistry.delete(n);var l=this._data.tileDisplayData.displayObjects.indexOf(d);this._data.tileDisplayData.displayObjects.splice(l,1)}}for(var u=0,h=e.addOrUpdate&&e.addOrUpdate.tileDisplayData&&e.addOrUpdate.tileDisplayData.displayObjects||[];u<h.length;u++){var d,c=h[u];if(d=this._data.tileDisplayData.displayObjectRegistry.get(c.id)){var f=d.displayRecords;d.set(c),d.displayRecords=f;for(var p=d.displayRecords.length,v=0;v<p;++v){var _=d.displayRecords[v],m=c.displayRecords[v];(v>=c.displayRecords.length||_.geometryType!==m.geometryType||_.symbolLevel!==m.symbolLevel||_.zOrder!==m.zOrder||_.materialInfo.materialKey!==m.materialInfo.materialKey)&&(this._dispRecStore.delete(d.displayRecords[v]),v<c.displayRecords.length&&(d.displayRecords[v]=void 0))}d.displayRecords.length=c.displayRecords.length,d.anchor=c.anchor,d.metrics=c.metrics}else(d=c.copy()).displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(c.id,d),this._data.tileDisplayData.displayObjects.push(d);var g=c.displayRecords.length;for(v=0;v<g;++v){m=c.displayRecords[v];(_=d.displayRecords[v])?(_.meshData=m.meshData,_.materialInfo=m.materialInfo):((_=m.copy()).vertexFrom=void 0,_.indexFrom=void 0,d.displayRecords[v]=_);var y=m.geometryType,x=e.addOrUpdate.tileBufferData.geometries[y],S=x.vertexBuffer,V=x.indexBuffer;t=this._dispRecStore.setMeshData(_,m,S,V)&&t}}return t},t}(a)}.apply(null,r))||(e.exports=n)},2358:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(11),i(2359),i(1527)],void 0===(n=function(e,t,i,r,n){Object.defineProperty(t,"__esModule",{value:!0});var o=["FILL","LINE","MARKER","TEXT","LABEL"],a=function(){function e(e,t,i,n){for(var o in this._strides=e,this._displayList=t,this._vertexAlignments={},this._freeListsAndStorage={},this._dirtyMap=null,this._dirtyMap=i,e){var a=!1,s=!1;for(var l in this._freeListsAndStorage[o]={vtxFreeList:n?new r.FreeList(n):null,idxFreeList:n?new r.FreeList(n):null,vertexBuffers:{},indexBuffer:n?new Uint32Array(n):null},e[o])this._freeListsAndStorage[o].vertexBuffers[l]={data:n?new Uint32Array(Math.floor(n*e[o][l]/4)):null,stride:e[o][l]},e[o][l]%4==2?a=!0:e[o][l]%4!=0&&(s=!0);this._vertexAlignments[o]=s?4:a?2:1}}return e.fromTileData=function(t,i){var n=function(e){var t=e.getStrides(),i={};for(var r in t)i[o[r]]=t[r];return i}(t),a=[0,0,0,0,0],s=[0,0,0,0,0],l=[];t.tileDisplayData.displayObjectRegistry.forEach(function(e){l.push(e)});for(var u=0,h=l;u<h.length;u++)for(var d=0,c=h[u].displayRecords;d<c.length;d++){var f=c[d];a[f.geometryType]=Math.max(a[f.geometryType],f.vertexFrom+f.vertexCount),s[f.geometryType]=Math.max(s[f.geometryType],f.indexFrom+f.indexCount)}for(var p=new e(n,t.tileDisplayData.displayList,i,null),v=0;v<t.tileBufferData.geometries.length;++v){var _=a[v],m=s[v],g=t.tileBufferData.geometries[v],y=o[v],x=p._storageFor(y),S=t.tileBufferData.geometries[v].indexBuffer;x.indexBuffer=S,x.idxFreeList=new r.FreeList(S.length),x.idxFreeList.allocate(m);var V=void 0;for(var I in g.vertexBuffer){var b=t.tileBufferData.geometries[v].vertexBuffer[I];x.vertexBuffers[I].data=b.data,x.vertexBuffers[I].stride=b.stride,V=4*b.data.length/b.stride}x.vtxFreeList=new r.FreeList(V),x.vtxFreeList.allocate(_)}return p},e.prototype.delete=function(e){var t=o[e.geometryType];this._freeVertices(t,e.vertexFrom,e.vertexCount),this._freeIndices(t,e.indexFrom,e.indexCount),this._displayList.removeFromList(e),e.vertexFrom=void 0,e.indexFrom=void 0},e.prototype.setMeshData=function(e,t,i,r){var a=o[e.geometryType];e.meshData=null;var s=void 0,l=void 0;void 0===e.vertexFrom?(l=this._align(a,t.vertexCount),s=this._allocateVertices(a,l)):t.vertexCount>e.vertexCount?(this._freeVertices(a,e.vertexFrom,e.vertexCount),l=this._align(a,t.vertexCount),s=this._allocateVertices(a,l)):t.vertexCount===e.vertexCount?(s=e.vertexFrom,l=e.vertexCount):(this._freeVertices(a,e.vertexFrom+t.vertexCount,e.vertexCount-t.vertexCount),s=e.vertexFrom,l=t.vertexCount);var u=!0,h=void 0,d=void 0;if(void 0===e.indexFrom?(d=t.indexCount,h=this._allocateIndices(a,d)):t.indexCount>e.indexCount?(this._displayList.removeFromList(e),this._freeIndices(a,e.indexFrom,e.indexCount),d=t.indexCount,h=this._allocateIndices(a,d)):t.indexCount===e.indexCount?(u=!1,h=e.indexFrom,d=e.indexCount):(this._displayList.removeFromList(e),this._freeIndices(a,e.indexFrom+t.indexCount,e.indexCount-t.indexCount),h=e.indexFrom,d=t.indexCount),-1!==s&&-1!==h){var c=this._storageFor(a);if(n.copyMeshData(s,h,c.vertexBuffers,c.indexBuffer,t,i,r),e.vertexFrom=s,e.indexFrom=h,e.vertexCount=t.vertexCount,e.indexCount=t.indexCount,this._dirtyMap)for(var f in this._dirtyMap.markDirtyIndices(e.geometryType,e.indexFrom,e.indexCount),i)this._dirtyMap.markDirtyVertices(e.geometryType,f,e.vertexFrom,e.vertexCount);return u&&this._displayList.addToList(e),!0}return-1!==s&&this._freeVertices(a,s,l),-1!==h&&this._freeIndices(a,h,d),e.setMeshDataFromBuffers(t,i,r),e.vertexFrom=void 0,e.vertexCount=0,e.indexFrom=void 0,e.indexCount=0,!1},e.prototype._allocateVertices=function(e,t){var i=this._storageFor(e),r=i.vtxFreeList.allocate(t);return-1===r?-1:i.vtxFreeList.fragmentation>.5?-1:r},e.prototype._freeVertices=function(e,t,r){var n=this._storageFor(e);if(n.vtxFreeList.free(t,r),i("esri-feature-tiles-debug"))for(var o in n.vertexBuffers)for(var a=n.vertexBuffers[o].data,s=this._stridesFor(e,o),l=t*s/4,u=r*s/4,h=l;h<l+u;++h)a[h]=0},e.prototype._freeIndices=function(e,t,r){var n=this._storageFor(e);if(n.idxFreeList.free(t,r),i("esri-feature-tiles-debug"))for(var o=n.indexBuffer,a=t;a<t+r;++a)o[a]=0},e.prototype._align=function(e,t){var i=t%this._vertexAlignments[e];return 0===i?t:t+(this._vertexAlignments[e]-i)},e.prototype._allocateIndices=function(e,t){var i=this._storageFor(e),r=i.idxFreeList.allocate(t);return-1===r?-1:i.idxFreeList.fragmentation>.5?-1:r},e.prototype._storageFor=function(e){return this._freeListsAndStorage[e]},e.prototype._stridesFor=function(e,t){return this._strides[e][t]},e}();t.default=a}.apply(null,r))||(e.exports=n)},2359:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._largestRange=null,this._parent=e,this._updateLargestRange()}return Object.defineProperty(e.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!0,configurable:!0}),e.prototype.rangeCreated=function(e){(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)},e.prototype.rangeResized=function(e,t,i){e===this._largestRange?e.count<i&&this._updateLargestRange():(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)},e.prototype.findBestRange=function(e){for(var t=this._parent._freeHead,i=null;null!==t;)t.count>=e&&(!i||t.count-e<i.count-e)&&(i=t),t=t.next;return i},e.prototype.findAdjacentRanges=function(e,t){for(var i=!0,r=!1,n=null,o=this._parent._freeHead;i&&!r;){var a=null!==n?n.from+n.count:0,s=null!==o?o.from:this._parent._size;e>=a&&e+t<=s?(i=!1,r=!0):null!==o?(n=o,o=o.next):i=!1}return[n,o]},e.prototype._updateLargestRange=function(){for(var e=null,t=this._parent._freeHead;null!==t;)(!e||t.count>e.count)&&(e=t),t=t.next;this._largestRange=e},e}(),r=function(){function e(e,t){this._allocated=0,this._size=e,this._freeHead=e>0?{from:0,count:e,prev:null,next:null}:null,this._bookKeeper=t||new i(this),this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}return e.prototype.allocate=function(t){var i=this._bookKeeper.findBestRange(t);if(null===i)return-1;var r=i.from,n=i.count;if(i.from+=t,i.count-=t,this._bookKeeper.rangeResized(i,r,n),this._allocated+=t,0===i.count){var o=null!==i.prev?this._freeHead:i.next;e._removeRange(i),this._freeHead=o}return r},e.prototype.free=function(t,i){var r=this._bookKeeper.findAdjacentRanges(t,i),n=r[0],o=r[1],a={from:t,count:i,prev:n,next:o};if(null!==n&&(n.next=a),null!==o&&(o.prev=a),this._bookKeeper.rangeCreated(a),this._allocated-=i,null!==o&&a.from+a.count===o.from){var s=a.from,l=a.count;e._fuse(a,o),e._removeRange(o),this._bookKeeper.rangeResized(a,s,l),this._bookKeeper.rangeResized(o,void 0,0)}if(null!==n&&n.from+n.count===a.from){s=n.from,l=n.count;e._fuse(n,a),e._removeRange(a),this._bookKeeper.rangeResized(n,s,l),this._bookKeeper.rangeResized(a,void 0,0)}this._freeHead=null!==a.prev?this._freeHead:a},Object.defineProperty(e.prototype,"fragmentation",{get:function(){var e=this._size-this._allocated;return 0===e?0:1-this._bookKeeper.largestRange.count/e},enumerable:!0,configurable:!0}),e._removeRange=function(e){null!==e.prev?null!==e.next?(e.prev.next=e.next,e.next.prev=e.prev):e.prev.next=null:null!==e.next&&(e.next.prev=null)},e._fuse=function(e,t){e.count+=t.count,e.next=t.next,t.from+=t.count,t.count=0,null!==t.next&&(t.next.prev=e)},e}();t.FreeList=r}.apply(null,r))||(e.exports=n)},2360:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1527)],void 0===(n=function(e,t,i){function r(e,t,i){if(!e.allDirty)if(null!=e.from&&null!=e.count){var r=Math.min(e.from,t),n=Math.max(e.from+e.count,t+i)-r;e.from=r,e.count=n}else e.from=t,e.count=i}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._dirties=i.createGeometryData(function(e){return{indices:{from:null,count:null,allDirty:!1}}},function(e,t){return{vertices:{from:null,count:null,allDirty:!1}}})}return e.prototype.markAllClean=function(){for(var e=0,t=this._dirties;e<t.length;e++){var i=t[e];for(var r in i.data.indices.from=null,i.data.indices.count=null,i.data.indices.allDirty=!1,i.buffers)i.buffers[r].data.vertices.from=null,i.buffers[r].data.vertices.count=null,i.buffers[r].data.vertices.allDirty=!1}},e.prototype.markAllDirty=function(){for(var e=0,t=this._dirties;e<t.length;e++){var i=t[e];for(var r in i.data.indices.allDirty=!0,i.buffers)i.buffers[r].data.vertices.allDirty=!0}},e.prototype.forEach=function(e){for(var t=new Map,i=0;i<this._dirties.length;++i){var r=this._dirties[i],n=new Map;for(var o in r.buffers){var a=r.buffers[o].data.vertices;(a.allDirty||null!=a.from&&null!=a.count)&&n.set(o,a)}var s,l=r.data.indices;((s=l.allDirty||null!=l.from&&null!=l.count?{indices:l,vertices:n}:{indices:void 0,vertices:n}).indices||s.vertices.size>0)&&t.set(i,s)}t.forEach(function(t,i){e({indices:t.indices||null,vertices:t.vertices.size>0?t.vertices:null},i)})},e.prototype.markDirtyIndices=function(e,t,i){r(this._dirties[e].data.indices,t,i)},e.prototype.markDirtyVertices=function(e,t,i,n){r(this._dirties[e].buffers[t].data.vertices,i,n)},e}();t.default=n}.apply(null,r))||(e.exports=n)},2361:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1527),i(1500)],void 0===(n=function(e,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.geometryMap=i.createGeometryData(function(t){return{indexBuffer:r.createIndex(e,35044),vao:null}},function(t,n){return{vertexBuffer:r.createVertex(e,i.C_VBO_INFO[n])}})}return e.prototype.dispose=function(){for(var e in this.geometryMap){var t=this.geometryMap[e];for(var i in t.data.vao&&t.data.vao.dispose(!1),t.data.indexBuffer&&t.data.indexBuffer.dispose(),t.buffers)t.buffers[i]&&t.buffers[i].data.vertexBuffer.dispose()}},e.prototype.get=function(e){var t=this.geometryMap[e],i={};for(var r in t.buffers)i[r]=t.buffers[r].data.vertexBuffer;return{indexBuffer:t.data.indexBuffer,get vao(){return t.data.vao},set vao(e){t.data.vao=e},vertexBufferMap:i}},e.prototype.has=function(e){return null!=this.geometryMap[e]},e.prototype.upload=function(e,t){var i=this;t.forEach(function(t,r){t.indices&&(t.indices.allDirty?i._uploadIndices(e,r):null!=t.indices.from&&null!=t.indices.count&&i._uploadIndices(e,r,t.indices.from,t.indices.count)),t.vertices&&t.vertices.forEach(function(t,n){t.allDirty?i._uploadVertices(e,r,n):null!=t.from&&null!=t.count&&i._uploadVertices(e,r,n,t.from,t.count)})})},e.prototype._uploadVertices=function(e,t,i,r,n){var o=this.geometryMap[t];if(o){var a=e.geometries[t].vertexBuffer[i];if(a){var s=a.stride,l=a.data.buffer;o.buffers[i]&&l.byteLength>0&&(null!=r&&null!=n?o.buffers[i].data.vertexBuffer.setSubData(l,r*s,r*s,(r+n)*s):o.buffers[i].data.vertexBuffer.setData(l))}}},e.prototype._uploadIndices=function(e,t,i,r){var n=this.geometryMap[t];if(n){var o=e.geometries[t].indexBuffer.buffer;n.data.indexBuffer&&o.byteLength>0&&(null!=i&&null!=r?n.data.indexBuffer.setSubData(o,4*i,4*i,4*(i+r)):n.data.indexBuffer.setData(o))}},e}();t.default=n}.apply(null,r))||(e.exports=n)}}]);