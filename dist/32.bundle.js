(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/3d/layers/SceneLayerWorker":1412,"esri/views/3d/layers/PointCloudWorker":1417,"esri/views/vectorTiles/WorkerTileHandler":1428,"esri/views/2d/layers/features/Pipeline":1429,"esri/layers/graphics/sources/support/CSVSourceWorker":1430,"esri/views/webgl/Util":1448,"esri/views/2d/tiling/enums":1492,"esri/views/3d/layers/i3s/I3SBinaryReader":1520,"esri/views/3d/support/orientedBoundingBox":1521,"esri/views/2d/support/Evented":1523,"esri/views/2d/tiling/TileStrategy":1606,"esri/views/3d/layers/i3s/LEPCC":1607,"esri/views/2d/engine/webgl/Geometry":1622,"esri/views/2d/engine/webgl/GeometryUtils":1623,"esri/views/3d/support/dito":1625,"esri/renderers/PointCloudRenderer":1644,"esri/views/2d/engine/webgl/Rect":1654,"esri/renderers/support/pointCloud/PointSizeAlgorithm":1668,"esri/views/3d/layers/i3s/I3SGeometryUtil":1670,"esri/views/3d/layers/i3s/I3SProjectionUtil":1671,"esri/views/2d/engine/webgl/TextShaping":1684,"esri/views/2d/engine/webgl/TileClipper":1685,"esri/renderers/PointCloudClassBreaksRenderer":1693,"esri/renderers/support/pointCloud/PointSizeFixedSizeAlgorithm":1694,"esri/renderers/support/pointCloud/PointSizeSplatAlgorithm":1695,"esri/renderers/PointCloudStretchRenderer":1696,"esri/renderers/PointCloudUniqueValueRenderer":1697,"esri/views/vectorTiles/Bucket":1701,"esri/views/vectorTiles/MemoryBuffer":1766,"esri/views/2d/engine/webgl/LineTess":1767,"esri/views/3d/layers/i3s/PointCloudRendererUtil":1768,"esri/renderers/support/pointCloud/ColorModulation":1778,"esri/renderers/support/pointCloud/pointSizeAlgorithmJSONUtils":1779,"esri/renderers/support/pointCloud/pointSizeAlgorithmTypeUtils":1780,"esri/renderers/support/pointCloud/ColorClassBreakInfo":1781,"esri/renderers/support/pointCloud/StopInfo":1782,"esri/renderers/support/pointCloud/ColorUniqueValueInfo":1783,"esri/views/2d/layers/features/controllers":1790,"esri/views/vectorTiles/FillBucket":1884,"esri/core/executeAsync":1885,"esri/views/vectorTiles/BackgroundBucket":1886,"esri/views/vectorTiles/CircleBucket":1887,"esri/views/vectorTiles/LineBucket":1888,"esri/views/vectorTiles/Placement":1889,"esri/views/vectorTiles/SymbolBucket":1890,"esri/views/vectorTiles/WorkerTile":2179,"esri/views/vectorTiles/IndexMemoryBuffer":2180,"esri/views/vectorTiles/Conflict":2181,"esri/views/vectorTiles/TileParser":2182,"esri/views/vectorTiles/Feature":2183,"esri/views/vectorTiles/SourceLayerData":2184,"esri/views/vectorTiles/VertexMemoryBuffer":2185,"esri/views/2d/layers/features/processors":2186,"esri/views/2d/layers/features/support/TileStore":2187,"dstore/Csv":2190})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{1412:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(22),r(1670),r(1671),r(49),r(1646),r(1521),r(98),r(1592),r(1446)],void 0===(n=function(e,t,r,i,n,o,s,a,l,c,u,f){var d=function(){function e(){}return e.prototype.process=function(e){var t=[e.geometryBuffer];return r.resolve({result:this.transform(e,t),transferList:t})},e.prototype.transform=function(e,t){var r=i.fromJSON(e.indexSR),d=i.fromJSON(e.vertexSR),p=i.fromJSON(e.renderSR),v=!1,y=0,m=[],x=e.obb?null:l.create([0,0,0],[-1,-1,-1],[0,0,0,1]);s.vec3d.set(e.center,h),h[2]+=e.elevationOffset;var g=s.mat4d.create();c.computeLinearTransformation(r,h,g,p);for(var b=0,_=e.geometryData;b<_.length;b++)for(var I=_[b],w=I.geometries,C=I.componentOffsets,T=0,P=w;T<P.length;T++){var M=P[T],S=e.layouts[y];++y;var B=[{name:f.VertexAttrConstants.COLOR,byteValue:255}],A=[f.VertexAttrConstants.NORMAL,f.VertexAttrConstants.NORMALCOMPRESSED,f.VertexAttrConstants.SYMBOLCOLOR,f.VertexAttrConstants.COMPONENTINDEX],E=n.interleaveGeometryBuffer(M,e.geometryBuffer,S,B,A),D=new u(new Float32Array(E),S),V=D.getAttribute(f.VertexAttrConstants.POSITION),z=o.reprojectPoints(V,e.center,e.elevationOffset,r,d,p);if(x&&this._updateObb(x,V,g),e.needNormals){var N={normals:D.getAttribute(f.VertexAttrConstants.NORMALCOMPRESSED),positions:V,normalInd:D.getIndices(f.VertexAttrConstants.NORMALCOMPRESSED),positionInd:D.getIndices(f.VertexAttrConstants.POSITION)};n.processAndInterleaveNormals(e.normalReferenceFrame,M,e.geometryBuffer,z.globalTrafo,N)}var O=D.getAttribute(f.VertexAttrConstants.COMPONENTINDEX);O&&this._createComponentNumbers(O,C);var j=D.getAttribute(f.VertexAttrConstants.COLOR);j&&!v&&(v=this._hasColors(j));var F=S[0].stride,R=1-.8*F/(F+4),L=a.deduplicate(E,F/4,R);if(null!=L){var k=L.uniqueCount<65536?new Uint16Array(L.indices):L.indices,U=n.extractPositionData(L.buffer,S,k);m.push({layout:S,interleavedVertexData:L.buffer,indices:k,corMatrices:z,hasColors:v,positionData:U}),t&&(t.push(L.buffer),t.push(k.buffer),t.push(U.data.buffer),t.push(U.indices.buffer))}else{U=n.extractPositionData(E,S);m.push({layout:S,interleavedVertexData:E,corMatrices:z,hasColors:v,positionData:U}),t&&(t.push(E),t.push(U.data.buffer),t.push(U.indices.buffer))}}return x&&(s.mat4d.multiplyVec3(g,x.center,x.center),c.vectorToVector(x.center,p,x.center,d),x.center[2]-=e.elevationOffset),{geometryBuffer:e.geometryBuffer,transformedGeometries:m,obb:x}},e.prototype._hasColors=function(e){for(var t=e.data,r=e.size,i=e.offsetIdx,n=e.strideIdx,o=i;o<t.length;o+=n)for(var s=0;s<r;s++)if(255!==t[o+s])return!0;return!1},e.prototype._createComponentNumbers=function(e,t){for(var r=e.data,i=e.offsetIdx,n=e.strideIdx,o=r.length/n,s=0,a=i,l=0;l<o;l++)l>=t[s+1]&&s++,r[a]=s,a+=n},e.prototype._updateObb=function(e,t,r){if(e.halfSize[0]>0){s.vec3.subtract(e.center,e.halfSize,h),s.vec3.add(e.center,e.halfSize,p);for(var i=t.offsetIdx;i<t.data.length;i+=t.strideIdx)h[0]=Math.min(h[0],t.data[i]),h[1]=Math.min(h[1],t.data[i+1]),h[2]=Math.min(h[2],t.data[i+2]),p[0]=Math.max(p[0],t.data[i]),p[1]=Math.max(p[1],t.data[i+1]),p[2]=Math.max(p[2],t.data[i+2]);s.vec3.subtract(p,h,e.halfSize),s.vec3d.scale(e.halfSize,.5),s.vec3d.add(h,p,e.center),s.vec3d.scale(e.center,.5)}else{l.compute(t,e);var n=2*Math.sqrt(1+r[0]+r[5]+r[10]);v[0]=(r[9]-r[6])/n,v[1]=(r[2]-r[8])/n,v[2]=(r[4]-r[1])/n,v[3]=.25*n,s.quat4.conjugate(v),s.quat4.multiply(v,e.quaternion,e.quaternion)}},e}(),h=s.vec3d.create(),p=s.vec3d.create(),v=s.quat4.create();return d}.apply(null,i))||(e.exports=n)},1417:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(22),r(1520),r(1607),r(1768),r(49),r(98)],void 0===(n=function(e,t,r,i,n,o,s,a,l){var c=function(){function e(){}return e.prototype.process=function(e){var t=this.transform(e);return r.resolve({result:t,transferList:[t.rgb]})},e.prototype.transform=function(e){var t=this.readGeometry(e.schema,e.geometryBuffer),r=s.evaluateRenderer(e.rendererInfo,e.primaryAttribute,e.modulationAttribute,t,t.length/3);this._applyElevationOffsetInPlace(t,e.elevationOffset);var n=this._transformCoordinates(t,e.obb,i.fromJSON(e.inSR),i.fromJSON(e.outSR));return{obb:e.obb,points:n,rgb:r.buffer}},e.prototype.readGeometry=function(e,t){if(null==e.encoding||""===e.encoding){for(var r=n.createGeometryDataIndex(t,e,!1),i=n.createTypedView(t,r.vertexAttributes.position),s=r.header.fields,a=[s.offsetX,s.offsetY,s.offsetZ],l=[s.scaleX,s.scaleY,s.scaleZ],c=i.length/3,u=new Float64Array(3*c),f=0;f<c;f++)u[3*f]=i[3*f]*l[0]+a[0],u[3*f+1]=i[3*f+1]*l[1]+a[1],u[3*f+2]=i[3*f+2]*l[2]+a[2];return u}if("lepcc-xyz"===e.encoding)return o.decodeXYZ(t).result},e.prototype._transformCoordinates=function(e,t,r,i){var n=e.length/3;if(!l.bufferToBuffer(e,r,0,e,i,0,n))throw Error("Can't reproject");var o=a.vec3.createFrom(t.center[0],t.center[1],t.center[2]),s=a.vec3.create(),c=a.vec3.create();a.quat4.conjugate(t.quaternion,u);for(var f=new Float32Array(3*n),d=0;d<n;d++)s[0]=e[3*d]-o[0],s[1]=e[3*d+1]-o[1],s[2]=e[3*d+2]-o[2],a.quat4.multiplyVec3(u,s,c),t.halfSize[0]=Math.max(t.halfSize[0],Math.abs(c[0])),t.halfSize[1]=Math.max(t.halfSize[1],Math.abs(c[1])),t.halfSize[2]=Math.max(t.halfSize[2],Math.abs(c[2])),f[3*d]=s[0],f[3*d+1]=s[1],f[3*d+2]=s[2];return f},e.prototype._applyElevationOffsetInPlace=function(e,t){var r=e.length/3;if(0!==t)for(var i=0;i<r;i++)e[3*i+2]+=t},e}(),u=a.quat4.create();return c}.apply(null,i))||(e.exports=n)},1428:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(26),r(7),r(1492),r(2179),r(534)],void 0===(n=function(e,t,r,i,n,o,s){return function(){function e(){this._tiles=new Map,this._spriteInfo={},this._glyphInfo={}}return e.prototype.reset=function(){var e=new r;this._spriteInfo={},this._glyphInfo={};var t=this._tiles;return t.forEach(function(e){return e.setObsolete()}),t.clear(),e.resolve(),e.promise},e.prototype.getLayers=function(){return this._layers},e.prototype.setLayers=function(e){var t=new s(e);return this._layers=t.layers,i.resolve({data:""})},e.prototype.getTile=function(e,t){var r=this,s=e.key,a=o.pool.acquire();a.initialize(e.key,e.refKey,this,e.rotation);var l=e.cacheTile;return t.invoke("fetchTileData",e.refKey).then(function(e){return a.setDataAndParse(e,t).then(function(e){return l&&a.status!==n.TileStatus.INVALID&&r._tiles.set(s,a),e}).catch(function(e){return a.setObsolete(),o.pool.release(a),r._tiles.delete(a.tileKey),i.reject(e)})}).catch(function(e){return a.setObsolete(),r._tiles.has(a.tileKey)&&r._tiles.delete(a.tileKey),i.reject(e)}).always(function(e){return l||o.pool.release(a),e})},e.prototype.update=function(e){var t=this._tiles.get(e.key);return t?t.updateSymbols(e.rotation):i.reject()},e.prototype.destructTileData=function(e){return this._tiles.has(e)&&(o.pool.release(this._tiles.get(e)),this._tiles.delete(e)),i.resolve()},e.prototype.fetchSprites=function(e,t){var r=[],n=this._spriteInfo;return e.forEach(function(e){void 0===n[e]&&r.push(e)}),0===r.length?i.resolve():t.invoke("getSprites",r).then(function(e){for(var t in e){var r=e[t];n[t]=r}})},e.prototype.getSpriteItems=function(){return this._spriteInfo},e.prototype.fetchGlyphs=function(e,t,r,n){var o=[],s=this._glyphInfo[t];return s?r.forEach(function(e){s[e]||o.push(e)}):(s=this._glyphInfo[t]=[],r.forEach(function(e){return o.push(e)})),0===o.length?i.resolve():n.invoke("getGlyphs",{tileID:e,font:t,codePoints:o}).then(function(e){for(var t in e)s[t]=e[t]})},e.prototype.getGlyphItems=function(e){return this._glyphInfo[e]},e}()}.apply(null,i))||(e.exports=n)},1429:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(0),r(4),r(7),r(1),r(145),r(479),r(1790),r(2186),r(2187)],void 0===(n=function(e,t,r,i,n,o,s,a,l,c,u,f){Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.controller=null,t.processor=null,t.remoteClient=null,t.serviceAndViewInfo=null,t.tileStore=null,t.viewState=null,t}return r(t,e),t.prototype.initialize=function(){var e=this;this.watch("updating",function(t){e.remoteClient.invoke("setUpdating",t)})},t.prototype.destroy=function(){this.controller&&this.controller.destroy(),this.processor&&this.processor.destroy()},Object.defineProperty(t.prototype,"updating",{get:function(){var e=this.controller,t=this.processor;return!e||!t||e.updating||t.updating||!1},enumerable:!0,configurable:!0}),t.prototype.startup=function(e){var t=a.fromJSON(e.tileInfo);this.serviceAndViewInfo=e,this.tileStore=new f.default(t)},t.prototype.configure=function(e){var t=this,r=this.controller,i=this.processor,n=e.controller,s=e.processor,a=[null,null];return n&&(a[0]=c.createController(n.type,{remoteClient:this.remoteClient,tileStore:this.tileStore,serviceAndViewInfo:this.serviceAndViewInfo})),s&&(a[1]=u.createProcessor(s.type,{remoteClient:this.remoteClient,tileStore:this.tileStore,serviceAndViewInfo:this.serviceAndViewInfo})),o.all(a).then(function(e){var o=e[0],a=e[1];o&&(r&&r===t.controller&&r.destroy(),t.controller=o,o.configuration=n,o.setViewState(t.viewState),a||(o.processor=t.processor)),a&&(i&&i===t.processor&&i.destroy(),t.processor=a,a.configuration=s,r.processor=a)})},t.prototype.setViewState=function(e){var t=l.fromJSON(e);this._set("viewState",t),this.tileStore.setViewState(t),this.controller&&this.controller.setViewState(t)},i([s.property()],t.prototype,"controller",void 0),i([s.property()],t.prototype,"processor",void 0),i([s.property({dependsOn:["controller.updating","processor.updating"]})],t.prototype,"updating",null),i([s.property()],t.prototype,"viewState",void 0),i([s.subclass()],t)}(s.declared(n));t.default=d}.apply(null,i))||(e.exports=n)},1430:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1472),r(1624),r(11),r(127),r(2190),r(27),r(21),r(8),r(7),r(20),r(1792),r(62),r(29),r(500),r(1893),r(60)],void 0===(n=function(e,t,r,i,n,o,s,a,l,c,u,f,d,h,p,v,y,m){Object.defineProperty(t,"__esModule",{value:!0});var x=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong"],g=["lat","latitude","y","ycenter","latitude83","latdecdeg","POINT-Y"],b=["lon","lng","long","longitude","x","xcenter","longitude83","longdecdeg","POINT-X"],_=[","," ",";","|","\t"],I=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,w=[0,0],C=function(){return function(e,t){this.x=e,this.y=t}}(),T=function(){var e=o._parseInfo(),t=new RegExp("^"+e.regexp+"$"),r=new RegExp("["+e.group+"\\s\\xa0]","g"),i=e.factor;return function(n){var o=t.exec(n);if(e.factor=i,!o)return NaN;var s=o[1];if(!o[1]){if(!o[2])return NaN;s=o[2],e.factor*=-1}return+(s=s.replace(r,"").replace(e.decimal,"."))*e.factor}}(),P=function(){function e(){this._store=null}return e.prototype.load=function(e){var t=this;return u.all([this._fetch(e.url),this._checkProjection(e)]).then(function(r){var i=r[0],n=t._parse(i,e.parsing);return t._store=t._createStore(i,n),t._store.executeQueryForExtent().then(function(e){return n.layerDefinition.extent=e.extent,n})})},e.prototype.queryFeatures=function(e){return this._store.executeQuery(m.fromJSON(e))},e.prototype.queryFeatureCount=function(e){return this._store.executeQueryForCount(m.fromJSON(e))},e.prototype.queryObjectIds=function(e){return this._store.executeQueryForIds(m.fromJSON(e))},e.prototype.queryExtent=function(e){return this._store.executeQueryForExtent(m.fromJSON(e))},e.prototype._fetch=function(e){if(!e)return u.reject(new c("csv-source:invalid-source","url not defined"));var t=f.urlToObject(e);return l(t.path,{query:t.query,responseType:"text"}).then(function(e){return e.data})},e.prototype._parse=function(e,t){var r={columnDelimiter:t.columnDelimiter,layerDefinition:null,locationInfo:{latitudeFieldName:t.latitudeField,longitudeFieldName:t.longitudeField}},i=this._readFirstLine(e);if(!i)throw new c("csv","CSV is empty");if(!t.columnDelimiter){var n=this._inferDelimiter(i);if(!n)throw new c("csv","Unable to detect the delimiter from CSV");r.columnDelimiter=n}var o=i.split(r.columnDelimiter),s=r.layerDefinition={name:"csv",geometryType:"esriGeometryPoint",objectIdField:null,fields:[],extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:t.spatialReference||{wkid:102100}}};if(!t.latitudeField||!t.longitudeField){var a=this._inferLocationInfo(o);if(!t.longitudeField&&!a.longitudeFieldName||!t.latitudeField&&!a.latitudeFieldName)throw new c("csv","Unable to identify latitudeField and/or longitudeField from CSV");r.locationInfo={longitudeFieldName:t.longitudeField||a.longitudeFieldName,latitudeFieldName:t.latitudeField||a.latitudeFieldName}}return t.fields&&t.fields.length?s.fields=t.fields:s.fields=this._inferFields(e,r.columnDelimiter,o,r.locationInfo),s.fields.some(function(e){return"esriFieldTypeOID"===e.type&&(s.objectIdField=e.name,!0)})||(s.objectIdField="__OBJECTID",s.fields.unshift({name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",domain:null})),r},e.prototype._inferLocationInfo=function(e){var t=null,r=null;return e.forEach(function(e){var i=e.toLowerCase();-1===g.indexOf(i)||r||(r=e),-1===b.indexOf(i)||t||(t=e)}),{longitudeFieldName:t,latitudeFieldName:r}},e.prototype._inferFields=function(e,t,r,i){for(var n=[],o=this._sampleLines(e).map(function(e){return e.split(t).map(function(e){return e.trim()})}),s=this,a=0;a<r.length;a++)!function(e){var t=r[e];if(t===i.longitudeFieldName||t===i.latitudeFieldName)n.push({name:t,alias:t,type:"esriFieldTypeDouble",domain:null});else{var a=o.map(function(t){return t[e]}),l=s._inferFieldType(a),c={name:t.replace(/[\s\'’‘\.\-\/\(\)]+/g,"_"),type:null,alias:t,domain:null,editable:!0,nullable:!0};switch(l){case"integer":c.type="esriFieldTypeInteger";break;case"double":c.type="esriFieldTypeDouble";break;case"date":c.type="esriFieldTypeDate",c.length=36;break;default:c.type="esriFieldTypeString",c.length=255}n.push(c)}}(a);return n},e.prototype._inferFieldType=function(e){var t=this,r=/[^+-.,0-9]/;return e.map(function(e){var i=!1;if(""===e||r.test(e))i=!0;else{var n=T(e);if(!isNaN(n))return/[.,]/.test(e)?"double":n>214783647||n<-214783648?"double":"integer";if(-1===e.indexOf("E"))i=!0;else{if(n=Number(e),!isNaN(n))return"double";if(-1===e.indexOf(","))i=!0;else{if(e=e.replace(",","."),n=Number(e),!isNaN(n))return"double";i=!0}}}if(i){if(/^[-]?\d*[.,]?\d*$/.test(e))return"string";var o=new Date(e);return t._isValidDate(o,e)?"date":"string"}return"string"}).reduce(function(e,t){return e===t?t:"string"===e||"string"===t?"string":"double"===e||"double"===t?"double":void 0})},e.prototype._isValidDate=function(e,t){if(!e||"[object Date]"!==Object.prototype.toString.call(e)||isNaN(e.getTime()))return!1;var r=!0;if(n("chrome")&&/\d+\W*$/.test(t)){var i=t.match(/[a-zA-Z]{2,}/);if(i){for(var o=!1,s=0;!o&&s<=i.length;)o=!I.test(i[s]),s++;r=!o}}return r},e.prototype._readFirstLine=function(e){return e.substring(0,e.indexOf("\n")).trim()},e.prototype._sampleLines=function(e,t){void 0===t&&(t=10);for(var r=!1,i=[],n=e.indexOf("\n")+1;!r&&i.length<t;){var o=e.indexOf("\n",n);-1===o&&(r=!0);var s;(s=-1===o&&n<e.length-1?e.substring(n).trim():e.substring(n,o).trim())&&i.push(s),n=o+1}return i},e.prototype._inferDelimiter=function(e){var t=0,r="";return _.forEach(function(i){var n=e.split(i).length;n>t&&(t=n,r=i)}),""===r?null:r},e.prototype._createStore=function(e,t){for(var r,n=t.locationInfo,o=n.latitudeFieldName,l=n.longitudeFieldName,c=t.layerDefinition,u=c.objectIdField,f=c.fields,m=c.extent,g=[],b=[],_=new i.Set,I=new i.Set,P=[],M=0,S=f;M<S.length;M++){var B=S[M],A=B.name,E=B.type;"esriFieldTypeDate"===E?_.add(A):x.indexOf(E)>-1&&I.add(A),A!==u&&P.push(A)}var D=new s;D.delimiter=t.columnDelimiter,D.fieldNames=P,D.newline="\n";var V=D.parse(e),z=0;V.shift();for(var N=0,O=V;N<O.length;N++){var j=O[N],F=this._parseCoordinateValue(j[o]),R=this._parseCoordinateValue(j[l]);if(null!=R&&null!=F&&!isNaN(F)&&!isNaN(R)){for(var L in j)if(L!==o&&L!==l)if(_.has(L)){var k=new Date(j[L]);j[L]=this._isValidDate(k,j[L])?k.getTime():null}else if(I.has(L)){var U=T(j[L]);isNaN(U)?j[L]=null:j[L]=U}j[u]=z,z++,g.push(new C(R,F)),b.push(j)}}if(!h.equals({wkid:4326},m.spatialReference))if(h.isWebMercator(m.spatialReference))for(var Y=0,q=g;Y<q.length;Y++){var G=q[Y];r=p.lngLatToXY(G.x,G.y,w),G.x=r[0],G.y=r[1]}else g=d.projectMany(g,a.SpatialReference.WGS84,m.spatialReference,null,!0);for(var J=new y.default({fields:t.layerDefinition.fields,geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1,objectIdField:u,spatialReference:m.spatialReference||{wkid:4326},cacheSpatialQueries:!0}),X=[],Z=0;Z<g.length;Z++){var H=g[Z],W=H.x,K=H.y,Q=b[Z];Q[u]=Z+1,X.push(new v.OptimizedFeature(new v.OptimizedGeometry([],[W,K]),Q))}return J.load(X),J},e.prototype._parseCoordinateValue=function(e){if(null==e||""===e)return null;var t=T(e);return(isNaN(t)||Math.abs(t)>181)&&(t=parseFloat(e)),t},e.prototype._checkProjection=function(e){var t=e.parsing.spatialReference;return!t||p.canProject(a.SpatialReference.WGS84,t)?u.resolve():d.isSupported()?d.load():u.reject(new c("csv-layer","Projection not supported"))},e}();t.default=P}.apply(null,i))||(e.exports=n)},1448:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(8)],void 0===(n=function(e,t,r,i){return function(){function e(){}return e.vertexCount=function(t,r){return t.vertexBuffers[r].size/e.getStride(t.layout[r])},e.getStride=function(e){return e[0].stride},e.getBytesPerElement=function(e){switch(e){case 5126:case 5124:case 5125:return 4;case 5122:case 5123:return 2;case 5120:case 5121:return 1;default:throw new Error("Unknown data type")}},e.addDescriptor=function(t,r,i,n,o,s){var a=e.getBytesPerElement(n);if(t.length>0){var l=t[0].stride,c=l+a*i;t.forEach(function(e){return e.stride=c}),t.push({name:r,count:i,type:n,offset:l,stride:c,normalized:o,divisor:s})}else t.push({name:r,count:i,type:n,offset:0,stride:a*i,normalized:o,divisor:s})},e.assertCompatibleVertexAttributeLocations=function(e,t){var r=e.locations===t.locations;return r||console.error("VertexAttributeLocations are incompatible"),r},e.hasAttribute=function(e,t){for(var r=0;r<e.length;r++)if(e[r].name===t)return!0;return!1},e.findAttribute=function(e,t){for(var r=0;r<e.length;r++)if(e[r].name===t)return e[r];return null},e.copyFramebufferToTexture=function(e,t,r,i,n){void 0===n&&(n=0);var o=e.getBoundFramebufferObject(),s=e.getBoundTexture(0);e.bindFramebuffer(t),e.bindTexture(r,0),e.gl.copyTexImage2D(e.gl.TEXTURE_2D,n,r.descriptor.pixelFormat,i[0],i[1],i[2],i[3],0),e.gl.flush(),e.bindFramebuffer(o),e.bindTexture(s,0)},e.assert=function(e,t){if(!e)throw new i(t)},e.setBaseInstanceOffset=function(e,t){var i={};for(var n in e)i[n]=e[n].map(function(e){return e.divisor?r({},e,{baseInstance:t}):e});return i},e.bindVertexBufferLayout=function(e,t,r,i,n){var o=e.gl,s=e.capabilities.instancing;e.bindBuffer(r),i.forEach(function(e){var r=t[e.name],i=(n||(0+e.baseInstance?e.baseInstance:0))*e.stride;if(void 0===r&&console.error("There is no location for vertex attribute '"+e.name+"' defined."),e.baseInstance&&!e.divisor&&console.error("Vertex attribute '"+e.name+"' uses baseInstanceOffset without divisor."),e.count<=4)o.vertexAttribPointer(r,e.count,e.type,e.normalized,e.stride,e.offset+i),o.enableVertexAttribArray(r),e.divisor&&e.divisor>0&&s&&s.vertexAttribDivisor(r,e.divisor);else if(9===e.count)for(var a=0;a<3;a++)o.vertexAttribPointer(r+a,3,e.type,e.normalized,e.stride,e.offset+12*a+i),o.enableVertexAttribArray(r+a),e.divisor&&e.divisor>0&&s&&s.vertexAttribDivisor(r+a,e.divisor);else if(16===e.count)for(a=0;a<4;a++)o.vertexAttribPointer(r+a,4,e.type,e.normalized,e.stride,e.offset+16*a+i),o.enableVertexAttribArray(r+a),e.divisor&&e.divisor>0&&s&&s.vertexAttribDivisor(r+a,e.divisor);else console.error("Unsupported vertex attribute element count: "+e.count)})},e.unbindVertexBufferLayout=function(e,t,r,i){var n=e.gl;e.bindBuffer(r),i.forEach(function(e){var r=t[e.name];if(e.count<=4)n.disableVertexAttribArray(r);else if(9===e.count)for(var i=0;i<3;i++)n.disableVertexAttribArray(r+i);else if(16===e.count)for(i=0;i<4;i++)n.disableVertexAttribArray(r+i);else console.error("Unsupported vertex attribute element count: "+e.count)}),e.unbindBuffer(34962)},e}()}.apply(null,i))||(e.exports=n)},1492:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.NO_DATA=1]="NO_DATA",e[e.READY=2]="READY",e[e.MODIFIED=3]="MODIFIED",e[e.INVALID=4]="INVALID"}(t.TileStatus||(t.TileStatus={}))}.apply(null,i))||(e.exports=n)},1520:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(8),r(5),r(9),r(1607)],void 0===(n=function(e,t,r,i,n,o){function s(e,t,i){for(var n="",o=0;o<i;){var s=e[t+o];if(s<128)n+=String.fromCharCode(s),o++;else if(s>=192&&s<224){if(o+1>=i)throw new r("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");var a=(31&s)<<6|63&e[t+o+1];n+=String.fromCharCode(a),o+=2}else if(s>=224&&s<240){if(o+2>=i)throw new r("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");a=(15&s)<<12|(63&e[t+o+1])<<6|63&e[t+o+2];n+=String.fromCharCode(a),o+=3}else{if(!(s>=240&&s<248))throw new r("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");if(o+3>=i)throw new r("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");if((a=(7&s)<<18|(63&e[t+o+1])<<12|(63&e[t+o+2])<<6|63&e[t+o+3])>=65536){var l=55296+(a-65536>>10),c=56320+(1023&a);n+=String.fromCharCode(l,c)}else n+=String.fromCharCode(a);o+=4}}return n}function a(e,r){for(var i={byteOffset:0,byteCount:0,fields:Object.create(null)},n=0,o=0;o<r.length;o++){var s=r[o],a=s.valueType||s.type,l=t.valueType2ArrayBufferReader[a];i.fields[s.property]=l(e,n),n+=t.valueType2TypedArrayClassMap[a].BYTES_PER_ELEMENT}return i.byteCount=n,i}function l(e,t,i){var n,o,a=[],l=0;for(o=0;o<e;o+=1){if((n=t[o])>0){if(a.push(s(i,l,n-1)),0!==i[l+n-1])throw new r("string-array-error","Invalid string array: missing null termination.")}else a.push(null);l+=n}return a}function c(e,r){return new(0,t.valueType2TypedArrayClassMap[r.valueType])(e,r.byteOffset,r.count*r.valuesPerElement)}function u(e,t){return new Uint8Array(e,t.byteOffset,t.byteCount)}function f(e,t,n){for(var o=null!=t.header?a(e,t.header):{byteOffset:0,byteCount:0,fields:{count:n}},s={header:o,byteOffset:o.byteCount,byteCount:0,entries:Object.create(null)},l=o.byteCount,c=0;c<t.ordering.length;c++){var u=t.ordering[c],f=i.clone(t[u]);if(f.count=o.fields.count,"String"===f.valueType){if(f.byteOffset=l,f.byteCount=o.fields[u+"ByteCount"],"UTF-8"!==f.encoding)throw new r("unsupported-encoding","Unsupported String encoding.",{encoding:f.encoding})}else{if(!h(f.valueType))throw new r("unsupported-value-type","Unsupported binary valueType",{valueType:f.valueType});var d=p(f.valueType);l+=l%d!=0?d-l%d:0,f.byteOffset=l,f.byteCount=d*f.valuesPerElement*f.count}l+=f.byteCount,s.entries[u]=f}return s.byteCount=l-s.byteOffset,s}function d(e,t,i){if(t!==e&&v.error("Invalid "+i+" buffer size\n expected: "+e+", actual: "+t+")"),t<e)throw new r("buffer-too-small","Binary buffer is too small",{expectedSize:e,actualSize:t})}function h(e){return t.valueType2TypedArrayClassMap.hasOwnProperty(e)}function p(e){return h(e)&&t.valueType2TypedArrayClassMap[e].BYTES_PER_ELEMENT}Object.defineProperty(t,"__esModule",{value:!0});var v=n.getLogger("esri.views.3d.layers.i3s.I3SBinaryReader");t.readHeader=a,t.readStringArray=l,t.createTypedView=c,t.createRawView=u,t.createAttributeDataIndex=f,t.createGeometryDataIndex=function(e,t,r){var n=a(e,t&&t.header),o=n.byteCount,s={header:n,byteOffset:n.byteCount,byteCount:0,vertexAttributes:i.clone(t.vertexAttributes)},l=s.vertexAttributes;r||null==l.region||delete l.region;for(var c=n.fields,u=null!=c.vertexCount?c.vertexCount:c.count,f=0;f<t.ordering.length;f++){var h=t.ordering[f];null!=l[h]&&(l[h].byteOffset=o,l[h].count=u,o+=p(l[h].valueType)*l[h].valuesPerElement*u)}var v=c.faceCount;if(t.faces&&v){s.faces=i.clone(t.faces);var y=s.faces;for(f=0;f<t.ordering.length;f++){var m=t.ordering[f];null!=y[m]&&(y[m].byteOffset=o,y[m].count=v,o+=p(y[m].valueType)*y[m].valuesPerElement*v)}}var x=c.featureCount;if(t.featureAttributes&&t.featureAttributeOrder&&x){s.featureAttributes=i.clone(t.featureAttributes);var g=s.featureAttributes;for(f=0;f<t.featureAttributeOrder.length;f++){var b=t.featureAttributeOrder[f];g[b].byteOffset=o,g[b].count=x;var _=p(g[b].valueType);"UInt64"===g[b].valueType&&(_=8),o+=_*g[b].valuesPerElement*x}}return d(o,e.byteLength,"geometry"),s.byteCount=o-s.byteOffset,s},t.readBinaryAttribute=function(e,t,i){if("lepcc-rgb"===e.encoding)return o.decodeRGB(t);if("lepcc-intensity"===e.encoding)return o.decodeIntensity(t);if(null!=e.encoding&&""!==e.encoding)throw new r("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");e["attributeByteCounts "]&&!e.attributeByteCounts&&(v.warn("Warning: Trailing space in 'attributeByteCounts '."),e.attributeByteCounts=e["attributeByteCounts "]),"ObjectIds"===e.ordering[0]&&e.hasOwnProperty("objectIds")&&(v.warn("Warning: Case error in objectIds"),e.ordering[0]="objectIds");var n=f(t,e,i);d(n.byteOffset+n.byteCount,t.byteLength,"attribute");var s=n.entries.attributeValues||n.entries.objectIds;if(s){if("String"===s.valueType){var a=n.entries.attributeByteCounts,h=c(t,a),p=u(t,s);return l(a.count,h,p)}return c(t,s)}throw new r("bad-attribute-storage-info","Bad attributeStorageInfo specification.")},t.valueType2TypedArrayClassMap={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array},t.valueType2ArrayBufferReader={Float32:function(e,t){return new DataView(e,0).getFloat32(t,!0)},Float64:function(e,t){return new DataView(e,0).getFloat64(t,!0)},UInt8:function(e,t){return new DataView(e,0).getUint8(t)},Int8:function(e,t){return new DataView(e,0).getInt8(t)},UInt16:function(e,t){return new DataView(e,0).getUint16(t,!0)},Int16:function(e,t){return new DataView(e,0).getInt16(t,!0)},UInt32:function(e,t){return new DataView(e,0).getUint32(t,!0)},Int32:function(e,t){return new DataView(e,0).getInt32(t,!0)}},t.isValueType=h,t.getBytesPerValue=p}.apply(null,i))||(e.exports=n)},1521:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(473),r(49),r(1625),r(1469)],void 0===(n=function(e,t,r,i,n,o){function s(e,t,r){return{center:i.vec3d.createFrom(e[0],e[1],e[2]),halfSize:u.createFrom(t[0],t[1],t[2]),quaternion:c.createFrom(r[0],r[1],r[2],r[3])}}function a(e,t){var r=o.plane.distance(t,e.center),i=l(e,t);return r>i?1:r<-i?-1:0}function l(e,t){c.conjugate(e.quaternion,d),c.multiplyVec3(d,t,h);var r=e.halfSize;return Math.abs(h[0]*r[0])+Math.abs(h[1]*r[1])+Math.abs(h[2]*r[2])}Object.defineProperty(t,"__esModule",{value:!0});var c=i.quat4,u=i.vec3,f=i.mat3d,d=c.create(),h=u.create(),p=u.create(),v=f.create(),y=function(){return function(e){var t=56*e;this.buffer=new ArrayBuffer(t),this.obbs=new Array(e);for(var r=0;r<e;r++)this.obbs[r]={center:new Float64Array(this.buffer,56*r+0,3),halfSize:new Float32Array(this.buffer,56*r+24,3),quaternion:new Float32Array(this.buffer,56*r+36,4)}}}();t.ObbArray=y,t.create=s,t.clone=function(e){return s(e.center,e.halfSize,e.quaternion)},t.set=function(e,t){i.vec3d.set(e.center,t.center),i.vec3.set(e.halfSize,t.halfSize),i.quat4.set(e.quaternion,t.quaternion)},t.compute=function(e,t){return t||(t=s([0,0,0],[-1,-1,-1],[0,0,0,1])),n.computeOBB(e,t),t},t.intersectPlane=a,t.toAaBoundingBox=function(e,t){t||(t=r.create());var i=c.toMat3(e.quaternion,v),n=e.halfSize[0]*Math.abs(i[0])+e.halfSize[1]*Math.abs(i[3])+e.halfSize[2]*Math.abs(i[6]),o=e.halfSize[0]*Math.abs(i[1])+e.halfSize[1]*Math.abs(i[4])+e.halfSize[2]*Math.abs(i[7]),s=e.halfSize[0]*Math.abs(i[2])+e.halfSize[1]*Math.abs(i[5])+e.halfSize[2]*Math.abs(i[8]);return t[0]=e.center[0]-n,t[1]=e.center[1]-o,t[2]=e.center[2]-s,t[3]=e.center[0]+n,t[4]=e.center[1]+o,t[5]=e.center[2]+s,t},t.minimumDistancePlane=function(e,t){return o.plane.distance(t,e.center)-l(e,t)},t.maximumDistancePlane=function(e,t){return o.plane.distance(t,e.center)+l(e,t)},t.isVisible=function(e,t){return a(e,t[0])<=0&&a(e,t[1])<=0&&a(e,t[2])<=0&&a(e,t[3])<=0&&a(e,t[4])<=0&&a(e,t[5])<=0},t.intersectLine=function(e,t,r,n){void 0===n&&(n=0),c.conjugate(e.quaternion,d),i.vec3.subtract(t,e.center,h);for(var o=c.multiplyVec3(d,h,h),s=c.multiplyVec3(d,r,p),a=-1/0,l=1/0,u=0;u<3;u++)if(Math.abs(s[u])>1e-6){var f=(n+e.halfSize[u]-o[u])/s[u],v=(-n-e.halfSize[u]-o[u])/s[u];a=Math.max(a,Math.min(f,v)),l=Math.min(l,Math.max(f,v))}else if(o[u]>e.halfSize[u]+n||o[u]<-e.halfSize[u]-n)return!1;return a<=l}}.apply(null,i))||(e.exports=n)},1523:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._listeners={}}return e.prototype.on=function(e,t){var r=this;null==this._listeners[e]&&(this._listeners[e]=new Map);var i={};return this._listeners[e].set(i,t),{remove:function(){return r._listeners[e].delete(i)}}},e.prototype.once=function(e,t){var r=this.on(e,function(e){r.remove(),t(e)});return r},e.prototype.emit=function(e,t){this.hasEventListener(e)&&this._listeners[e].forEach(function(e){return e(t)})},e.prototype.hasEventListener=function(e){return null!=this._listeners[e]&&this._listeners[e].size>0},e}();t.default=r}.apply(null,i))||(e.exports=n)},1606:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(1492),r(182)],void 0===(n=function(e,t,r,i,n){function o(e,t){e.delete(t)}var s=new n(0,0,0,0),a=new Map,l=[],c=[];return function(){function e(e){this._previousResolution=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.cachePolicy&&(this.cachePolicy=e.cachePolicy),null!=e.buffer&&(this.buffer=e.buffer)}return e.prototype.destroy=function(){this.tileIndex.clear()},e.prototype.update=function(e){var t=this,r=this.tileIndex,n=this.tileInfoView.getTileCoverage(e.state,this.buffer);if(n){var u=n.spans,f=n.lodInfo,d=f.level,h=e.state.resolution,p=!e.stationary&&h>this._previousResolution;this._previousResolution=h,r.forEach(function(e){return e.visible=!0}),this.tiles.length=0,a.clear();var v=0,y=0;if(u.length>0)for(var m=0,x=u;m<x.length;m++)for(var g=x[m],b=g.row,_=g.colFrom,I=g.colTo,w=_;w<=I;w++){v++;var C=s.set(d,b,f.normalizeCol(w),f.getWorldForColumn(w)).id;if(r.has(C)){if((T=r.get(C)).status!==i.TileStatus.INITIALIZED&&y++,T.attached){a.set(C,T);continue}T.attached||p||this._addParentTile(C,a)}else{var T=this.acquireTile(s);this.tileIndex.set(C,T),p||this._addParentTile(C,a)}}var P=y===v;c.length=0,l.length=0,r.forEach(function(e,r){if(s.set(r),!a.has(r)){var o=t.tileInfoView.intersects(n,s);!o||!p&&P?"purge"===t.cachePolicy&&e.status!==i.TileStatus.MODIFIED&&e.status!==i.TileStatus.READY?l.push(r):(s.level>d||!o)&&l.push(r):e.attached?c.push(r):s.level>d&&l.push(r)}});for(var M=0,S=c;M<S.length;M++){C=S[M];(T=r.get(C))&&T.attached&&a.set(C,T)}for(var B=0,A=l;B<A.length;B++){C=A[B],T=r.get(C);this.releaseTile(T),o(r,C)}a.forEach(function(e){return t.tiles.push(e)}),r.forEach(function(e){a.has(e.key.id)||(e.visible=!1)}),c.length=0,l.length=0,a.clear()}},e.prototype.clear=function(){var e=this,t=this.tileIndex;t.forEach(function(t){e.releaseTile(t)}),t.clear()},e.prototype._addParentTile=function(e,t){for(var r=e,i=null;r=this.tileInfoView.getTileParentId(r);)if(this.tileIndex.has(r)&&(i=this.tileIndex.get(r))&&i.attached){t.has(i.key.id)||t.set(i.key.id,i);break}},e}()}.apply(null,i))||(e.exports=n)},1607:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(8)],void 0===(n=function(e,t,r){function i(e,t,r){return{identifier:String.fromCharCode.apply(null,new Uint8Array(e,r+u.identifierOffset,u.identifierLength)),version:t.getUint16(r+u.versionOffset,c),checksum:t.getUint32(r+u.checksumOffset,c)}}function n(e,t){return{sizeLo:e.getUint32(t+f.sizeLo,c),sizeHi:e.getUint32(t+f.sizeHi,c),minX:e.getFloat64(t+f.minX,c),minY:e.getFloat64(t+f.minY,c),minZ:e.getFloat64(t+f.minZ,c),maxX:e.getFloat64(t+f.maxX,c),maxY:e.getFloat64(t+f.maxY,c),maxZ:e.getFloat64(t+f.maxZ,c),errorX:e.getFloat64(t+f.errorX,c),errorY:e.getFloat64(t+f.errorY,c),errorZ:e.getFloat64(t+f.errorZ,c),count:e.getUint32(t+f.count,c),reserved:e.getUint32(t+f.reserved,c)}}function o(e,t,r){var i=[];t=s(e,t,i);for(var n=[],o=0;o<i.length;o++){n.length=0,t=s(e,t,n);for(var a=0;a<n.length;a++)r.push(n[a]+i[o])}return t}function s(e,t,i){var n=new DataView(e,t),o=n.getUint8(0),s=31&o,a=!!(32&o),l=(192&o)>>6,u=0;if(0===l)u=n.getUint32(1,c),t+=5;else if(1===l)u=n.getUint16(1,c),t+=3;else{if(2!==l)throw new r("lepcc-decode-error","Bad count type");u=n.getUint8(1),t+=2}if(a)throw new r("lepcc-decode-error","LUT not implemented");for(var f=Math.ceil(u*s/8),d=new Uint8Array(e,t,f),h=0,p=0,v=0,y=-1>>>32-s,m=0;m<u;m++){for(;p<s;)h|=d[v]<<p,p+=8,v+=1;i[m]=h&y,h>>>=s,(p-=s)+s>32&&(h|=d[v-1]>>8-p)}return t+v}function a(e,t){return{sizeLo:e.getUint32(t+d.sizeLo,c),sizeHi:e.getUint32(t+d.sizeHi,c),count:e.getUint32(t+d.count,c),colorMapCount:e.getUint16(t+d.colorMapCount,c),lookupMethod:e.getUint8(t+d.lookupMethod),compressionMethod:e.getUint8(t+d.compressionMethod)}}function l(e,t){return{sizeLo:e.getUint32(t+h.sizeLo,c),sizeHi:e.getUint32(t+h.sizeHi,c),count:e.getUint32(t+h.count,c),scaleFactor:e.getUint16(t+h.scaleFactor,c),bitsPerPoint:e.getUint8(t+h.bitsPerPoint),reserved:e.getUint8(t+h.reserved)}}Object.defineProperty(t,"__esModule",{value:!0});var c=!0,u={identifierOffset:0,identifierLength:10,versionOffset:10,checksumOffset:12,byteCount:16},f={sizeLo:0,sizeHi:4,minX:8,minY:16,minZ:24,maxX:32,maxY:40,maxZ:48,errorX:56,errorY:64,errorZ:72,count:80,reserved:84,byteCount:88};t.decodeXYZ=function(e){var t=new DataView(e,0),s=0,a=i(e,t,s),l=a.identifier,c=a.version;if(s+=u.byteCount,"LEPCC     "!==l)throw new r("lepcc-decode-error","Bad identifier");if(c>1)throw new r("lepcc-decode-error","Unknown version");var d=n(t,s);if(s+=f.byteCount,d.sizeHi*Math.pow(2,32)+d.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");var h=new Float64Array(3*d.count),p=[],v=[],y=[],m=[];if((s=o(e,s=o(e,s=o(e,s=o(e,s,p),v),y),m))!==e.byteLength)throw new r("lepcc-decode-error","Bad length");for(var x=0,g=0,b=0;b<p.length;b++){g+=p[b];for(var _=0,I=0;I<v[b];I++){_+=y[x];var w=m[x];h[3*x]=Math.min(d.maxX,d.minX+2*d.errorX*_),h[3*x+1]=Math.min(d.maxY,d.minY+2*d.errorY*g),h[3*x+2]=Math.min(d.maxZ,d.minZ+2*d.errorZ*w),x++}}return{errorX:d.errorX,errorY:d.errorY,errorZ:d.errorZ,result:h}};var d={sizeLo:0,sizeHi:4,count:8,colorMapCount:12,lookupMethod:14,compressionMethod:15,byteCount:16};t.decodeRGB=function(e){var t=new DataView(e,0),n=0,o=i(e,t,n),s=o.identifier,l=o.version;if(n+=u.byteCount,"ClusterRGB"!==s)throw new r("lepcc-decode-error","Bad identifier");if(l>1)throw new r("lepcc-decode-error","Unknown version");var c=a(t,n);if(n+=d.byteCount,c.sizeHi*Math.pow(2,32)+c.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");if(2!==c.lookupMethod&&1!==c.lookupMethod||0!==c.compressionMethod){if(0===c.lookupMethod&&0===c.compressionMethod){if(3*c.count+n!==e.byteLength||0!==c.colorMapCount)throw new r("lepcc-decode-error","Bad count");return new Uint8Array(e,n).slice()}if(c.lookupMethod<=2&&1===c.compressionMethod){if(n+3!==e.byteLength||1!==c.colorMapCount)throw new r("lepcc-decode-error","Bad count");for(var f=t.getUint8(n),h=t.getUint8(n+1),p=t.getUint8(n+2),v=new Uint8Array(3*c.count),y=0;y<c.count;y++)v[3*y]=f,v[3*y+1]=h,v[3*y+2]=p;return v}throw new r("lepcc-decode-error","Bad method "+c.lookupMethod+","+c.compressionMethod)}if(3*c.colorMapCount+c.count+n!==e.byteLength||c.colorMapCount>256)throw new r("lepcc-decode-error","Bad count");var m=new Uint8Array(e,n,3*c.colorMapCount),x=new Uint8Array(e,n+3*c.colorMapCount,c.count);for(v=new Uint8Array(3*c.count),y=0;y<c.count;y++){var g=x[y];v[3*y]=m[3*g],v[3*y+1]=m[3*g+1],v[3*y+2]=m[3*g+2]}return v};var h={sizeLo:0,sizeHi:4,count:8,scaleFactor:12,bitsPerPoint:14,reserved:15,byteCount:16};t.decodeIntensity=function(e){var t=new DataView(e,0),n=0,o=i(e,t,n),a=o.identifier,c=o.version;if(n+=u.byteCount,"Intensity "!==a)throw new r("lepcc-decode-error","Bad identifier");if(c>1)throw new r("lepcc-decode-error","Unknown version");var f=l(t,n);if(n+=h.byteCount,f.sizeHi*Math.pow(2,32)+f.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");var d=new Uint16Array(f.count);if(8===f.bitsPerPoint){if(f.count+n!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(var p=new Uint8Array(e,n,f.count),v=0;v<f.count;v++)d[v]=p[v]*f.scaleFactor}else if(16===f.bitsPerPoint){if(2*f.count+n!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(p=new Uint16Array(e,n,f.count),v=0;v<f.count;v++)d[v]=p[v]*f.scaleFactor}else{if(s(e,n,p=[])!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(v=0;v<f.count;v++)d[v]=p[v]*f.scaleFactor}return d}}.apply(null,i))||(e.exports=n)},1622:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.equals=function(e,t){return e===this.x&&t===this.y},e.prototype.isEqual=function(e){return e.x===this.x&&e.y===this.y},e.prototype.setCoords=function(e,t){this.x=e,this.y=t},e.prototype.normalize=function(){var e=this.x,t=this.y,r=Math.sqrt(e*e+t*t);this.x/=r,this.y/=r},e.prototype.rightPerpendicular=function(){var e=this.x;this.x=this.y,this.y=-e},e.prototype.move=function(e,t){this.x+=e,this.y+=t},e.prototype.assign=function(e){this.x=e.x,this.y=e.y},e.prototype.assignAdd=function(e,t){this.x=e.x+t.x,this.y=e.y+t.y},e.prototype.assignSub=function(e,t){this.x=e.x-t.x,this.y=e.y-t.y},e.prototype.rotate=function(e,t){var r=this.x,i=this.y;this.x=r*e-i*t,this.y=r*t+i*e},e.prototype.scale=function(e){this.x*=e,this.y*=e},e.prototype.length=function(){var e=this.x,t=this.y;return Math.sqrt(e*e+t*t)},e.distance=function(e,t){var r=t.x-e.x,i=t.y-e.y;return Math.sqrt(r*r+i*i)},e.add=function(t,r){return new e(t.x+r.x,t.y+r.y)},e.sub=function(t,r){return new e(t.x-r.x,t.y-r.y)},e}();t.Point=r}.apply(null,i))||(e.exports=n)},1623:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){function r(e,t){return(e%=t)>=0?e:e+t}Object.defineProperty(t,"__esModule",{value:!0}),t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var i=1/Math.LN2;t.positiveMod=r,t.radToByte=function(e){return r(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return r(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*i},t.sqr=function(e){return e*e},t.clamp=function(e,t,r){return Math.min(Math.max(e,t),r)},t.interpolate=function(e,t,r){return e*(1-r)+t*r},t.between=function(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}}.apply(null,i))||(e.exports=n)},1625:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(49)],void 0===(n=function(e,t,r){function i(e,t,i,n,o,a,l,c,u,f,d){return function(e,t,i){for(var n=r.vec3d.dist2(e.maxVert[0],e.minVert[0]),o=0,s=1;s<7;++s){var a=r.vec3d.dist2(e.maxVert[s],e.minVert[s]);a>n&&(n=a,o=s)}r.vec3d.set(e.minVert[o],t),r.vec3d.set(e.maxVert[o],i)}(e,n,o),r.vec3d.dist2(n,o)<h?1:(r.vec3d.subtract(n,o,l),r.vec3d.normalize(l),function(e,t,i,n){for(var o=e.data,s=e.offsetIdx,a=e.strideIdx,l=Number.NEGATIVE_INFINITY,c=0,u=s;u<o.length;u+=a){r.vec3d.set3(o[u]-t[0],o[u+1]-t[1],o[u+2]-t[2],C);var f=i[0]*C[0]+i[1]*C[1]+i[2]*C[2],d=r.vec3d.length2(i),h=r.vec3d.length2(C)-f*f/d;h>l&&(l=h,c=u)}return r.vec3d.set3(o[c],o[c+1],o[c+2],n),l}(t,n,l,a)<h?2:(r.vec3d.subtract(o,a,c),r.vec3d.normalize(c),r.vec3d.subtract(a,n,u),r.vec3d.normalize(u),r.vec3d.cross(c,l,i),r.vec3d.normalize(i),s(t,i,l,c,u,f),0))}function n(e,t,i,n,a,l,c,u,f,d){o(e,t,i,n,a,y,m),void 0!==y[0]&&(r.vec3d.subtract(y,i,x),r.vec3d.normalize(x),r.vec3d.subtract(y,n,g),r.vec3d.normalize(g),r.vec3d.subtract(y,a,b),r.vec3d.normalize(b),r.vec3d.cross(g,l,_),r.vec3d.normalize(_),r.vec3d.cross(b,c,I),r.vec3d.normalize(I),r.vec3d.cross(x,u,w),r.vec3d.normalize(w),s(e,_,l,g,x,f),s(e,I,c,b,g,f),s(e,w,u,x,b,f)),void 0!==m[0]&&(r.vec3d.subtract(m,i,x),r.vec3d.normalize(x),r.vec3d.subtract(m,n,g),r.vec3d.normalize(g),r.vec3d.subtract(m,a,b),r.vec3d.normalize(b),r.vec3d.cross(g,l,_),r.vec3d.normalize(_),r.vec3d.cross(b,c,I),r.vec3d.normalize(I),r.vec3d.cross(x,u,w),r.vec3d.normalize(w),s(e,_,l,g,x,f),s(e,I,c,b,g,f),s(e,w,u,x,b,f))}function o(e,t,i,n,o,s,a){!function(e,t,i,n,o){var s=e.data,a=e.offsetIdx,l=e.strideIdx;r.vec3d.set3(s[a],s[a+1],s[a+2],n),r.vec3d.set(n,o),i[0]=r.vec3d.dot(D,t),i[1]=i[0];for(var c=a+l;c<s.length;c+=l){r.vec3d.set3(s[c],s[c+1],s[c+2],D);var u=r.vec3d.dot(D,t);u<i[0]&&(i[0]=u,r.vec3d.set(D,n)),u>i[1]&&(i[1]=u,r.vec3d.set(D,o))}}(e,t,T,a,s);var l=r.vec3.dot(i,t);T[1]-h<=l&&(s[0]=void 0),T[0]+h>=l&&(a[0]=void 0)}function s(e,t,i,n,o,s){if(!(r.vec3d.length2(t)<h)){r.vec3d.cross(i,t,P),r.vec3d.cross(n,t,M),r.vec3d.cross(o,t,S),a(e,t,T),A[1]=T[0],B[1]=T[1],E[1]=B[1]-A[1];for(var l=[i,n,o],c=[P,M,S],u=0;u<3;++u){a(e,l[u],T),A[0]=T[0],B[0]=T[1],a(e,c[u],T),A[2]=T[0],B[2]=T[1],E[0]=B[0]-A[0],E[2]=B[2]-A[2];var f=d(E);f<s.quality&&(r.vec3d.set(l[u],s.b0),r.vec3d.set(t,s.b1),r.vec3d.set(c[u],s.b2),s.quality=f)}}}function a(e,t,r){var i=e.data,n=e.offsetIdx,o=e.strideIdx;r[0]=Number.POSITIVE_INFINITY,r[1]=Number.NEGATIVE_INFINITY;for(var s=n;s<i.length;s+=o){var a=i[s]*t[0]+i[s+1]*t[1]+i[s+2]*t[2];r[0]=Math.min(r[0],a),r[1]=Math.max(r[1],a)}}function l(e,t,i){r.vec3d.set(e,i.center),r.vec3d.scale(t,.5,i.halfSize),r.quat4.identity(i.quaternion)}function c(e,t,i){r.vec3d.set(t,V),Math.abs(t[0])>Math.abs(t[1])&&Math.abs(t[0])>Math.abs(t[2])?V[0]=0:Math.abs(t[1])>Math.abs(t[2])?V[1]=0:V[2]=0,r.vec3d.length2(V)<h&&(V[0]=V[1]=V[2]=1),r.vec3d.cross(t,V,z),r.vec3d.normalize(z),r.vec3d.cross(t,z,N),r.vec3d.normalize(N),u(e,t,z,N,O,j),r.vec3d.subtract(j,O,F),f(t,z,N,O,j,F,i)}function u(e,t,r,i,n,o){a(e,t,T),n[0]=T[0],o[0]=T[1],a(e,r,T),n[1]=T[0],o[1]=T[1],a(e,i,T),n[2]=T[0],o[2]=T[1]}function f(e,t,i,n,o,s,a){L[0]=e[0],L[3]=e[1],L[6]=e[2],L[1]=t[0],L[4]=t[1],L[7]=t[2],L[2]=i[0],L[5]=i[1],L[8]=i[2],r.quat4.fromRotationMatrix(L,a.quaternion),r.vec3d.add(n,o,k),r.vec3d.scale(k,.5),r.vec3d.scale(e,k[0],a.center),r.vec3d.scale(t,k[1],R),r.vec3d.add(a.center,R),r.vec3d.scale(i,k[2],R),r.vec3d.add(a.center,R),r.vec3d.scale(s,.5,a.halfSize)}function d(e){return e[0]*e[1]+e[0]*e[2]+e[1]*e[2]}Object.defineProperty(t,"__esModule",{value:!0});var h=1e-6,p=r.vec3d.create(),v=r.vec3d.create();t.computeOBB=function(e,t){var o=e.data,s=e.strideIdx,a=o.length/s;if(!(a<=0)){var h=new U(e);r.vec3d.add(h.minProj,h.maxProj,p),r.vec3d.scale(p,.5),r.vec3d.subtract(h.maxProj,h.minProj,v);var y=d(v),m=new Y;m.quality=y,a<14&&(e={data:new Float64Array(h.buffer,112,42),size:3,offsetIdx:0,strideIdx:3});var x=r.vec3d.create(),g=r.vec3d.create(),b=r.vec3d.create(),_=r.vec3d.create(),I=r.vec3d.create(),w=r.vec3d.create(),C=r.vec3d.create();switch(i(h,e,C,x,g,b,_,I,w,m)){case 1:return void l(p,v,t);case 2:return void c(e,_,t)}n(e,C,x,g,b,_,I,w,m),u(e,m.b0,m.b1,m.b2,O,j);var T=r.vec3d.create();r.vec3d.subtract(j,O,T),m.quality=d(T),m.quality<y?f(m.b0,m.b1,m.b2,O,j,T,t):l(p,v,t)}};var y=r.vec3d.create(),m=r.vec3d.create(),x=r.vec3d.create(),g=r.vec3d.create(),b=r.vec3d.create(),_=r.vec3d.create(),I=r.vec3d.create(),w=r.vec3d.create(),C=r.vec3d.create(),T=r.vec2d.create(),P=r.vec3d.create(),M=r.vec3d.create(),S=r.vec3d.create(),B=r.vec3d.create(),A=r.vec3d.create(),E=r.vec3d.create(),D=r.vec3d.create(),V=r.vec3d.create(),z=r.vec3d.create(),N=r.vec3d.create(),O=r.vec3d.create(),j=r.vec3d.create(),F=r.vec3d.create(),R=r.vec3d.create(),L=r.mat3d.create(),k=r.vec3d.create(),U=function(){return function(e){this.minVert=[],this.maxVert=[],this.buffer=new ArrayBuffer(448);var t=0;for(this.minProj=new Float64Array(this.buffer,t,7),t+=56,this.maxProj=new Float64Array(this.buffer,t,7),t+=56;this.minVert.length<7;)this.minVert.push(new Float64Array(this.buffer,t,3)),t+=24;for(;this.maxVert.length<7;)this.maxVert.push(new Float64Array(this.buffer,t,3)),t+=24;for(var i=0;i<7;++i)this.minProj[i]=Number.POSITIVE_INFINITY,this.maxProj[i]=Number.NEGATIVE_INFINITY;var n=[],o=[],s=e.data,a=e.offsetIdx,l=e.strideIdx;for(i=a;i<s.length;i+=l){var c=s[i];c<this.minProj[0]&&(this.minProj[0]=c,n[0]=i),c>this.maxProj[0]&&(this.maxProj[0]=c,o[0]=i),(c=s[i+1])<this.minProj[1]&&(this.minProj[1]=c,n[1]=i),c>this.maxProj[1]&&(this.maxProj[1]=c,o[1]=i),(c=s[i+2])<this.minProj[2]&&(this.minProj[2]=c,n[2]=i),c>this.maxProj[2]&&(this.maxProj[2]=c,o[2]=i),(c=s[i]+s[i+1]+s[i+2])<this.minProj[3]&&(this.minProj[3]=c,n[3]=i),c>this.maxProj[3]&&(this.maxProj[3]=c,o[3]=i),(c=s[i]+s[i+1]-s[i+2])<this.minProj[4]&&(this.minProj[4]=c,n[4]=i),c>this.maxProj[4]&&(this.maxProj[4]=c,o[4]=i),(c=s[i]-s[i+1]+s[i+2])<this.minProj[5]&&(this.minProj[5]=c,n[5]=i),c>this.maxProj[5]&&(this.maxProj[5]=c,o[5]=i),(c=s[i]-s[i+1]-s[i+2])<this.minProj[6]&&(this.minProj[6]=c,n[6]=i),c>this.maxProj[6]&&(this.maxProj[6]=c,o[6]=i)}for(i=0;i<7;++i){var u=n[i];r.vec3d.set3(s[u],s[u+1],s[u+2],this.minVert[i]),u=o[i],r.vec3d.set3(s[u],s[u+1],s[u+2],this.maxVert[i])}}}(),Y=function(){return function(){this.b0=r.vec3d.createFrom(1,0,0),this.b1=r.vec3d.createFrom(0,1,0),this.b2=r.vec3d.createFrom(0,0,1),this.quality=0}}()}.apply(null,i))||(e.exports=n)},1644:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(0),r(6),r(17),r(5),r(1),r(1778),r(1779),r(1780)],void 0===(n=function(e,t,r,i,n,o,s,a,l,c,u){var f=o({pointCloudClassBreaksRenderer:"point-cloud-class-breaks",pointCloudRGBRenderer:"point-cloud-rgb",pointCloudStretchRenderer:"point-cloud-stretch",pointCloudUniqueValueRenderer:"point-cloud-unique-value"}),d=function(e){function t(t){var r=e.call(this)||this;return r.type=void 0,r.pointSizeAlgorithm=null,r.colorModulation=null,r.pointsPerInch=10,r}return r(t,e),t.prototype.clone=function(){return console.warn(".clone() is not implemented for "+this.declaredClass),null},t.prototype.cloneProperties=function(){return{pointSizeAlgorithm:s.clone(this.pointSizeAlgorithm),colorModulation:s.clone(this.colorModulation),pointsPerInch:s.clone(this.pointsPerInch)}},i([a.property({type:String,readOnly:!0,nonNullable:!0,json:{read:!1,write:f.write}})],t.prototype,"type",void 0),i([a.property({types:u.pointSizeAlgorithmTypes,json:{read:c.read,write:!0}})],t.prototype,"pointSizeAlgorithm",void 0),i([a.property({type:l.default,json:{write:!0}})],t.prototype,"colorModulation",void 0),i([a.property({json:{write:!0},nonNullable:!0,type:Number})],t.prototype,"pointsPerInch",void 0),i([a.subclass("esri.renderers.PointCloudRenderer")],t)}(a.declared(n));return(d||(d={})).fieldTransformTypeKebabDict=o({none:"none",lowFourBit:"low-four-bit",highFourBit:"high-four-bit",absoluteValue:"absolute-value",moduloTen:"modulo-ten"}),d}.apply(null,i))||(e.exports=n)},1654:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(e,t,r,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=e,this.y=t,this.width=r,this.height=i}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this.width<=0||this.height<=0},enumerable:!0,configurable:!0}),e}()}.apply(null,i))||(e.exports=n)},1668:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(0),r(6),r(17),r(1)],void 0===(n=function(e,t,r,i,n,o,s){Object.defineProperty(t,"__esModule",{value:!0}),t.typeKebabDictionary=o({pointCloudFixedSizeAlgorithm:"fixed-size",pointCloudSplatAlgorithm:"splat"});var a=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return r(n,e),i([s.property({type:String,readOnly:!0,nonNullable:!0,json:{read:!1,write:t.typeKebabDictionary.write}})],n.prototype,"type",void 0),i([s.subclass("esri.renderers.support.pointCloud.PointSizeAlgorithm")],n)}(s.declared(n));t.PointSizeAlgorithm=a,t.default=a}.apply(null,i))||(e.exports=n)},1670:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1520),r(1646),r(1447),r(1446)],void 0===(n=function(e,t,r,i,n,o){function s(e,t,r,i,n,o,s){switch(r){case 1:for(var a=0;a<s;a++)i[n]=e[t],t+=1,n+=o;break;case 2:for(a=0;a<s;a++)i[n]=e[t],i[n+1]=e[t+1],t+=2,n+=o;break;case 3:for(a=0;a<s;a++)i[n]=e[t],i[n+1]=e[t+1],i[n+2]=e[t+2],t+=3,n+=o;break;case 4:for(a=0;a<s;a++)i[n]=e[t],i[n+1]=e[t+1],i[n+2]=e[t+2],i[n+3]=e[t+3],t+=4,n+=o;break;default:throw d("Unhandled stride size "+r)}}function a(e,t,r,i,n,o){switch(t){case 1:for(var s=0;s<o;s++)r[i]=e,i+=n;break;case 2:for(s=0;s<o;s++)r[i]=e,r[i+1]=e,i+=n;break;case 3:for(s=0;s<o;s++)r[i]=e,r[i+1]=e,r[i+2]=e,i+=n;break;case 4:for(s=0;s<o;s++)r[i]=e,r[i+1]=e,r[i+2]=e,r[i+3]=e,i+=n;break;default:throw d("Unhandled stride size "+t)}}function l(e){switch(e){case 5120:return Int8Array;case 5126:return Float32Array;case 5124:return Int32Array;case 5122:return Int16Array;case 5121:return Uint8Array;case 5125:return Uint32Array;case 5123:return Uint16Array}throw new Error("Unhandled data type: "+e)}function c(e){switch(e){case 5120:return"Int8";case 5126:return"Float32";case 5124:return"Int32";case 5122:return"Int16";case 5121:return"UInt8";case 5125:return"UInt32";case 5123:return"UInt16"}throw new Error("Unhandled data type: "+e)}function u(e){return e%Uint32Array.BYTES_PER_ELEMENT==0}function f(e){return e>0&&e%Uint32Array.BYTES_PER_ELEMENT==0}function d(e){return new Error("I3SGeometryUtil processing failed: "+e)}function h(e){var t=e.normals,r=e.positions,i=e.normalInd,s=e.positionInd;o.assert(e.normalInd.length===e.positionInd.length);for(var a=n.vec3.create(),l=n.vec3.create(),c=n.vec2.create(),u=r.data,f=r.offsetIdx,d=r.strideIdx,h=t.data,p=t.offsetIdx,v=t.strideIdx,y=0;y<s.length;y+=3){var m=s[y],x=f+d*m,g=u[x],b=u[x+1],_=u[x+2];x=f+d*(m=s[y+1]),a[0]=u[x]-g,a[1]=u[x+1]-b,a[2]=u[x+2]-_,x=f+d*(m=s[y+2]),l[0]=u[x]-g,l[1]=u[x+1]-b,l[2]=u[x+2]-_,n.vec3.cross(a,l,a),o.encodeNormal(a,c);for(var I=0;I<3;I++){var w=p+v*i[y+I];h[w]=o.encodeInt16(c[0]),h[w+1]=o.encodeInt16(c[1])}}}function p(e,t,r){var i=e.length/3,n=t.data,s=t.offsetIdx,a=t.strideIdx;if(null!=r)for(var l=r,c=l[0],u=l[1],f=l[2],d=l[4],h=l[5],p=l[6],v=l[8],y=l[9],g=l[10],b=0;b<i;b++){var _=e[3*b],I=e[3*b+1],w=e[3*b+2];m[0]=c*_+u*I+f*w,m[1]=d*_+h*I+p*w,m[2]=v*_+y*I+g*w,o.encodeNormal(m,x),n[s+b*a]=o.encodeInt16(x[0]),n[s+b*a+1]=o.encodeInt16(x[1])}else for(b=0;b<i;b++)m[0]=e[3*b],m[1]=e[3*b+1],m[2]=e[3*b+2],o.encodeNormal(m,x),n[s+b*a]=o.encodeInt16(x[0]),n[s+b*a+1]=o.encodeInt16(x[1])}Object.defineProperty(t,"__esModule",{value:!0});var v=new Uint8Array(64);t.interleaveGeometryBuffer=function(e,t,r,i,n){void 0===i&&(i=[]),void 0===n&&(n=[]);var o=e.params.vertexAttributes,h=o.position.count;if(!f(r[0].stride))throw d("Layout stride must use "+Uint32Array.BYTES_PER_ELEMENT+"-byte words");for(var p=r[0].stride/Uint32Array.BYTES_PER_ELEMENT,y=new Uint32Array(p*h),m=0,x=r=r.slice(0).sort(function(e,t){return e.offset-t.offset});m<x.length;m++)!function(e){if(-1!==n.indexOf(e.name))return"continue";var r=o[e.name],p=l(e.type),m=void 0,x=!1;if(null==r){var g=i.filter(function(t){return t.name===e.name})[0];if(!g)throw d("Geometry definition is missing attribute");r={valueType:c(e.type),byteOffset:0,count:h,valuesPerElement:e.count};for(var b=0;b<v.length;b++)v[b]=g.byteValue;m=v.buffer,x=!0}else m=t;if(c(e.type)!==r.valueType)throw d("Geometry definition type must match attribute type");if(!u(r.byteOffset)||!u(e.offset))throw d(e.name+" offset must use "+Uint32Array.BYTES_PER_ELEMENT+"-byte words");if(!f(r.valuesPerElement*p.BYTES_PER_ELEMENT)||!f(e.count*p.BYTES_PER_ELEMENT))throw d(e.name+" data must use "+Uint32Array.BYTES_PER_ELEMENT+"-byte words");var _=new Uint32Array(m),I=r.byteOffset/Uint32Array.BYTES_PER_ELEMENT,w=r.valuesPerElement*p.BYTES_PER_ELEMENT/Uint32Array.BYTES_PER_ELEMENT,C=e.offset/Uint32Array.BYTES_PER_ELEMENT,T=e.stride/Uint32Array.BYTES_PER_ELEMENT;x?a(_[0],w,y,C,T,h):s(_,I,w,y,C,T,h)}(x[m]);return y.buffer},t.processAndInterleaveNormals=function(e,t,i,n,o){if("none"===e)h(o);else{var s=r.createTypedView(i,t.params.vertexAttributes.normal),a="earth-centered"===e?n:null;p(s,o.normals,a)}};var y=65536;t.extractPositionData=function(e,t,r){var n=t[0];if(null==n||"position"!==n.name||5126!==n.type)return null;for(var o=new Float32Array(e),s=n.stride/4,a=3*o.length/s,l=new Float32Array(a),c=0;c<a/3;c++)l[3*c]=o[c*s+n.offset],l[3*c+1]=o[c*s+n.offset+1],l[3*c+2]=o[c*s+n.offset+2];var u,f=i.deduplicate(l.buffer,3),d=f.uniqueCount<y;if(r)for(u=new(d?Uint16Array:Uint32Array)(r.length),c=0;c<r.length;c++)u[c]=f.indices[r[c]];else u=d?new Uint16Array(f.indices):f.indices;return{data:new Float32Array(f.buffer),indices:u}};var m=n.vec3.create(),x=n.vec2.create()}.apply(null,i))||(e.exports=n)},1671:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(49),r(98)],void 0===(n=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0}),t.ReprojectionTypes={PER_VERTEX:"perVertex",NO_REPROJECTION:"noReprojection"};var n=1e3,o=new Float64Array(3*n),s=r.vec3d.create();t.reprojectPoints=function(e,t,a,l,c,u){var f=e.data,d=e.offsetIdx,h=e.strideIdx;r.vec3d.set(t,s),s[2]+=a;var p=r.mat4d.create();i.computeLinearTransformation(l,s,p,u);var v=r.mat4d.create();r.mat4d.inverse(p,v);var y=r.mat4d.create();r.mat4d.identity(y);var m=[0,0,0],x=f.length/h;i.vectorToVector(s,l,m,c);for(var g=0;g<x;g+=n){for(var b=Math.min(n,x-g),_=0;_<b;_++){var I=d+h*(g+_);o[3*_]=f[I]+m[0],o[3*_+1]=f[I+1]+m[1],o[3*_+2]=f[I+2]+m[2]}for(i.bufferToBuffer(o,c,0,o,u,0,b),_=0;_<b;_++){var w=o[3*_],C=o[3*_+1],T=o[3*_+2],P=d+h*(g+_);f[P]=v[0]*w+v[4]*C+v[8]*T+v[12],f[P+1]=v[1]*w+v[5]*C+v[9]*T+v[13],f[P+2]=v[2]*w+v[6]*C+v[10]*T+v[14]}}return{localTrafo:y,globalTrafo:p}}}.apply(null,i))||(e.exports=n)},1684:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1654)],void 0===(n=function(e,t,r){return function(){function e(e,t,r,i,n,o,s,a){this._glyphItems=e,this._maxWidth=t,this._lineHeight=r,this._letterSpacing=i,this._offset=n,this._hAnchor=o,this._vAnchor=s,this._justify=a}return e.prototype.getShaping=function(e,t){for(var r=this._letterSpacing,i=this._lineHeight,n=this._justify,o=this._maxWidth,s=[],a=0,l=0,c=0,u=0,f=-1,d=0,h=-1,p=e.length,v=0;v<p;v++){var y=e.charCodeAt(v);if(10!==y){for(var m=void 0,x=0,g=this._glyphItems;x<g.length&&!(m=g[x][y]);x++);if(m){if(s.push({codePoint:y,x:a,y:l,glyphMosaicItem:m}),a+=m.metrics.advance+r,o>0&&a>o&&h>=0){var b=h+1,_=s[b].x;d=Math.max(_,d);for(var I=b;I<s.length;I++)t?s[I].y-=i:s[I].y+=i,s[I].x-=_;n&&this._applyJustification(s,u,h),t?l-=i:l+=i,a-=_,++c,u=b,h=-1}++f,32===y&&(h=s.length-1)}}else{if(v===p-1)continue;if(f>=u){_=(w=s[f]).x+w.glyphMosaicItem.metrics.advance;d=Math.max(_,d),n&&this._applyJustification(s,u,f),u=s.length}t?l-=i:l+=i,a=0,++c}}if(f>=u){var w,C=(w=s[f]).x+w.glyphMosaicItem.metrics.advance;d=Math.max(d,C),n&&this._applyJustification(s,u,f)}if(s.length>0){var T=(n-this._hAnchor)*d,P=(-this._vAnchor*(c+1)+.5)*i;t&&c&&(P+=c*i),T+=this._offset[0],P+=this._offset[1];for(var M=0,S=s;M<S.length;M++){var B=S[M];B.x+=T,B.y+=P}}return s},e.getBox=function(e){var t=e.length;if(0!==t){for(var r=e[0].x+e[0].glyphMosaicItem.metrics.left,i=r,n=e[0].y,o=n,s=n,a=1;a<t;a++){var l=e[a],c=l.x+l.glyphMosaicItem.metrics.left;c<r&&(r=c),c>i&&(i=c);var u=l.y;if(u<n&&(n=u),u>o&&(o=u),u!==s){var f=e[a-1].glyphMosaicItem.metrics.width;i=Math.max(i,e[a-1].x+e[a-1].glyphMosaicItem.metrics.left+f),s=u}}var d=e[t-1].glyphMosaicItem.metrics.width;return i=Math.max(i,e[t-1].x+e[t-1].glyphMosaicItem.metrics.left+d),{x:r,y:o+=12,width:i-r,height:o-(n-=12)}}},e.addDecoration=function(e,t){var i=e.length;if(0!==i){for(var n=e[0].x+e[0].glyphMosaicItem.metrics.left,o=e[0].y,s=1;s<i;s++){var a=e[s];if(a.y!==o){var l=e[s-1].x+e[s-1].glyphMosaicItem.metrics.left+e[s-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:n,y:o+t-3,glyphMosaicItem:{rect:new r(4,0,4,8),metrics:{width:l-n,height:8,left:0,top:0,advance:0},page:0}}),o=a.y,n=a.x+a.glyphMosaicItem.metrics.left}}var c=e[i-1].x+e[i-1].glyphMosaicItem.metrics.left+e[i-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:n,y:o+t-3,glyphMosaicItem:{rect:new r(4,0,4,8),metrics:{width:c-n,height:8,left:0,top:0,advance:0},page:0}})}},e.prototype._applyJustification=function(e,t,r){for(var i=e[r],n=i.glyphMosaicItem.metrics.advance,o=(i.x+n)*this._justify,s=t;s<=r;s++)e[s].x-=o},e}()}.apply(null,i))||(e.exports=n)},1685:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1622),r(1623)],void 0===(n=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(e,t,r){this.ratio=e,this.x=t,this.y=r}}(),o=function(){function e(e,t,r,i,n){void 0===i&&(i=8),void 0===n&&(n=8),this.lines=[],this.starts=[],this.pixelRatio=i,this.pixelMargin=n,this.tileSize=512*i,this.dz=e,this.yPos=t,this.xPos=r}return e.prototype.setExtent=function(e){this.finalRatio=this.tileSize/e*(1<<this.dz);var t=this.pixelRatio*this.pixelMargin;t/=this.finalRatio;var r=e>>this.dz;t>r&&(t=r),this.margin=t,this.xmin=r*this.xPos-t,this.ymin=r*this.yPos-t,this.xmax=this.xmin+r+2*t,this.ymax=this.ymin+r+2*t},e.prototype.reset=function(e){this.type=e,this.lines=[],this.starts=[],this.line=null,this.start=0},e.prototype.moveTo=function(e,t){this._pushLine(),this._prevIsIn=this._isIn(e,t),this._moveTo(e,t,this._prevIsIn),this._prevPt=new r.Point(e,t),this._firstPt=new r.Point(e,t),this._dist=0},e.prototype.lineTo=function(e,t){var i,o,s,a,l,c,u,f,d=this._isIn(e,t),h=new r.Point(e,t),p=r.Point.distance(this._prevPt,h);if(d)this._prevIsIn?this._lineTo(e,t,!0):(i=this._prevPt,o=h,s=this._intersect(o,i),this.start=this._dist+p*(1-this._r),this._lineTo(s.x,s.y,!0),this._lineTo(o.x,o.y,!0));else if(this._prevIsIn)o=this._prevPt,i=h,s=this._intersect(o,i),this._lineTo(s.x,s.y,!0),this._lineTo(i.x,i.y,!1);else{var v=this._prevPt,y=h;if(v.x<=this.xmin&&y.x<=this.xmin||v.x>=this.xmax&&y.x>=this.xmax||v.y<=this.ymin&&y.y<=this.ymin||v.y>=this.ymax&&y.y>=this.ymax)this._lineTo(y.x,y.y,!1);else{var m=[];if((v.x<this.xmin&&y.x>this.xmin||v.x>this.xmin&&y.x<this.xmin)&&(a=(this.xmin-v.x)/(y.x-v.x),(f=v.y+a*(y.y-v.y))<=this.ymin?c=!1:f>=this.ymax?c=!0:m.push(new n(a,this.xmin,f))),(v.x<this.xmax&&y.x>this.xmax||v.x>this.xmax&&y.x<this.xmax)&&(a=(this.xmax-v.x)/(y.x-v.x),(f=v.y+a*(y.y-v.y))<=this.ymin?c=!1:f>=this.ymax?c=!0:m.push(new n(a,this.xmax,f))),(v.y<this.ymin&&y.y>this.ymin||v.y>this.ymin&&y.y<this.ymin)&&(a=(this.ymin-v.y)/(y.y-v.y),(u=v.x+a*(y.x-v.x))<=this.xmin?l=!1:u>=this.xmax?l=!0:m.push(new n(a,u,this.ymin))),(v.y<this.ymax&&y.y>this.ymax||v.y>this.ymax&&y.y<this.ymax)&&(a=(this.ymax-v.y)/(y.y-v.y),(u=v.x+a*(y.x-v.x))<=this.xmin?l=!1:u>=this.xmax?l=!0:m.push(new n(a,u,this.ymax))),0===m.length)l?c?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):c?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(m.length>1&&m[0].ratio>m[1].ratio)this.start=this._dist+p*m[1].ratio,this._lineTo(m[1].x,m[1].y,!0),this._lineTo(m[0].x,m[0].y,!0);else{this.start=this._dist+p*m[0].ratio;for(var x=0;x<m.length;x++)this._lineTo(m[x].x,m[x].y,!0)}this._lineTo(y.x,y.y,!1)}}this._dist+=p,this._prevIsIn=d,this._prevPt=h},e.prototype.close=function(){if(this.line.length>2){var e=this._firstPt,t=this._prevPt;e.x===t.x&&e.y===t.y||this.lineTo(e.x,e.y);for(var r=this.line,i=r.length;i>=4&&(r[0].x===r[1].x&&r[0].x===r[i-2].x||r[0].y===r[1].y&&r[0].y===r[i-2].y);)r.pop(),r[0].x=r[i-2].x,r[0].y=r[i-2].y,--i}},e.prototype.result=function(e){return void 0===e&&(e=!0),this._pushLine(),0===this.lines.length?null:(3===this.type&&e&&a.simplify(this.tileSize,this.margin*this.finalRatio,this.lines),this.lines)},e.prototype.resultWithStarts=function(){if(2!==this.type)throw new Error("Only valid for lines");this._pushLine();var e=this.lines,t=e.length;if(0===t)return null;for(var r=[],i=0;i<t;i++)r.push({line:e[i],start:this.starts[i]||0});return r},e.prototype._isIn=function(e,t){return e>=this.xmin&&e<=this.xmax&&t>=this.ymin&&t<=this.ymax},e.prototype._intersect=function(e,t){var i,n,o;if(t.x>=this.xmin&&t.x<=this.xmax)o=((n=t.y<=this.ymin?this.ymin:this.ymax)-e.y)/(t.y-e.y),i=e.x+o*(t.x-e.x);else if(t.y>=this.ymin&&t.y<=this.ymax)o=((i=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),n=e.y+o*(t.y-e.y);else{n=t.y<=this.ymin?this.ymin:this.ymax;var s=((i=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),a=(n-e.y)/(t.y-e.y);s<a?(o=s,n=e.y+s*(t.y-e.y)):(o=a,i=e.x+a*(t.x-e.x))}return this._r=o,new r.Point(i,n)},e.prototype._pushLine=function(){this.line&&(1===this.type?this.line.length>0&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?this.line.length>1&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&this.line.length>3&&(this.lines.push(this.line),this.starts.push(this.start))),this.line=[],this.start=0},e.prototype._moveTo=function(e,t,i){3!==this.type?i&&(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new r.Point(e,t))):(i||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new r.Point(e,t)),this._is_h=!1,this._is_v=!1)},e.prototype._lineTo=function(e,t,i){var n,o;if(3!==this.type)if(i){if(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.length>0&&(n=this.line[this.line.length-1]).equals(e,t))return;this.line.push(new r.Point(e,t))}else this.line&&this.line.length>0&&this._pushLine();else if(i||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line&&this.line.length>0){var s=(n=this.line[this.line.length-1]).x===e,a=n.y===t;if(s&&a)return;this._is_h&&s?(n.x=e,n.y=t,(o=this.line[this.line.length-2]).x===e&&o.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(o=this.line[this.line.length-2],this._is_h=o.x===e,this._is_v=o.y===t)):(this._is_h=o.x===e,this._is_v=o.y===t)):this._is_v&&a?(n.x=e,n.y=t,(o=this.line[this.line.length-2]).x===e&&o.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(o=this.line[this.line.length-2],this._is_h=o.x===e,this._is_v=o.y===t)):(this._is_h=o.x===e,this._is_v=o.y===t)):(this.line.push(new r.Point(e,t)),this._is_h=s,this._is_v=a)}else this.line.push(new r.Point(e,t))},e}();t.TileClipper=o;var s=function(){function e(){}return e.prototype.setExtent=function(e){this._ratio=4096===e?1:4096/e},e.prototype.reset=function(e){this.type=e,this.lines=[],this.line=null},e.prototype.moveTo=function(e,t){this.line&&this.lines.push(this.line),this.line=[];var i=this._ratio;this.line.push(new r.Point(Math.round(e*i),Math.round(t*i)))},e.prototype.lineTo=function(e,t){var i=this._ratio;this.line.push(new r.Point(Math.round(e*i),Math.round(t*i)))},e.prototype.close=function(){var e=this.line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])},e.prototype.result=function(){return this.line&&this.lines.push(this.line),0===this.lines.length?null:(3===this.type&&1!==this._ratio&&a.simplify(4096,64,this.lines),this.lines)},e}();t.SimpleBuilder=s;var a=function(){function e(){}return e.simplify=function(t,r,i){if(i){for(var n=-r,o=t+r,s=-r,a=t+r,l=[],c=[],u=i.length,f=0;f<u;++f){var d=i[f];if(d&&!(d.length<2))for(var h=d[0],p=void 0,v=d.length,y=1;y<v;++y)p=d[y],h.x===p.x&&(h.x<=n&&(h.y>p.y?(l.push(f),l.push(y),l.push(0),l.push(-1)):(c.push(f),c.push(y),c.push(0),c.push(-1))),h.x>=o&&(h.y<p.y?(l.push(f),l.push(y),l.push(1),l.push(-1)):(c.push(f),c.push(y),c.push(1),c.push(-1)))),h.y===p.y&&(h.y<=s&&(h.x<p.x?(l.push(f),l.push(y),l.push(2),l.push(-1)):(c.push(f),c.push(y),c.push(2),c.push(-1))),h.y>=a&&(h.x>p.x?(l.push(f),l.push(y),l.push(3),l.push(-1)):(c.push(f),c.push(y),c.push(3),c.push(-1)))),h=p}if(0!==l.length&&0!==c.length){e.fillParent(i,c,l),e.fillParent(i,l,c);var m=[];e.calcDeltas(m,c,l),e.calcDeltas(m,l,c),e.addDeltas(m,i)}}},e.fillParent=function(e,t,r){for(var n=r.length,o=t.length,s=0;s<o;s+=4){for(var a=t[s],l=t[s+1],c=t[s+2],u=e[a][l-1],f=e[a][l],d=8092,h=-1,p=0;p<n;p+=4)if(r[p+2]===c){var v=r[p],y=r[p+1],m=e[v][y-1],x=e[v][y];switch(c){case 0:case 1:if(i.between(u.y,m.y,x.y)&&i.between(f.y,m.y,x.y))(g=Math.abs(x.y-m.y))<d&&(d=g,h=p);break;case 2:case 3:var g;if(i.between(u.x,m.x,x.x)&&i.between(f.x,m.x,x.x))(g=Math.abs(x.x-m.x))<d&&(d=g,h=p)}}t[s+3]=h}},e.calcDeltas=function(t,r,i){for(var n=r.length,o=0;o<n;o+=4){var s=e.calcDelta(o,r,i,[]);t.push(r[o]),t.push(r[o+1]),t.push(r[o+2]),t.push(s)}},e.calcDelta=function(t,r,i,n){var o=r[t+3];if(-1===o)return 0;var s=n.length;return s>1&&n[s-2]===o?0:(n.push(o),e.calcDelta(o,i,r,n)+1)},e.addDeltas=function(e,t){for(var r=e.length,i=0,n=0;n<r;n+=4){(a=e[n+3])>i&&(i=a)}for(n=0;n<r;n+=4){var o=t[e[n]],s=e[n+1],a=i-e[n+3];switch(e[n+2]){case 0:o[s-1].x-=a,o[s].x-=a,1===s&&(o[o.length-1].x-=a),s===o.length-1&&(o[0].x-=a);break;case 1:o[s-1].x+=a,o[s].x+=a,1===s&&(o[o.length-1].x+=a),s===o.length-1&&(o[0].x+=a);break;case 2:o[s-1].y-=a,o[s].y-=a,1===s&&(o[o.length-1].y-=a),s===o.length-1&&(o[0].y-=a);break;case 3:o[s-1].y+=a,o[s].y+=a,1===s&&(o[o.length-1].y+=a),s===o.length-1&&(o[0].y+=a)}}},e}()}.apply(null,i))||(e.exports=n)},1693:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(2),r(0),r(5),r(1),r(1644),r(260),r(1781)],void 0===(n=function(e,t,r,i,n,o,s,a,l,c){return function(e){function t(t){var r=e.call(this)||this;return r.type="point-cloud-class-breaks",r.field=null,r.legendOptions=null,r.fieldTransformType=null,r.colorClassBreakInfos=null,r}var u;return i(t,e),u=t,t.prototype.clone=function(){return new u(r({},this.cloneProperties(),{field:this.field,fieldTransformType:this.fieldTransformType,colorClassBreakInfos:o.clone(this.colorClassBreakInfos),legendOptions:o.clone(this.legendOptions)}))},n([s.property()],t.prototype,"type",void 0),n([s.property({json:{write:!0},type:String})],t.prototype,"field",void 0),n([s.property({type:l.default,json:{write:!0}})],t.prototype,"legendOptions",void 0),n([s.property({json:{read:a.fieldTransformTypeKebabDict.read,write:a.fieldTransformTypeKebabDict.write},type:String})],t.prototype,"fieldTransformType",void 0),n([s.property({type:[c.default],json:{write:!0}})],t.prototype,"colorClassBreakInfos",void 0),u=n([s.subclass("esri.renderers.PointCloudClassBreaksRenderer")],t)}(s.declared(a))}.apply(null,i))||(e.exports=n)},1694:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(0),r(1),r(1668)],void 0===(n=function(e,t,r,i,n,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="fixed-size",t.size=0,t.useRealWorldSymbolSizes=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({size:this.size,useRealWorldSymbolSizes:this.useRealWorldSymbolSizes})},i([n.property()],t.prototype,"type",void 0),i([n.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"size",void 0),i([n.property({type:Boolean,json:{write:!0}})],t.prototype,"useRealWorldSymbolSizes",void 0),o=i([n.subclass("esri.renderers.support.pointCloud.PointSizeFixedSizeAlgorithm")],t)}(n.declared(o.default));t.PointSizeFixedSizeAlgorithm=s,t.default=s}.apply(null,i))||(e.exports=n)},1695:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(0),r(1),r(1668)],void 0===(n=function(e,t,r,i,n,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="splat",t.scaleFactor=1,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({scaleFactor:this.scaleFactor})},i([n.property()],t.prototype,"type",void 0),i([n.property({type:Number,value:1,nonNullable:!0,json:{write:!0}})],t.prototype,"scaleFactor",void 0),o=i([n.subclass("esri.renderers.support.pointCloud.PointSizeSplatAlgorithm")],t)}(n.declared(o.default));t.PointSizeSplatAlgorithm=s,t.default=s}.apply(null,i))||(e.exports=n)},1696:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(2),r(0),r(5),r(1),r(1644),r(260),r(1782)],void 0===(n=function(e,t,r,i,n,o,s,a,l,c){return function(e){function t(t){var r=e.call(this)||this;return r.type="point-cloud-stretch",r.field=null,r.legendOptions=null,r.fieldTransformType=null,r.stops=null,r}var u;return i(t,e),u=t,t.prototype.clone=function(){return new u(r({},this.cloneProperties(),{field:o.clone(this.field),fieldTransformType:o.clone(this.fieldTransformType),stops:o.clone(this.stops),legendOptions:o.clone(this.legendOptions)}))},n([s.property()],t.prototype,"type",void 0),n([s.property({json:{write:!0},type:String})],t.prototype,"field",void 0),n([s.property({type:l.default,json:{write:!0}})],t.prototype,"legendOptions",void 0),n([s.property({json:{read:a.fieldTransformTypeKebabDict.read,write:a.fieldTransformTypeKebabDict.write},type:String})],t.prototype,"fieldTransformType",void 0),n([s.property({type:[c.default],json:{write:!0}})],t.prototype,"stops",void 0),u=n([s.subclass("esri.renderers.PointCloudStretchRenderer")],t)}(s.declared(a))}.apply(null,i))||(e.exports=n)},1697:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(2),r(0),r(5),r(1),r(1644),r(260),r(1783)],void 0===(n=function(e,t,r,i,n,o,s,a,l,c){return function(e){function t(t){var r=e.call(this)||this;return r.type="point-cloud-unique-value",r.field=null,r.fieldTransformType=null,r.colorUniqueValueInfos=null,r.legendOptions=null,r}var u;return i(t,e),u=t,t.prototype.clone=function(){return new u(r({},this.cloneProperties(),{field:o.clone(this.field),fieldTransformType:o.clone(this.fieldTransformType),colorUniqueValueInfos:o.clone(this.colorUniqueValueInfos),legendOptions:o.clone(this.legendOptions)}))},n([s.property()],t.prototype,"type",void 0),n([s.property({json:{write:!0},type:String})],t.prototype,"field",void 0),n([s.property({json:{read:a.fieldTransformTypeKebabDict.read,write:a.fieldTransformTypeKebabDict.write},type:String})],t.prototype,"fieldTransformType",void 0),n([s.property({type:[c.default],json:{write:!0}})],t.prototype,"colorUniqueValueInfos",void 0),n([s.property({type:l.default,json:{write:!0}})],t.prototype,"legendOptions",void 0),u=n([s.subclass("esri.renderers.PointCloudUniqueValueRenderer")],t)}(s.declared(a))}.apply(null,i))||(e.exports=n)},1701:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(e,t){this.layerExtent=4096,this._features=[],this.layer=e,this.zoom=t,this._filter=e.getFeatureFilter()}return e.prototype.pushFeature=function(e){this._filter.filter(e)&&this._features.push(e)},e.prototype.hasFeatures=function(){return this._features.length>0},e.prototype.processFeatures=function(e,t){},e.prototype.assignBufferInfo=function(e){},e}()}.apply(null,i))||(e.exports=n)},1766:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(e){this._array=[],e<=0&&console.error("strideInBytes must be positive!"),this._stride=e}return Object.defineProperty(e.prototype,"array",{get:function(){return this._array},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return 4*this._array.length/this._stride},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemSize",{get:function(){return this._stride},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sizeInBytes",{get:function(){return 4*this._array.length},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.array.length=0},e.prototype.toBuffer=function(){return new Uint32Array(this._array).buffer},e.i1616to32=function(e,t){return 65535&e|t<<16},e.i8888to32=function(e,t,r,i){return 255&e|(255&t)<<8|(255&r)<<16|i<<24},e.i8816to32=function(e,t,r){return 255&e|(255&t)<<8|r<<16},e}()}.apply(null,i))||(e.exports=n)},1767:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){function r(e){var t,r={items:new Array,count:0};for(t=0;t<e;++t)r.items.push(void 0);return r}function i(e,t){b.vector[0]=e.vector[0],b.vector[1]=e.vector[1],b.texCoords[0]=e.texCoords[0],b.texCoords[1]=e.texCoords[1],b.direction[0]=e.direction[0],b.direction[1]=e.direction[1],b.base=e.base,e.vector[0]=t.vector[0],e.vector[1]=t.vector[1],e.texCoords[0]=t.texCoords[0],e.texCoords[1]=t.texCoords[1],e.direction[0]=t.direction[0],e.direction[1]=t.direction[1],e.base=t.base,t.vector[0]=b.vector[0],t.vector[1]=b.vector[1],t.texCoords[0]=b.texCoords[0],t.texCoords[1]=b.texCoords[1],t.direction[0]=b.direction[0],t.direction[1]=b.direction[1],t.base=b.base}function n(e,t){return e[0]*t[0]+e[1]*t[1]}function o(e){return Math.sqrt(n(e,e))}function s(e,t){var r=o(t);return e[0]=t[0]/r,e[1]=t[1]/r,e}function a(e,t){return e[0]=-t[1],e[1]=t[0],e}function l(e,t){return e[0]*t[1]-e[1]*t[0]}function c(e,t){return e[0]=-t[0],e[1]=-t[1],e}function u(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function f(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function d(e,t,r){return function(e,t,r){return(t[0]-e[0])*(r[1]-e[1])-(r[0]-e[0])*(t[1]-e[1])}(e,t,r)<0}function h(e,t){var r=n(e,t);return r>.999?0:r<-.999?Math.PI:Math.acos(r)}function p(e,t,r,i,n){if(0!==i){var s,a=o(t),l=h(u(I[0],t,1/a),u(I[1],r,1/a)),c=(n?-1:1)*l/i,f=Math.cos(c),d=Math.sin(c),p=t[0],v=t[1];for(s=0;s<i-1;++s){var y=p;p=f*y-d*v,v=d*y+f*v,e.items[s][0]=p,e.items[s][1]=v}e.count=i-1}else e.count=0}function v(e){var t,r=e.count,i=Math.floor(r/2);for(t=0;t<i;++t){var n=e.items[t];e.items[t]=e.items[r-t-1],e.items[r-t-1]=n}}var y,m;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ENTRY=1]="ENTRY",e[e.EXIT=2]="EXIT",e[e.CAP=3]="CAP"}(y=t.VectorRole||(t.VectorRole={})),function(e){e[e.START=1]="START",e[e.END=2]="END"}(m=t.CapPosition||(t.CapPosition={})),t.SYSTEM_MAG_LIMIT=3.8,t.MITER_SAFE_RADS=2*Math.acos(1/t.SYSTEM_MAG_LIMIT);var x=t.SYSTEM_MAG_LIMIT*t.SYSTEM_MAG_LIMIT,g=16/(2*Math.PI);t.allocTriangles=function(e){var t,r={items:new Array,count:0};for(t=0;t<e;++t)r.items.push({v1:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v2:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v3:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]}});return r},t.allocExtrudeVectors=function(){var e=function(e){var t,r={items:new Array,count:0};for(t=0;t<e;++t)r.items.push({vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]});return r}(30),t={};return t[y.ENTRY]=r(20),t[y.EXIT]=r(20),t[y.CAP]=r(20),{vectors:e,lists:t}},t.copyExtrudeVectors=function(e,t){var r;for(r=0;r<t.vectors.count;++r)e.vectors.items[r].vector[0]=t.vectors.items[r].vector[0],e.vectors.items[r].vector[1]=t.vectors.items[r].vector[1],e.vectors.items[r].texCoords[0]=t.vectors.items[r].texCoords[0],e.vectors.items[r].texCoords[1]=t.vectors.items[r].texCoords[1],e.vectors.items[r].direction[0]=t.vectors.items[r].direction[0],e.vectors.items[r].direction[1]=t.vectors.items[r].direction[1],e.vectors.items[r].base=t.vectors.items[r].base;e.vectors.count=t.vectors.count;var i=t.lists[y.ENTRY],n=e.lists[y.ENTRY],o=t.lists[y.EXIT],s=e.lists[y.EXIT],a=t.lists[y.CAP],l=e.lists[y.CAP];for(r=0;r<i.count;++r)n.items[r]=i.items[r];for(n.count=i.count,r=0;r<o.count;++r)s.items[r]=o.items[r];for(s.count=o.count,r=0;r<a.count;++r)l.items[r]=a.items[r];l.count=a.count,e.capCenter=t.capCenter};var b={vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0],base:void 0};t.swapExtrudeVectors=i;var _,I=[];for(_=0;_<32;++_)I.push([void 0,void 0]);var w=function(e){var t,r={items:new Array,count:0};for(t=0;t<16;++t)r.items.push([void 0,void 0]);return r}();t.length=o,t.normalize=s,t.getNumberOfSlices=function(e){return Math.max(Math.round(e*g),1)},t.getRads=h,t.reverse=v;var C=[void 0,void 0],T=[void 0,void 0],P=[0,0],M=[0,0],S=[0,0],B=[0,0],A=Math.cos(Math.PI/4),E=Math.sin(Math.PI/4),D=Math.sqrt(2),V=function(){function e(e){this._distanceAlongCorrection=e.distanceAlongCorrection}return e.prototype.bridge=function(e,t,r){var n,o,s,a,l=t.vectors,c=t.lists[y.EXIT],u=r.vectors,f=r.lists[y.ENTRY];if(c.count===f.count+1)n=c.items,o=l.items,s=f.items,a=u.items;else if(f.count===c.count+1)n=f.items,o=u.items,s=c.items,a=l.items;else{if(c.count!==f.count)return console.error("Cannot bridge "+c.count+" to "+f.count+"."),void(e.count=0);n=f.items,o=u.items,s=c.items,a=l.items}var h,p=c.count+f.count-2;for(e.count=p,C[0]=n,C[1]=s,T[0]=o,T[1]=a,h=0;h<p;++h){var v=e.items[h],m=(h+0)%2,x=Math.floor((h+0)/2),g=T[m][C[m][x]];v.v1.vector[0]=g.vector[0],v.v1.vector[1]=g.vector[1],v.v1.texCoords[0]=g.texCoords[0],v.v1.texCoords[1]=g.texCoords[1],v.v1.direction[0]=g.direction[0],v.v1.direction[1]=g.direction[1],v.v1.base=g.base;var b=(h+1)%2,_=Math.floor((h+1)/2),I=T[b][C[b][_]];v.v2.vector[0]=I.vector[0],v.v2.vector[1]=I.vector[1],v.v2.texCoords[0]=I.texCoords[0],v.v2.texCoords[1]=I.texCoords[1],v.v2.direction[0]=I.direction[0],v.v2.direction[1]=I.direction[1],v.v2.base=I.base;var w=(h+2)%2,A=Math.floor((h+2)/2),E=T[w][C[w][A]];v.v3.vector[0]=E.vector[0],v.v3.vector[1]=E.vector[1],v.v3.texCoords[0]=E.texCoords[0],v.v3.texCoords[1]=E.texCoords[1],v.v3.direction[0]=E.direction[0],v.v3.direction[1]=E.direction[1],v.v3.base=E.base;var D=v.v1.base&&v.v1.base.point||P,V=v.v2.base&&v.v2.base.point||P,z=v.v3.base&&v.v3.base.point||P;M[0]=D[0]+v.v1.vector[0],M[1]=D[1]+v.v1.vector[1],S[0]=V[0]+v.v2.vector[0],S[1]=V[1]+v.v2.vector[1],B[0]=z[0]+v.v3.vector[0],B[1]=z[1]+v.v3.vector[1],d(M,S,B)||i(v.v2,v.v3)}},e.prototype.pie=function(e,t){if(0!==t.lists[y.CAP].count){if(1===t.lists[y.CAP].count)return console.error("A single vector is not enough to define a pie."),void(e.count=0);var r;for(e.count=t.lists[y.CAP].count-1,r=0;r<e.count;++r){var n=e.items[r],o=t.lists[y.CAP].items[r],s=t.vectors.items[o];n.v1.vector[0]=s.vector[0],n.v1.vector[1]=s.vector[1],n.v1.texCoords[0]=s.texCoords[0],n.v1.texCoords[1]=s.texCoords[1],n.v1.direction[0]=s.direction[0],n.v1.direction[1]=s.direction[1],n.v1.base=s.base;var a=t.lists[y.CAP].items[r+1],l=t.vectors.items[a];n.v2.vector[0]=l.vector[0],n.v2.vector[1]=l.vector[1],n.v2.texCoords[0]=l.texCoords[0],n.v2.texCoords[1]=l.texCoords[1],n.v2.direction[0]=l.direction[0],n.v2.direction[1]=l.direction[1],n.v2.base=l.base;var c=t.capCenter,u=t.vectors.items[c];n.v3.vector[0]=u.vector[0],n.v3.vector[1]=u.vector[1],n.v3.texCoords[0]=u.texCoords[0],n.v3.texCoords[1]=u.texCoords[1],n.v3.direction[0]=u.direction[0],n.v3.direction[1]=u.direction[1],n.v3.base=u.base;var f=n.v1.base&&n.v1.base.point||P,h=n.v2.base&&n.v2.base.point||P,p=n.v3.base&&n.v3.base.point||P;M[0]=f[0]+n.v1.vector[0],M[1]=f[1]+n.v1.vector[1],S[0]=h[0]+n.v2.vector[0],S[1]=h[1]+n.v2.vector[1],B[0]=p[0]+n.v3.vector[0],B[1]=p[1]+n.v3.vector[1],d(M,S,B)||i(n.v2,n.v3)}}else e.count=0},e.prototype.buttCap=function(e,t,r){this.fastMiterJoin(e,t,r)},e.prototype.roundCap=function(e,t,r,i,n,o){void 0===o&&(o=0),this.fastMiterJoin(e,t,r);var s=i===m.START?0:1,a=i===m.START?1:0;e.capCenter=e.vectors.count;var l=e.vectors.items[e.capCenter];l.vector[0]=0,l.vector[1]=0,l.texCoords[0]=0,l.texCoords[1]=0,l.direction[0]=0,l.direction[1]=0,++e.vectors.count,p(w,e.vectors.items[s].vector,e.vectors.items[a].vector,n,!1);var c=e.vectors.count,u=e.lists[y.CAP];u.items[0]=s;var f,d=e.vectors.items[s].texCoords[1],h=e.vectors.items[a].texCoords[1];for(f=0;f<w.count;++f){var v=o*(1-Math.abs(w.count/2-f)/(w.count/2)),x=d+f/(w.count-1)*(h-d),g=w.items[f],b=e.vectors.items[c+f];b.vector[0]=g[0],b.vector[1]=g[1],b.texCoords[0]=v,b.texCoords[1]=x,b.direction[0]=0,b.direction[1]=0,u.items[f+1]=c+f}u.items[w.count+1]=a,u.count=w.count+2,e.vectors.count=c+w.count},e.prototype.squareCap=function(e,t,r,i){this.fastMiterJoin(e,t,r);var n=i===m.START?0:1,o=i===m.START?1:0,s=I[0],a=I[1],l=I[2],c=I[3],f=I[4],d=e.vectors.items[n].vector;s[0]=A*d[0]-E*d[1],s[1]=E*d[0]+A*d[1],u(c,s,D),a[0]=A*s[0]-E*s[1],a[1]=E*s[0]+A*s[1],l[0]=A*a[0]-E*a[1],l[1]=E*a[0]+A*a[1],u(f,l,D);var h=e.vectors.items[n];h.vector[0]=c[0],h.vector[1]=c[1];var p=e.vectors.items[o];p.vector[0]=f[0],p.vector[1]=f[1]},e.prototype.fastMiterJoin=function(e,t,r){var i=a(I[0],r),n=i,o=c(I[1],i),s=e.vectors.items[0];s.vector[0]=n[0],s.vector[1]=n[1],s.texCoords[0]=0,s.texCoords[1]=-1,s.direction[0]=0,s.direction[1]=0;var l=e.vectors.items[1];l.vector[0]=o[0],l.vector[1]=o[1],l.texCoords[0]=0,l.texCoords[1]=1,l.direction[0]=0,l.direction[1]=0,e.vectors.count=2;var u=e.lists[y.ENTRY];u.items[0]=0,u.items[1]=1,u.count=2;var f=e.lists[y.EXIT];f.items[0]=0,f.items[1]=1,f.count=2,e.lists[y.CAP].count=0,e.capCenter=void 0},e.prototype.miterJoin=function(e,t,r){var i=a(I[0],t),o=a(I[1],r),l=I[2];l[0]=i[0]+o[0],l[1]=i[1]+o[1];var f=s(I[3],l),d=n(f,i);f=u(I[4],f,1/d);var h=c(I[5],f);if(this._distanceAlongCorrection){(m=e.vectors.items[0]).vector[0]=f[0],m.vector[1]=f[1],m.texCoords[0]=0,m.texCoords[1]=-1,m.direction[0]=t[0],m.direction[1]=t[1],(x=e.vectors.items[1]).vector[0]=h[0],x.vector[1]=h[1],x.texCoords[0]=0,x.texCoords[1]=1,x.direction[0]=t[0],x.direction[1]=t[1];var p=e.vectors.items[2];p.vector[0]=f[0],p.vector[1]=f[1],p.texCoords[0]=0,p.texCoords[1]=-1,p.direction[0]=r[0],p.direction[1]=r[1];var v=e.vectors.items[3];v.vector[0]=h[0],v.vector[1]=h[1],v.texCoords[0]=0,v.texCoords[1]=1,v.direction[0]=r[0],v.direction[1]=r[1],e.vectors.count=4,(g=e.lists[y.ENTRY]).items[0]=0,g.items[1]=1,g.count=2,(b=e.lists[y.EXIT]).items[0]=2,b.items[1]=3,b.count=2}else{var m,x,g,b;(m=e.vectors.items[0]).vector[0]=f[0],m.vector[1]=f[1],m.texCoords[0]=0,m.texCoords[1]=-1,m.direction[0]=0,m.direction[1]=0,(x=e.vectors.items[1]).vector[0]=h[0],x.vector[1]=h[1],x.texCoords[0]=0,x.texCoords[1]=1,x.direction[0]=0,x.direction[1]=0,e.vectors.count=2,(g=e.lists[y.ENTRY]).items[0]=0,g.items[1]=1,g.count=2,(b=e.lists[y.EXIT]).items[0]=0,b.items[1]=1,b.count=2}e.lists[y.CAP].count=0,e.capCenter=void 0},e.prototype.bevelJoin=function(e,t,r,i){var o=i*i,d=l(t,r),h=d>0?[-1,1]:[1,-1],p=h[0],m=h[1],g=d>0?c(I[0],a(I[1],t)):a(I[2],t),b=d>0?c(I[3],a(I[4],r)):a(I[5],r),_=I[6];_[0]=g[0]+b[0],_[1]=g[1]+b[1];var w=s(I[7],_),C=c(I[8],w),T=n(w,g),P=l(w,g),M=Math.abs(P/T),S=1+M*M,B=S<x?[M,this._distanceAlongCorrection]:[Math.sqrt(x-1),!0],A=B[0],E=B[1],D=S<o?[M,this._distanceAlongCorrection]:[Math.sqrt(o-1),!0],V=D[0],z=D[1];if(z&&E){f((R=e.vectors.items[0]).vector,c(I[9],g),u(I[10],c(I[11],t),A)),R.texCoords[0]=0,R.texCoords[1]=p,R.direction[0]=this._distanceAlongCorrection?t[0]:0,R.direction[1]=this._distanceAlongCorrection?t[1]:0,f((L=e.vectors.items[1]).vector,c(I[12],b),u(I[13],r,A)),L.texCoords[0]=0,L.texCoords[1]=p,L.direction[0]=this._distanceAlongCorrection?r[0]:0,L.direction[1]=this._distanceAlongCorrection?r[1]:0,(O=e.vectors.items[2]).vector[0]=0,O.vector[1]=0,O.texCoords[0]=0,O.texCoords[1]=0,O.direction[0]=0,O.direction[1]=0,f((j=e.vectors.items[3]).vector,g,u(I[14],t,V)),j.texCoords[0]=0,j.texCoords[1]=m,j.direction[0]=this._distanceAlongCorrection?t[0]:0,j.direction[1]=this._distanceAlongCorrection?t[1]:0;var N=e.vectors.items[4];if(f(N.vector,b,u(I[15],c(I[16],r),V)),N.texCoords[0]=0,N.texCoords[1]=m,N.direction[0]=this._distanceAlongCorrection?r[0]:0,N.direction[1]=this._distanceAlongCorrection?r[1]:0,e.vectors.count=5,(k=e.lists[y.ENTRY]).items[0]=0,k.items[1]=2,k.items[2]=3,k.count=3,(U=e.lists[y.EXIT]).items[0]=1,U.items[1]=2,U.items[2]=4,U.count=3,S<o)(F=e.lists[y.CAP]).count=0,e.capCenter=void 0;else(F=e.lists[y.CAP]).items[0]=3,F.items[1]=4,F.count=2,e.capCenter=2}else if(!z&&E){f((R=e.vectors.items[0]).vector,c(I[9],g),u(I[10],c(I[11],t),A)),R.texCoords[0]=0,R.texCoords[1]=p,R.direction[0]=this._distanceAlongCorrection?t[0]:0,R.direction[1]=this._distanceAlongCorrection?t[1]:0,f((L=e.vectors.items[1]).vector,c(I[12],b),u(I[13],r,A)),L.texCoords[0]=0,L.texCoords[1]=p,L.direction[0]=this._distanceAlongCorrection?r[0]:0,L.direction[1]=this._distanceAlongCorrection?r[1]:0,(O=e.vectors.items[2]).vector[0]=0,O.vector[1]=0,O.texCoords[0]=0,O.texCoords[1]=0,O.direction[0]=0,O.direction[1]=0,u((j=e.vectors.items[3]).vector,w,1/T),j.texCoords[0]=0,j.texCoords[1]=m,j.direction[0]=0,j.direction[1]=0,e.vectors.count=4,(k=e.lists[y.ENTRY]).items[0]=0,k.items[1]=2,k.items[2]=3,k.count=3,(U=e.lists[y.EXIT]).items[0]=1,U.items[1]=2,U.items[2]=3,U.count=3,e.lists[y.CAP].count=0,e.capCenter=void 0}else if(z&&!E){var O,j,F;if(u((R=e.vectors.items[0]).vector,C,1/T),R.texCoords[0]=0,R.texCoords[1]=p,R.direction[0]=0,R.direction[1]=0,(L=e.vectors.items[1]).vector[0]=0,L.vector[1]=0,L.texCoords[0]=0,L.texCoords[1]=0,L.direction[0]=0,L.direction[1]=0,f((O=e.vectors.items[2]).vector,g,u(I[9],t,V)),O.texCoords[0]=0,O.texCoords[1]=m,O.direction[0]=this._distanceAlongCorrection?t[0]:0,O.direction[1]=this._distanceAlongCorrection?t[1]:0,f((j=e.vectors.items[3]).vector,b,u(I[10],c(I[11],r),V)),j.texCoords[0]=0,j.texCoords[1]=m,j.direction[0]=this._distanceAlongCorrection?r[0]:0,j.direction[1]=this._distanceAlongCorrection?r[1]:0,e.vectors.count=4,(k=e.lists[y.ENTRY]).items[0]=0,k.items[1]=1,k.items[2]=2,k.count=3,(U=e.lists[y.EXIT]).items[0]=0,U.items[1]=1,U.items[2]=3,U.count=3,S<o)(F=e.lists[y.CAP]).count=0,e.capCenter=void 0;else(F=e.lists[y.CAP]).items[0]=2,F.items[1]=3,F.count=2,e.capCenter=1}else if(!z&&!E){var R,L,k,U;u((R=e.vectors.items[0]).vector,C,1/T),R.texCoords[0]=0,R.texCoords[1]=p,R.direction[0]=0,R.direction[1]=0,u((L=e.vectors.items[1]).vector,w,1/T),L.texCoords[0]=0,L.texCoords[1]=m,L.direction[0]=0,L.direction[1]=0,e.vectors.count=2,(k=e.lists[y.ENTRY]).items[0]=0,k.items[1]=1,k.count=2,(U=e.lists[y.EXIT]).items[0]=0,U.items[1]=1,U.count=2,e.lists[y.CAP].count=0,e.capCenter=void 0}d<0&&(v(e.lists[y.ENTRY]),v(e.lists[y.EXIT]))},e.prototype.roundJoin=function(e,t,r,i){var o=l(t,r),d=o>0?[-1,1]:[1,-1],h=d[0],m=d[1],g=o>0?c(I[0],a(I[1],t)):a(I[2],t),b=o>0?c(I[3],a(I[4],r)):a(I[5],r),_=I[6];_[0]=g[0]+b[0],_[1]=g[1]+b[1];var C=s(I[7],_),T=c(I[8],C),P=n(C,g),M=l(C,g),S=Math.abs(M/P),B=1+S*S<x?[S,this._distanceAlongCorrection]:[Math.sqrt(x-1),!0],A=B[0];if(B[1]){(D=e.vectors.items[0]).vector[0]=g[0],D.vector[1]=g[1],D.texCoords[0]=0,D.texCoords[1]=m,D.direction[0]=0,D.direction[1]=0,(V=e.vectors.items[1]).vector[0]=b[0],V.vector[1]=b[1],V.texCoords[0]=0,V.texCoords[1]=m,V.direction[0]=0,V.direction[1]=0,f((z=e.vectors.items[2]).vector,c(I[9],g),u(I[10],c(I[11],t),A)),z.texCoords[0]=0,z.texCoords[1]=h,z.direction[0]=this._distanceAlongCorrection?t[0]:0,z.direction[1]=this._distanceAlongCorrection?t[1]:0,f((N=e.vectors.items[3]).vector,c(I[12],b),u(I[13],r,A)),N.texCoords[0]=0,N.texCoords[1]=h,N.direction[0]=this._distanceAlongCorrection?r[0]:0,N.direction[1]=this._distanceAlongCorrection?r[1]:0;var E=e.vectors.items[4];E.vector[0]=0,E.vector[1]=0,E.texCoords[0]=0,E.texCoords[1]=0,E.direction[0]=0,E.direction[1]=0,e.vectors.count=5,(O=e.lists[y.ENTRY]).items[0]=2,O.items[1]=4,O.items[2]=0,O.count=3,(j=e.lists[y.EXIT]).items[0]=3,j.items[1]=4,j.items[2]=1,j.count=3,e.capCenter=4}else{var D,V,z,N,O,j;(D=e.vectors.items[0]).vector[0]=g[0],D.vector[1]=g[1],D.texCoords[0]=0,D.texCoords[1]=m,D.direction[0]=0,D.direction[1]=0,(V=e.vectors.items[1]).vector[0]=b[0],V.vector[1]=b[1],V.texCoords[0]=0,V.texCoords[1]=m,V.direction[0]=0,V.direction[1]=0,u((z=e.vectors.items[2]).vector,T,1/P),z.texCoords[0]=0,z.texCoords[1]=h,z.direction[0]=0,z.direction[1]=0,(N=e.vectors.items[3]).vector[0]=0,N.vector[1]=0,N.texCoords[0]=0,N.texCoords[1]=0,N.direction[0]=0,N.direction[1]=0,e.vectors.count=4,(O=e.lists[y.ENTRY]).items[0]=2,O.items[1]=3,O.items[2]=0,O.count=3,(j=e.lists[y.EXIT]).items[0]=2,j.items[1]=3,j.items[2]=1,j.count=3,e.capCenter=3}p(w,g,b,i,o<0);var F,R=e.vectors.count,L=e.lists[y.CAP];for(L.items[0]=0,F=0;F<w.count;++F){var k=w.items[F],U=e.vectors.items[R+F];U.vector[0]=k[0],U.vector[1]=k[1],U.texCoords[0]=0,U.texCoords[1]=m,U.direction[0]=0,U.direction[1]=0,L.items[F+1]=R+F}L.items[w.count+1]=1,L.count=w.count+2,e.vectors.count=R+w.count,o<0&&(v(e.lists[y.ENTRY]),v(e.lists[y.EXIT]))},e.prototype.unitRoundJoin=function(e,t,r,i){var n=l(t,r),o=n>0?[-1,1]:[1,-1],s=o[0],u=o[1],f=n>0?c(I[0],a(I[1],t)):a(I[2],t),d=n>0?c(I[3],a(I[4],r)):a(I[5],r),h=e.vectors.items[0];h.vector[0]=f[0],h.vector[1]=f[1],h.texCoords[0]=0,h.texCoords[1]=u,h.direction[0]=0,h.direction[1]=0;var m=e.vectors.items[1];m.vector[0]=d[0],m.vector[1]=d[1],m.texCoords[0]=0,m.texCoords[1]=u,m.direction[0]=0,m.direction[1]=0;var x=e.vectors.items[2];c(x.vector,f),x.texCoords[0]=0,x.texCoords[1]=s,x.direction[0]=0,x.direction[1]=0;var g=e.vectors.items[3];c(g.vector,d),g.texCoords[0]=0,g.texCoords[1]=s,g.direction[0]=0,g.direction[1]=0;var b=e.vectors.items[4];b.vector[0]=0,b.vector[1]=0,b.texCoords[0]=0,b.texCoords[1]=0,b.direction[0]=0,b.direction[1]=0,e.vectors.count=5;var _=e.lists[y.ENTRY];_.items[0]=2,_.items[1]=0,_.count=2;var C=e.lists[y.EXIT];C.items[0]=3,C.items[1]=1,C.count=2,e.capCenter=4,p(w,f,d,i,n<0);var T,P=e.vectors.count,M=e.lists[y.CAP];for(M.items[0]=0,T=0;T<w.count;++T){var S=w.items[T],B=e.vectors.items[P+T];B.vector[0]=S[0],B.vector[1]=S[1],B.texCoords[0]=0,B.texCoords[1]=u,B.direction[0]=0,B.direction[1]=0,M.items[T+1]=P+T}M.items[w.count+1]=1,M.count=w.count+2,e.vectors.count=P+w.count,n<0&&(v(e.lists[y.ENTRY]),v(e.lists[y.EXIT]))},e.prototype.rectJoin=function(e,t,r){var i=a(I[0],t),n=a(I[1],r),o=e.vectors.items[0];o.vector[0]=i[0],o.vector[1]=i[1],o.texCoords[0]=0,o.texCoords[1]=-1,o.direction[0]=0,o.direction[1]=0;var s=e.vectors.items[1];s.vector[0]=n[0],s.vector[1]=n[1],s.texCoords[0]=0,s.texCoords[1]=-1,s.direction[0]=0,s.direction[1]=0;var l=e.vectors.items[2];c(l.vector,i),l.texCoords[0]=0,l.texCoords[1]=1,l.direction[0]=0,l.direction[1]=0;var u=e.vectors.items[3];c(u.vector,n),u.texCoords[0]=0,u.texCoords[1]=1,u.direction[0]=0,u.direction[1]=0,e.vectors.count=4;var f=e.lists[y.ENTRY];f.items[0]=0,f.items[1]=2,f.count=2;var d=e.lists[y.EXIT];d.items[0]=1,d.items[1]=3,d.count=2,e.capCenter=void 0},e}();t.Tessellator=V}.apply(null,i))||(e.exports=n)},1768:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1693),r(1696),r(1697),r(1520)],void 0===(n=function(e,t,r,i,n,o){function s(e,t){for(var r=0,i=e;r<i.length;r++){var n=i[r];if(n.name===t&&null!=n.attributeValues&&"UInt8"===n.attributeValues.valueType&&3===n.attributeValues.valuesPerElement)return{storageInfo:n,useElevation:!1}}return null}function a(e,t){for(var r=0,i=e;r<i.length;r++){var n=i[r];if(n.name===t){var o="embedded-elevation"===n.encoding;return{storageInfo:o?null:n,useElevation:o}}}return"elevation"===t.toLowerCase()?{storageInfo:null,useElevation:!0}:null}function l(e,t,r,i){if(e&&e.useElevation){for(var n=new Float64Array(i),s=0;s<i;s++)n[s]=r[3*s+2];return n}return e&&t?o.readBinaryAttribute(e.storageInfo,t,i):null}function c(e){return null==e||"none"===e?null:"low-four-bit"===e?function(e){return 15&e}:"high-four-bit"===e?function(e){return(240&e)>>4}:"absolute-value"===e?function(e){return Math.abs(e)}:"modulo-ten"===e?function(e){return e%10}:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getRendererInfo=function(e){var t=e.renderer,r=t&&t.type,i=t&&e.renderer.toJSON()||null,n=null,o=!1;"point-cloud-unique-value"===r?n=a(e.attributeStorageInfo,t.field):"point-cloud-stretch"===r?n=a(e.attributeStorageInfo,t.field):"point-cloud-class-breaks"===r?n=a(e.attributeStorageInfo,t.field):o="point-cloud-rgb"===r?null!=(n=s(e.attributeStorageInfo,t.field)):null!=(n=s(e.attributeStorageInfo,"RGB"));var l=null;return t&&t.colorModulation&&(l=a(e.attributeStorageInfo,t.colorModulation.field)),{rendererJSON:i,isRGBRenderer:o,primaryAttribute:n,modulationAttribute:l}},t.evaluateRenderer=function(e,t,o,s,a){var u=e.rendererJSON,f=e.isRGBRenderer,d=e.primaryAttribute,h=e.modulationAttribute,p=l(d,t,s,a),v=l(h,o,s,a),y=null,m=null;if(p&&f)y=p;else if(p&&"pointCloudUniqueValueRenderer"===u.type){var x=(m=n.fromJSON(u)).colorUniqueValueInfos;y=new Uint8Array(3*a);for(var g=c(m.fieldTransformType),b=0;b<a;b++)for(var _=(C=g?g(p[b]):p[b])+"",I=0;I<x.length;I++)if(x[I].values.indexOf(_)>=0){y[3*b]=x[I].color.r,y[3*b+1]=x[I].color.g,y[3*b+2]=x[I].color.b;break}}else if(p&&"pointCloudStretchRenderer"===u.type){var w=(m=i.fromJSON(u)).stops;for(y=new Uint8Array(3*a),g=c(m.fieldTransformType),b=0;b<a;b++){var C=g?g(p[b]):p[b],T=w.length-1;if(C<w[0].value)y[3*b]=w[0].color.r,y[3*b+1]=w[0].color.g,y[3*b+2]=w[0].color.b;else if(C>=w[T].value)y[3*b]=w[T].color.r,y[3*b+1]=w[T].color.g,y[3*b+2]=w[T].color.b;else for(I=1;I<w.length;I++)if(C<w[I].value){var P=(C-w[I-1].value)/(w[I].value-w[I-1].value);y[3*b]=w[I].color.r*P+w[I-1].color.r*(1-P),y[3*b+1]=w[I].color.g*P+w[I-1].color.g*(1-P),y[3*b+2]=w[I].color.b*P+w[I-1].color.b*(1-P);break}}}else if(p&&"pointCloudClassBreaksRenderer"===u.type){var M=(m=r.fromJSON(u)).colorClassBreakInfos;for(y=new Uint8Array(3*a),g=c(m.fieldTransformType),b=0;b<a;b++)for(C=g?g(p[b]):p[b],I=0;I<M.length;I++)if(C>=M[I].minValue&&C<=M[I].maxValue){y[3*b]=M[I].color.r,y[3*b+1]=M[I].color.g,y[3*b+2]=M[I].color.b;break}}else for(y=new Uint8Array(3*a),b=0;b<y.length;b++)y[b]=255;if(v&&m&&m.colorModulation){var S=m.colorModulation.minValue,B=m.colorModulation.maxValue;for(b=0;b<a;b++){var A=(C=v[b])>=B?1:C<=S?.3:.3+.7*(C-S)/(B-S);y[3*b]=A*y[3*b],y[3*b+1]=A*y[3*b+1],y[3*b+2]=A*y[3*b+2]}}return y},t.getSplatSizeAlgorithm=function(e){var t=e&&e.pointSizeAlgorithm;return t&&"splat"===t.type?t:null},t.getFixedSizeAlgorithm=function(e){var t=e&&e.pointSizeAlgorithm;return t&&"fixed-size"===t.type?t:null},t.rendererUsesFixedSizes=function(e){var t=e&&e.pointSizeAlgorithm;return!(!t||!t.type)&&"fixed-size"===t.type}}.apply(null,i))||(e.exports=n)},1778:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(0),r(6),r(1)],void 0===(n=function(e,t,r,i,n,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.field=null,t.minValue=0,t.maxValue=255,t}var n;return r(t,e),n=t,t.prototype.clone=function(){return new n({field:this.field,minValue:this.minValue,maxValue:this.maxValue})},i([o.property({type:String,json:{write:!0}})],t.prototype,"field",void 0),i([o.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minValue",void 0),i([o.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxValue",void 0),n=i([o.subclass("esri.renderers.support.pointCloud.ColorModulation")],t)}(o.declared(n));t.ColorModulation=s,t.default=s}.apply(null,i))||(e.exports=n)},1779:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(105),r(1694),r(1695)],void 0===(n=function(e,t,r,i,n){function o(e){return e&&s[e.type]||null}Object.defineProperty(t,"__esModule",{value:!0});var s={pointCloudFixedSizeAlgorithm:i.default,pointCloudSplatAlgorithm:n.default};t.read=function(e,t,i){var n=o(e);if(n){var s=new n;return s.read(e,i),s}return i&&i.messages&&e&&i.messages.push(new r("pointsizealgorithm:unsupported","Point size algorithms of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:i})),null},t.fromJSON=function(e){var t=o(e);return t?t.fromJSON(e):null}}.apply(null,i))||(e.exports=n)},1780:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1668),r(1694),r(1695)],void 0===(n=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:!0}),t.pointSizeAlgorithmTypes={key:"type",base:r.default,typeMap:{"fixed-size":i.default,splat:n.default}}}.apply(null,i))||(e.exports=n)},1781:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(0),r(25),r(6),r(5),r(1),r(35)],void 0===(n=function(e,t,r,i,n,o,s,a,l){Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.description=null,t.label=null,t.minValue=0,t.maxValue=0,t.color=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,color:s.clone(this.color)})},i([a.property({type:String,json:{write:!0}})],t.prototype,"description",void 0),i([a.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),i([a.property({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],t.prototype,"minValue",void 0),i([a.property({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],t.prototype,"maxValue",void 0),i([a.property({type:n,json:{type:[l.Integer],write:!0}})],t.prototype,"color",void 0),o=i([a.subclass("esri.renderers.support.pointCloud.ColorClassBreakInfo")],t)}(a.declared(o));t.ColorClassBreakInfo=c,t.default=c}.apply(null,i))||(e.exports=n)},1782:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(0),r(25),r(6),r(5),r(1),r(35)],void 0===(n=function(e,t,r,i,n,o,s,a,l){Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.value=0,t.color=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({label:this.label,value:this.value,color:s.clone(this.color)})},i([a.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),i([a.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"value",void 0),i([a.property({type:n,json:{type:[l.Integer],write:!0}})],t.prototype,"color",void 0),o=i([a.subclass("esri.renderers.support.pointCloud.StopInfo")],t)}(a.declared(o));t.StopInfo=c,t.default=c}.apply(null,i))||(e.exports=n)},1783:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(0),r(25),r(6),r(5),r(1),r(35)],void 0===(n=function(e,t,r,i,n,o,s,a,l){Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.description=null,t.label=null,t.values=null,t.color=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({description:this.description,label:this.label,values:s.clone(this.values),color:s.clone(this.color)})},i([a.property({type:String,json:{write:!0}})],t.prototype,"description",void 0),i([a.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),i([a.property({type:[String],json:{write:!0}})],t.prototype,"values",void 0),i([a.property({type:n,json:{type:[l.Integer],write:!0}})],t.prototype,"color",void 0),o=i([a.subclass("esri.renderers.support.pointCloud.ColorUniqueValueInfo")],t)}(a.declared(o));t.ColorUniqueValueInfo=c,t.default=c}.apply(null,i))||(e.exports=n)},1790:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(8),r(7)],void 0===(n=function(e,t,i,n,o){Object.defineProperty(t,"__esModule",{value:!0}),t.getControllerConfiguration=function(e){var t=e.source;return e.capabilities.operations.supportsQuery?function(e){return e&&"esri.layers.graphics.sources.CSVSource"===e.declaredClass}(t)?o.resolve().then(function(){return{type:"memory",processing:e.processing&&e.processing.toWorker()||null}}):o.resolve({type:"on-demand",gdbVersion:e.gdbVersion,historicMoment:e.historicMoment&&e.historicMoment.getTime(),processing:e.processing&&e.processing.toWorker()||null}):o.reject(new n("graphicscontroller:query-capability-required","Service requires query capabilities to be used as a feature layer",{layer:e}))},t.createController=function(e,t){return("memory"===e?o.create(function(e){return r.e(55).then(function(){var t=[r(1903)];e.apply(null,t)}.bind(this)).catch(r.oe)}):o.create(function(e){return Promise.all([r.e(23),r.e(56)]).then(function(){var t=[r(1904)];e.apply(null,t)}.bind(this)).catch(r.oe)})).then(function(e){return e.default}).then(function(e){var r=t.serviceAndViewInfo,n=t.remoteClient,o=t.tileStore;return new e(i({},r,{tileStore:o,remoteClient:n}))})}}.apply(null,i))||(e.exports=n)},1884:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(0),r(125),r(483),r(1622),r(1701)],void 0===(n=function(e,t,r,i,n,o,s,a){return function(e){function t(t,r,i,n,o,s){var a=e.call(this,t,r)||this;if(t.hasDataDrivenFill!==i.isDataDriven())throw new Error("incompatible fill buffer");if(t.hasDataDrivenOutline!==o.isDataDriven())throw new Error("incompatible outline buffer");return a._fillVertexBuffer=i,a._fillIndexBuffer=n,a._outlineVertexBuffer=o,a._outlineIndexBuffer=s,a}return r(t,e),Object.defineProperty(t.prototype,"fillIndexStart",{get:function(){return this._fillIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillIndexCount",{get:function(){return this._fillIndexCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outlineIndexStart",{get:function(){return this._outlineIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outlineIndexCount",{get:function(){return this._outlineIndexCount},enumerable:!0,configurable:!0}),t.prototype.assignBufferInfo=function(e){var t=e;t._fillIndexStart=this._fillIndexStart,t._fillIndexCount=this._fillIndexCount,e.layer.getPaintProperty("fill-outline-color")?(t._outlineIndexStart=this._outlineIndexStart,t._outlineIndexCount=this._outlineIndexCount):(t._outlineIndexStart=0,t._outlineIndexCount=0)},t.prototype.processFeatures=function(e,t){this._fillIndexStart=this._fillIndexBuffer.index,this._fillIndexCount=0,this._outlineIndexStart=this._outlineIndexBuffer.index,this._outlineIndexCount=0;var r=this.layer,i=this.zoom,n=r.hasDataDrivenFill,o=r.hasDataDrivenOutline;e&&e.setExtent(this.layerExtent);var s=r.getPaintValue("fill-pattern",i),a=r.getPaintValue("fill-antialias",i)&&void 0===s,l=[1,1,1,1],c=[1,1,1,1],u=1;if(r.outlineUsesFillColor){if(a&&!r.hasDataDrivenOpacity){var f=r.getPaintValue("fill-opacity",i),d=r.getPaintValue("fill-opacity",i+1);f<1&&d<1&&(a=!1)}if(a&&!r.hasDataDrivenColor){var h=r.getPaintValue("fill-color",i),p=r.getPaintValue("fill-color",i+1);h[3]<1&&p[3]<1&&(a=!1)}}for(var v=0,y=this._features;v<y.length;v++){var m=y[v];!s&&r.hasDataDrivenColor&&(l=r.getPaintValue("fill-color",i,m)),r.hasDataDrivenOpacity&&(u=r.getPaintValue("fill-opacity",i,m)),!s&&r.hasDataDrivenOutlineColor&&(c=r.getPaintValue("fill-outline-color",i,m));var x=void 0;n&&(x={color:l,opacity:u});var g=void 0;o&&(g={color:r.outlineUsesFillColor?l:c,opacity:u});var b=m.getGeometry(e);this._processFeature(b,a,r.outlineUsesFillColor,x,g)}},t.prototype._processFeature=function(e,r,i,n,o){if(e){var s=e.length;if(r&&(!i||!o||o.color[3]*o.opacity==1))for(var a=0;a<s;a++)this._processOutline(e[a],o);var l;for(a=0;a<s;a++){var c=t._area(e[a]);c>128?(void 0!==l&&this._processFill(e,l,n),l=[a]):c<-128&&void 0!==l&&l.push(a)}void 0!==l&&this._processFill(e,l,n)}},t.prototype._processOutline=function(e,t){var r,i,n,o=this._outlineVertexBuffer,a=this._outlineIndexBuffer,l=a.index,c=new s.Point(0,0),u=new s.Point(0,0),f=new s.Point(0,0),d=-1,h=-1,p=-1,v=-1,y=-1,m=!1,x=e.length;if(!(x<2)){for(var g=e[0],b=e[x-1];x&&b.isEqual(g);)b=e[--x-1];if(!(x-0<2)){for(var _=0;_<x;++_){0===_?(r=e[x-1],i=e[0],n=e[1],c.assignSub(i,r),c.normalize(),c.rightPerpendicular()):(r=i,i=n,n=_!==x-1?e[_+1]:e[0],c.assign(u));var I=this._isClipEdge(r,i);-1===v&&(m=I),u.assignSub(n,i),u.normalize(),u.rightPerpendicular();var w=c.x*u.y-c.y*u.x;f.assignAdd(c,u),f.normalize();var C=-f.x*-c.x+-f.y*-c.y,T=Math.abs(0!==C?1/C:1);T>8&&(T=8),w>=0?(p=o.add(i.x,i.y,c.x,c.y,0,1,t),-1===v&&(v=p),d>=0&&h>=0&&p>=0&&!I&&a.add(d,h,p),h=o.add(i.x,i.y,T*-f.x,T*-f.y,0,-1,t),-1===y&&(y=h),d>=0&&h>=0&&p>=0&&!I&&a.add(d,h,p),d=h,h=p,p=o.add(i.x,i.y,f.x,f.y,0,1,t),d>=0&&h>=0&&p>=0&&!I&&a.add(d,h,p),h=o.add(i.x,i.y,u.x,u.y,0,1,t),d>=0&&h>=0&&p>=0&&!I&&a.add(d,h,p)):(p=o.add(i.x,i.y,T*f.x,T*f.y,0,1,t),-1===v&&(v=p),d>=0&&h>=0&&p>=0&&!I&&a.add(d,h,p),h=o.add(i.x,i.y,-c.x,-c.y,0,-1,t),-1===y&&(y=h),d>=0&&h>=0&&p>=0&&!I&&a.add(d,h,p),d=h,h=p,p=o.add(i.x,i.y,-f.x,-f.y,0,-1,t),d>=0&&h>=0&&p>=0&&!I&&a.add(d,h,p),(d=o.add(i.x,i.y,-u.x,-u.y,0,-1,t))>=0&&h>=0&&p>=0&&!I&&a.add(d,h,p))}d>=0&&h>=0&&v>=0&&!m&&a.add(d,h,v),d>=0&&v>=0&&y>=0&&!m&&a.add(d,y,v),this._outlineIndexCount+=3*(a.index-l)}}},t.prototype._processFill=function(e,t,r){var i;t.length>1&&(i=[]);for(var s=0,a=0,l=t;a<l.length;a++){var c=l[a];0!==s&&i.push(s),s+=e[c].length}for(var u=2*s,f=n.acquire(),d=0,h=t;d<h.length;d++)for(var p=e[c=h[d]],v=p.length,y=0;y<v;++y)f.push(p[y].x),f.push(p[y].y);var m=o(f,i,2),x=m.length;if(x>0){for(var g=this._fillVertexBuffer.index,b=0;b<u;)this._fillVertexBuffer.add(f[b++],f[b++],r);for(var _=0;_<x;)this._fillIndexBuffer.add(g+m[_++],g+m[_++],g+m[_++]);this._fillIndexCount+=x}n.release(f)},t.prototype._isClipEdge=function(e,t){return e.x===t.x?e.x<=-64||e.x>=4160:e.y===t.y&&(e.y<=-64||e.y>=4160)},t._area=function(e){for(var t=0,r=e.length-1,i=0;i<r;i++)t+=(e[i].x-e[i+1].x)*(e[i].y+e[i+1].y);return.5*(t+(e[r].x-e[0].x)*(e[r].y+e[0].y))},t}(a)}.apply(null,i))||(e.exports=n)},1885:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(11),r(514),r(143),r(7)],void 0===(n=function(e,t,r,i,n,o){function s(){var e=0===l.length;if(!e){for(var t=n();!e&&n()-t<a;){var r=l[u];if(r){if(!0===r()){var o=c.get(r);l[u]=null,c.delete(r),o()}u=(u+1)%l.length}else l.splice(u,1),(e=0===l.length)?u=0:u%=l.length}e||i(s)}}var a=r("host-browser")?6:200,l=[],c=new Map,u=0;return function(e){return e?o.create(function(t){l.push(e),c.set(e,t),1===l.length&&i(s)},function(){l[l.indexOf(e)]=null,c.delete(e)}):o.reject(new TypeError("callback is not a function"))}}.apply(null,i))||(e.exports=n)},1886:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(0),r(1701)],void 0===(n=function(e,t,r,i,n){return function(e){function t(t,r){return e.call(this,t,r)||this}return r(t,e),t}(n)}.apply(null,i))||(e.exports=n)},1887:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(0),r(1701)],void 0===(n=function(e,t,r,i,n){return function(e){function t(t,r,i,n){var o=e.call(this,t,r)||this;return o._circleVertexBuffer=i,o._circleIndexBuffer=n,o}return r(t,e),Object.defineProperty(t.prototype,"circleIndexStart",{get:function(){return this._circleIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"circleIndexCount",{get:function(){return this._circleIndexCount},enumerable:!0,configurable:!0}),t.prototype.assignBufferInfo=function(e){var t=e;t._circleIndexStart=this._circleIndexStart,t._circleIndexCount=this._circleIndexCount},t.prototype.processFeatures=function(e,t){var r=this._circleVertexBuffer,i=this._circleIndexBuffer;this._circleIndexStart=i.index,this._circleIndexCount=0;var n=this.layer,o=this.zoom;e&&e.setExtent(this.layerExtent);for(var s=1,a=[1,1,1,1],l=1,c=0,u=1,f=[1,1,1,1],d=1,h=0,p=this._features;h<p.length;h++){var v=p[h],y=v.getGeometry(e);if(y){n.hasDataDrivenRadius&&(s=n.getPaintValue("circle-radius",o,v)),n.hasDataDrivenColor&&(a=n.getPaintValue("circle-color",o,v)),n.hasDataDrivenOpacity&&(l=n.getPaintValue("circle-opacity",o,v)),n.hasDataDrivenStrokeWidth&&(u=n.getPaintValue("circle-stroke-width",o,v)),n.hasDataDrivenStrokeColor&&(f=n.getPaintValue("circle-stroke-color",o,v)),n.hasDataDrivenStrokeOpacity&&(d=n.getPaintValue("circle-stroke-opacity",o,v)),n.hasDataDrivenBlur&&(c=n.getPaintValue("circle-blur",o,v));for(var m=0,x=y;m<x.length;m++){var g=x[m];if(g)for(var b=0,_=g;b<_.length;b++){var I=_[b],w=r.index;r.add(I.x,I.y,0,0,s,a,l,c,u,f,d),r.add(I.x,I.y,0,1,s,a,l,c,u,f,d),r.add(I.x,I.y,1,0,s,a,l,c,u,f,d),r.add(I.x,I.y,1,1,s,a,l,c,u,f,d),i.add(w+0,w+1,w+2),i.add(w+1,w+2,w+3),this._circleIndexCount+=6}}}}},t}(n)}.apply(null,i))||(e.exports=n)},1888:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(0),r(1767),r(1701),r(521)],void 0===(n=function(e,t,r,i,n,o,s){var a=20,l=new n.Tessellator({distanceAlongCorrection:!0});return function(e){function t(t,r,i,o){var s=e.call(this,t,r)||this;if(s.extrudeVectorsDoubleBuffer=[n.allocExtrudeVectors(),n.allocExtrudeVectors()],s.firstExtrudeVectors=n.allocExtrudeVectors(),s.recycledTriangleBridge=n.allocTriangles(a),s.recycledTrianglePie=n.allocTriangles(a),t.hasDataDrivenLine!==i.isDataDriven())throw new Error("incompatible line buffer");return s._lineVertexBuffer=i,s._lineIndexBuffer=o,s}return r(t,e),Object.defineProperty(t.prototype,"lineIndexStart",{get:function(){return this._lineIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineIndexCount",{get:function(){return this._lineIndexCount},enumerable:!0,configurable:!0}),t.prototype.assignBufferInfo=function(e){var t=e;t._lineIndexStart=this._lineIndexStart,t._lineIndexCount=this._lineIndexCount},t.prototype.processFeatures=function(e,t){this._lineIndexStart=this._lineIndexBuffer.index,this._lineIndexCount=0;var r=this.layer,i=this.zoom,n=r.hasDataDrivenLine;e&&e.setExtent(this.layerExtent);for(var o=r.getPaintValue("line-pattern",i),a=[1,1,1,1],l=1,c=1,u=0,f=this._features;u<f.length;u++){var d=f[u],h=new s.LineLayout(r,i,d);!o&&r.hasDataDrivenColor&&(a=r.getPaintValue("line-color",i,d)),r.hasDataDrivenOpacity&&(l=r.getPaintValue("line-opacity",i,d)),r.hasDataDrivenWidth&&(c=r.getPaintValue("line-width",i,d));var p=void 0;if(!(n&&(p={color:a,opacity:l,size:Math.max(Math.min(c,256),0)},p.size<=0||p.opacity<=0||p.color[3]<=0))){var v=d.getGeometry(e);this._processFeature(h,v,p)}}},t.prototype._processFeature=function(e,t,r){if(t)for(var i=t.length,n=0;n<i;n++)this._processGeometry(t[n],e,r)},t.prototype._processGeometry=function(e,t,r){if(!(e.length<2)){for(var i=e[0],o=e[e.length-1],s=o.x-i.x,a=o.y-i.y,l=s*s+a*a<1e-6,c=e[0],u=1;u<e.length;)(s=e[u].x-c.x)*s+(a=e[u].y-c.y)*a<1e-6?e.splice(u,1):(c=e[u],++u);if(!(e.length<2)){this.vertices=e,this.verticesLen=e.length,this.isClosed=l,this.cap=t.cap,this.join=t.join,this.almostParallelRads=.05,this.veryShallowRads=.1,this.miterSafeRads=n.MITER_SAFE_RADS,this.miterLimitMag=Math.min(t.miterLimit,n.SYSTEM_MAG_LIMIT),this.roundLimitRads=Math.min(t.roundLimit,.5),this.newRoundJoinsSafeRads=2.3;for(var f=this._lineIndexBuffer.index,d=0,h=void 0,p=this.verticesLen,v=0;v<p;++v){var y=e[v],m=e[(v+p-1)%p],x=l&&this._isClipEdge(m,y),g=h===this.extrudeVectorsDoubleBuffer[v%2]?this.extrudeVectorsDoubleBuffer[(v+1)%2]:this.extrudeVectorsDoubleBuffer[v%2];if(v<p-1||!l||this.hasPattern?(this._computeExtrudeVectors(g,v),this._writeGPUVertices(y.x,y.y,d,g,r),!g.capCenter||l&&v===p-1||this._writeGPUPieElements(g,x),l&&0===v&&!this.hasPattern&&n.copyExtrudeVectors(this.firstExtrudeVectors,g)):n.copyExtrudeVectors(g,this.firstExtrudeVectors),h&&this._writeGPUBridgeElements(h,g,x),v<p-1){var b=e[v+1];d+=n.length([b.x-y.x,b.y-y.y])}h=g}this._lineIndexCount+=3*(this._lineIndexBuffer.index-f)}}},t.prototype._computeExtrudeVectors=function(e,t){var r=this.vertices,i=this.verticesLen,o=this.isClosed,s=r[t],a=[void 0,void 0],l=[void 0,void 0];if(t>0&&t<i-1){var c=r[(t+i-1)%i],u=r[(t+1)%i];n.normalize(a,[s.x-c.x,s.y-c.y]),n.normalize(l,[u.x-s.x,u.y-s.y])}else if(0===t){u=r[(t+1)%i];if(n.normalize(l,[u.x-s.x,u.y-s.y]),o){var f=r[i-2];n.normalize(a,[s.x-f.x,s.y-f.y])}else a=l}else{if(t!==i-1)return void console.error("Vertex index 'i' out of range.");c=r[(t+i-1)%i];if(n.normalize(a,[s.x-c.x,s.y-c.y]),o){var d=r[1];n.normalize(l,[d.x-s.x,d.y-s.y])}else l=a}o||0!==t?o||t!==i-1?this._computeJoinExtrudeVectors(e,a,l):this._computeCapExtrudeVectors(e,a,l,n.CapPosition.END):this._computeCapExtrudeVectors(e,a,l,n.CapPosition.START)},t.prototype._computeCapExtrudeVectors=function(e,t,r,i){0===this.cap?l.buttCap(e,t,r):1===this.cap?l.roundCap(e,t,r,i,n.getNumberOfSlices(Math.PI),i===n.CapPosition.START?-1:1):2===this.cap?l.squareCap(e,t,r,i):l.buttCap(e,t,r)},t.prototype._computeJoinExtrudeVectors=function(e,t,r){var i=n.getRads(t,r);if(i>Math.PI-this.almostParallelRads)l.rectJoin(e,t,r);else if(0===this.join&&i>=this.veryShallowRads)l.bevelJoin(e,t,r,1);else if(1===this.join&&i>=this.veryShallowRads){var o=n.getNumberOfSlices(i);i<this.newRoundJoinsSafeRads?o<2||i<this.roundLimitRads?l.bevelJoin(e,t,r,1):l.roundJoin(e,t,r,o):l.unitRoundJoin(e,t,r,o)}else i<this.almostParallelRads?l.fastMiterJoin(e,t,r):i<this.miterSafeRads?l.miterJoin(e,t,r):l.bevelJoin(e,t,r,this.miterLimitMag)},t.prototype._writeGPUVertices=function(e,t,r,i,n){for(var o=0;o<i.vectors.count;++o){var s=i.vectors.items[o].vector[0],a=i.vectors.items[o].vector[1],l=i.vectors.items[o].texCoords[0],c=i.vectors.items[o].texCoords[1];i.vectors.items[o].base=this._lineVertexBuffer.index,this._lineVertexBuffer.add(e,t,s,a,l,c,r,n)}},t.prototype._writeGPUBridgeElements=function(e,t,r){if(l.bridge(this.recycledTriangleBridge,e,t),!r)for(var i=0;i<this.recycledTriangleBridge.count;++i){var n=this.recycledTriangleBridge.items[i];this._lineIndexBuffer.add(n.v1.base,n.v2.base,n.v3.base)}},t.prototype._writeGPUPieElements=function(e,t){if(l.pie(this.recycledTrianglePie,e),!t)for(var r=0;r<this.recycledTrianglePie.count;++r){var i=this.recycledTrianglePie.items[r];this._lineIndexBuffer.add(i.v1.base,i.v2.base,i.v3.base)}},t.prototype._isClipEdge=function(e,t){return e.x===t.x?e.x<=-64||e.x>=4160:e.y===t.y&&(e.y<=-64||e.y>=4160)},t}(o)}.apply(null,i))||(e.exports=n)},1889:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1622),r(2181),r(254)],void 0===(n=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){return function(e,t,r,i,n){void 0===r&&(r=0),void 0===i&&(i=-1),void 0===n&&(n=c),this.x=e,this.y=t,this.angle=r,this.segment=i,this.minzoom=n}}();t.Anchor=o;var s=function(){return function(e,t,r,i,o,s,a){void 0===o&&(o=!1),void 0===s&&(s=c),void 0===a&&(a=n.C_INFINITY),this.anchor=e,this.labelAngle=t,this.glyphAngle=r,this.page=i,this.upsideDown=o,this.minzoom=s,this.maxzoom=a}}(),a=function(){return function(e,t,r,i,n,o,s,a,l,c){this.tl=e,this.tr=t,this.bl=r,this.br=i,this.mosaicRect=n,this.labelAngle=o,this.anchor=s,this.minzoom=a,this.maxzoom=l,this.page=c}}();t.PlacedSymbol=a;var l=function(){return function(e,t){this.footprint=e,this.shapes=t}}();t.Placement=l;var c=.5,u=function(){function e(){this.mapAngle=0,this._conflictEngine=new i.ConflictEngine}return e.prototype.reset=function(){this._conflictEngine.reset()},e.prototype.setAngle=function(e){this.mapAngle=e,this._conflictEngine.setAngle(e)},e.prototype.getIconPlacement=function(e,t,o,s,u,f,d){var h=o.width/o.pixelRatio,p=o.height/o.pixelRatio,v=f.offset[0]-h/2,y=f.offset[1]-p/2,m=v+h,x=y+p,g=o.rect,b=o.sdf?17:2,_=v-b,I=y-b,w=_+g.width/o.pixelRatio,C=I+g.height/o.pixelRatio,T=new r.Point(_,I),P=new r.Point(w,C),M=new r.Point(_,C),S=new r.Point(w,I),B=f.rotate*n.C_DEG_TO_RAD,A=1===f.rotationAlignment;if(e.segment>=0&&!A&&(B+=e.angle),0!==B){var E=Math.cos(B),D=Math.sin(B);T.rotate(E,D),P.rotate(E,D),M.rotate(E,D),S.rotate(E,D)}var V=8*f.padding,z=new r.Point(e.x,e.y),N=new i.Footprint(this.mapAngle,V,A);N.addBox(z,new i.Box(v,y,m,x),s,B,t,c,n.C_INFINITY);var O=new a(T,S,M,P,g,0,z,c,n.C_INFINITY,0),j=new l(N,[O]),F=c;return f.allowOverlap||(F=this._conflictEngine.getMinZoom(j.footprint,F,d,A)),N.minzoom=F,j},e.prototype.getTextPlacement=function(e,t,o,u,f,d,h,p){for(var v,y=new r.Point(e.x,e.y),m=h.rotate*n.C_DEG_TO_RAD,x=0===h.rotationAlignment,g=h.keepUpright,b=c,_=!x,I=_?0:e.angle,w=e.segment>=0&&x,C=8*h.padding,T=new i.Footprint(this.mapAngle,C,_),P=[],M=!w,S=Number.POSITIVE_INFINITY,B=Number.NEGATIVE_INFINITY,A=S,E=B,D=w?g:x&&g,V=0,z=u;V<z.length;V++){var N=z[V],O=N.glyphMosaicItem;if(O&&!O.rect.isEmpty){var j=O.rect,F=O.metrics,R=O.page;M&&(v&&v!==N.y&&(T.addBox(y,new i.Box(S,A,B,E),f,m,t,c,n.C_INFINITY),A=S=Number.POSITIVE_INFINITY,E=B=Number.NEGATIVE_INFINITY),v=N.y);var L=[];if(w){var k=.5*O.metrics.width,U=(o.x+N.x+F.left-4+k)*f;if(b=this._placeGlyph(e,b,U,d,e.segment,1,R,L),g&&(b=this._placeGlyph(e,b,U,d,e.segment,-1,R,L)),b>=2)break}else L.push(new s(y,I,I,R)),x&&g&&L.push(new s(y,I+n.C_PI,I+n.C_PI,R,!0));for(var Y=N.x+o.x+F.left,q=N.y+o.y-F.top,G=Y+F.width,J=q+F.height,X=new r.Point(Y-4,q-4),Z=new r.Point(X.x+j.width,X.y+j.height),H=new r.Point(X.x,Z.y),W=new r.Point(Z.x,X.y),K=0,Q=L;K<Q.length;K++){var $=Q[K],ee=X.clone(),te=H.clone(),re=W.clone(),ie=Z.clone(),ne=q,oe=J,se=$.glyphAngle+m;if(0!==se){var ae=Math.cos(se),le=Math.sin(se);ee.rotate(ae,le),ie.rotate(ae,le),te.rotate(ae,le),re.rotate(ae,le)}P.push(new a(ee,re,te,ie,j,$.labelAngle,$.anchor,$.minzoom,$.maxzoom,$.page)),D&&!this._legible($.labelAngle)||(M?(Y<S&&(S=Y),ne<A&&(A=ne),G>B&&(B=G),oe>E&&(E=oe)):$.minzoom<2&&T.addBox($.anchor,new i.Box(Y,ne,G,oe),f,se,t,$.minzoom,$.maxzoom))}}}if(b>=2)return null;M&&T.addBox(y,new i.Box(S,A,B,E),f,m,t,c,n.C_INFINITY);var ce=new l(T,P);return h.allowOverlap||(b=this._conflictEngine.getMinZoom(ce.footprint,b,p,_)),T.minzoom=b,ce},e.prototype.add=function(e){this._conflictEngine.add(e.footprint)},e.prototype._legible=function(e){var t=n.radToByte(e);return t<65||t>=193},e.prototype._placeGlyph=function(e,t,i,o,a,l,c,u){var f=l,d=f<0?n.positiveMod(e.angle+n.C_PI,n.C_2PI):e.angle,h=this._legible(d),p=0;i<0&&(f*=-1,i*=-1,p=n.C_PI),f>0&&++a;var v=new r.Point(e.x,e.y),y=o[a],m=n.C_INFINITY;if(o.length<=a)return m;for(;;){var x=y.x-v.x,g=y.y-v.y,b=Math.sqrt(x*x+g*g),_=Math.max(i/b,t),I=x/b,w=g/b,C=n.positiveMod(Math.atan2(w,I)+p,n.C_2PI);if(u.push(new s(v,d,C,c,h,_,m)),_<=t)return _;v=y.clone();do{if(a+=f,o.length<=a||a<0)return _;y=o[a]}while(v.isEqual(y));var T=y.x-v.x,P=y.y-v.y,M=Math.sqrt(T*T+P*P);T*=b/M,P*=b/M,v.x-=T,v.y-=P,m=_}},e}();t.PlacementEngine=u}.apply(null,i))||(e.exports=n)},1890:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(0),r(1700),r(1622),r(1684),r(1701),r(254),r(1889),r(521)],void 0===(n=function(e,t,r,i,n,o,s,a,l,c,u){function f(e,t){return e.iconMosaicItem&&t.iconMosaicItem?e.iconMosaicItem.page===t.iconMosaicItem.page?0:e.iconMosaicItem.page<t.iconMosaicItem.page?-1:1:e.iconMosaicItem&&!t.iconMosaicItem?1:!e.iconMosaicItem&&t.iconMosaicItem?-1:0}return function(e){function t(t,r,i,n,o,s,a,l){var c=e.call(this,t,r)||this;if(c._markerMap=new Map,c._glyphMap=new Map,c._glyphBufferDataStorage=new Map,c._sdfMarkers=!1,t.hasDataDrivenIcon!==i.isDataDriven())throw new Error("incompatible icon buffer");if(t.hasDataDrivenText!==o.isDataDriven())throw new Error("incompatible text buffer");return c._iconVertexBuffer=i,c._iconIndexBuffer=n,c._textVertexBuffer=o,c._textIndexBuffer=s,c._placementEngine=a,c._workerTileHandler=l,c}return r(t,e),Object.defineProperty(t.prototype,"markerPageMap",{get:function(){return this._markerMap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"glyphsPageMap",{get:function(){return this._glyphMap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sdfMarker",{get:function(){return this._sdfMarkers},enumerable:!0,configurable:!0}),t.prototype.copy=function(e,r,i,n,o){var s=new t(this.layer,this.zoom,e,r,i,n,o,this._workerTileHandler);return s.layerIndex=this.layerIndex,s.layerExtent=this.layerExtent,s._iconIndexStart=r.index,s._textIndexStart=n.index,s._iconIndexCount=0,s._textIndexCount=0,s._symbolInstances=this._symbolInstances,s._workerTileHandler=this._workerTileHandler,s._fontArray=this._fontArray,s._textLayout=this._textLayout,s._iconLayout=this._iconLayout,s._isLinePlacement=this._isLinePlacement,s._avoidEdges=this._avoidEdges,s},t.prototype.getResources=function(e,r,i){var n=this.layer,o=this.zoom,s=n.hasDataDrivenIcon,a=n.hasDataDrivenText;e&&e.setExtent(this.layerExtent);for(var l=n.getLayoutProperty("icon-image"),c=n.getLayoutProperty("text-field"),u=n.getLayoutValue("text-font",o),f=n.getLayoutValue("text-transform",o),d=[],h=[1,1,1,1],p=1,v=1,y=[1,1,1,1],m=1,x=1,g=0,b=this._features;g<b.length;g++){var _=b[g],I=_.getGeometry(e);if(I&&0!==I.length){var w=void 0;l&&(w=n.getLayoutValue("icon-image",o,_),l.isDataDriven||(w=this._replaceKeys(w,_.values)),w&&r.add(w));var C=void 0,T=!1;if(c&&(C=n.getLayoutValue("text-field",o,_),c.isDataDriven||(C=this._replaceKeys(C,_.values)),C=C.replace(/\\n/g,"\n"))){switch(f){case 2:C=C.toLowerCase();break;case 1:C=C.toUpperCase()}if(t._bidiEngine.hasBidiChar(C)){var P;P="rtl"===t._bidiEngine.checkContextual(C)?"IDNNN":"ICNNN",C=t._bidiEngine.bidiTransform(C,P,"VLYSN"),T=!0}var M=C.length;if(M>0)for(var S=0,B=u;S<B.length;S++){var A=B[S],E=i[A];E||(E=i[A]=new Set);for(var D=0;D<M;D++){var V=C.charCodeAt(D);E.add(V)}}}if(w||C){var z=n.getLayoutValue("icon-size",o,_),N=n.getLayoutValue("text-size",o,_);n.hasDataDrivenIconColor&&(h=n.getPaintValue("icon-color",o,_)),n.hasDataDrivenIconOpacity&&(p=n.getPaintValue("icon-opacity",o,_)),n.hasDataDrivenIconSize&&(v=z),n.hasDataDrivenTextColor&&(y=n.getPaintValue("text-color",o,_)),n.hasDataDrivenTextOpacity&&(m=n.getPaintValue("text-opacity",o,_)),n.hasDataDrivenTextSize&&(x=N);var O={sprite:w,label:C,rtl:T,type:_.type,geometry:I,iconSize:z,iconRotate:n.getLayoutValue("icon-rotate",o,_),ddIconValues:s?{color:h,opacity:p,size:v}:null,textSize:N,textRotate:n.getLayoutValue("text-rotate",o,_),ddTextValues:a?{color:y,opacity:m,size:x}:null};d.push(O)}}}this._symbolFeatures=d},t.prototype.processFeatures=function(e,r){e&&e.setExtent(this.layerExtent);var i,n,o,a,d,h=this.layer,p=this.zoom,v=this._isLinePlacement=1===h.getLayoutValue("symbol-placement",p),y=this._avoidEdges=h.getLayoutValue("symbol-avoid-edges",p)&&!v,m=8*h.getLayoutValue("symbol-spacing",p),x=h.getLayoutProperty("icon-image"),g=h.getLayoutProperty("text-field"),b=this._workerTileHandler;if(x&&(this._iconLayout=new u.IconLayout(h,p,v),i=b.getSpriteItems(),n=this._getTranslate(!0)),g){var _=this._textLayout=new u.TextLayout(h,p,v);this._fontArray=_.fontArray;var I=.5;switch(_.anchor){case 5:case 1:case 7:I=0;break;case 6:case 2:case 8:I=1}var w=.5;switch(_.anchor){case 5:case 3:case 6:w=0;break;case 7:case 4:case 8:w=1}var C=.5;switch(_.justify){case 0:C=0;break;case 2:C=1}var T=24*_.letterSpacing,P=v?0:24*_.maxWidth,M=24*_.lineHeight,S=[24*_.offset[0],24*_.offset[1]];o=this._fontArray.map(function(e){return b.getGlyphItems(e)}),a=new s(o,P,M,T,S,I,w,C),d=this._getTranslate(!1)}this._iconIndexStart=this._iconIndexBuffer.index,this._textIndexStart=this._textIndexBuffer.index,this._iconIndexCount=0,this._textIndexCount=0,this._markerMap.clear(),this._glyphMap.clear();var B=[];this._symbolInstances=B;var A=this._textLayout,E=1;A&&A.size&&(E=A.size/24);for(var D=A?A.maxAngle*l.C_DEG_TO_RAD:0,V=A?8*A.size:0,z=0,N=this._symbolFeatures;z<N.length;z++){var O=N[z],j=void 0;O.sprite&&(j=i[O.sprite])&&j.sdf&&(this._sdfMarkers=!0);var F=void 0,R=O.label,L=0;if(R&&(F=a.getShaping(R,O.rtl))&&F.length>0){for(var k=1e30,U=-1e30,Y=0,q=F;Y<q.length;Y++){var G=q[Y];k=Math.min(k,G.x),U=Math.max(U,G.x)}L=(U-k+48)*E*8}for(var J=0,X=O.geometry;J<X.length;J++){var Z=X[J],H=void 0;if(v){if(F&&F.length>0&&A&&A.size){var W=8*A.size*(2+Math.min(2,4*Math.abs(A.offset[1])));t._smoothVertices(Z,W)}H=t._findAnchors(Z,m,L)}else H=3===O.type?t._findCentroid(Z):[new c.Anchor(Z[0].x,Z[0].y)];for(var K=0,Q=H;K<Q.length;K++){var $=Q[K];$.x<0||$.x>4096||$.y<0||$.y>4096||v&&L>0&&0===A.rotationAlignment&&!t._honorsTextMaxAngle(Z,$,L,D,V)||B.push({shaping:F,line:Z,iconMosaicItem:j,anchor:$,iconSize:O.iconSize,iconRotate:O.iconRotate,ddIconValues:O.ddIconValues,textSize:O.textSize,textRotate:O.textRotate,ddTextValues:O.ddTextValues})}}}B.sort(f);for(var ee=0,te=B;ee<te.length;ee++){var re=te[ee];this._processFeature(re,n,d,y)}this._addPlacedGlyphs()},t.prototype.updateSymbols=function(){this._iconIndexStart=this._iconIndexBuffer.index,this._textIndexStart=this._textIndexBuffer.index,this._iconIndexCount=0,this._textIndexCount=0,this._markerMap.clear(),this._glyphMap.clear();var e,t,r=this._avoidEdges,i=this.layer;i.getLayoutProperty("icon-image")&&(e=this._getTranslate(!0)),i.getLayoutProperty("text-field")&&(t=this._getTranslate(!1));for(var n=0,o=this._symbolInstances;n<o.length;n++){var s=o[n];this._processFeature(s,e,t,r)}this._addPlacedGlyphs()},t.prototype._getTranslate=function(e){var t=this.layer.getPaintValue(e?"icon-translate":"text-translate",this.zoom);if(0!==t[0]||0!==t[1]){var r=this._placementEngine.mapAngle;if(0!==r&&0===this.layer.getPaintValue(e?"icon-translate-anchor":"text-translate-anchor",this.zoom)){var i=Math.sin(r),n=Math.cos(r);return[8*(t[0]*n-t[1]*i),8*(t[0]*i+t[1]*n)]}return[8*t[0],8*t[1]]}},t.prototype._replaceKeys=function(e,t){return e.replace(/{([^{}]+)}/g,function(e,r){return r in t?t[r]:""})},t.prototype._processFeature=function(e,t,r,i){var n=e.line,s=e.iconMosaicItem,a=e.shaping,c=e.anchor,u=this._iconLayout,f=u&&!!s,d=!0,h=1;f&&(u.size=e.iconSize,u.rotate=e.iconRotate,h=8*u.size,d=u.optional||!s);var p=this._textLayout,v=p&&a&&a.length>0,y=1,m=y,x=!0;v&&(p.size=e.textSize,p.rotate=e.textRotate,m=8*(y=p.size/24),x=p.optional||!a||0===a.length);var g,b,_=new o.Point(0,-17);if((f&&(g=this._placementEngine.getIconPlacement(c,t,s,h,n,u,i),c.minzoom>g.footprint.minzoom&&(g.footprint.minzoom=c.minzoom),g.footprint.minzoom===l.C_INFINITY&&(g=null)),g||d)&&(v&&(b=this._placementEngine.getTextPlacement(c,r,_,a,m,n,p,i))&&(c.minzoom>b.footprint.minzoom&&(b.footprint.minzoom=c.minzoom),b.footprint.minzoom===l.C_INFINITY&&(b=null)),b||x)){if(g&&b||(x||d?x||b?d||g||(b=null):g=null:(g=null,b=null)),g&&b&&!x&&!d){var I=Math.max(g.footprint.minzoom,b.footprint.minzoom);g.footprint.minzoom=I,b.footprint.minzoom=I}b&&(p.ignorePlacement||this._placementEngine.add(b),this._storePlacedGlyphs(b.shapes,b.footprint.minzoom,this.zoom,e.ddTextValues)),g&&(u.ignorePlacement||this._placementEngine.add(g),this._addPlacedIcons(g.shapes,g.footprint.minzoom,this.zoom,s.page,e.ddIconValues))}},t.prototype._addPlacedIcons=function(e,t,r,i,n){for(var o=Math.max(r+l.log2(t),0),s=this._iconVertexBuffer,a=this._iconIndexBuffer,c=0,u=e;c<u.length;c++){var f=u[c],d=Math.max(r+l.log2(f.minzoom),o),h=Math.min(r+l.log2(f.maxzoom),25);if(!(h<=d)){var p=f.tl,v=f.tr,y=f.bl,m=f.br,x=f.mosaicRect,g=f.labelAngle,b=f.anchor,_=s.index,I=x.x,w=x.y,C=I+x.width,T=w+x.height;s.add(b.x,b.y,p.x,p.y,I,w,g,d,h,o,n),s.add(b.x,b.y,v.x,v.y,C,w,g,d,h,o,n),s.add(b.x,b.y,y.x,y.y,I,T,g,d,h,o,n),s.add(b.x,b.y,m.x,m.y,C,T,g,d,h,o,n),a.add(_+0,_+1,_+2),a.add(_+1,_+2,_+3),this._markerMap.has(i)?this._markerMap.get(i)[1]+=6:this._markerMap.set(i,[this._iconIndexStart+this._iconIndexCount,6]),this._iconIndexCount+=2}}},t.prototype._addPlacedGlyphs=function(){var e=this,t=this._textVertexBuffer,r=this._textIndexBuffer;this._glyphBufferDataStorage.forEach(function(i,n){for(var o=0,s=i;o<s.length;o++){var a=s[o],l=t.index;t.add(a.glyphAnchor[0],a.glyphAnchor[1],a.tl[0],a.tl[1],a.xmin,a.ymin,a.labelAngle,a.minLod,a.maxLod,a.placementLod,a.ddValues),t.add(a.glyphAnchor[0],a.glyphAnchor[1],a.tr[0],a.tr[1],a.xmax,a.ymin,a.labelAngle,a.minLod,a.maxLod,a.placementLod,a.ddValues),t.add(a.glyphAnchor[0],a.glyphAnchor[1],a.bl[0],a.bl[1],a.xmin,a.ymax,a.labelAngle,a.minLod,a.maxLod,a.placementLod,a.ddValues),t.add(a.glyphAnchor[0],a.glyphAnchor[1],a.br[0],a.br[1],a.xmax,a.ymax,a.labelAngle,a.minLod,a.maxLod,a.placementLod,a.ddValues),r.add(l+0,l+1,l+2),r.add(l+1,l+2,l+3),e._glyphMap.has(n)?e._glyphMap.get(n)[1]+=6:e._glyphMap.set(n,[e._textIndexStart+e._textIndexCount,6]),e._textIndexCount+=2}}),this._glyphBufferDataStorage.clear()},t.prototype._storePlacedGlyphs=function(e,t,r,i){for(var n=Math.max(r+l.log2(t),0),o=0,s=e;o<s.length;o++){var a=s[o],c=Math.max(r+l.log2(a.minzoom),n),u=Math.min(r+l.log2(a.maxzoom),25);if(!(u<=c)){var f=a.tl,d=a.tr,h=a.bl,p=a.br,v=a.labelAngle,y=a.anchor,m=a.mosaicRect;this._glyphBufferDataStorage.has(a.page)||this._glyphBufferDataStorage.set(a.page,[]),this._glyphBufferDataStorage.get(a.page).push({glyphAnchor:[y.x,y.y],tl:[f.x,f.y],tr:[d.x,d.y],bl:[h.x,h.y],br:[p.x,p.y],xmin:m.x,ymin:m.y,xmax:m.x+m.width,ymax:m.y+m.height,labelAngle:v,minLod:c,maxLod:u,placementLod:n,ddValues:i})}}},t._findAnchors=function(e,t,r){t+=r;for(var i=0,n=e.length-1,s=0;s<n;s++)i+=o.Point.distance(e[s],e[s+1]);var a=r||t;if(i<=(a*=.5))return[];var u=a/i,f=0,d=-(t=i/Math.max(Math.round(i/t),1))/2,h=[],p=e.length-1;for(s=0;s<p;s++){for(var v=e[s],y=e[s+1],m=y.x-v.x,x=y.y-v.y,g=Math.sqrt(m*m+x*x),b=void 0;d+t<f+g;){var _=((d+=t)-f)/g,I=l.interpolate(v.x,y.x,_),w=l.interpolate(v.y,y.y,_);void 0===b&&(b=Math.atan2(x,m)),h.push(new c.Anchor(I,w,b,s,u))}f+=g}return h},t._deviation=function(e,t,r){var i=(t.x-e.x)*(r.x-t.x)+(t.y-e.y)*(r.y-t.y),n=(t.x-e.x)*(r.y-t.y)-(t.y-e.y)*(r.x-t.x);return Math.atan2(n,i)},t._honorsTextMaxAngle=function(e,t,r,i,n){for(var s=0,a=r/2,l=new o.Point(t.x,t.y),c=t.segment+1;s>-a;){if(--c<0)return!1;s-=o.Point.distance(e[c],l),l=e[c]}s+=o.Point.distance(e[c],e[c+1]);for(var u=[],f=0,d=e.length;s<a;){var h=e[c],p=c,v=void 0;do{if(++p===d)return!1;v=e[p]}while(v.isEqual(h));var y=p,m=void 0;do{if(++y===d)return!1;m=e[y]}while(m.isEqual(v));var x=this._deviation(h,v,m);for(u.push({deviation:x,distToAnchor:s}),f+=x;s-u[0].distToAnchor>n;)f-=u.shift().deviation;if(Math.abs(f)>i)return!1;s+=o.Point.distance(v,m),c=p}return!0},t._smoothVertices=function(e,t){if(!(t<=0)){var r=e.length;if(!(r<3)){var i=[],n=0;i.push(0);for(var s=1;s<r;s++)n+=o.Point.distance(e[s],e[s-1]),i.push(n);t=Math.min(t,.2*n);var a=[];a.push(e[0].x),a.push(e[0].y);var l=e[r-1].x,c=e[r-1].y,u=o.Point.sub(e[0],e[1]);u.normalize(),e[0].x+=t*u.x,e[0].y+=t*u.y,u.assignSub(e[r-1],e[r-2]),u.normalize(),e[r-1].x+=t*u.x,e[r-1].y+=t*u.y;for(s=1;s<r;s++)i[s]+=t;i[r-1]+=t;var f=.5*t;for(s=1;s<r-1;s++){for(var d=0,h=0,p=0,v=s-1;v>=0&&!(i[v+1]<i[s]-f);v--){var y=f+i[v+1]-i[s],m=i[v+1]-i[v],x=i[s]-i[v]<f?1:y/m;if(Math.abs(x)<1e-6)break;var g=x*y-.5*(C=x*x)*m,b=x*m/t,_=e[v+1],I=e[v].x-_.x,w=e[v].y-_.y;d+=b/g*(_.x*x*y+.5*C*(y*I-m*_.x)-C*x*m*I/3),h+=b/g*(_.y*x*y+.5*C*(y*w-m*_.y)-C*x*m*w/3),p+=b}for(v=s+1;v<r&&!(i[v-1]>i[s]+f);v++){y=f-i[v-1]+i[s],m=i[v]-i[v-1],x=i[v]-i[s]<f?1:y/m;if(Math.abs(x)<1e-6)break;var C;g=x*y-.5*(C=x*x)*m,b=x*m/t,_=e[v-1],I=e[v].x-_.x,w=e[v].y-_.y;d+=b/g*(_.x*x*y+.5*C*(y*I-m*_.x)-C*x*m*I/3),h+=b/g*(_.y*x*y+.5*C*(y*w-m*_.y)-C*x*m*w/3),p+=b}a.push(d/p),a.push(h/p)}a.push(l),a.push(c);for(s=0,v=0;s<r;s++)e[s].x=a[v++],e[s].y=a[v++]}}},t._findCentroid=function(e){var t=e.length-1,r=0,i=0,n=0,o=e[0].x,s=e[0].y;o>4096&&(o=4096),o<0&&(o=0),s>4096&&(s=4096),s<0&&(s=0);for(var a=1;a<t;a++){var l=e[a].x,u=e[a].y,f=e[a+1].x,d=e[a+1].y;l>4096&&(l=4096),l<0&&(l=0),u>4096&&(u=4096),u<0&&(u=0),f>4096&&(f=4096),f<0&&(f=0),d>4096&&(d=4096),d<0&&(d=0);var h=(l-o)*(d-s)-(f-o)*(u-s);r+=h*(o+l+f),i+=h*(s+u+d),n+=h}return r/=3*n,i/=3*n,isNaN(r)||isNaN(i)?[]:[new c.Anchor(r,i)]},t._bidiEngine=new n,t}(a)}.apply(null,i))||(e.exports=n)},2179:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(26),r(1885),r(99),r(7),r(1492),r(1886),r(1887),r(1884),r(254),r(2180),r(1888),r(1889),r(1890),r(2182),r(2185)],void 0===(n=function(e,t,r,i,n,o,s,a,l,c,u,f,d,h,p,v,y){return function(){function e(){this.rotation=0,this.status=s.TileStatus.INITIALIZED,this._symbolBuckets=[],this.placementEngine=new h.PlacementEngine,this.fillVertexBuffer=new y.FillVertexBuffer(!1),this.fillDDVertexBuffer=new y.FillVertexBuffer(!0),this.fillIndexBuffer=new f.TriangleIndexBuffer,this.outlineVertexBuffer=new y.OutlineVertexBuffer(!1),this.outlineDDVertexBuffer=new y.OutlineVertexBuffer(!0),this.outlineIndexBuffer=new f.TriangleIndexBuffer,this.lineVertexBuffer=new y.LineVertexBuffer(!1),this.lineDDVertexBuffer=new y.LineVertexBuffer(!0),this.lineIndexBuffer=new f.TriangleIndexBuffer,this.iconVertexBuffer=new y.SymbolVertexBuffer(!1),this.iconDDVertexBuffer=new y.SymbolVertexBuffer(!0),this.iconIndexBuffer=new f.TriangleIndexBuffer,this.textVertexBuffer=new y.SymbolVertexBuffer(!1),this.textDDVertexBuffer=new y.SymbolVertexBuffer(!0),this.textIndexBuffer=new f.TriangleIndexBuffer,this.circleVertexBuffer=new y.CircleVertexBuffer,this.circleIndexBuffer=new f.TriangleIndexBuffer}return e.prototype.initialize=function(e,t,r,i){void 0===i&&(i=0),this.tileKey=e,this.refKey=t,this._workerTileHandler=r,this.rotation=i,this.placementEngine.setAngle(u.C_DEG_TO_RAD*i)},e.prototype.release=function(){this.tileKey=this.refKey="",this.status=s.TileStatus.INITIALIZED,this.rotation=0,this.fillVertexBuffer.reset(),this.fillDDVertexBuffer.reset(),this.fillIndexBuffer.reset(),this.outlineVertexBuffer.reset(),this.outlineDDVertexBuffer.reset(),this.outlineIndexBuffer.reset(),this.lineVertexBuffer.reset(),this.lineDDVertexBuffer.reset(),this.lineIndexBuffer.reset(),this.iconVertexBuffer.reset(),this.iconDDVertexBuffer.reset(),this.iconIndexBuffer.reset(),this.textVertexBuffer.reset(),this.textDDVertexBuffer.reset(),this.textIndexBuffer.reset(),this.circleVertexBuffer.reset(),this.circleIndexBuffer.reset(),this.placementEngine.reset(),this._symbolBuckets.length=0,this._workerTileHandler=null},e.prototype.setDataAndParse=function(e,t){var i=this,n=new r(function(e){i.status=s.TileStatus.INVALID});return this._parse(e,t).then(function(e){i.status=s.TileStatus.READY;for(var t=[1,i.fillVertexBuffer.sizeInBytes,2,i.fillDDVertexBuffer.sizeInBytes,3,i.fillIndexBuffer.sizeInBytes,4,i.outlineVertexBuffer.sizeInBytes,5,i.outlineDDVertexBuffer.sizeInBytes,6,i.outlineIndexBuffer.sizeInBytes,7,i.lineVertexBuffer.sizeInBytes,8,i.lineDDVertexBuffer.sizeInBytes,9,i.lineIndexBuffer.sizeInBytes,10,i.iconVertexBuffer.sizeInBytes,11,i.iconDDVertexBuffer.sizeInBytes,12,i.iconIndexBuffer.sizeInBytes,13,i.textVertexBuffer.sizeInBytes,14,i.textDDVertexBuffer.sizeInBytes,15,i.textIndexBuffer.sizeInBytes,16,i.circleVertexBuffer.sizeInBytes,17,i.circleIndexBuffer.sizeInBytes],r=new Uint32Array(t),o=[],u=e.length,f=0;f<u;f++){var h=e[f];if(h instanceof c)o.push(h.layerIndex),o.push(1),o.push(h.fillIndexStart),o.push(h.fillIndexCount),o.push(h.outlineIndexStart),o.push(h.outlineIndexCount);else if(h instanceof d)o.push(h.layerIndex),o.push(2),o.push(h.lineIndexStart),o.push(h.lineIndexCount);else if(h instanceof p){o.push(h.layerIndex),o.push(3),o.push(h.sdfMarker?1:0);var v=h.markerPageMap;o.push(v.size),v.forEach(function(e,t){o.push(t),o.push(e[0]),o.push(e[1])});var y=h.glyphsPageMap;o.push(y.size),y.forEach(function(e,t){o.push(t),o.push(e[0]),o.push(e[1])})}else h instanceof l?(o.push(h.layerIndex),o.push(4),o.push(h.circleIndexStart),o.push(h.circleIndexCount)):h instanceof a&&(o.push(h.layerIndex),o.push(0))}var m=new Uint32Array(o),x=i.fillVertexBuffer.toBuffer(),g=i.fillDDVertexBuffer.toBuffer(),b=i.fillIndexBuffer.toBuffer(),_=i.outlineVertexBuffer.toBuffer(),I=i.outlineDDVertexBuffer.toBuffer(),w=i.outlineIndexBuffer.toBuffer(),C=i.lineVertexBuffer.toBuffer(),T=i.lineDDVertexBuffer.toBuffer(),P=i.lineIndexBuffer.toBuffer(),M=i.iconVertexBuffer.toBuffer(),S=i.iconDDVertexBuffer.toBuffer(),B=i.iconIndexBuffer.toBuffer(),A=i.textVertexBuffer.toBuffer(),E=i.textDDVertexBuffer.toBuffer(),D=i.textIndexBuffer.toBuffer(),V=i.circleVertexBuffer.toBuffer(),z=i.circleIndexBuffer.toBuffer();n.resolve({result:{bufferDataInfo:r.buffer,bucketDataInfo:m.buffer,bufferData:[x,g,b,_,I,w,C,T,P,M,S,B,A,E,D,V,z]},transferList:[x,g,b,_,I,w,C,T,P,M,S,B,A,E,D,V,z,r.buffer,m.buffer]})}),n.promise},e.prototype.addBucket=function(e){this._symbolBuckets.push(e)},e.prototype.updateSymbols=function(e){var t=this,r=this._symbolBuckets;if(!r||0===r.length)return o.resolve();this.rotation=e;var n=this.placementEngine;n.reset(),n.setAngle(e/256*360*u.C_DEG_TO_RAD);var a=this.iconVertexBuffer;a.reset();var l=this.iconDDVertexBuffer;l.reset();var c=this.iconIndexBuffer;c.reset();var f=this.textVertexBuffer;f.reset();var d=this.textDDVertexBuffer;d.reset();var h=this.textIndexBuffer;h.reset();var p=[],v=r.length,y=0;return i(function(){if(t.status===s.TileStatus.INVALID||t.status===s.TileStatus.INITIALIZED)return!0;if(y<v){var e=r[y++],i=e.layer,o=e.copy(i.hasDataDrivenIcon?l:a,c,i.hasDataDrivenText?d:f,h,n);o&&(p.push(o),o.updateSymbols())}return y>=v}).then(function(){if(t.status===s.TileStatus.INVALID||t.status===s.TileStatus.INITIALIZED||0===a.sizeInBytes&&0===l.sizeInBytes&&0===c.sizeInBytes&&0===f.sizeInBytes&&0===d.sizeInBytes&&0===h.sizeInBytes)return{result:null,transferList:null};var e=[10,a.sizeInBytes,11,l.sizeInBytes,12,c.sizeInBytes,13,f.sizeInBytes,14,d.sizeInBytes,15,h.sizeInBytes],r=new Uint32Array(e),i=[];v=p.length;for(var n=0;n<v;n++){var o=p[n];i.push(o.layerIndex),i.push(3),i.push(o.sdfMarker?1:0);var u=o.markerPageMap;i.push(u.size),u.forEach(function(e,t){i.push(t),i.push(e[0]),i.push(e[1])});var y=o.glyphsPageMap;i.push(y.size),y.forEach(function(e,t){i.push(t),i.push(e[0]),i.push(e[1])})}var m=new Uint32Array(i),x=a.toBuffer(),g=l.toBuffer(),b=c.toBuffer(),_=f.toBuffer(),I=d.toBuffer(),w=h.toBuffer();return{result:{bufferDataInfo:r.buffer,bucketDataInfo:m.buffer,bufferData:[x,g,b,_,I,w]},transferList:[x,g,b,_,I,w,r.buffer,m.buffer]}}).catch(function(){return null})},e.prototype.setObsolete=function(){this.status=s.TileStatus.INVALID},e.prototype.getLayers=function(){return this._workerTileHandler.getLayers()},e.prototype.getWorkerTileHandler=function(){return this._workerTileHandler},e.prototype._parse=function(e,t){return e&&0!==e.byteLength?(this.status=s.TileStatus.MODIFIED,new v(e,this,t).parse()):o.resolve([])},e.pool=new n(e),e}()}.apply(null,i))||(e.exports=n)},2180:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(0),r(1766)],void 0===(n=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return e.call(this,12)||this}return r(t,e),t.prototype.add=function(e,t,r){var i=this.array;i.push(e),i.push(t),i.push(r)},t}(n);t.TriangleIndexBuffer=o;var s=function(e){function t(){return e.call(this,4)||this}return r(t,e),t.prototype.add=function(e){this.array.push(e)},t}(n);t.PointElementMemoryBuffer=s}.apply(null,i))||(e.exports=n)},2181:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1622),r(254)],void 0===(n=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r,i){this.left=e,this.top=t,this.right=r,this.bottom=i}return e.prototype.clone=function(){return new e(this.left,this.top,this.right,this.bottom)},e.prototype.move=function(e,t){this.left+=e,this.top+=t,this.right+=e,this.bottom+=t},e.prototype.rotate=function(e,t){var r=this.left,i=this.right,n=this.top,o=this.bottom,s=r*e-n*t,a=r*t+n*e,l=i*e-n*t,c=i*t+n*e,u=r*e-o*t,f=r*t+o*e,d=i*e-o*t,h=i*t+o*e;this.left=Math.min(s,l,u,d),this.top=Math.min(a,c,f,h),this.right=Math.max(s,l,u,d),this.bottom=Math.max(a,c,f,h)},e.overlaps=function(e,t){return e.right>t.left&&e.left<t.right&&e.bottom>t.top&&e.top<t.bottom},e}();t.Box=n;var o=function(){function e(e,t,r,i){this.anchor=e,this.corners=t,this.minzoom=r,this.maxzoom=i}return e.prototype.left=function(){return this.corners[0].x},e.prototype.right=function(){return this.corners[2].x},e.prototype.top=function(){return this.corners[1].y},e.prototype.bottom=function(){return this.corners[3].y},e}();t.Obstacle=o;var s=function(){function e(e,t,r){this.obstacles=[],this.mapAngle=e,this.padding=t,this.isScreenAligned=r,this.minzoom=a}return e.prototype.addBox=function(e,t,i,n,s,a,l){var c=t.left*i-this.padding,u=t.top*i-this.padding,f=t.right*i+this.padding,d=t.bottom*i+this.padding,h=[new r.Point(c,u),new r.Point(f,u),new r.Point(f,d),new r.Point(c,d)];if(0!==this.mapAngle){var p=Math.cos(this.mapAngle),v=Math.sin(this.mapAngle);(e=e.clone()).rotate(p,v)}if(this.isScreenAligned||(n+=this.mapAngle),0!==n){p=Math.cos(n),v=Math.sin(n);h[0].rotate(p,v),h[1].rotate(p,v),h[2].rotate(p,v),h[3].rotate(p,v);for(var y=0,m=1;m<4;m++)h[m].x<h[y].x?y=m:h[m].x===h[y].x&&h[m].y<h[y].y&&(y=m);if(y){var x=[];for(m=0;m<4;m++)x.push(h[(m+y)%4]);h=x}}if(s)for(var g=0,b=h;g<b.length;g++){b[g].move(s[0],s[1])}this.obstacles.push(new o(e,h,a,l))},e}();t.Footprint=s;var a=.5,l=function(){function e(){this._grid=[]}return e.prototype.setAngle=function(e){},e.prototype.reset=function(){this._grid=[]},e.prototype.add=function(t){for(var r=this._grid,i=0,n=t.obstacles;i<n.length;i++)for(var o=n[i],s=o.anchor,a=e._gridClamp(Math.min(o.left()+s.x,s.x)),l=e._gridClamp(Math.max(o.right()+s.x,s.x)),c=e._gridClamp(Math.min(o.top()+s.y,s.y)),u=e._gridClamp(Math.max(o.bottom()+s.y,s.y)),f=c;f<=u;f++)for(var d=a;d<=l;d++){var h=r[16*f+d];h||(h=r[16*f+d]=[]),h.push(o)}},e.prototype.getMinZoom=function(t,r,n,o){if(0===t.obstacles.length)return i.C_INFINITY;for(var s=r,a=this._grid,l=0,c=t.obstacles;l<c.length;l++)for(var u=c[l],f=u.anchor,d=e._gridClamp(Math.min(u.left()+f.x,f.x)),h=e._gridClamp(Math.max(u.right()+f.x,f.x)),p=e._gridClamp(Math.min(u.top()+f.y,f.y)),v=e._gridClamp(Math.max(u.bottom()+f.y,f.y)),y=p;y<=v;y++)for(var m=d;m<=h;m++){var x=a[16*y+m];if(x)for(var g=0,b=x;g<b.length;g++){var _=b[g];if(!(u.minzoom>=_.maxzoom||_.minzoom>=u.maxzoom)&&(s=e._calcPlacementZoom(u,_,s))>=2)return i.C_INFINITY}}return s<2?s:i.C_INFINITY},e._gridClamp=function(e){return i.clamp(e>>9,-7,8)},e._calcPlacementZoom=function(t,r,n){var o=r.anchor.x-t.anchor.x;if(0===o&&(t.right()<r.left()||r.right()<t.left()))return n;var s=r.anchor.y-t.anchor.y;if(0===s&&(t.bottom()<r.top()||r.bottom()<t.top()))return n;var a=i.C_INFINITY;if(0!==o){var l=(o>0?t.right()-r.left():t.left()-r.right())/o;l<a&&(a=l);var c=o>0?e._calcExtZoomX(t,r,l):e._calcExtZoomX(r,t,l);c<a&&(a=c)}if(0!==s){var u=(s>0?t.bottom()-r.top():t.top()-r.bottom())/s;u<a&&(a=u);var f=s>0?e._calcExtZoomY(t,r,u):e._calcExtZoomY(r,t,u);f<a&&(a=f)}return a<t.minzoom||a<r.minzoom?n:((a=Math.min(a,t.maxzoom,r.maxzoom))<n&&(a=n),a)},e._calcExtZoomX=function(e,t,r){var i,n,o,s;if(e.anchor.y+e.corners[2].y/r<t.anchor.y+t.corners[0].y/r){var a=e.corners[2].x-e.corners[3].x,l=e.corners[2].y-e.corners[3].y,c=t.corners[1].x-t.corners[0].x;a*(t.corners[1].y-t.corners[0].y)-l*c>=0?e.anchor.y+e.corners[3].y/r<t.anchor.y+t.corners[0].y/r?(i=e.corners[3],n=t.corners[0],o=t.corners[1],s=1):(i=t.corners[0],n=e.corners[3],o=e.corners[2],s=-1):e.anchor.y+e.corners[2].y/r>t.anchor.y+t.corners[1].y/r?(i=e.corners[2],n=t.corners[0],o=t.corners[1],s=1):(i=t.corners[1],n=e.corners[3],o=e.corners[2],s=-1)}else{a=e.corners[2].x-e.corners[1].x,l=e.corners[2].y-e.corners[1].y,c=t.corners[3].x-t.corners[0].x;a*(t.corners[3].y-t.corners[0].y)-l*c<0?e.anchor.y+e.corners[1].y/r>t.anchor.y+t.corners[0].y/r?(i=e.corners[1],n=t.corners[0],o=t.corners[3],s=1):(i=t.corners[0],n=e.corners[1],o=e.corners[2],s=-1):e.anchor.y+e.corners[2].y/r<t.anchor.y+t.corners[3].y/r?(i=e.corners[2],n=t.corners[0],o=t.corners[3],s=1):(i=t.corners[3],n=e.corners[1],o=e.corners[2],s=-1)}var u=o.x-n.x,f=o.y-n.y;return s*((i.y-n.y)*u-(i.x-n.x)*f)/((e.anchor.x-t.anchor.x)*f-(e.anchor.y-t.anchor.y)*u)},e._calcExtZoomY=function(e,t,r){var i,n,o,s;if(e.anchor.x+e.corners[3].x/r<t.anchor.x+t.corners[1].x/r){var a=e.corners[3].x-e.corners[2].x,l=e.corners[3].y-e.corners[2].y,c=t.corners[0].x-t.corners[1].x;a*(t.corners[0].y-t.corners[1].y)-l*c<0?e.anchor.x+e.corners[2].x/r<t.anchor.x+t.corners[1].x/r?(i=e.corners[2],n=t.corners[1],o=t.corners[0],s=1):(i=t.corners[1],n=e.corners[2],o=e.corners[3],s=-1):e.anchor.x+e.corners[3].x/r>t.anchor.x+t.corners[0].x/r?(i=e.corners[3],n=t.corners[1],o=t.corners[0],s=1):(i=t.corners[0],n=e.corners[2],o=e.corners[3],s=-1)}else{a=e.corners[3].x-e.corners[0].x,l=e.corners[3].y-e.corners[0].y,c=t.corners[2].x-t.corners[1].x;a*(t.corners[2].y-t.corners[1].y)-l*c>0?e.anchor.x+e.corners[0].x/r>t.anchor.x+t.corners[1].x/r?(i=e.corners[0],n=t.corners[1],o=t.corners[2],s=1):(i=t.corners[1],n=e.corners[0],o=e.corners[3],s=-1):e.anchor.x+e.corners[3].x/r<t.anchor.x+t.corners[2].x/r?(i=e.corners[3],n=t.corners[1],o=t.corners[2],s=1):(i=t.corners[2],n=e.corners[0],o=e.corners[3],s=-1)}var u=o.x-n.x,f=o.y-n.y;return s*((i.y-n.y)*u-(i.x-n.x)*f)/((e.anchor.x-t.anchor.x)*f-(e.anchor.y-t.anchor.y)*u)},e}();t.ConflictEngine=l}.apply(null,i))||(e.exports=n)},2182:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(83),r(1885),r(510),r(7),r(1685),r(1492),r(1886),r(1887),r(2183),r(1884),r(1888),r(2184),r(1890)],void 0===(n=function(e,t,r,i,n,o,s,a,l,c,u,f,d,h,p){return function(){function e(e,t,r){this._pbfTile=new n(new Uint8Array(e),new DataView(e)),this._tile=t,this._connection=r,this._layers=t.getLayers();var i=t.tileKey.split("/").map(parseFloat),o=i[0],a=i[1],l=i[2];if(this._level=o,t.refKey){var c=o-t.refKey.split("/").map(parseFloat)[0];if(c>0){var u=(1<<c)-1,f=a&u,d=l&u;this._tileClipper=new s.TileClipper(c,f,d)}}this._tileClipper||(this._tileClipper=new s.SimpleBuilder)}return e.prototype.parse=function(){for(var e,t=this,n=this._parseTileData(this._pbfTile),s=this._layers,l=s.length,c=this._level,f=[],d={},h=new Set,p=l-1;p>=0;p--)if(!((e=s[p]).minzoom&&c<e.minzoom||e.maxzoom&&c>=e.maxzoom||e.layout&&"none"===e.layout.visibility))if(0!==e.type){var v=e.sourceLayer,y=n[v];if(y)if(h.add(v),x=this._createBucket(e)){x.layerIndex=p,x.layerExtent=y.extent;var m=d[v];m||(m=d[v]=[]),m.push(x)}}else{var x;(x=this._createBucket(e)).layerIndex=p,f.push(x)}var g=10*this._level,b=10*(this._level+1),_=[],I=[],w=[],C=[],T=this._tileClipper,P=new Set,M={},S=[];h.forEach(function(e){return S.push(e)});var B=0,A=0,E=S.length;return i(function(){if(t._tile.status===a.TileStatus.INVALID)return!0;switch(B){case 0:if(A<E){var e=S[A++],r=n[e];if(!(v=d[e])||0===v.length)break;for(var i=r.getData();i.next(2);){var o=new u(i.getMessage(),r),s=o.values;if(s){var l=s._minzoom;if(l&&l>=b)continue;var c=s._maxzoom;if(c&&c<=g)continue}for(var f=0,h=v;f<h.length;f++){(x=h[f]).pushFeature(o)}}}else{var p=t._tile;for(var e in d)for(var v,y=0,m=v=d[e];y<m.length;y++){var x;(x=m[y]).hasFeatures()&&(3===x.layer.type?(_.push(x),p.addBucket(x)):x.layer.refLayerId?w.push(x):(I.push(x),C[x.layer.id]=x))}B=1,A=0,E=_.length}break;case 1:A<E?_[A++].getResources(T,P,M):B=2}return 2===B}).then(function(){if(t._tile.status===a.TileStatus.INVALID)return[];var e,n,s=[],l=t._tile.getWorkerTileHandler();for(var c in P.size>0&&(e=l.fetchSprites(P,t._connection),s.push(e)),M){var u=M[c];u.size>0&&(n=l.fetchGlyphs(t._tile.tileKey,c,u,t._connection),s.push(n))}return r(s).then(function(e){if(t._tile.status===a.TileStatus.INVALID)return[];var r=0,n=0,o=I.length;return i(function(){if(t._tile.status===a.TileStatus.INVALID)return!0;switch(r){case 0:if(n<o)(s=I[n++]).processFeatures(T,t._tile),f.push(s);else r=1,n=0,o=w.length;break;case 1:for(var e=0,i=w;e<i.length;e++){var s=i[e],l=C[s.layer.refLayerId];l&&(l.assignBufferInfo(s),f.push(s))}r=2,n=0,o=_.length;break;case 2:if(n<o)(s=_[n++]).processFeatures(T,t._tile),f.push(s);else r=3}return 3===r}).then(function(){return f.sort(function(e,t){return e.layerIndex-t.layerIndex}),f})}).catch(function(e){return o.reject(new Error(e))})}).catch(function(e){return o.reject(new Error(e))})},e.prototype._parseTileData=function(e){for(var t={};e.next();)switch(e.tag()){case 3:var r=new h(e.getMessage());t[r.name]=r;break;default:e.skip()}return t},e.prototype._createBucket=function(e){switch(e.type){case 0:return this._createBackgroundBucket(e);case 1:return this._createFillBucket(e);case 2:return this._createLineBucket(e);case 4:return this._createCircleBucket(e);case 3:return this._createSymbolBucket(e)}},e.prototype._createBackgroundBucket=function(e){return new l(e,this._level)},e.prototype._createFillBucket=function(e){var t=this._tile;return new f(e,this._level,e.hasDataDrivenFill?t.fillDDVertexBuffer:t.fillVertexBuffer,t.fillIndexBuffer,e.hasDataDrivenOutline?t.outlineDDVertexBuffer:t.outlineVertexBuffer,t.outlineIndexBuffer)},e.prototype._createLineBucket=function(e){var t=this._tile;return new d(e,this._level,e.hasDataDrivenLine?t.lineDDVertexBuffer:t.lineVertexBuffer,t.lineIndexBuffer)},e.prototype._createCircleBucket=function(e){var t=this._tile;return new c(e,this._level,t.circleVertexBuffer,t.circleIndexBuffer)},e.prototype._createSymbolBucket=function(e){var t=this._tile;return new p(e,this._level,e.hasDataDrivenIcon?t.iconDDVertexBuffer:t.iconVertexBuffer,t.iconIndexBuffer,e.hasDataDrivenText?t.textDDVertexBuffer:t.textVertexBuffer,t.textIndexBuffer,t.placementEngine,t.getWorkerTileHandler())},e}()}.apply(null,i))||(e.exports=n)},2183:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1622)],void 0===(n=function(e,t,r){return function(){function e(e,t){this.values={};for(var r=t.keys,i=t.values;e.next();)switch(e.tag()){case 1:this.id=e.getUInt64();break;case 2:for(var n=e.getMessage(),o=this.values;!n.empty();){var s=n.getUInt32(),a=n.getUInt32();o[r[s]]=i[a]}break;case 3:this.type=e.getUInt32();break;case 4:this._pbfGeometry=e.getMessage();break;default:e.skip()}}return e.prototype.getGeometry=function(e){if(void 0!==this._geometry)return this._geometry;var t,i,n,o=this._pbfGeometry;e?e.reset(this.type):t=[];for(var s=1,a=0,l=0,c=0;!o.empty();){if(0===a){var u=o.getUInt32();s=7&u,a=u>>3}switch(a--,s){case 1:l+=o.getSInt32(),c+=o.getSInt32(),e?e.moveTo(l,c):(i&&t.push(i),(i=[]).push(new r.Point(l,c)));break;case 2:l+=o.getSInt32(),c+=o.getSInt32(),e?e.lineTo(l,c):i.push(new r.Point(l,c));break;case 7:e?e.close():i&&!i[0].equals(l,c)&&i.push(i[0].clone());break;default:throw new Error("Invalid path operation")}}return e?n=e.result():(i&&t.push(i),n=t),this._geometry=n,n},e}()}.apply(null,i))||(e.exports=n)},2184:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(t){for(this.extent=4096,this.keys=[],this.values=[],this._pbfLayer=t.clone();t.next();)switch(t.tag()){case 1:this.name=t.getString();break;case 3:this.keys.push(t.getString());break;case 4:this.values.push(e._parseValue(t.getMessage()));break;case 5:this.extent=t.getUInt32();break;default:t.skip()}}return e.prototype.getData=function(){return this._pbfLayer},e._parseValue=function(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getInt64();case 5:return e.getUInt64();case 6:return e.getSInt64();case 7:return e.getBool();default:e.skip()}return null},e}()}.apply(null,i))||(e.exports=n)},2185:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(0),r(254),r(1766)],void 0===(n=function(e,t,r,i,n,o){Object.defineProperty(t,"__esModule",{value:!0});var s=new Float32Array(1),a=new Uint32Array(s.buffer),l=function(e){function t(t){var r=e.call(this,t?20:12)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r,i,n,l,c,u){var f=this.array,d=o.i1616to32(e,t);if(f.push(d),d=o.i8888to32(Math.round(31*r),Math.round(31*i),Math.round(31*n),Math.round(31*l)),f.push(d),d=o.i1616to32(c,0),f.push(d),this._isDataDriven){if(!u)throw new Error("Expecting data driven values.");var h=u.color,p=h[3]*u.opacity*255;f.push(o.i8888to32(h[0]*p,h[1]*p,h[2]*p,p)),s[0]=u.size,f.push(a[0])}},t}(o);t.LineVertexBuffer=l;var c=function(e){function t(t){var r=e.call(this,t?8:4)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r){var i=this.array;if(i.push(o.i1616to32(e,t)),this._isDataDriven){if(!r)throw new Error("Expecting data driven values.");var n=r.color,s=n[3]*r.opacity*255;i.push(o.i8888to32(n[0]*s,n[1]*s,n[2]*s,s))}},t}(o);t.FillVertexBuffer=c;var u=function(e){function t(t){var r=e.call(this,t?12:8)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r,i,n,s,a){var l=this.array,c=this.index,u=o.i1616to32(e,t);if(l.push(u),u=o.i8888to32(Math.round(15*r),Math.round(15*i),n,s),l.push(u),this._isDataDriven){if(!a)throw new Error("Expecting data driven values.");var f=a.color,d=f[3]*a.opacity*255;l.push(o.i8888to32(f[0]*d,f[1]*d,f[2]*d,d))}return c},t}(o);t.OutlineVertexBuffer=u;var f=function(e){function t(t){var r=e.call(this,t?24:16)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r,i,l,c,u,f,d,h,p){var v=this.array,y=o.i1616to32(e,t);if(v.push(y),y=o.i1616to32(Math.round(8*r),Math.round(8*i)),v.push(y),y=o.i8888to32(l/4,c/4,0,0),v.push(y),y=o.i8888to32(Math.ceil(10*h),n.radToByte(u),10*f,Math.min(10*d,255)),v.push(y),this._isDataDriven){if(!p)throw new Error("Expecting data driven values.");var m=p.color,x=m[3]*p.opacity*255;v.push(o.i8888to32(m[0]*x,m[1]*x,m[2]*x,x)),s[0]=p.size,v.push(a[0])}},t}(o);t.SymbolVertexBuffer=f;var d=function(e){function t(){return e.call(this,16)||this}return r(t,e),t.prototype.add=function(e,t,r,i,n,s,a,l,c,u,f){var d=this.array,h=o.i1616to32(2*e+r,2*t+i);d.push(h);var p=s[3]*a*255;h=o.i8888to32(s[0]*p,s[1]*p,s[2]*p,p),d.push(h);var v=u[3]*f*255;h=o.i8888to32(u[0]*v,u[1]*v,u[2]*v,v),d.push(h),h=o.i8888to32(Math.min(32*l,255),Math.min(4*c,255),Math.min(n,255),0),d.push(h)},t}(o);t.CircleVertexBuffer=d}.apply(null,i))||(e.exports=n)},2186:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(7)],void 0===(n=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createProcessor=function(e,t){var o;return"heatmap"===e?o=n.create(function(e){return r.e(57).then(function(){var t=[r(2281)];e.apply(null,t)}.bind(this)).catch(r.oe)}):"symbol"===e&&(o=n.create(function(e){return Promise.all([r.e(9),r.e(67)]).then(function(){var t=[r(2282)];e.apply(null,t)}.bind(this)).catch(r.oe)})),o.then(function(e){return e.default}).then(function(e){var r=t.serviceAndViewInfo,n=t.remoteClient,o=t.tileStore;return new e(i({},r,{tileStore:o,remoteClient:n}))})}}.apply(null,i))||(e.exports=n)},2187:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(0),r(1624),r(11),r(1891),r(1686),r(1791),r(1523),r(182)],void 0===(n=function(e,t,r,i,n,o,s,a,l,c,u){Object.defineProperty(t,"__esModule",{value:!0});var f={added:[],removed:[]},d=new n.default,h=new u(0,0,0,0),p=function(e){function t(t){var r=e.call(this)||this;return r._tiles=new Map,r._index=s(9,o("csp-restrictions")?function(e){return{minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),r.tiles=[],r.tileInfo=t,r._tileInfoView=new a.TileInfoView(t),r.spatialReference=t.spatialReference,r}return r(t,e),t.prototype.destroy=function(){this._tiles.clear()},t.prototype.has=function(e){return this._tiles.has(e)},t.prototype.get=function(e){return this._tiles.get(e)},t.prototype.findByKey=function(e){return this._tiles.get(e.id)},t.prototype.intersections=function(e,t){var r="string"==typeof e?this.get(e):e;if(!r)return[];for(var i=t*r.resolution,n=r.bounds[0]-i,o=r.bounds[1]-i,s=r.bounds[2]+i,a=r.bounds[3]+i,l=[],c=0,u=this._index.search({minX:n,minY:o,maxX:s,maxY:a});c<u.length;c++){var f=u[c],d=f.bounds.slice();d[0]=Math.max(d[0],n),d[1]=Math.max(d[1],o),d[2]=Math.min(d[2],s),d[3]=Math.min(d[3],a),d[2]-d[0]>0&&d[3]-d[1]>0&&l.push({bounds:d,tile:f})}return l},t.prototype.setViewState=function(e){var t=this._tileInfoView.getTileCoverage(e,0);if(t){var r=t.spans,i=t.lodInfo,n=i.level;if(r.length>0)for(var o=0,s=r;o<s.length;o++)for(var a=s[o],c=a.row,u=a.colFrom,p=a.colTo,v=u;v<=p;v++){var y=h.set(n,c,i.normalizeCol(v),i.getWorldForColumn(v)).id;if(d.add(y),!this.has(y)){var m=new l.default(this._tileInfoView,y);this._tiles.set(y,m),this._index.insert(m),this.tiles.push(m),f.added.push(m)}}for(var x=this.tiles.length-1;x>=0;x--){m=this.tiles[x];d.has(m.id)||(this._tiles.delete(m.id),this.tiles.splice(x,1),this._index.remove(m),f.removed.push(m))}(f.added.length||f.removed.length)&&this.emit("update",f),d.clear(),f.added.length=0,f.removed.length=0}},t}(c.default);t.default=p}.apply(null,i))||(e.exports=n)},2190:function(e,t,r){var i,n;i=[r(13),r(117)],void 0===(n=function(e,t){var r=/^\s*"([\S\s]*)"\s*$/,i=/""/g,n=/"/g;function o(e,t){var r,i={},n=e.length;for(r=0;r<n;r++)i[e[r]]=t[r];return i}return t(null,{fieldNames:null,delimiter:",",newline:"\r\n",trim:!1,parse:function(t){var n,s,a,l,c,u,f,d,h=[],p=t.split(this.newline),v=this.fieldNames,y=0,m=[],x="",g="";e:for(u=0,a=p.length;u<a;u++)if(e.trim(p[u])){for(f=0,l=(n=p[u].split(this.delimiter)).length;f<l;f++){for(d=-1,x+=g+(s=n[f]),g="";(d=s.indexOf('"',d+1))>=0;)y++;if(y%2==0){if(y>0){if(!(c=r.exec(x))){console.warn("Csv: discarding row with invalid value: "+x),m=[],x="",y=0;continue e}m.push(c[1].replace(i,'"'))}else m.push(this.trim||!v?e.trim(x):x);x="",y=0}else g=this.delimiter}0===y?(v?h.push(o(v,m)):v=this.fieldNames=m,m=[]):g=this.newline}return h},toCsv:function(e){return this.stringify(this.data,e)},stringify:function(e,t){var r,i,o,s,a=(t=t||{}).alwaysQuote,l=this.fieldNames,c=this.delimiter,u=this.newline,f="";for(r=-1;r<e.length;r++)for(r>-1&&(f+=u),i=0;i<l.length;i++)null!==(o=r<0?l[i]:e[r][l[i]])&&void 0!==o||(o=""),"string"!=typeof o&&(o=o.toString()),s=a||o.indexOf('"')>=0||o.indexOf(c)>=0,f+=(i>0?c:"")+(s?'"'+o.replace(n,'""')+'"':o);return t.trailingNewline&&(f+=u),f}})}.apply(null,i))||(e.exports=n)}}]);