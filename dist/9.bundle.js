(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/3d/layers/graphics/graphicUtils":1505,"esri/views/2d/engine/webgl/enums":1512,"esri/views/2d/engine/webgl/Utils":1528,"esri/views/2d/engine/webgl/color":1642,"esri/views/2d/engine/webgl/number":1645,"esri/views/3d/layers/support/FastSymbolUpdates":1654,"esri/views/2d/engine/webgl/visualVariablesUtils":1732,"esri/views/2d/engine/webgl/rendererInfoUtils":1749,"esri/views/2d/engine/webgl/SymbolProperties":1845})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{1505:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(27),r(475),r(57),r(479),r(186),r(30),r(252),r(49),r(81)],void 0===(n=function(e,t,r,i,n,o,a,s,l,u,c){function f(e){var t=e.paths[0];if(!t||0===t.length)return null;var r=a.getPointOnPath(t,a.getPathLength(t)/2);return l.makeDehydratedPoint(r[0],r[1],r[2],e.spatialReference)}Object.defineProperty(t,"__esModule",{value:!0});var p=[1,1,1];t.computeCentroid=function(e){if("point"===e.type)return e;if(l.isHydratedGeometry(e))switch(e.type){case"extent":return e.center;case"polygon":return e.centroid;case"polyline":return f(e);case"mesh":return e.extent.center}else switch(e.type){case"extent":return function(e){var t=c.isFinite(e.zmin);return l.makeDehydratedPoint(.5*(e.xmax+e.xmin),.5*(e.ymax+e.ymin),t?.5*(e.zmax+e.zmin):void 0,e.spatialReference)}(e);case"polygon":return function(e){var t=o.ringsCentroid(e.rings,l.hasZ(e));return l.makeDehydratedPoint(t[0],t[1],t[2],e.spatialReference)}(e);case"polyline":return f(e)}},t.convertPointSR=function(e,t){var i=e.spatialReference;i.isWebMercator&&t.isWGS84?(s.xyToLngLat(e.x,e.y,v),e.x=v[0],e.y=v[1],e.spatialReference=r.SpatialReference.WGS84):t.isWebMercator&&i.isWGS84&&(s.lngLatToXY(e.x,e.y,v),e.x=v[0],e.y=v[1],e.spatialReference=r.SpatialReference.WebMercator)},t.enlargeExtent=function(e,t,r){if(e){t||(t=n.create());var i=e,o=.5*i.width*(r-1),a=.5*i.height*(r-1);return i.width<1e-7*i.height?o+=a/20:i.height<1e-7*i.width&&(a+=o/20),u.vec4d.set4(i.xmin-o,i.ymin-a,i.xmax+o,i.ymax+a,t),t}return null},t.updateVertexAttributeAuxpos1w=function(e,t){for(var r=0;r<e.geometries.length;++r){var i=e.geometries[r].data.vertexAttributes.auxpos1;i&&i.data[3]!==t&&(i.data[3]=t,e.geometryVertexAttrsUpdated(r))}},t.mixinColorAndOpacity=function(e,t){var r=[1,1,1,1];return null!=e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),null!==t&&void 0!==t?r[3]=t:null!=e&&e.length>3&&(r[3]=e[3]),r},t.overrideColor=function(e,t,r,i,n,o){void 0===o&&(o=[0,0,0,0]);for(var a=0;a<3;++a)e&&null!=e[a]?o[a]=e[a]:r&&null!=r[a]?o[a]=r[a]:o[a]=n[a];return o[3]=null!=t?t:null!=i?i:n[3],o},t.computeObjectScale=function(e,t,r,i){void 0===e&&(e=p),void 0===i&&(i=1);var n=new Array(3);if(null==t||null==r)n[0]=1,n[1]=1,n[2]=1;else{for(var o=void 0,a=0,s=2;s>=0;s--){var l=e[s],u=void 0,c=null!=l,f=0===s&&!o&&!c,v=r[s];"symbolValue"===l||f?u=0!==v?t[s]/v:1:c&&"proportional"!==l&&isFinite(l)&&(u=0!==v?l/v:1),null!=u&&(n[s]=u,o=u,a=Math.max(a,Math.abs(u)))}for(s=2;s>=0;s--)null==n[s]?n[s]=o:0===n[s]&&(n[s]=.001*a)}for(s=2;s>=0;s--)n[s]/=i;return n},t.computeSizeWithResourceSize=function(e,t){var r=t.isPrimitive,i=t.width,n=t.depth,o=t.height,a=r?10:1;if(null==i&&null==o&&null==n)return[a*e[0],a*e[1],a*e[2]];for(var s,l=[i,n,o],u=0;u<3;u++){var c=l[u];if(null!=c){s=c/e[u];break}}for(u=0;u<3;u++)null==l[u]&&(l[u]=e[u]*s);return l},t.validateSymbolLayerSize=function(e){return function(e){return null!=e.isPrimitive}(e)&&(e=[e.width,e.depth,e.height]),function e(t){if(Array.isArray(t)){for(var r=0,i=t;r<i.length;r++)if(!e(i[r]))return!1;return!0}return null==t||t>=0}(e)?null:"Symbol sizes may not be negative values"},t.computeObjectRotation=function(e,t,r,i){void 0===i&&(i=u.mat4d.identity());var n=e||0,o=t||0,a=r||0;return 0!==n&&u.mat4d.rotateZ(i,-n/180*Math.PI,i),0!==o&&u.mat4d.rotateX(i,o/180*Math.PI,i),0!==a&&u.mat4d.rotateY(i,a/180*Math.PI,i),i},t.demResolutionForBoundingBox=function(e,t){return null!=t.minDemResolution?t.minDemResolution:i.isPoint(e)?t.minDemResolutionForPoints:.01*i.maximumDimension(e)};var v=[0,0]}.apply(null,i))||(e.exports=n)},1512:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.FILL=0]="FILL",e[e.LINE=1]="LINE",e[e.MARKER=2]="MARKER",e[e.TEXT=3]="TEXT",e[e.LABEL=4]="LABEL",e[e.NONE=5]="NONE",e[e.UNKNOWN=6]="UNKNOWN",e[e.COUNT=7]="COUNT"}(t.WGLGeometryType||(t.WGLGeometryType={})),function(e){e[e.SUCCEEDED=0]="SUCCEEDED",e[e.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"}(t.WGLGeometryTransactionStatus||(t.WGLGeometryTransactionStatus={})),function(e){e[e.NONE=0]="NONE",e[e.FILL=1]="FILL",e[e.LINE=2]="LINE",e[e.MARKER=4]="MARKER",e[e.TEXT=8]="TEXT",e[e.LABEL=16]="LABEL",e[e.LABEL_ALPHA=32]="LABEL_ALPHA",e[e.HITTEST=64]="HITTEST",e[e.HIGHLIGHT=128]="HIGHLIGHT",e[e.CLIP=256]="CLIP",e[e.DEBUG=512]="DEBUG",e[e.NUM_DRAW_PHASES=12]="NUM_DRAW_PHASES"}(t.WGLDrawPhase||(t.WGLDrawPhase={})),function(e){e[e.SIZE=0]="SIZE",e[e.COLOR=1]="COLOR",e[e.OPACITY=2]="OPACITY",e[e.ROTATION=3]="ROTATION"}(t.VVType||(t.VVType={})),function(e){e[e.NONE=0]="NONE",e[e.OPACITY=1]="OPACITY",e[e.COLOR=2]="COLOR",e[e.ROTATION=4]="ROTATION",e[e.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE",e[e.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS",e[e.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS",e[e.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"}(t.WGLVVFlag||(t.WGLVVFlag={})),function(e){e[e.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",e[e.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",e[e.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",e[e.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(t.WGLVVTarget||(t.WGLVVTarget={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.BUTT=1]="BUTT",e[e.ROUND=2]="ROUND",e[e.SQUARE=3]="SQUARE"}(t.CapType||(t.CapType={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.MITER=1]="MITER",e[e.BEVEL=2]="BEVEL",e[e.ROUND=3]="ROUND"}(t.JoinType||(t.JoinType={})),function(e){e.SIMPLE_MARKER="esriSMS",e.SIMPLE_LINE="esriSLS",e.SIMPLE_FILL="esriSFS",e.PICTURE_MARKER="esriPMS",e.PICTURE_FILL="esriPFS",e.TEXT="esriTS"}(t.EsriSymbolType||(t.EsriSymbolType={})),function(e){e.SIMPLE_MARKER="simple-marker",e.SIMPLE_LINE="simple-line",e.SIMPLE_FILL="simple-fill",e.PICTURE_MARKER="picture-marker",e.PICTURE_FILL="picture-fill",e.TEXT="text"}(t.EsriSymbolTypeKebab||(t.EsriSymbolTypeKebab={}))}.apply(null,i))||(e.exports=n)},1528:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(127),r(110),r(8),r(9),r(32),r(87),r(1642),r(1512),r(1845)],void 0===(n=function(e,t,r,i,n,o,a,s,l,u,c){function f(e){for(var t={},r=0,i=e;r<i.length;r++){var n=i[r];t[n.name]=n.strideInBytes}return t}function p(e){switch(e){case u.WGLGeometryType.MARKER:return h;case u.WGLGeometryType.FILL:return C;case u.WGLGeometryType.LINE:return L;case u.WGLGeometryType.TEXT:return g;case u.WGLGeometryType.LABEL:return z}return null}function v(e){switch(e){case"esriSMS":return"simple-marker";case"esriPMS":return"picture-marker";case"esriSLS":return"simple-line";case"esriPLS":return"picture-line";case"esriSFS":return"simple-fill";case"esriPFS":return"picture-fill";case"esriTS":return"text"}return e}function d(e){var t=v(e.type);if(t){switch(t){case"simple-marker":case"picture-marker":case"CIMPointSymbol":return!0}return!1}}function E(e){var t=v(e.type);if(t){switch(t){case"simple-fill":case"picture-fill":case"CIMPolygonSymbol":return!0}return!1}}function _(e){var t=v(e.type);if(t){switch(t){case"simple-line":case"picture-line":case"CIMLineSymbol":return!0}return!1}}function m(e){var t=v(e.type);if(t){switch(t){case"text":case"CIMTextSymbol":return!0}return!1}}function S(e,t){return!1}function y(e){return e&&e.length||0}function T(e){return"string"==typeof e}Object.defineProperty(t,"__esModule",{value:!0});var I,V=o.getLogger("esri.views.2d.engine.webgl.Utils");t.C_HITTEST_SEARCH_SIZE=4,t.C_VBO_GEOMETRY="geometry",t.C_VBO_PERINSTANCE="per_instance",t.C_VBO_PERINSTANCE_VV="per_instance_vv",t.C_VBO_VISIBILITY="visibility",t.C_VBO_VISIBILITY_RANGE="visibilityRange",t.C_ICON_VERTEX_DEF=[{name:t.C_VBO_GEOMETRY,strideInBytes:24,divisor:0}],t.C_ICON_VERTEX_DEF_VV=[{name:t.C_VBO_GEOMETRY,strideInBytes:40,divisor:0}],t.C_ICON_HEATMAP=[{name:t.C_VBO_GEOMETRY,strideInBytes:28,divisor:0}],t.C_FILL_VERTEX_DEF=[{name:t.C_VBO_GEOMETRY,strideInBytes:24,divisor:0}],t.C_FILL_VERTEX_DEF_VV=[{name:t.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}],t.C_LINE_VERTEX_DEF=[{name:t.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}],t.C_LINE_VERTEX_DEF_VV=[{name:t.C_VBO_GEOMETRY,strideInBytes:44,divisor:0}],t.C_TEXT_VERTEX_DEF=[{name:t.C_VBO_GEOMETRY,strideInBytes:20,divisor:0},{name:t.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}],t.C_TEXT_VERTEX_DEF_VV=[{name:t.C_VBO_GEOMETRY,strideInBytes:36,divisor:0},{name:t.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}],t.C_LABEL_VERTEX_DEF=[{name:t.C_VBO_GEOMETRY,strideInBytes:20,divisor:0},{name:t.C_VBO_VISIBILITY,strideInBytes:1,divisor:0},{name:t.C_VBO_VISIBILITY_RANGE,strideInBytes:2,divisor:0}],t.C_ICON_STRIDE_SPEC=f(t.C_ICON_VERTEX_DEF),t.C_ICON_STRIDE_SPEC_VV=f(t.C_ICON_VERTEX_DEF_VV),t.C_ICON_STRIDE_SPEC_HEATMAP=f(t.C_ICON_HEATMAP),t.C_FILL_STRIDE_SPEC=f(t.C_FILL_VERTEX_DEF),t.C_FILL_STRIDE_SPEC_VV=f(t.C_FILL_VERTEX_DEF_VV),t.C_LINE_STRIDE_SPEC=f(t.C_LINE_VERTEX_DEF),t.C_LINE_STRIDE_SPEC_VV=f(t.C_LINE_VERTEX_DEF_VV),t.C_TEXT_STRIDE_SPEC=f(t.C_TEXT_VERTEX_DEF),t.C_TEXT_STRIDE_SPEC_VV=f(t.C_TEXT_VERTEX_DEF_VV),t.C_LABEL_STRIDE_SPEC=f(t.C_LABEL_VERTEX_DEF),t.getStrides=function(e,r,i){switch(void 0===i&&(i=!1),e){case u.WGLGeometryType.MARKER:return r?t.C_ICON_STRIDE_SPEC_VV:i?t.C_ICON_STRIDE_SPEC_HEATMAP:t.C_ICON_STRIDE_SPEC;case u.WGLGeometryType.FILL:return r?t.C_FILL_STRIDE_SPEC_VV:t.C_FILL_STRIDE_SPEC;case u.WGLGeometryType.LINE:return r?t.C_LINE_STRIDE_SPEC_VV:t.C_LINE_STRIDE_SPEC;case u.WGLGeometryType.TEXT:return r?t.C_TEXT_STRIDE_SPEC_VV:t.C_TEXT_STRIDE_SPEC;case u.WGLGeometryType.LABEL:return t.C_LABEL_STRIDE_SPEC}return null};var h=[t.C_VBO_GEOMETRY],C=[t.C_VBO_GEOMETRY],L=[t.C_VBO_GEOMETRY],g=[t.C_VBO_GEOMETRY,t.C_VBO_VISIBILITY],z=[t.C_VBO_GEOMETRY,t.C_VBO_VISIBILITY,t.C_VBO_VISIBILITY_RANGE];t.getNamedBuffers=p,t.getSymbolGeometryType=function(e){return d(e)?u.WGLGeometryType.MARKER:_(e)?u.WGLGeometryType.LINE:E(e)?u.WGLGeometryType.FILL:m(e)?u.WGLGeometryType.TEXT:u.WGLGeometryType.UNKNOWN},t.normalizeSymbolType=v,t.isMarkerSymbol=d,t.isFillSymbol=E,t.isLineSymbol=_,t.isPictureSymbol=function(e){var t=v(e.type);if(t){switch(t){case"picture-marker":case"picture-line":case"picture-fill":return!0}return!1}return!1},t.isTextSymbol=m,t.getTextProperties=function(e){return c.TextProperties.pool.acquire(e.color?l.copyAndPremultiply(e.color):[255,255,255,255],e.haloColor?l.copyAndPremultiply(e.haloColor):[255,255,255,255],a.pt2px(e.haloSize),a.pt2px(e.font.size),e.angle*Math.PI/180,e.xoffset/e.font.size,e.yoffset/e.font.size,"left"===e.horizontalAlignment?0:"right"===e.horizontalAlignment?1:.5,"top"===e.verticalAlignment?0:"bottom"===e.verticalAlignment?1:.5)},t.isSameUniformValue=S,t.isSameMaterialInfo=function(e,t){if(e.materialKey!==t.materialKey)return!1;if(y(e.texBindingInfo)!==y(t.texBindingInfo))return!1;if(y(e.materialParams)!==y(t.materialParams))return!1;for(var r=e.texBindingInfo.length,i=0;i<r;++i){var n=e.texBindingInfo[i],o=t.texBindingInfo[i];if(n.unit!==o.unit||n.pageId!==o.pageId||n.semantic!==o.semantic)return!1}var a=e.materialParams.length;for(i=0;i<a;++i){var s=e.materialParams[i],l=t.materialParams[i];if(s.name!==l.name||(s.value,l.value,1))return!1}return!0},t.serializeString=function(e,t,r){for(var i=0,n=e.length,o=0;o<n;++o)t&&(t[r+i]=e.charCodeAt(o)),++i;return t&&(t[r+i]=0),++i},t.deserializeString=function(e,t,r){var i=0;e.s="";for(var n=!0;n;){var o=t[r+i];++i,0!==o?e.s+=String.fromCharCode(o):n=!1}return i},t.isDefined=function(e){return null!==e&&void 0!==e},t.isNumber=function(e){return"number"==typeof e},t.isString=T,t.isStringOrNull=function(e){return null==e||T(e)},t.lerp=function(e,t,r){return e+(t-e)*r};var b=function(){function e(){this._arr=[],this._push=this._push.bind(this)}return e.prototype._push=function(e,t){this._arr.push(t)},e.prototype.getKeys=function(e){return this._arr.length=0,e&&e.forEach(this._push),this._arr},e}();t.KeysGetter=b;var R=function(){function e(){this._arr=[],this._push=this._push.bind(this)}return e.prototype._push=function(e,t){this._arr.push(e)},e.prototype.getValues=function(e){return this._arr.length=0,e&&e.forEach(this._push),this._arr},e}();t.ValuesGetter=R,t.getCapType=function(e){switch(e){case"butt":return u.CapType.BUTT;case"round":return u.CapType.ROUND;case"square":return u.CapType.SQUARE;default:return V.error(new n("mapview-invalid-type","Cap type "+e+" is not a valid option. Defaulting to round")),u.CapType.ROUND}},t.getJoinType=function(e){switch(e){case"miter":return u.JoinType.MITER;case"bevel":return u.JoinType.BEVEL;case"round":return u.JoinType.ROUND;default:return V.error(new n("mapview-invalid-type","Join type "+e+" is not a valid option. Defaulting to round")),u.JoinType.ROUND}},t.getVVType=function(e){switch(e){case"opacity":return u.VVType.OPACITY;case"color":return u.VVType.COLOR;case"rotation":return u.VVType.ROTATION;case"size":return u.VVType.SIZE;default:return V.error("Cannot interpret unknown vv: "+e),null}},t.createArcadeFunction=function(e,t){var n=e.valueExpression,o=e.spatialReference,a=e.layer,l=s.createFunction(n),u=new i;return function(e,i){u.repurposeFromGraphicLikeObject(e.geometry,e.attributes,a);var n=i&&new r({viewingMode:i.viewingMode,scale:i.scale}),c={vars:{$feature:u,$view:n||{}},spatialReference:o},f=s.executeFunction(l,c);return t?t(f):f}},t.copyMeshData=function(e,t,r,i,n,o,a){for(var s in o)for(var l=o[s].stride,u=o[s].data,c=r[s].data,f=l*n.vertexCount/4,p=l*e/4,v=l*n.vertexFrom/4,d=0;d<f;++d)c[d+p]=u[d+v];var E=n.indexCount;for(d=0;d<E;++d)i[d+t]=a[d+n.indexFrom]-n.vertexFrom+e},t.C_VBO_INFO=((I={})[t.C_VBO_GEOMETRY]=35044,I[t.C_VBO_VISIBILITY]=35044,I[t.C_VBO_VISIBILITY_RANGE]=35048,I),t.createGeometryData=function(e,t){for(var r=[],i=0;i<5;++i){for(var n={},o=0,a=p(i);o<a.length;o++){var s=a[o];n[s]={data:t(i,s)}}r.push({data:e(i),buffers:n})}return r}}.apply(null,i))||(e.exports=n)},1642:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1645)],void 0===(n=function(e,t,r){function i(e,t){return Array.isArray(t)?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]):(e[0]=t.r,e[1]=t.g,e[2]=t.b,e[3]=t.a),e}function n(e,t,r){void 0===t&&(t=0),void 0===r&&(r=!1);var i=e[t+3];return e[t+0]*=i,e[t+1]*=i,e[t+2]*=i,r||(e[t+3]*=255),e}Object.defineProperty(t,"__esModule",{value:!0}),t.white=[255,255,255,1];var o=[0,0,0,0];t.premultiplyAlpha=n,t.copyAndPremultiply=function(e){return n(i([],e))},t.premultiplyAlphaUint32=function(e){return n(i(o,e)),r.i8888to32(o[0],o[1],o[2],o[3])},t.premultiplyAlphaRGBA=function(e){var t=e.r,i=e.g,n=e.b,o=e.a,a=t*o,s=i*o,l=n*o,u=255*o;return r.i8888to32(a,s,l,u)}}.apply(null,i))||(e.exports=n)},1645:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=new Float32Array(1),i=new Uint32Array(r.buffer);t.nextHighestPowerOfTwo=function(e){var t=e;return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t},t.toUint32=function(e){return r[0]=e,i[0]},t.i1616to32=function(e,t){return 65535&e|t<<16},t.i8888to32=function(e,t,r,i){return 255&e|(255&t)<<8|(255&r)<<16|i<<24},t.i8816to32=function(e,t,r){return 255&e|(255&t)<<8|r<<16},t.numTo32=function(e){return 0|e}}.apply(null,i))||(e.exports=n)},1654:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(482),r(1505),r(49)],void 0===(n=function(e,t,r,i,n){function o(e){return null!==e&&void 0!==e}function a(e){return"number"==typeof e}function s(e){return"string"==typeof e}function l(e,t){e&&e.push(t),c(t)}function u(e){V&&console.warn("[FastSymbolUpdates] "+e)}function c(e){V&&console.info("[FastSymbolUpdates] "+e)}function f(e,t,i,n,s){var u=e.minSize,c=e.maxSize;if(e.expression)return l(s,"Could not convert size info: expression not supported"),!1;if(e.useSymbolValue){var f=n.symbolSize[i];return t.minSize[i]=f,t.maxSize[i]=f,t.offset[i]=t.minSize[i],t.factor[i]=0,t.type[i]=1,!0}if(o(e.field))return o(e.stops)?2===e.stops.length&&a(e.stops[0].size)&&a(e.stops[1].size)?(p(e.stops[0].size,e.stops[1].size,e.stops[0].value,e.stops[1].value,t,i),t.type[i]=1,!0):(l(s,"Could not convert size info: stops only supported with 2 elements"),!1):a(u)&&a(c)&&o(e.minDataValue)&&o(e.maxDataValue)?(p(u,c,e.minDataValue,e.maxDataValue,t,i),t.type[i]=1,!0):null!=r.meterIn[e.valueUnit]?(t.minSize[i]=-1/0,t.maxSize[i]=1/0,t.offset[i]=0,t.factor[i]=1/r.meterIn[e.valueUnit],t.type[i]=1,!0):"unknown"===e.valueUnit?(l(s,"Could not convert size info: proportional size not supported"),!1):(l(s,"Could not convert size info: scale-dependent size not supported"),!1);if(!o(e.field)){if(e.stops&&e.stops[0]&&a(e.stops[0].size))return t.minSize[i]=e.stops[0].size,t.maxSize[i]=e.stops[0].size,t.offset[i]=t.minSize[i],t.factor[i]=0,t.type[i]=1,!0;if(a(u))return t.minSize[i]=u,t.maxSize[i]=u,t.offset[i]=u,t.factor[i]=0,t.type[i]=1,!0}return l(s,"Could not convert size info: unsupported variant of sizeInfo"),!1}function p(e,t,r,i,n,o){var a=Math.abs(i-r)>0?(t-e)/(i-r):0;n.minSize[o]=a>0?e:t,n.maxSize[o]=a>0?t:e,n.offset[o]=e-r*a,n.factor[o]=a}function v(e,t,r,i){if(e.normalizationField||e.valueRepresentation)return l(i,"Could not convert size info: unsupported property"),null;if(!function(e){return null==e||s(e)}(e.field))return l(i,"Could not convert size info: field is not a string"),null;if(t.size){if(e.field)if(t.size.field){if(e.field!==t.size.field)return l(i,"Could not convert size info: multiple fields in use"),null}else t.size.field=e.field}else t.size={field:e.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};var n;switch(e.axis){case"width":return(n=f(e,t.size,0,r,i))?t:null;case"height":return(n=f(e,t.size,2,r,i))?t:null;case"depth":return(n=f(e,t.size,1,r,i))?t:null;case"width-and-depth":return(n=f(e,t.size,0,r,i))&&f(e,t.size,1,r,i),n?t:null;case null:case void 0:case"all":return(n=(n=(n=f(e,t.size,0,r,i))&&f(e,t.size,1,r,i))&&f(e,t.size,2,r,i))?t:null;default:return l(i,'Could not convert size info: unknown axis "'+e.axis+'""'),null}}function d(e,t,r){e[4*t+0]=r.r/255,e[4*t+1]=r.g/255,e[4*t+2]=r.b/255,e[4*t+3]=r.a}function E(e,t,r){if(e.normalizationField)return l(r,"Could not convert color info: unsupported property"),null;if(s(e.field))if(e.stops){if(e.stops.length>8)return l(r,"Could not convert color info: too many color stops"),null;t.color={field:e.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(var i=e.stops,n=0;n<8;++n){var a=i[Math.min(n,i.length-1)];t.color.values[n]=a.value,d(t.color.colors,n,a.color)}}else{if(!e.colors)return l(r,"Could not convert color info: missing stops or colors"),null;if(!o(e.minDataValue)||!o(e.maxDataValue))return l(r,"Could not convert color info: missing data values"),null;if(2!==e.colors.length)return l(r,"Could not convert color info: invalid colors array"),null;t.color={field:e.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},t.color.values[0]=e.minDataValue,d(t.color.colors,0,e.colors[0]),t.color.values[1]=e.maxDataValue,d(t.color.colors,1,e.colors[1]);for(n=2;n<8;++n)t.color.values[n]=e.maxDataValue,d(t.color.colors,n,e.colors[1])}else{if(!(e.stops&&e.stops.length>=0||e.colors&&e.colors.length>=0))return l(r,"Could not convert color info: no field and no colors/stops"),null;var u=e.stops&&e.stops.length>=0?e.stops[0].color:e.colors[0];t.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(n=0;n<8;n++)t.color.values[n]=1/0,d(t.color.colors,n,u)}return t}function _(e,t,r,i){var n=2===r&&"arithmetic"===e.rotationType;t.offset[r]=n?90:0,t.factor[r]=n?-1:1,t.type[r]=1}function m(e,t,r){if(!e)return null;var i=!t.supportedTypes||!!t.supportedTypes.size,n=!t.supportedTypes||!!t.supportedTypes.color,o=!t.supportedTypes||!!t.supportedTypes.rotation;V&&(r=r||[]);var a=e.reduce(function(e,a){if(!e)return e;if(a.valueExpression)return l(r,"Could not convert visual variables: arcade expressions not supported"),null;switch(a.type){case"size":return i?v(a,e,t,r):e;case"color":return n?E(a,e,r):e;case"rotation":return o?function(e,t,r){if(!s(e.field))return l(r,"Could not convert rotation info: field is not a string"),null;if(t.rotation){if(e.field)if(t.rotation.field){if(e.field!==t.rotation.field)return l(r,"Could not convert rotation info: multiple fields in use"),null}else t.rotation.field=e.field}else t.rotation={field:e.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};switch(e.axis){case"tilt":return _(e,t.rotation,0),t;case"roll":return _(e,t.rotation,1),t;case null:case void 0:case"heading":return _(e,t.rotation,2),t;default:return l(r,'Could not convert rotation info: unknown axis "'+e.axis+'""'),null}}(a,e,r):e;default:return l(r,"Could not convert visual variables: unsupported type "+a.type),null}},{size:null,color:null,rotation:null});return a&&a.size&&!function(e,t,r){for(var i=0;i<3;++i){var n=t.unitInMeters;1===e.type[i]&&(n*=t.modelSize[i],e.type[i]=2),e.minSize[i]=e.minSize[i]/n,e.maxSize[i]=e.maxSize[i]/n,e.offset[i]=e.offset[i]/n,e.factor[i]=e.factor[i]/n}var o;if(0!==e.type[0])o=0;else if(0!==e.type[1])o=1;else{if(0===e.type[2])return l(r,"No size axis contains a valid size or scale"),!1;o=2}for(i=0;i<3;++i)0===e.type[i]&&(e.minSize[i]=e.minSize[o],e.maxSize[i]=e.maxSize[o],e.offset[i]=e.offset[o],e.factor[i]=e.factor[o],e.type[i]=e.type[o]);return!0}(a.size,t,r)?null:a}function S(e){return e&&null!=e.size}function y(e,t,r){if(!!e!=!!t)return u("State update failed ({$name} enabled/disabled)"),!1;if(e&&e.field!==t.field)return u("State update failed ({$name} field changed)"),!1;if(e&&"rotation"===r)for(var i=e,n=t,o=0;o<3;o++)if(i.type[o]!==n.type[o]||i.offset[o]!==n.offset[o]||i.factor[o]!==n.factor[o])return!1;return!0}function T(e,t){var r={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvSymbolAnchor:null,vvSymbolRotation:null},i=S(e);return e&&e.size?(r.vvSizeEnabled=!0,r.vvSizeMinSize=e.size.minSize,r.vvSizeMaxSize=e.size.maxSize,r.vvSizeOffset=e.size.offset,r.vvSizeFactor=e.size.factor):e&&i&&(r.vvSizeValue=t.transformation.scale),e&&i&&(r.vvSymbolAnchor=t.transformation.anchor,r.vvSymbolRotation=t.transformation.rotation),e&&e.color&&(r.vvColorEnabled=!0,r.vvColorValues=e.color.values,r.vvColorColors=e.color.colors),r}Object.defineProperty(t,"__esModule",{value:!0});var I,V=!1,h=!1;t.convertVisualVariables=m,t.initFastSymbolUpdatesState=function(e,t,r){if(h)return u("State not initialized, fast updates disabled (globally disabled)"),{enabled:!1};if(!t)return u("State not initialized, fast updates disabled (no shader support)"),{enabled:!1};if(!e)return u("State not initialized, fast updates disabled (no renderer)"),{enabled:!1};if(e.disableFastUpdates)return u("State not initialized, fast updates disabled (renderer.disableFastUpdates set)"),{enabled:!1};var i=m(e.visualVariables,r);return i?(c("State initialized, fast updates enabled"),{enabled:!0,visualVariables:i,materialParameters:T(i,r),customTransformation:S(i)}):(u("State not initialized, fast updates disabled (conversion failed)"),{enabled:!1})},t.updateFastSymbolUpdatesState=function(e,t,r){if(!t||!e.enabled)return!1;var i=e.visualVariables,n=m(t.visualVariables,r);return n?!!(y(i.size,n.size,"size")&&y(i.color,n.color,"color")&&y(i.rotation,n.rotation,"rotation"))&&(e.visualVariables=n,e.materialParameters=T(n,r),e.customTransformation=S(n),c("State updated"),!0):(u("State update failed (conversion failed)"),!1)},t.getMaterialParams=T,function(e){function t(e,t,r){return e<t?t:e>r?r:e}var r=n.mat4d,o=n.vec3,a=r.create(),s=o.create();e.evaluateModelTransform=function(e,n,o){if(!e.vvSizeEnabled)return o;if(r.set(o,a),i.computeObjectRotation(e.vvSymbolRotation[2],e.vvSymbolRotation[0],e.vvSymbolRotation[1],a),e.vvSizeEnabled){for(var l=0;l<3;++l){var u=e.vvSizeOffset[l]+n[0]*e.vvSizeFactor[l];s[l]=t(u,e.vvSizeMinSize[l],e.vvSizeMaxSize[l])}r.scale(a,s,a)}else r.scale(a,e.vvSizeValue,a);return r.translate(a,e.vvSymbolAnchor,a),a}}(I||(I={})),t.evaluateModelTransform=I.evaluateModelTransform}.apply(null,i))||(e.exports=n)},1732:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(32),r(1642),r(1512),r(1528),r(1654)],void 0===(n=function(e,t,r,i,n,o,a){function s(e){return o.isNumber(e.minDataValue)&&o.isNumber(e.maxDataValue)&&null!=e.minSize&&null!=e.maxSize?n.WGLVVFlag.SIZE_MINMAX_VALUE:(e.expression&&"view.scale"===e.expression||e.valueExpression&&"$view.scale"===e.valueExpression)&&Array.isArray(e.stops)?n.WGLVVFlag.SIZE_SCALE_STOPS:(null!=e.field||e.expression&&"view.scale"!==e.expression||e.valueExpression&&"$view.scale"!==e.valueExpression)&&Array.isArray(e.stops)?n.WGLVVFlag.SIZE_FIELD_STOPS:(null!=e.field||e.expression&&"view.scale"!==e.expression||e.valueExpression&&"$view.scale"!==e.valueExpression)&&null!=e.valueUnit?n.WGLVVFlag.SIZE_UNIT_VALUE:n.WGLVVFlag.NONE}function l(e){return{value:e.value,size:r.toPt(e.size)}}function u(e){return e.map(function(e){return l(e)})}function c(e){if("string"==typeof e||"number"==typeof e)return r.toPt(e);var t=e;return{type:"size",expression:t.expression,stops:u(t.stops)}}function f(e){var t={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(o.isString(e.field))if(e.stops){if(e.stops.length>8)return null;for(var r=e.stops,i=0;i<8;++i){var n=r[Math.min(i,r.length-1)];t.values[i]=n.value,t.opacities[i]=n.opacity}}else{if(!e.opacityValues)return null;if(!o.isDefined(e.minDataValue)||!o.isDefined(e.maxDataValue))return null;if(2!==e.opacityValues.length)return null;t.values[0]=e.minDataValue,t.opacities[0]=e.opacityValues[0],t.values[1]=e.maxDataValue,t.opacities[1]=e.opacityValues[1];for(i=2;i<8;++i)t.values[i]=e.maxDataValue,t.opacities[i]=e.opacityValues[1]}else{if(!(e.stops&&e.stops.length>=0||e.opacityValues&&e.opacityValues.length>=0))return null;var a=e.stops&&e.stops.length>=0?e.stops[0].opacity:e.opacityValues[0];for(i=0;i<8;i++)t.values[i]=1/0,t.opacities[i]=a}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getTypeOfSizeVisualVariable=s,t.getVisualVariableSizeValueRepresentationRatio=function(e,t){if(!e||!t)return e;switch(t){case"radius":case"distance":return 2*e;case"diameter":case"width":return e;case"area":return Math.sqrt(e)}return e},t.stopToSizeStop=l,t.normalizeSizeStops=u,t.normalizeSizeElement=c,t.getVisualVariablesFields=function(e){var t=e&&e.length>0?{}:null;return t&&e.forEach(function(e){var r=e.type;e.field&&(t[r]=e.field)}),t},t.convertVisualVariables=function(e){var t=e&&e.length>0?{}:null,o=t?{}:null;if(!t)return{vvFields:t,vvRanges:o};for(var l=0,p=e;l<p.length;l++){var v=p[l],d=v.type;if(v.field&&(t[d]=v.field),"size"===d){o.size||(o.size={});var E=v;switch(s(E)){case n.WGLVVFlag.SIZE_MINMAX_VALUE:o.size.minMaxValue={minDataValue:E.minDataValue,maxDataValue:E.maxDataValue,minSize:c(E.minSize),maxSize:c(E.maxSize)};break;case n.WGLVVFlag.SIZE_SCALE_STOPS:o.size.scaleStops={stops:u(E.stops)};break;case n.WGLVVFlag.SIZE_FIELD_STOPS:for(var _=[],m=[],S=u(E.stops),y=S.length,T=0;T<6;T++){var I=S[Math.min(T,y-1)];_.push(I.value),m.push(r.pt2px(I.size))}o.size.fieldStops={values:_,sizes:m};break;case n.WGLVVFlag.SIZE_UNIT_VALUE:o.size.unitValue={unit:E.valueUnit,valueRepresentation:E.valueRepresentation}}}else if("color"===d){var V=a.convertVisualVariables([v],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null});for(o.color=V.color,T=0;T<32;T+=4)i.premultiplyAlpha(o.color.colors,T,!0)}else if("opacity"===d)o.opacity=f(v);else if("rotation"===d){var h=v;o.rotation={type:h.rotationType}}}return{vvFields:t,vvRanges:o}}}.apply(null,i))||(e.exports=n)},1749:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(58),r(110),r(87),r(1512),r(1732)],void 0===(n=function(e,t,r,i,n,o,a,s){function l(e,t,n){if(!e)return null;var a=0,s={},l=e.clone(),c=l.visualVariables,f=null;if("simple"!==l.type){var p=l.field,v=l.valueExpression;if(!p&&v){var d="$$fake"+a++,E=o.createFunction(v);s[d]=function(e,r){return u.repurposeFromGraphicLikeObject(e.geometry,e.attributes,n),o.executeFunction(E,{vars:{$feature:u,$view:o.getViewInfo(r)},spatialReference:t})},l.field=d,l.valueExpression=null,f=function(e,t){return t.attributes[d]=s[d](t),e.valueExpression?e.getSymbol(i.fromJSON(t)):e.getSymbol(t)}}}return c&&(l.visualVariables=c.map(function(e){if(e.normalizationField){var i=e.field,l=e.normalizationField,c="$$fake"+a++;return s[c]=function(e,t){return e.attributes[i]/e.attributes[l]},(f=r({},e)).field=c,delete f.normalizationField,f}if(e.valueExpression&&"$view.scale"!==e.valueExpression){var f,p=e.valueExpression,v=(c="$$fake"+a++,o.createFunction(p));return s[c]=function(e,r){return u.repurposeFromGraphicLikeObject(e.geometry,e.attributes,n),o.executeFunction(v,{vars:{$feature:u,$view:o.getViewInfo(r)},spatialReference:t})},(f=r({},e)).field=c,delete f.valueExpression,f}return e})),{renderer:l,normalizingFunctions:s,getSymbolFunction:f}}Object.defineProperty(t,"__esModule",{value:!0});var u=new n;t.createRendererInfo=function(e,t,r){var i=l(e,t,r)||{renderer:null,normalizingFunctions:null,getSymbolFunction:null},n=i&&i.normalizingFunctions,o=i&&i.getSymbolFunction;e=i&&i.renderer||e;var a=s.convertVisualVariables(e.visualVariables);return{renderer:e,vvFields:a.vvFields,vvRanges:a.vvRanges,getValue:function(e,t){var r=n[t];return r?r(e):e.attributes[t]},getSymbol:function(e){return o?o(this.renderer,e):this.renderer.getSymbol?this.renderer.getSymbol.call(this.renderer,e):null}}},t.getNormalizedRenderer=function(e,t,r){var i=l(e,t,r)||{renderer:null,normalizingFunctions:null,getSymbolFunction:null};return i&&i.renderer||e},t.getSymbol=function(e,t){return e.getSymbol(t)},t.isRendererWebGLCompatible=function(e){if(!e)return!1;if(-1===["simple","class-breaks","unique-value","heatmap"].indexOf(e.type))return!1;if(e.visualVariables)for(var t=0,r=e.visualVariables;t<r.length;t++){var i=r[t];switch(i.type){case"color":case"opacity":if(i.stops&&i.stops.length>8)return!1;break;case"size":if(s.getTypeOfSizeVisualVariable(i)===a.WGLVVFlag.SIZE_FIELD_STOPS&&i.stops&&i.stops.length>6)return!1}}return!0}}.apply(null,i))||(e.exports=n)},1845:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(100)],void 0===(n=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.color=[0,0,0,0],this.haloColor=[0,0,0,0],this.haloSize=0,this.size=12,this.angle=0,this.offsetX=0,this.offsetY=0,this.hAnchor=0,this.vAnchor=0}return e.prototype.acquire=function(e,t,r,i,n,o,a,s,l){this.color=e,this.haloColor=t,this.haloSize=r,this.size=i,this.angle=n,this.offsetX=o,this.offsetY=a,this.hAnchor=s,this.vAnchor=l},e.prototype.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0,this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0,this.haloSize=0,this.size=0,this.angle=0,this.offsetX=0,this.offsetY=0,this.hAnchor=0,this.vAnchor=0},e.pool=new r(e),e}();t.TextProperties=i}.apply(null,i))||(e.exports=n)}}]);