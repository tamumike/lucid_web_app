(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/webgl/BufferObject":1564,"esri/views/3d/support/buffer/typedArrayUtil":1583,"esri/views/2d/engine/webgl/definitions":1606,"esri/geometry/support/quantizationUtils":1620,"esri/views/2d/engine/webgl/WGLDisplayList":1735,"esri/views/2d/engine/webgl/WGLRendererInfo":1811,"esri/views/2d/engine/webgl/TileData":1812,"esri/views/2d/engine/webgl/MemoryRequirements":1813,"esri/views/2d/engine/webgl/TileBufferData":1814,"esri/views/2d/engine/webgl/TileDisplayData":1815,"esri/views/2d/engine/webgl/util/Reader":1816,"esri/views/2d/engine/webgl/WGLTile":1818,"esri/views/2d/engine/webgl/DirtyMap":1819,"esri/views/2d/engine/webgl/DisplayRecordStore":1820,"esri/views/2d/engine/webgl/FreeList":1821,"esri/views/2d/engine/webgl/Fader":1822,"esri/views/2d/engine/webgl/WGLBuffers":1823,"esri/views/2d/engine/webgl/rendererInfoUtils":2017,"esri/views/2d/layers/features/tileRenderers/BaseTileRenderer":2018,"esri/views/2d/layers/features/tileRenderers/SymbolTileRenderer":2488,"esri/views/2d/engine/webgl/WGLFeatureView":2489})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{1564:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(19),r(1583)],void 0===(n=function(e,t,r,i){return function(){function e(t,i,n,a,o){this._context=null,this._glName=null,this._bufferType=void 0,this._usage=35044,this._size=-1,this._indexType=void 0,this._context=t,this._bufferType=i,this._usage=n,this._id=e._nextId++,this._glName=this._context.gl.createBuffer(),r("esri-webgl-debug")&&t.instanceCounter.incrementCount(1),a&&this.setData(a,o)}return e.createIndex=function(t,r,i,n){return new e(t,34963,r,i,n)},e.createVertex=function(t,r,i){return new e(t,34962,r,i)},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"usage",{get:function(){return this._usage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._context&&(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),r("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(1),this._context=null)},e.prototype.setData=function(e,t){if(e){if("number"==typeof e){if(e<0&&console.error("Buffer size cannot be negative!"),34963===this._bufferType&&t)switch(this._indexType=t,this._size=e,t){case 5123:e*=2;break;case 5125:e*=4}}else{var r=e.byteLength;i.isUint16Array(e)&&(r/=2,this._indexType=5123),i.isUint32Array(e)&&(r/=4,this._indexType=5125),this._size=r}var n=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this),this._context.gl.bufferData(this._bufferType,e,this._usage),this._context.bindVAO(n)}},e.prototype.setSubData=function(e,t,r,n){if(void 0===t&&(t=0),void 0===r&&(r=0),e){(t<0||t>=this._size)&&console.error("offset is out of range!");var a=t,o=r,s=n,l=e.byteLength;i.isUint16Array(e)&&(l/=2,a*=2,o*=2,s*=2),i.isUint32Array(e)&&(l/=4,a*=4,o*=4,s*=4),void 0===n&&(n=l-1),r>=n&&console.error("end must be bigger than start!"),t+r-n>this._size&&console.error("An attempt to write beyond the end of the buffer!");var u=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this);var f=this._context.gl,d=ArrayBuffer.isView(e)?e.buffer:e;f.bufferSubData(this._bufferType,a,d.slice(o,s)),this._context.bindVAO(u)}},e._nextId=0,e}()}.apply(null,i))||(e.exports=n)},1583:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=function(e,t){if(e.forEach)e.forEach(t);else for(var r=0;r<e.length;r++)t(e[r],r,e)},t.slice=function(e,t,r){if(e.slice)return e.slice(t,r);void 0===t?t=0:(t<0&&(t+=e.length),t=Math.min(e.length,Math.max(0,t))),void 0===r?r=e.length:(r<0&&(r+=e.length),r=Math.min(e.length,Math.max(0,r)));for(var i=Math.max(0,r-t),n=new(0,e.constructor)(i),a=0;a<i;a++)n[a]=e[t+a];return n},t.isArrayBuffer=function(e){return e instanceof ArrayBuffer||e&&e.constructor&&"ArrayBuffer"===e.constructor.name},t.isInt8Array=function(e){return e instanceof Int8Array||e&&e.constructor&&"Int8Array"===e.constructor.name},t.isUint8Array=function(e){return e instanceof Uint8Array||e&&e.constructor&&"Uint8Array"===e.constructor.name},t.isInt16Array=function(e){return e instanceof Int16Array||e&&e.constructor&&"Int16Array"===e.constructor.name},t.isUint16Array=function(e){return e instanceof Uint16Array||e&&e.constructor&&"Uint16Array"===e.constructor.name},t.isInt32Array=function(e){return e instanceof Int32Array||e&&e.constructor&&"Int32Array"===e.constructor.name},t.isUint32Array=function(e){return e instanceof Uint32Array||e&&e.constructor&&"Uint32Array"===e.constructor.name},t.isFloat32Array=function(e){return e instanceof Float32Array||e&&e.constructor&&"Float32Array"===e.constructor.name},t.isFloat64Array=function(e){return e instanceof Float64Array||e&&e.constructor&&"Float64Array"===e.constructor.name},t.toArray=function(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e[r];return t}}.apply(null,i))||(e.exports=n)},1606:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EXTRUDE_SCALE=64,t.PICTURE_FILL_COLOR=4294967295,t.TILE_SIZE=512,t.ANGLE_FACTOR_256=256/360,t.DEBUG_LABELS=!1,t.COLLISION_BUCKET_SIZE=128,t.COLLISION_MAX_ZOOM_DELTA=3,t.COLLISION_EARLY_REJECT_BUCKET_SIZE=32,t.COLLISION_BOX_PADDING=8,t.COLLISION_TILE_BOX_SIZE=t.TILE_SIZE/t.COLLISION_BUCKET_SIZE,t.COLLISION_PLACEMENT_PADDING=8,t.HEURISTIC_GLYPHS_PER_LINE=50,t.HEURISTIC_GLYPHS_PER_FEATURE=10,t.GLYPH_SIZE=24,t.TEXT_LINE_HEIGHT=1.2*t.GLYPH_SIZE,t.TEXT_MAX_WIDTH=10*t.GLYPH_SIZE,t.TEXT_SPACING=0}.apply(null,i))||(e.exports=n)},1620:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(59)],void 0===(n=function(e,t,r){function i(e){return e&&"upperLeft"===e.originPosition}function n(e,t){var r=e.scale,i=e.translate;return Math.round((t-i[0])/r[0])}function a(e,t){var r=e.scale,i=e.translate;return Math.round((i[1]-t)/r[1])}function o(e,t,r){for(var i,o,s,l,u=[],f=0;f<r.length;f++){var d=r[f];f>0?(s=n(e,d[0]),l=a(e,d[1]),s===i&&l===o||(u.push(t(d,s-i,l-o)),i=s,o=l)):(i=n(e,d[0]),o=a(e,d[1]),u.push(t(d,i,o)))}return u.length>0?u:null}function s(e,t,r,i){return o(e,r?i?w:T:i?T:D,t)}function l(e,t,r,i){for(var n=[],a=r?i?w:T:i?T:D,s=0;s<t.length;s++){var l=o(e,a,t[s]);l&&l.length>=3&&n.push(l)}return n.length?n:null}function u(e,t,r,i){for(var n=[],a=r?i?w:T:i?T:D,s=0;s<t.length;s++){var l=o(e,a,t[s]);l&&l.length>=2&&n.push(l)}return n.length?n:null}function f(e,t){var r=e.scale,i=e.translate;return t*r[0]+i[0]}function d(e,t){var r=e.scale;return e.translate[1]-t*r[1]}function p(e,t,r){var i=new Array(r.length);if(!r.length)return i;var n=e.scale,a=n[0],o=n[1],s=f(e,r[0][0]),l=d(e,r[0][1]);i[0]=t(r[0],s,l);for(var u=1;u<r.length;u++){var p=r[u];s+=p[0]*a,l-=p[1]*o,i[u]=t(p,s,l)}return i}function c(e,t,r){for(var i=new Array(r.length),n=0;n<r.length;n++)i[n]=p(e,t,r[n]);return i}function h(e,t,r,i){return p(e,r?i?w:T:i?T:D,t)}function y(e,t,r,i){return c(e,r?i?w:T:i?T:D,t)}function v(e,t,r,i){return c(e,r?i?w:T:i?T:D,t)}function g(e,t,r){for(var i=r[0],n=i[0],a=i[1],o=Math.min(n,t[0]),s=Math.min(a,t[1]),l=Math.max(n,t[2]),u=Math.max(a,t[3]),f=1;f<r.length;f++){var d=r[f],p=d[0],c=d[1];n+=p,a+=c,p<0&&(o=Math.min(o,n)),p>0&&(l=Math.max(l,n)),c<0?s=Math.min(s,a):c>0&&(u=Math.max(u,a))}return e[0]=o,e[1]=s,e[2]=l,e[3]=u,e}function m(e,t){if(!t.length)return null;e[0]=e[1]=Number.POSITIVE_INFINITY,e[2]=e[3]=Number.NEGATIVE_INFINITY;for(var r=0;r<t.length;r++)g(e,e,t[r]);return e}function _(e,t,r,i,o){return t.xmin=n(e,r.xmin),t.ymin=a(e,r.ymin),t.xmax=n(e,r.xmax),t.ymax=a(e,r.ymax),t!==r&&(i&&(t.zmin=r.zmin,t.zmax=r.zmax),o&&(t.mmin=r.mmin,t.mmax=r.mmax)),t}function x(e,t,r,i,n){return t.points=s(e,r.points,i,n),t}function b(e,t,r,i,o){return t.x=n(e,r.x),t.y=a(e,r.y),t!==r&&(i&&(t.z=r.z),o&&(t.m=r.m)),t}function L(e,t,r,i,n){var a=l(e,r.rings,i,n);return a?(t.rings=a,t):null}function I(e,t,r,i,n){var a=u(e,r.paths,i,n);return a?(t.paths=a,t):null}Object.defineProperty(t,"__esModule",{value:!0});var D=function(e,t,r){return[t,r]},T=function(e,t,r){return[t,r,e[2]]},w=function(e,t,r){return[t,r,e[2],e[3]]};t.toTransform=function(e){return e?{originPosition:"upperLeft",scale:[e.tolerance,e.tolerance],translate:[e.extent.xmin,e.extent.ymax]}:null},t.equals=function(e,t){return e===t||null==e&&null==t||null!=e&&null!=t&&(i(e)?(r=e.translate[0],n=e.translate[1],a=e.scale[0]):(r=e.extent.xmin,n=e.extent.ymax,a=e.tolerance),i(t)?(o=t.translate[0],s=t.translate[1],l=t.scale[0]):(o=t.extent.xmin,s=t.extent.ymax,l=t.tolerance),r===o&&n===s&&a===l);var r,n,a,o,s,l},t.quantizeX=n,t.quantizeY=a,t.quantizeBounds=function(e,t,r){return t[0]=n(e,r[0]),t[3]=a(e,r[1]),t[2]=n(e,r[2]),t[1]=a(e,r[3]),t},t.quantizePoints=s,t.quantizeRings=l,t.quantizePaths=u,t.hydrateX=f,t.hydrateY=d,t.hydrateCoordsArray=p,t.hydrateCoordsArrayArray=c,t.hydrateBounds=function(e,t,r){return r?(t[0]=f(e,r[0]),t[1]=d(e,r[3]),t[2]=f(e,r[2]),t[3]=d(e,r[1]),t):[f(e,t[0]),d(e,t[3]),f(e,t[2]),d(e,t[1])]},t.hydratePoints=h,t.hydratePaths=y,t.hydrateRings=v,t.getQuantizedBoundsCoordsArray=g,t.getQuantizedBoundsCoordsArrayArray=m,t.getQuantizedBoundsPoints=function(e){var t=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return g(t,t,e)},t.getQuantizedBoundsPaths=function(e){return m([0,0,0,0],e)},t.getQuantizedBoundsRings=function(e){return m([0,0,0,0],e)},t.quantizeExtent=_,t.quantizeMultipoint=x,t.quantizePoint=b,t.quantizePolygon=L,t.quantizePolyline=I,t.quantizeGeometry=function(e,t){return e&&t?r.isPoint(t)?b(e,{},t,!1,!1):r.isPolyline(t)?I(e,{},t,!1,!1):r.isPolygon(t)?L(e,{},t,!1,!1):r.isMultipoint(t)?x(e,{},t,!1,!1):r.isExtent(t)?_(e,{},t,!1,!1):null:null},t.hydrateExtent=function(e,t,r,i,n){return t.xmin=f(e,r.xmin),t.ymin=d(e,r.ymin),t.xmax=f(e,r.xmax),t.ymax=d(e,r.ymax),t!==r&&(i&&(t.zmin=r.zmin,t.zmax=r.zmax),n&&(t.mmin=r.mmin,t.mmax=r.mmax)),t},t.hydrateMultipoint=function(e,t,r,i,n){return t.points=h(e,r.points,i,n),t},t.hydratePoint=function(e,t,r,i,n){return t.x=f(e,r.x),t.y=d(e,r.y),t!==r&&(i&&(t.z=r.z),n&&(t.m=r.m)),t},t.hydratePolygon=function(e,t,r,i,n){return t.rings=v(e,r.rings,i,n),t},t.hydratePolyline=function(e,t,r,i,n){return t.paths=y(e,r.paths,i,n),t}}.apply(null,i))||(e.exports=n)},1735:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(83),r(9),r(1582),r(1846),r(1579)],void 0===(n=function(e,t,r,i,n,a,o){var s=i.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");function l(e,t,r){for(var i=[],n=3;n<arguments.length;n++)i[n-3]=arguments[n];t<e.length?e.splice.apply(e,[t,r].concat(i)):e.push.apply(e,i)}var u=new Map;u.set(n.WGLDrawPhase.MAP,[n.WGLGeometryType.FILL,n.WGLGeometryType.LINE,n.WGLGeometryType.MARKER,n.WGLGeometryType.TEXT]),u.set(n.WGLDrawPhase.LABEL,[n.WGLGeometryType.LABEL]),u.set(n.WGLDrawPhase.LABEL_ALPHA,[n.WGLGeometryType.LABEL]);var f=function(){function e(e){void 0===e&&(e=!1),this.symbolLevels=[],this.unified=e}return e.prototype.replay=function(e,t){if(this.unified)for(var r=0,i=this.symbolLevels;r<i.length;r++)for(var n=0,a=i[r].zLevels;n<a.length;n++){var o=a[n].geometryDPInfo;for(var s in o)if(o[s])for(var l=0,f=o[s];l<f.length;l++){var d=f[l];e.painter.getGeometryBrush(d.geometryType).drawGeometry(e,t,d,null)}}else for(var p=function(r){var i=e.painter.getGeometryBrush(r);c.byType(r,function(r){i.drawGeometry(e,t,r,null)})},c=this,h=0,y=u.get(e.drawPhase);h<y.length;h++)p(y[h])},Object.defineProperty(e.prototype,"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.symbolLevels.length=0},e.prototype.addToList=function(e,t){if(Array.isArray(e))for(var r=0,i=e;r<i.length;r++){var n=i[r];this._addToList(n,t)}else this._addToList(e,t)},e.prototype.removeFromList=function(e){Array.isArray(e)||(e=[e]);for(var t=null,r=0,i=e;r<i.length;r++){var n=i[r];t=this._removeFromList(n)}return t},e.prototype.byType=function(e,t){for(var r=0,i=this.symbolLevels;r<i.length;r++)for(var n=0,a=i[r].zLevels;n<a.length;n++){var o=a[n].geometryDPInfo,s=this.getDPInfoType(e);if(o[s])for(var l=0,u=o[s];l<u.length;l++)t(u[l])}},e.prototype.clone=function(){for(var t=new e(this.unified),r=0,i=this.symbolLevels;r<i.length;r++){var n=i[r];t.symbolLevels.push(n.clone())}return t},e.prototype.splitAfter=function(e){for(var t=this._getDisplayList(e.symbolLevel,e.zOrder,e.geometryType),r=t.length,i=e.indexFrom+e.indexCount,n=0;n<r;++n){var a=t[n];if(a.geometryType===e.geometryType&&i>a.indexFrom&&i<=a.indexFrom+a.indexCount){if(i<a.indexFrom+a.indexCount){var o=new d;o.geometryType=a.geometryType,o.materialInfo=a.materialInfo,o.indexFrom=i,o.indexCount=a.indexFrom+a.indexCount-i,t.splice(n+1,0,o),a.indexCount=i-a.indexFrom}return n}}},e.prototype._addToList=function(e,t){var r=e.symbolLevel,i=e.zOrder,n=this._getDisplayList(r,i,e.geometryType),a=null!=t?t:n.length-1,s=0<=a&&a<n.length?n[a]:null;if(null===s||!o.isSameMaterialInfo(s.materialInfo,e.materialInfo)||s.indexFrom+s.indexCount!==e.indexFrom||this.unified&&s.geometryType!==e.geometryType){var u=new d;u.indexFrom=e.indexFrom,u.indexCount=e.indexCount,u.materialInfo=e.materialInfo,u.geometryType=e.geometryType,l(n,a+1,0,u)}else s.indexCount+=e.indexCount},e.prototype._removeFromList=function(e){for(var t=e.symbolLevel,r=e.zOrder,i=this._getDisplayList(t,r,e.geometryType),n=i.length,o=void 0,s=0;s<n;++s){var u=i[s];if(e.indexFrom+e.indexCount>u.indexFrom&&e.indexFrom<u.indexFrom+u.indexCount&&(!this.unified||u.geometryType===e.geometryType)){o=s;break}}if(void 0===o)return null;if(u=i[o],e.indexFrom===u.indexFrom)return u.indexCount-=e.indexCount,u.indexFrom+=e.indexCount,0===u.indexCount&&l(i,o,1),o-1;if(e.indexFrom+e.indexCount===u.indexFrom+u.indexCount)return u.indexCount-=e.indexCount,0===u.indexCount?(l(i,o,1),o-1):o;var f=u.indexFrom,p=e.indexFrom-u.indexFrom,c=e.indexCount,h=u.indexFrom+u.indexCount-(e.indexFrom+e.indexCount);u.indexCount=p;var y=new d;return y.geometryType=u.geometryType,y.materialInfo=new a.default,y.materialInfo.copy(u.materialInfo),y.indexFrom=f+p+c,y.indexCount=h,l(i,o+1,0,y),o},e.prototype._getDisplayList=function(e,t,r){for(var i,a,o=this.symbolLevels.length,s=0;s<o;s++)if(this.symbolLevels[s].symbolLevel===e){i=this.symbolLevels[s];break}i||((i=new h).symbolLevel=e,this.symbolLevels.push(i));for(var l,u=i.zLevels.length,f=0;f<u;f++)if(i.zLevels[f].zLevel===t){a=i.zLevels[f];break}if(a||((a=new c).geometryDPInfo=new p,a.zLevel=t,i.zLevels.push(a)),this.unified)a.geometryDPInfo.unified||(a.geometryDPInfo.unified=[]),l=a.geometryDPInfo.unified;else switch(r){case n.WGLGeometryType.FILL:a.geometryDPInfo.fill||(a.geometryDPInfo.fill=[]),l=a.geometryDPInfo.fill;break;case n.WGLGeometryType.LINE:a.geometryDPInfo.line||(a.geometryDPInfo.line=[]),l=a.geometryDPInfo.line;break;case n.WGLGeometryType.MARKER:a.geometryDPInfo.marker||(a.geometryDPInfo.marker=[]),l=a.geometryDPInfo.marker;break;case n.WGLGeometryType.TEXT:a.geometryDPInfo.text||(a.geometryDPInfo.text=[]),l=a.geometryDPInfo.text;break;case n.WGLGeometryType.LABEL:a.geometryDPInfo.label||(a.geometryDPInfo.label=[]),l=a.geometryDPInfo.label;break;default:console.error("Trying to add a record with geometry type '"+r+"'.")}return l},e.prototype.getDPInfoType=function(e){if(this.unified)return"unified";switch(e){case n.WGLGeometryType.FILL:return"fill";case n.WGLGeometryType.LINE:return"line";case n.WGLGeometryType.MARKER:return"marker";case n.WGLGeometryType.TEXT:return"text";case n.WGLGeometryType.LABEL:return"label";default:s.error("DisplayList: Tried to convert unknown geometryType: "+e)}},e}(),d=function(){function e(){this.materialInfo=null,this.indexFrom=0,this.indexCount=0}return e.prototype.clone=function(){var t=new e;return t.geometryType=this.geometryType,t.materialInfo=new a.default,t.materialInfo.copy(this.materialInfo),t.indexFrom=this.indexFrom,t.indexCount=this.indexCount,t},e}(),p=function(){function e(){this.fill=null,this.line=null,this.marker=null,this.text=null,this.label=null,this.unified=null}return e.prototype.clone=function(){var t=new e;return t.fill=this.fill&&this.fill.map(function(e){return e.clone()}),t.line=this.line&&this.line.map(function(e){return e.clone()}),t.marker=this.marker&&this.marker.map(function(e){return e.clone()}),t.text=this.text&&this.text.map(function(e){return e.clone()}),t.label=this.label&&this.label.map(function(e){return e.clone()}),t.unified=this.unified&&this.unified.map(function(e){return e.clone()}),t},e}(),c=function(){function e(){this.geometryDPInfo=new p}return e.prototype.clone=function(){var t=new e;return t.zLevel=this.zLevel,t.geometryDPInfo=this.geometryDPInfo.clone(),t},e}(),h=function(){function e(){this.zLevels=[]}return e.prototype.clone=function(){var t=new e;t.symbolLevel=this.symbolLevel;for(var r=0,i=this.zLevels;r<i.length;r++){var n=i[r];t.zLevels.push(n.clone())}return t},e}();return f}.apply(null,i))||(e.exports=n)},1811:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(27),r(67),r(265),r(1579)],void 0===(n=function(e,t,r,i,n,a){function o(e,t){var r=t.length;if(e<t[0].value||1===r)return t[0].size;for(var i=1;i<r;i++)if(e<t[i].value){var n=(e-t[i-1].value)/(t[i].value-t[i-1].value);return t[i-1].size+n*(t[i].size-t[i-1].size)}return t[r-1].size}return function(){function e(){this.symbolLevels=[],this.vvColorValues=new Float32Array(8),this.vvColors=new Float32Array(32),this.vvOpacityValues=new Float32Array(8),this.vvOpacities=new Float32Array(8),this.vvSizeMinMaxValue=new Float32Array(4),this.vvSizeFieldStopsValues=new Float32Array(6),this.vvSizeFieldStopsSizes=new Float32Array(6),this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1},this.symbolLevels.push(0)}return Object.defineProperty(e.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0}),e.prototype.updateVisualVariables=function(e,t){var s=this._vvMaterialParameters;if(s.vvOpacityEnabled=!1,s.vvSizeEnabled=!1,s.vvColorEnabled=!1,s.vvRotationEnabled=!1,e){var l=e.size;if(l){if(s.vvSizeEnabled=!0,l.minMaxValue){var u=l.minMaxValue,f=void 0,d=void 0;if(a.isDefined(u.minSize)&&a.isDefined(u.maxSize))if(a.isNumber(u.minSize)&&a.isNumber(u.maxSize))f=r.pt2px(u.minSize),d=r.pt2px(u.maxSize);else{var p=t.scale;f=r.pt2px(o(p,u.minSize.stops)),d=r.pt2px(o(p,u.maxSize.stops))}this.vvSizeMinMaxValue.set([u.minDataValue,u.maxDataValue,f,d])}if(l.scaleStops&&(this.vvSizeScaleStopsValue=r.pt2px(o(t.scale,l.scaleStops.stops))),l.unitValue){var c=i.getMetersPerUnitForSR(t.spatialReference)/n.meterIn[l.unitValue.unit];this.vvSizeUnitValueToPixelsRatio=c/t.resolution}l.fieldStops&&(this.vvSizeFieldStopsValues.set(l.fieldStops.values),this.vvSizeFieldStopsSizes.set(l.fieldStops.sizes))}var h=e.color;h&&(s.vvColorEnabled=!0,this.vvColorValues.set(h.values),this.vvColors.set(h.colors));var y=e.opacity;y&&(s.vvOpacityEnabled=!0,this.vvOpacityValues.set(y.values),this.vvOpacities.set(y.opacities));var v=e.rotation;v&&(s.vvRotationEnabled=!0,s.vvRotationType=v.type)}},e}()}.apply(null,i))||(e.exports=n)},1812:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1813),r(1814),r(1815),r(1579),r(1579),r(1744),r(1734),r(1849),r(1730),r(1816),r(1725),r(1817)],void 0===(n=function(e,t,r,i,n,a,o,s,l,u,f,d,p,c){var h=new r.default,y=new r.default;function v(e,t){var r={};for(var i in e){var n={data:o.allocateTypedArrayBuffer(t,e[i]),stride:e[i]};r[i]=n}return r}return function(){function e(){this.tileDisplayData=null,this.tileBufferData=null}return e.prototype.reshuffle=function(){h.reset();var t=n.groupRecordsByGeometryType(this.tileDisplayData.displayObjects);for(var r in t)for(var s=0,l=b=t[r];s<l.length;s++){var u=l[s];h.needMore(u.geometryType,u.meshData?u.meshData.vertexCount:u.vertexCount,u.meshData?u.meshData.indexData.length:u.indexCount)}var f=t.length,d=new i;for(r=0;r<f;++r){d.geometries[r].indexBuffer=new Uint32Array(Math.round(1.15*h.indicesFor(r)));var p=[];for(var c in this.tileBufferData.geometries[r].vertexBuffer)p.push(this.tileBufferData.geometries[r].vertexBuffer[c].stride);var v=e._computeVertexAlignment(p),g=Math.round(1.15*h.verticesFor(r)),m=e._align(g,v);for(var _ in this.tileBufferData.geometries[r].vertexBuffer){var x=this.tileBufferData.geometries[r].vertexBuffer[_].stride;d.geometries[r].vertexBuffer[_]={stride:x,data:o.allocateTypedArrayBuffer(m,x)}}}for(y.reset(),this.tileDisplayData.displayList.clear(),r=0;r<f;++r){for(var b,L=0,I=b=t[r];L<I.length;L++){if((u=I[L]).meshData)u.writeMeshDataToBuffers(y.verticesFor(r),d.geometries[r].vertexBuffer,y.indicesFor(r),d.geometries[r].indexBuffer),u.meshData=null;else{var D=this.tileBufferData.geometries[r].vertexBuffer,T=this.tileBufferData.geometries[r].indexBuffer,w=d.geometries[r].vertexBuffer,B=d.geometries[r].indexBuffer,F=y.verticesFor(r),O=y.indicesFor(r);a.copyMeshData(F,O,w,B,u,D,T),u.vertexFrom=F,u.indexFrom=O}y.needMore(r,u.vertexCount,u.indexCount)}this.tileDisplayData.displayList.unified||this.tileDisplayData.displayList.addToList(b)}if(this.tileDisplayData.displayList.unified)for(var R=0,C=this.tileDisplayData.displayObjects;R<C.length;R++){var V=C[R];this.tileDisplayData.displayList.addToList(V.displayRecords)}this.tileBufferData=d},e.prototype.getStrides=function(){for(var e=[],t=0;t<this.tileBufferData.geometries.length;++t){var r=this.tileBufferData.geometries[t];for(var i in e[t]={},r.vertexBuffer)e[t][i]=r.vertexBuffer[i].stride}return e},e.prototype._guessSize=function(){for(var e=this.tileDisplayData.displayObjects,t=Math.min(e.length,4),r=0,i=0;i<t;i++)r=Math.max(r,e[i].displayRecords.length);return 2*(12*e.length+e.length*r*40)},e.prototype.serialize=function(){var e=this.tileBufferData.serialize(),t=this.tileBufferData.getBuffers(),r=this.tileDisplayData.serialize(new c.default(Int32Array,this._guessSize())).buffer();return t.push(r),{result:{displayData:r,bufferData:e},transferList:t}},e.decode=function(t){var r=f.default.deserialize(new d.default(t.materialStore)),i=p.deserializeList(new d.default(t.displayObjects),s,{store:r}),n={};for(var a in t.vertexBuffersMap)n[a]=u.VertexBuffers.decode(t.vertexBuffersMap[a]);return e.fromMeshData({materials:r,displayObjects:i,vertexBuffersMap:n},!1)},e.fromMeshData=function(t,r){void 0===r&&(r=!0);var a=new e,o=new n.default,s=new i;for(var l in o.displayObjects=t.displayObjects,r&&t.materials.hydrateObjects(o.displayObjects),t.vertexBuffersMap){var u=t.vertexBuffersMap[l];s.geometries[l].indexBuffer=u.indexBuffer,s.geometries[l].vertexBuffer=u.namedBuffers}return a.tileDisplayData=o,a.tileBufferData=s,a},e.bind=function(t,r){var i=new e;return i.tileDisplayData=t,i.tileBufferData=r,i},e.create=function(t,r){var a=new e;a.tileDisplayData=new n.default;for(var o=[0,0,0,0,0],s=[0,0,0,0,0],u=[[],[],[],[],[]],f=0,d=a.tileDisplayData.displayObjects=t;f<d.length;f++)for(var p=0,c=d[f].displayRecords;p<c.length;p++){var h=c[p];u[h.geometryType].push(h),o[h.geometryType]+=h.meshData.vertexCount,s[h.geometryType]+=h.meshData.indexData.length}for(var y,g=new i,m=[(y=r).fill||{},y.line||{},y.icon||{},y.text||{},y.label||{}],_=0;_<5;_++){var x=new Uint32Array(s[_]),b=v(m[_],o[_]);l.writeAllMeshDataToBuffers(u[_],b,x),g.geometries[_]={indexBuffer:x,vertexBuffer:b}}return a.tileBufferData=g,a},e._align=function(e,t){var r=e%t;return 0===r?e:e+(t-r)},e._computeVertexAlignment=function(e){for(var t=!1,r=!1,i=0,n=e;i<n.length;i++){var a=n[i];a%4==2?t=!0:a%4!=0&&(r=!0)}return r?4:t?2:1},e}()}.apply(null,i))||(e.exports=n)},1813:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._byGeometryType=null}return Object.defineProperty(e.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._byGeometryType=null},e.prototype.verticesFor=function(e){return this._byGeometryType?this._byGeometryType[e].vertices:0},e.prototype.indicesFor=function(e){return this._byGeometryType?this._byGeometryType[e].indices:0},e.prototype.needMore=function(e,t,r){if(t||r){this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]);var i=this._byGeometryType[e];i.vertices+=t,i.indices+=r}},e}();t.default=r}.apply(null,i))||(e.exports=n)},1814:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1579)],void 0===(n=function(e,t,r){return function(){function e(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}return e.deserialize=function(t){for(var i=new e,n=0;n<5;++n)for(var a in i.geometries[n].indexBuffer=new Uint32Array(t.geometries[n].indexBuffer),i.geometries[n].vertexBuffer={},t.geometries[n].vertexBuffer)i.geometries[n].vertexBuffer[a]={data:r.allocateTypedArrayBufferwithData(t.geometries[n].vertexBuffer[a].data,t.geometries[n].vertexBuffer[a].stride),stride:t.geometries[n].vertexBuffer[a].stride};return i},e.prototype.serialize=function(){for(var e={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},t=0;t<5;++t)for(var r in this.geometries[t].vertexBuffer)e.geometries[t].vertexBuffer[r]={data:this.geometries[t].vertexBuffer[r].data.buffer,stride:this.geometries[t].vertexBuffer[r].stride};return e},e.prototype.getBuffers=function(){for(var e=[],t=0;t<5;++t)for(var r in e.push(this.geometries[t].indexBuffer.buffer),this.geometries[t].vertexBuffer)e.push(this.geometries[t].vertexBuffer[r].data.buffer);return e},e}()}.apply(null,i))||(e.exports=n)},1815:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1735),r(1744),r(1730),r(1725)],void 0===(n=function(e,t,r,i,n,a){function o(e){for(var t=[[],[],[],[],[]],r=0,i=e;r<i.length;r++)for(var n=0,a=i[r].displayRecords;n<a.length;n++){var o=a[n];t[o.geometryType].push(o)}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.groupRecordsByGeometryType=o;var s=function(){function e(){}return Object.defineProperty(e.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var e=0,t=this.displayObjects;e<t.length;e++){var r=t[e];this._displayObjectRegistry.set(r.id,r)}}return this._displayObjectRegistry},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayList",{get:function(){return this._displayList},enumerable:!0,configurable:!0}),e.prototype.computeDisplayList=function(e){if(this._displayList=new r(e),e)for(var t=0,i=this.displayObjects;t<i.length;t++)for(var n=0,a=i[t].displayRecords;n<a.length;n++){var s=a[n];this._displayList.addToList(s)}else for(var l=o(this.displayObjects),u=l.length,f=0;f<u;++f){var d=l[f];this._displayList.addToList(d)}},e.prototype.serialize=function(e){return this.materialStore.serialize(e),a.serializeList(e,this.displayObjects),e},e.prototype._deserializeObjects=function(e){for(var t=e.readInt32(),r=new Array(t),n=new Map,a={store:this.materialStore},o=0;o<r.length;++o){var s=i.deserialize(e,a);r[o]=s,n.set(s.id,s)}this.displayObjects=r,this._displayList=null,this._displayObjectRegistry=n},e.deserialize=function(t){var r=new e;return r.materialStore=n.default.deserialize(t),r._deserializeObjects(t),r},e}();t.default=s}.apply(null,i))||(e.exports=n)},1816:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._pos=0,this._buffer=e,this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer)}return e.prototype.readInt32=function(){return this._i32View[this._pos++]},e.prototype.readF32=function(){return this._f32View[this._pos++]},e}();t.default=r}.apply(null,i))||(e.exports=n)},1818:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(26),r(38),r(1616),r(1606),r(1819),r(1820),r(1582),r(1822),r(1640),r(1579),r(1823),r(1735),r(138)],void 0===(n=function(e,t,r,i,n,a,o,s,l,u,f,d,p,c,h){function y(e,t){return e.sortKey-t.sortKey}var v=new Set;return function(e){function t(t,r,n){void 0===n&&(n=!1);var a=e.call(this)||this;return a._data=null,a.hlDisplayList=null,a._displayList=null,a._wglBuffers=null,a._dirtyMap=new o.default,a.coords=[0,0],a.bounds=[0,0,0,0],a.tileTransform={transform:i.mat4f32.create(),screenTransform:i.mat2df32.create(),displayCoord:i.vec2f32.create(),screenCoord:i.vec2f32.create()},a.dvsMat3=i.mat3f32.create(),a.tileMat3=i.mat3f32.create(),a.labelMat2d=i.mat2df32.create(),a._labelIndex=null,a._dirty=!0,a.fader=new u.default,a.key=h.pool.acquire(t),a.coords[0]=r[0],a.coords[1]=r[3],a.bounds=r,a._ensureCorrectZOrder=n,a}return r(t,e),Object.defineProperty(t.prototype,"iconGeometry",{get:function(){return this.getGeometry(l.WGLGeometryType.MARKER)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textGeometry",{get:function(){return this.getGeometry(l.WGLGeometryType.TEXT)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillGeometry",{get:function(){return this.getGeometry(l.WGLGeometryType.FILL)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineGeometry",{get:function(){return this.getGeometry(l.WGLGeometryType.LINE)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelGeometry",{get:function(){return this.getGeometry(l.WGLGeometryType.LABEL)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayObjects",{get:function(){return this._data.tileDisplayData.displayObjects},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canDisplay",{get:function(){return!!this.attached},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDirty",{get:function(){return this._dirty},set:function(e){(this._dirty=e)||this.isReady||this.ready(),this.requestRender()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasData",{get:function(){return!!this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!0,configurable:!0}),t.prototype.getGeometry=function(e){return this._wglBuffers&&this._wglBuffers.has(e)?this._wglBuffers.get(e):null},t.prototype.getDisplayList=function(e){switch(e){case l.WGLDrawPhase.HIGHLIGHT:return this.hlDisplayList;default:return this._data&&this._displayList}},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),t.prototype.setData=function(e,t,r){var i=e.addOrUpdate,n=e.remove;if(this.fader.reset(),(e.clear||!this.hasData)&&!e.addOrUpdate)return this.clear(),void this.ready();!e.clear&&this.hasData||!e.addOrUpdate?this.hasData&&this._doPatchData({addOrUpdate:i,remove:n},t,r):(i.tileDisplayData.computeDisplayList(this._ensureCorrectZOrder),this._dirtyMap=new o.default,this._dispRecStore=s.default.fromTileData(i,this._dirtyMap),this._data=i,this._readyTileIfNoLabels(t,r),this._dirtyMap.markAllDirty(),this._displayList||(this._displayList=i.tileDisplayData.displayList.clone()))},t.prototype.commitChanges=function(e){this.isDirty&&this._wglBuffers||(this._wglBuffers||(this._wglBuffers=new p.default(this.stage.context)),this._displayList=this._data.tileDisplayData.displayList.clone(),this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._dirtyMap.markAllClean())},t.prototype.resetVisibility=function(e){var t=this,r=new Array(0),i=new Array(1);e.forEach(function(e){i[0]=e,t.setVisibility(r,i)})},t.prototype.setVisibility=function(e,t){for(var r=this._data.tileBufferData.geometries.map(d.geometryToMappedGeometry),i=0,n=e;i<n.length;i++){var a=n[i];if(h=this._data.tileDisplayData.displayObjectRegistry.get(a))for(var o=0,s=h.displayRecords;o<s.length;o++)if(_=(L=r[(m=s[o]).geometryType]).geometry.vertexBuffer[d.C_VBO_VISIBILITY]){L.vertexFrom=null==L.vertexFrom?m.vertexFrom:Math.min(L.vertexFrom,m.vertexFrom),L.vertexTo=null==L.vertexTo?m.vertexFrom+m.vertexCount:Math.max(L.vertexTo,m.vertexFrom+m.vertexCount);for(var l=m.vertexFrom,u=m.vertexCount,f=0;f<u;++f)_.data[l+f]=255}}for(var p=0,c=t;p<c.length;p++){var h,y=c[p];if(h=this._data.tileDisplayData.displayObjectRegistry.get(y))for(var v=0,g=h.displayRecords;v<g.length;v++){var m,_;if(_=(L=r[(m=g[v]).geometryType]).geometry.vertexBuffer[d.C_VBO_VISIBILITY])for(L.vertexFrom=null==L.vertexFrom?m.vertexFrom:Math.min(L.vertexFrom,m.vertexFrom),L.vertexTo=null==L.vertexTo?m.vertexFrom+m.vertexCount:Math.max(L.vertexTo,m.vertexFrom+m.vertexCount),l=m.vertexFrom,u=m.vertexCount,f=0;f<u;++f)_.data[l+f]=0}}for(var x=!1,b=0;b<r.length;++b){var L;if(null!=(L=r[b]).vertexFrom&&null!=L.vertexTo){var I=L.vertexTo?L.vertexTo-L.vertexFrom:0;this._dirtyMap.markDirtyVertices(b,d.C_VBO_VISIBILITY,L.vertexFrom,I),x=!0}}x&&this.requestRender()},t.prototype.setVisibilityRange=function(e,t,r,i){for(var n=this._data.tileDisplayData.displayObjectRegistry.get(e),a=this._data.tileBufferData.geometries[l.WGLGeometryType.LABEL].vertexBuffer[d.C_VBO_VISIBILITY_RANGE],o=1/0,s=0,u=t;u<t+r;++u){for(var p=n.displayRecords[u],c=Math.max(p.minZoom,i),h=p.maxZoom,y=f.i8888to32(c,h,c,h),v=p.vertexFrom*a.stride/4,g=p.vertexCount*a.stride/4,m=v;m<v+g;++m)a.data[m]=y;o=Math.min(o,p.vertexFrom),s=Math.max(s,p.vertexFrom+p.vertexCount)}var _=s-o;this._dirtyMap.markDirtyVertices(l.WGLGeometryType.LABEL,d.C_VBO_VISIBILITY_RANGE,o,_)},t.prototype.setTransform=function(e,t){var r=this.tileMat3,n=e.toScreenNoRotation([0,0],this.coords),a=n[0],o=n[1],s=t;i.mat3.set(this.tileMat3,s,0,0,0,s,0,a,o,1),i.mat3.multiply(this.dvsMat3,e.displayViewMat3,r)},t.prototype.setLabelTransform=function(e,t){var r=this.labelMat2d,n=e.getScreenTransform(r,t),a=i.vec2f32.create();i.vec2.transformMat2d(a,this.coords,n),i.mat2d.identity(r),i.mat2d.translate(r,r,a),i.mat2d.multiply(r,e.viewMat2d,r)},t.prototype.clear=function(){this._data=null,this._displayList=null,this._dispRecStore=null,this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null),this.hlDisplayList&&(this.hlDisplayList=null)},t.prototype.attach=function(){return!0},t.prototype.dispose=function(){this.clear()},t.prototype.doRender=function(e){if(this.isReady&&this.hasData){if(this.commitChanges(e),this.stage.context.setStencilFunction(514,this.stencilRef,255),e.drawPhase===l.WGLDrawPhase.MAP||e.drawPhase===l.WGLDrawPhase.LABEL||e.drawPhase===l.WGLDrawPhase.LABEL_ALPHA)this._displayList.replay(e,this);else for(var t=0,r=this.stage.painter.getBrushes(e.drawPhase);t<r.length;t++)r[t].draw(e,this);this.fader.step()||this.requestRender()}},t.prototype.buildHLList=function(e){var t=this;this.hlDisplayList=new c,e.forEach(function(e){t._addToHLDisplayList(t.hlDisplayList,e)})},t.prototype._addToHLDisplayList=function(e,t){if(this._data){var r=this._data.tileDisplayData.displayObjectRegistry.get(t);if(r){for(var i=[],n=0,a=r.displayRecords;n<a.length;n++){var o=a[n].copy();o.meshData=null,o.symbolLevel=0,o.zOrder=0,i.push(o)}i.sort(y),e.addToList(i)}}},t.prototype._readyTileIfNoLabels=function(e,t){this.isDirty=!!e&&(t||(this.isDirty=!1),this._rebuildLabelIndex(),!0)},t.prototype._doPatchData=function(e,t,r){this._patchData(e)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=s.default.fromTileData(this._data,this._dirtyMap)),this._readyTileIfNoLabels(t,r),this.requestRender()},t.prototype._rebuildLabelIndex=function(){this._labelIndex=this._initLabelIndex();for(var e=0,t=this.displayObjects;e<t.length;e++)for(var r=0,i=t[e].metrics;r<i.length;r++){var n=i[r];this._insertIntoLabelIndex(n)}},t.prototype._insertIntoLabelIndex=function(e){-1!==e.xBucket&&this.labelIndex[e.yBucket][e.xBucket].push(e)},t.prototype._initLabelIndex=function(){for(var e=[],t=0;t<a.TILE_SIZE/a.COLLISION_BUCKET_SIZE;t++){e.push([]);for(var r=0;r<a.TILE_SIZE/a.COLLISION_BUCKET_SIZE;r++)e[t].push([])}return e},t.prototype._patchData=function(e){for(var t=!0,r=e.addOrUpdate&&e.addOrUpdate.tileDisplayData&&e.addOrUpdate.tileDisplayData.displayObjects||[],i=(e.remove||[]).slice(),n=0,a=r;n<a.length;n++)null!=(g=a[n]).insertAfter&&i.push(g.id);for(var o=0,s=i;o<s.length;o++){var l=s[o];if(y=this._data.tileDisplayData.displayObjectRegistry.get(l)){this._data.tileDisplayData.displayList.removeFromList(y.displayRecords);for(var u=0,f=y.displayRecords;u<f.length;u++){var d=f[u];this._dispRecStore.delete(d)}this._data.tileDisplayData.displayObjectRegistry.delete(l);var p=this._data.tileDisplayData.displayObjects.indexOf(y);this._data.tileDisplayData.displayObjects.splice(p,1)}}for(var c=0,h=r;c<h.length;c++){var y,g=h[c],m=void 0;if(y=this._data.tileDisplayData.displayObjectRegistry.get(g.id)){var _=y.displayRecords;y.set(g),y.displayRecords=_;for(var x=y.displayRecords.length,b=0;b<x;++b){var L=y.displayRecords[b],I=g.displayRecords[b];(b>=g.displayRecords.length||L.geometryType!==I.geometryType||L.symbolLevel!==I.symbolLevel||L.zOrder!==I.zOrder||L.materialInfo.materialKey!==I.materialInfo.materialKey)&&(this._dispRecStore.delete(y.displayRecords[b]),b<g.displayRecords.length&&(y.displayRecords[b]=void 0))}y.displayRecords.length=g.displayRecords.length,y.metrics=g.metrics}else{(y=g.copy()).displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(g.id,y);var D=void 0,T=this._data.tileDisplayData.displayObjects;if(null!=y.insertAfter)if(m={},0<=y.insertAfter){var w=this._data.tileDisplayData.displayObjectRegistry.get(y.insertAfter);w&&(D=T.indexOf(w)+1)<T.length?T.splice(D,0,y):(T.push(y),D=T.length)}else T.unshift(y),D=0;else T.push(y),D=T.length;if(m){var B=void 0;if(this._data.tileDisplayData.displayList.unified)B=0<g.displayRecords.length?1:0;else{v.clear();for(var F=0,O=g.displayRecords;F<O.length;F++){var R=O[F],C=this._data.tileDisplayData.displayList.getDPInfoType(R.geometryType);v.add(C)}B=v.size}var V=0;for(b=D-1;0<=b&&V<B;--b)for(var A=T[b].displayRecords.length-1;0<=A&&V<B;--A){var P=T[b].displayRecords[A];m[C=this._data.tileDisplayData.displayList.getDPInfoType(P.geometryType)]||(m[C]=P,++V)}}}var M=g.displayRecords.length;for(b=0;b<M;++b){I=g.displayRecords[b],(L=y.displayRecords[b])?(L.meshData=I.meshData,L.materialInfo=I.materialInfo):((L=I.copy()).vertexFrom=void 0,L.indexFrom=void 0,y.displayRecords[b]=L);var E=I.geometryType,z=(C=this._data.tileDisplayData.displayList.getDPInfoType(E),e.addOrUpdate.tileBufferData.geometries[E]),S=z.vertexBuffer,G=z.indexBuffer,j=void 0;m&&(j=m[C]?this._data.tileDisplayData.displayList.splitAfter(m[C]):-1),t=this._dispRecStore.setMeshData(L,I,S,G,j)&&t,m&&null!=L.indexFrom&&null!=L.indexFrom&&(m[C]=L)}}return t},t}(n.DisplayObject)}.apply(null,i))||(e.exports=n)},1819:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1579)],void 0===(n=function(e,t,r){function i(e,t,r){if(!e.allDirty)if(null!=e.from&&null!=e.count){var i=Math.min(e.from,t),n=Math.max(e.from+e.count,t+r)-i;e.from=i,e.count=n}else e.from=t,e.count=r}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._dirties=r.createGeometryData(function(e){return{indices:{from:null,count:null,allDirty:!1}}},function(e,t){return{vertices:{from:null,count:null,allDirty:!1}}})}return e.prototype.markAllClean=function(){for(var e=0,t=this._dirties;e<t.length;e++){var r=t[e];for(var i in r.data.indices.from=null,r.data.indices.count=null,r.data.indices.allDirty=!1,r.buffers)r.buffers[i].data.vertices.from=null,r.buffers[i].data.vertices.count=null,r.buffers[i].data.vertices.allDirty=!1}},e.prototype.markAllDirty=function(){for(var e=0,t=this._dirties;e<t.length;e++){var r=t[e];for(var i in r.data.indices.allDirty=!0,r.buffers)r.buffers[i].data.vertices.allDirty=!0}},e.prototype.forEach=function(e){for(var t=0;t<this._dirties.length;++t){var r=this._dirties[t],i={};for(var n in r.buffers){var a=r.buffers[n].data.vertices;(a.allDirty||null!=a.from&&null!=a.count&&0<a.count)&&(i[n]=a)}var o,s=r.data.indices;((o=s.allDirty||null!=s.from&&null!=s.count&&0<s.count?{indices:s,vertices:i}:{indices:null,vertices:i}).indices||0<Object.keys(o).length)&&e(o,t)}},e.prototype.markDirtyIndices=function(e,t,r){i(this._dirties[e].data.indices,t,r)},e.prototype.markDirtyVertices=function(e,t,r,n){i(this._dirties[e].buffers[t].data.vertices,r,n)},e}();t.default=n}.apply(null,i))||(e.exports=n)},1820:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(19),r(1821),r(1579)],void 0===(n=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:!0});var a=["FILL","LINE","MARKER","TEXT","LABEL"],o=function(){function e(e,t,r,a){for(var o in this._strides=e,this._displayList=t,this._freeListsAndStorage={},this._dirtyMap=null,this._dirtyMap=r,e)for(var s in this._freeListsAndStorage[o]={vtxFreeList:a?new i.FreeList(a):null,idxFreeList:a?new i.FreeList(a):null,vertexBuffers:{},indexBuffer:a?new Uint32Array(a):null},e[o])this._freeListsAndStorage[o].vertexBuffers[s]={data:a?n.allocateTypedArrayBuffer(a,e[o][s]):null,stride:e[o][s]}}return e.fromTileData=function(t,r){var o=function(e){var t=e.getStrides(),r={};for(var i in t)r[a[i]]=t[i];return r}(t),s=[0,0,0,0,0],l=[0,0,0,0,0],u=[];t.tileDisplayData.displayObjectRegistry.forEach(function(e){u.push(e)});for(var f=0,d=u;f<d.length;f++)for(var p=0,c=d[f].displayRecords;p<c.length;p++){var h=c[p];s[h.geometryType]=Math.max(s[h.geometryType],h.vertexFrom+h.vertexCount),l[h.geometryType]=Math.max(l[h.geometryType],h.indexFrom+h.indexCount)}for(var y=new e(o,t.tileDisplayData.displayList,r,null),v=0;v<t.tileBufferData.geometries.length;++v){var g=s[v],m=l[v],_=t.tileBufferData.geometries[v],x=a[v],b=y._storageFor(x),L=t.tileBufferData.geometries[v].indexBuffer;b.indexBuffer=L,b.idxFreeList=new i.FreeList(L.length),b.idxFreeList.allocate(m);var I=void 0;for(var D in _.vertexBuffer){var T=t.tileBufferData.geometries[v].vertexBuffer[D];b.vertexBuffers[D].data=T.data,b.vertexBuffers[D].stride=T.stride;var w=n.strideToPackingFactor(T.stride),B=T.data.length*w/T.stride;I||(I=B)}b.vtxFreeList=new i.FreeList(I),b.vtxFreeList.allocate(g)}return y},e.prototype.delete=function(e){var t=a[e.geometryType];this._freeVertices(t,e.vertexFrom,e.vertexCount),this._freeIndices(t,e.indexFrom,e.indexCount),this._displayList.removeFromList(e),e.vertexFrom=void 0,e.indexFrom=void 0},e.prototype.setMeshData=function(e,t,r,i,o){var s=a[e.geometryType];e.meshData=null;var l=void 0,u=void 0;void 0===e.vertexFrom?(u=t.vertexCount,l=this._allocateVertices(s,u)):t.vertexCount>e.vertexCount?(this._freeVertices(s,e.vertexFrom,e.vertexCount),u=t.vertexCount,l=this._allocateVertices(s,u)):u=t.vertexCount===e.vertexCount?(l=e.vertexFrom,e.vertexCount):(this._freeVertices(s,e.vertexFrom+t.vertexCount,e.vertexCount-t.vertexCount),l=e.vertexFrom,t.vertexCount);var f=!0,d=void 0,p=void 0,c=void 0;if(void 0===e.indexFrom?(d=o,c=t.indexCount,p=this._allocateIndices(s,c)):t.indexCount>e.indexCount?(d=this._displayList.removeFromList(e),this._freeIndices(s,e.indexFrom,e.indexCount),c=t.indexCount,p=this._allocateIndices(s,c)):c=t.indexCount===e.indexCount?(f=!1,p=e.indexFrom,e.indexCount):(d=this._displayList.removeFromList(e),this._freeIndices(s,e.indexFrom+t.indexCount,e.indexCount-t.indexCount),p=e.indexFrom,t.indexCount),-1===l||-1===p)return-1!==l&&this._freeVertices(s,l,u),-1!==p&&this._freeIndices(s,p,c),e.setMeshDataFromBuffers(t,r,i),e.vertexFrom=void 0,e.vertexCount=0,e.indexFrom=void 0,e.indexCount=0,!1;var h=this._storageFor(s);if(n.copyMeshData(l,p,h.vertexBuffers,h.indexBuffer,t,r,i),e.vertexFrom=l,e.indexFrom=p,e.vertexCount=t.vertexCount,e.indexCount=t.indexCount,this._dirtyMap)for(var y in this._dirtyMap.markDirtyIndices(e.geometryType,e.indexFrom,e.indexCount),r)this._dirtyMap.markDirtyVertices(e.geometryType,y,e.vertexFrom,e.vertexCount);return f&&this._displayList.addToList(e,d),!0},e.prototype._allocateVertices=function(e,t){var r=this._storageFor(e),i=r.vtxFreeList.allocate(t);return-1===i?-1:.5<r.vtxFreeList.fragmentation?-1:i},e.prototype._freeVertices=function(e,t,i){var a=this._storageFor(e);if(a.vtxFreeList.free(t,i),r("esri-feature-tiles-debug"))for(var o in a.vertexBuffers)for(var s=a.vertexBuffers[o].data,l=this._stridesFor(e,o),u=n.strideToPackingFactor(l),f=t*l/u,d=i*l/u,p=f;p<f+d;++p)s[p]=0},e.prototype._freeIndices=function(e,t,i){var n=this._storageFor(e);if(n.idxFreeList.free(t,i),r("esri-feature-tiles-debug"))for(var a=n.indexBuffer,o=t;o<t+i;++o)a[o]=0},e.prototype._allocateIndices=function(e,t){var r=this._storageFor(e),i=r.idxFreeList.allocate(t);return-1===i?-1:.5<r.idxFreeList.fragmentation?-1:i},e.prototype._storageFor=function(e){return this._freeListsAndStorage[e]},e.prototype._stridesFor=function(e,t){return this._strides[e][t]},e}();t.default=o}.apply(null,i))||(e.exports=n)},1821:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._largestRange=null,this._parent=e,this._updateLargestRange()}return Object.defineProperty(e.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!0,configurable:!0}),e.prototype.rangeCreated=function(e){(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)},e.prototype.rangeResized=function(e,t,r){e===this._largestRange?e.count<r&&this._updateLargestRange():(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)},e.prototype.findBestRange=function(e){for(var t=this._parent._freeHead,r=null;null!==t;)t.count>=e&&(!r||t.count-e<r.count-e)&&(r=t),t=t.next;return r},e.prototype.findAdjacentRanges=function(e,t){for(var r=!0,i=!1,n=null,a=this._parent._freeHead;r&&!i;){var o=null!==n?n.from+n.count:0,s=null!==a?a.from:this._parent._size;o<=e&&e+t<=s?i=!(r=!1):null!==a?a=(n=a).next:r=!1}return[n,a]},e.prototype._updateLargestRange=function(){for(var e=null,t=this._parent._freeHead;null!==t;)(!e||t.count>e.count)&&(e=t),t=t.next;this._largestRange=e},e}(),i=function(){function e(e,t){this._allocated=0,this._size=e,this._freeHead=0<e?{from:0,count:e,prev:null,next:null}:null,this._bookKeeper=t||new r(this),this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}return e.prototype.allocate=function(t){var r=this._bookKeeper.findBestRange(t);if(null===r)return-1;var i=r.from,n=r.count;if(r.from+=t,r.count-=t,this._bookKeeper.rangeResized(r,i,n),this._allocated+=t,0===r.count){var a=null!==r.prev?this._freeHead:r.next;e._removeRange(r),this._freeHead=a}return i},e.prototype.free=function(t,r){var i=this._bookKeeper.findAdjacentRanges(t,r),n=i[0],a=i[1],o={from:t,count:r,prev:n,next:a};if(null!==n&&(n.next=o),null!==a&&(a.prev=o),this._bookKeeper.rangeCreated(o),this._allocated-=r,null!==a&&o.from+o.count===a.from){var s=o.from,l=o.count;e._fuse(o,a),e._removeRange(a),this._bookKeeper.rangeResized(o,s,l),this._bookKeeper.rangeResized(a,void 0,0)}null!==n&&n.from+n.count===o.from&&(s=n.from,l=n.count,e._fuse(n,o),e._removeRange(o),this._bookKeeper.rangeResized(n,s,l),this._bookKeeper.rangeResized(o,void 0,0)),this._freeHead=null!==o.prev?this._freeHead:o},Object.defineProperty(e.prototype,"fragmentation",{get:function(){var e=this._size-this._allocated;return 0===e?0:1-this._bookKeeper.largestRange.count/e},enumerable:!0,configurable:!0}),e._removeRange=function(e){null!==e.prev?null!==e.next?(e.prev.next=e.next,e.next.prev=e.prev):e.prev.next=null:null!==e.next&&(e.next.prev=null)},e._fuse=function(e,t){e.count+=t.count,e.next=t.next,t.from+=t.count,t.count=0,null!==t.next&&(t.next.prev=e)},e}();t.FreeList=i}.apply(null,i))||(e.exports=n)},1822:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){void 0===e&&(e=400),this.duration=e,this._lastTime=0,this._elapsed=0,this._value=0,this._finished=!1}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._lastTime=0,this._elapsed=0,this._value=0},e.prototype.step=function(){var e=performance.now();if(0===this._lastTime)return this._lastTime=e,!(this._value=0);if(this._elapsed>=this.duration)return!0;var t=e-this._lastTime;return this._elapsed+=t,this._lastTime=e,this._value=Math.min(this._elapsed/this.duration,1),!1},e}();t.default=r}.apply(null,i))||(e.exports=n)},1823:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1579),r(1564)],void 0===(n=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.geometryMap=r.createGeometryData(function(t){return{indexBuffer:i.createIndex(e,35044),vao:null}},function(t,n){return{vertexBuffer:i.createVertex(e,r.C_VBO_INFO[n])}})}return e.prototype.dispose=function(){for(var e in this.geometryMap){var t=this.geometryMap[e];for(var r in t.data.vao&&t.data.vao.dispose(!1),t.data.indexBuffer&&t.data.indexBuffer.dispose(),t.buffers)t.buffers[r]&&t.buffers[r].data.vertexBuffer.dispose()}},e.prototype.get=function(e){var t=this.geometryMap[e],r={};for(var i in t.buffers)r[i]=t.buffers[i].data.vertexBuffer;return{indexBuffer:t.data.indexBuffer,get vao(){return t.data.vao},set vao(e){t.data.vao=e},vertexBufferMap:r}},e.prototype.has=function(e){return null!=this.geometryMap[e]},e.prototype.upload=function(e,t){var r=this;t.forEach(function(t,i){r._upload(t,i,e)})},e.prototype._upload=function(e,t,r){if(e.indices&&(e.indices.allDirty?this._uploadIndices(r,t):null!=e.indices.from&&null!=e.indices.count&&this._uploadIndices(r,t,e.indices.from,e.indices.count)),e.vertices){var i=e.vertices;for(var n in i){var a=i[n];a.allDirty?this._uploadVertices(r,t,n):null!=a.from&&null!=a.count&&this._uploadVertices(r,t,n,a.from,a.count)}}},e.prototype._uploadVertices=function(e,t,r,i,n){var a=this.geometryMap[t];if(a){var o=e.geometries[t].vertexBuffer[r];if(o){var s=o.stride,l=o.data.buffer;a.buffers[r]&&0<l.byteLength&&(null!=i&&null!=n?a.buffers[r].data.vertexBuffer.setSubData(l,i*s,i*s,(i+n)*s):a.buffers[r].data.vertexBuffer.setData(l))}}},e.prototype._uploadIndices=function(e,t,r,i){var n=this.geometryMap[t];if(n){var a=e.geometries[t].indexBuffer.buffer;n.data.indexBuffer&&0<a.byteLength&&(null!=r&&null!=i?n.data.indexBuffer.setSubData(a,4*r,4*r,4*(r+i)):n.data.indexBuffer.setData(a))}},e}();t.default=n}.apply(null,i))||(e.exports=n)},2017:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(50),r(100),r(53),r(1582),r(1850)],void 0===(n=function(e,t,r,i,n,a,o,s){Object.defineProperty(t,"__esModule",{value:!0});var l=new n;function u(e,t,r){if(!e)return null;var n=0,o={},s=e.clone(),u=s.visualVariables,f=null;if("simple"!==s.type){var d=s.field,p=s.valueExpression;if(!d&&p){var c="$$fake"+n++,h=a.createFunction(p);o[c]=function(e,i){return l.repurposeFromGraphicLikeObject(e.geometry,e.attributes,r),a.executeFunction(h,{vars:{$feature:l,$view:a.getViewInfo(i)},spatialReference:t})},s.field=c,s.valueExpression=null,f=function(e,t){return t.attributes[c]=o[c](t),e.valueExpression?e.getSymbol(i.fromJSON(t)):e.getSymbol(t)}}}return u&&(s.visualVariables=u.map(function(e){var i="size"===e.type&&e.valueExpression&&"$view.scale"===e.valueExpression;if(e.normalizationField){var s=e.field,u=e.normalizationField,f="$$fake"+n++;return o[f]=function(e,t){return e.attributes[s]/e.attributes[u]},(d=e.clone()).field=f,d.normalizationField=null,d}if(!e.valueExpression||i)return e;var d,p=e.valueExpression,c=(f="$$fake"+n++,a.createFunction(p));return o[f]=function(e,i){return l.repurposeFromGraphicLikeObject(e.geometry,e.attributes,r),a.executeFunction(c,{vars:{$feature:l,$view:a.getViewInfo(i)},spatialReference:t})},(d=e.clone()).field=f,d.valueExpression=null,d})),{renderer:s,normalizingFunctions:o,getSymbolFunction:f}}t.createRendererInfo=function(e,t,r){var i=u(e,t,r)||{renderer:null,normalizingFunctions:null,getSymbolFunction:null},n=i&&i.normalizingFunctions,a=i&&i.getSymbolFunction;e=i&&i.renderer||e;var o=s.convertVisualVariables(e.visualVariables);return{renderer:e,vvFields:o.vvFields,vvRanges:o.vvRanges,getValue:function(e,t){var r=n[t];return r?r(e):e.attributes[t]},getSymbol:function(e){return a?a(this.renderer,e):this.renderer.getSymbol?this.renderer.getSymbol.call(this.renderer,e):null}}},t.getNormalizedRenderer=function(e,t,r){var i=u(e,t,r)||{renderer:null,normalizingFunctions:null,getSymbolFunction:null};return i&&i.renderer||e},t.getSymbol=function(e,t){return e.getSymbol(t)},t.isRendererWebGLCompatible=function(e){if(!e)return!1;if(-1===["simple","class-breaks","unique-value","heatmap"].indexOf(e.type))return!1;if("visualVariables"in e&&e.visualVariables)for(var t=0,r=e.visualVariables;t<r.length;t++){var i=r[t];switch(i.type){case"color":case"opacity":if(i.stops&&8<i.stops.length)return!1;break;case"size":if(s.getTypeOfSizeVisualVariable(i)===o.WGLVVFlag.SIZE_FIELD_STOPS&&i.stops&&6<i.stops.length)return!1}}return!0}}.apply(null,i))||(e.exports=n)},2018:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(0),r(4),r(1602),r(1)],void 0===(n=function(e,t,r,i,n,a,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var r=e.call(this)||this;return r.tiles=new Map,r.layer=null,r}return r(t,e),t.prototype.destroy=function(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.highlightOptions=this.configuration=this.tiles=null},Object.defineProperty(t.prototype,"updating",{get:function(){return this.isUpdating()},enumerable:!0,configurable:!0}),t.prototype.acquireTile=function(e){var t=this,r=this.createTile(e);return r.once("isReady",function(){return t.notifyChange("updating")}),this.tiles.set(e.id,r),r},t.prototype.forEachTile=function(e){this.tiles.forEach(e)},t.prototype.releaseTile=function(e){this.tiles.delete(e.key.id),this.disposeTile(e)},t.prototype.isUpdating=function(){var e=!0;return this.tiles.forEach(function(t){e=e&&t.isReady}),!e},t.prototype.requestUpdate=function(){this.layerView.requestUpdate()},i([o.property()],t.prototype,"configuration",void 0),i([o.property()],t.prototype,"highlightOptions",void 0),i([o.property()],t.prototype,"layer",void 0),i([o.property()],t.prototype,"layerView",void 0),i([o.property()],t.prototype,"tileInfoView",void 0),i([o.property()],t.prototype,"updating",null),i([o.subclass()],t)}(o.declared(n,a));t.default=s}.apply(null,i))||(e.exports=n)},2488:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(0),r(10),r(538),r(4),r(9),r(27),r(1),r(72),r(525),r(53),r(2017),r(1850),r(2489),r(1818),r(2018)],void 0===(n=function(e,t,r,i,n,a,o,s,l,u,f,d,p,c,h,y,v,g){function m(e){if(!("visualVariables"in e&&e.visualVariables&&e.visualVariables.length))return e;var t=e.clone(),r=t.visualVariables.map(function(e){return function(e){return("size"===e.type||"color"===e.type||"opacity"===e.type)&&null!=e.stops}(e)?function(e){return e.stops=function(e,t){return t.length<=b?t:(x.warn("Found "+t.length+" Visual Variable stops, but MapView only supports "+b+". Displayed stops will be simplified."),t.length>2*b?function(e,t){for(var r=t[0],i=t.slice(1),n=i.pop(),a=i[0].value,o=i[i.length-1].value,s=(o-a)/L,u=[],f=a;f<o;f+=s){for(var d=0;f>=i[d].value;)d++;var p=i[d],c=t[d-1],h=f-c.value,y=p.value===c.value?1:h/(p.value-c.value);if("color"===e){var v=i[d],g=t[d-1],m=v.color.clone();m.r=_(g.color.r,m.r,y),m.g=_(g.color.g,m.g,y),m.b=_(g.color.b,m.b,y),m.a=_(g.color.a,m.a,y),u.push({value:f,color:m,label:v.label})}else if("size"===e){var x=i[d],b=t[d-1],I=l.toPt(x.size),D=l.toPt(b.size),T=_(D,I,y);u.push({value:f,size:T,label:x.label})}else{var w=i[d],B=t[d-1],F=_(B.opacity,w.opacity,y);u.push({value:f,opacity:F,label:w.label})}}return[r].concat(u,[n])}(e,t):function(e){for(var t=e[0],r=e.slice(1),i=r.pop();r.length>L;){for(var n=0,a=0,o=1;o<r.length;o++){var s=r[o-1],l=r[o],u=Math.abs(l.value-s.value);u>a&&(a=u,n=o)}r.splice(n,1)}return[t].concat(r,[i])}(t))}(e.type,e.stops),e}(e):e});return t.visualVariables=r,t}function _(e,t,r){return(1-r)*e+r*t}Object.defineProperty(t,"__esModule",{value:!0});var x=s.getLogger("esri.views.2d.layers.features.tileRenderer.SymbolTileRenderer"),b=8,L=b-2,I=function(e){function t(t){return e.call(this)||this}return r(t,e),t.prototype.createTile=function(e){var t=f.create();return this.tileInfoView.getTileBounds(t,e),new v(e,t)},t.prototype.disposeTile=function(e){this.featuresView.removeChild(e)},t.prototype.highlight=function(e){return this.featuresView.highlight(e)},t.prototype.hitTest=function(e,t){return this.featuresView.hitTest(e,t)},t.prototype.supportsRenderer=function(e){return null!=e&&c.isRendererWebGLCompatible(e)&&-1!==["simple","class-breaks","unique-value"].indexOf(e.type)},t.prototype.getProcessorConfiguration=function(){var e=this.layer,t=m(e.renderer);return{type:"symbol",renderer:t.toJSON(),devicePixelRatio:window.devicePixelRatio||1,definitionExpression:e.definitionExpression,outFields:e.outFields.slice().sort(),gdbVersion:e.gdbVersion,historicMoment:e.historicMoment&&e.historicMoment.getTime(),labelingInfo:e.labelingInfo&&e.labelingInfo.map(function(e){return e.toJSON()}),hasGeometryExpr:p.hasGeometryOperations(t)||e.labelingInfo&&e.labelingInfo.some(function(e){return p.hasGeometryOperations(e)})}},t.prototype.needsProcessorReconfiguration=function(e){var t=this.wouldClear(e),r=this.configuration;return this.configuration=e,t||r.definitionExpression!==e.definitionExpression},t.prototype.wouldClear=function(e){var t=this.configuration;if(!t||t.outFields.join()!==e.outFields.join()||d.diff(t.labelingInfo,e.labelingInfo))return!0;var r=this.configuration&&a.fromJSON(this.configuration.renderer)||null,i=e&&a.fromJSON(e.renderer)||null,n=d.diff(r,i);if(!n)return!1;switch(n.type){case"complete":return!0;case"partial":if(function(e){for(var t in e.diff){var r=e.diff[t];if("collection"===r.type){if(0!==r.changed.length||0!==r.added.length||0!==r.removed.length)return!0}else if("visualVariables"!==t&&"authoringInfo"!==t)return!0}return!1}(n))return!0;if(n.diff.visualVariables){var o=this.featuresView.visualVariablesInfo,s=this.tileInfoView.tileInfo.spatialReference,l={fields:this.layer.fields.map(function(e){return e.toJSON()})},u=c.getNormalizedRenderer(i,s,l),f=h.convertVisualVariables(u.visualVariables).vvFields;return!!d.diff(o.vvFields,f)}}},t.prototype.clear=function(){this.featuresView.disposeWebGLResources()},t.prototype.applyConfiguration=function(e){var t=a.fromJSON(e.renderer),r={fields:this.layer.fields.map(function(e){return e.toJSON()})},i=c.getNormalizedRenderer(t,this.tileInfoView.tileInfo.spatialReference,r);this.configuration=e,this.featuresView.visualVariablesInfo=h.convertVisualVariables(i.visualVariables)},t.prototype.install=function(e){var t=new y.default({highlightOptions:this.highlightOptions,tileInfoView:this.tileInfoView,layer:this.layer,layerView:this.layerView});this.featuresView=t,e.addChild(t)},t.prototype.uninstall=function(e){e.removeChild(this.featuresView),this.featuresView=null},t.prototype.onTileData=function(e){var t=this.tiles.get(e.tileKey);t&&this.featuresView.onTileData(t,e.data)},t.prototype.onTileError=function(e){var t=this.tiles.get(e.tileKey);t&&this.featuresView.onTileError(t)},t.prototype.getMaterialItems=function(e){return this.featuresView.getMaterialItems(e)},i([u.subclass()],t)}(u.declared(o,g.default));t.default=I}.apply(null,i))||(e.exports=n)},2489:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(26),r(7),r(7),r(22),r(1627),r(1812),r(1582),r(1579),r(1811)],void 0===(n=function(e,t,r,i,n,a,o,s,l,u,f,d){Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){function t(t){var r=e.call(this)||this;return r._rendererInfo=new d,r._pointToCallbacks=new Map,r._highlightIDs=new Set,r._invisibleFeatures=new Set,r._displayWidth=0,r._displayHeight=0,r._highlightOptionsUpToDate=!1,r.layer=null,r.highlightOptions=t.highlightOptions,r.tileInfoView=t.tileInfoView,r.layer=t.layer,r._layerView=t.layerView,r}return i(t,e),t.prototype.dispose=function(){this.removeAllChildren();for(var e=0,t=this.children;e<t.length;e++)t[e].dispose()},t.prototype.disposeWebGLResources=function(){for(var e=0,t=this.children;e<t.length;e++)t[e].clear()},t.prototype.displayWidth=function(){return this._displayWidth},Object.defineProperty(t.prototype,"displayHeight",{get:function(){return this._displayHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(e){this._highlightOptions=e,this._highlightOptionsUpToDate=!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visualVariablesInfo",{get:function(){return this._visualVariablesInfo},set:function(e){this._visualVariablesInfo=e,this.requestRender()},enumerable:!0,configurable:!0}),t.prototype.hitTest=function(e,t){var r=this,i=[e,t];return n.create(function(e,t){r._pointToCallbacks.set(i,{resolve:e,reject:t}),r.requestRender()},function(){r._pointToCallbacks.has(i)&&r._pointToCallbacks.delete(i)})},t.prototype.highlight=function(e){var t=this;return t.addHighlight(e),{remove:function(){t.removeHighlight(e)}}},t.prototype.setHighlight=function(e){this._highlightIDs.clear(),this.addHighlight(e)},t.prototype.setVisibility=function(e,t){e||(e=[]),t||(t=[]);for(var r=this._invisibleFeatures,i=0,n=e;i<n.length;i++){var a=n[i];r.has(a)&&r.delete(a)}for(var o=0,s=t;o<s.length;o++){var l=s[o];r.add(l)}for(var u=0,f=this.children;u<f.length;u++){var d=f[u];d.data&&d.setVisibility(e,t)}},t.prototype.addHighlight=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];this._highlightIDs.add(i)}this._buildHLList()},t.prototype.removeHighlight=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];this._highlightIDs.delete(i)}this._buildHLList()},t.prototype.whenAttached=function(){var e=this;return this.attached?n.resolve():n.create(function(t){return e.once("attached",function(){return t()})})},t.prototype.getMaterialItems=function(e){var t=this;return this.whenAttached().then(function(){var r=e;if(t.stage&&r&&0!==r.length){for(var i=[],n=t.stage.painter.textureManager,o=0,s=r;o<s.length;o++){var l=s[o];i.push(n.rasterizeItem(l.symbol,l.glyphIds))}return a.all(i).then(function(e){return e.map(function(e,t){return{id:t,mosaicItem:e}})})}})},t.prototype.onTileData=function(e,t){var i=!(!this.layer.labelingInfo||!this.layer.labelingInfo.length),n=t.addOrUpdate&&l.decode(t.addOrUpdate),a=r({},t,{addOrUpdate:n});e.setData(a,i,this.layer.labelsVisible),e.resetVisibility(this._invisibleFeatures),e.buildHLList(this._highlightIDs),this.contains(e)||this.addChild(e),this.requestRender(),this._layerView&&this._layerView.view.labelManager.requestUpdate()},t.prototype.onTileError=function(e){e.clear(),e.buildHLList(this._highlightIDs),this.contains(e)||this.addChild(e),this.requestRender()},t.prototype.addChild=function(t){var r=e.prototype.addChild.call(this,t);return this.layer.labelingInfo&&this._layerView&&this._layerView.view.labelManager.addTile(this.layer.uid,t),this._buildHLList(),r},t.prototype.removeChild=function(t){var r=e.prototype.removeChild.call(this,t);return this.layer.labelingInfo&&this._layerView&&this._layerView.view.labelManager.removeTile(this.layer.uid,t.key.id),this._buildHLList(),r},t.prototype.renderChildren=function(e){var t=this,i=this.stage.painter;this._updateTilesTransform(e.state,this.tileInfoView.getClosestInfoForScale(e.state.scale).level),this._updateHighlightOptions(),this._rendererInfo.updateVisualVariables(this._visualVariablesInfo.vvRanges,e.state);var n=this.tileInfoView.getClosestInfoForScale(e.state.scale).level,a=this.tileInfoView.tileInfo.scaleToZoom(e.state.scale),o=r({},e,{rendererInfo:this._rendererInfo,requiredLevel:n,displayLevel:a,context:this.stage.context,painter:this.stage.painter});this._rendererInfo.updateVisualVariables(this._visualVariablesInfo.vvRanges,o.state),this.sortChildren(function(e,t){return e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col});var s=o.drawPhase;if(s&(u.WGLDrawPhase.LABEL|u.WGLDrawPhase.LABEL_ALPHA)){var l=this.layer;if(!(l.labelsVisible&&l.labelingInfo&&0<l.labelingInfo.length))return;this._updateTilesTransform(o.state,o.requiredLevel)}i.draw(o,this.children,s,this._painterOptions),0<this._highlightIDs.size&&i.highlight(o,this.children),0!==this._pointToCallbacks.size&&(this._pointToCallbacks.forEach(function(e,r){e.resolve(t._hitTest(o,r[0],r[1]))}),this._pointToCallbacks.clear())},t.prototype._hitTest=function(e,t,r){var i=this.stage,n=i.painter,a=i.context,s=e.requiredLevel,l=[0,0];e.state.toMap(l,[t,r]);var d=e.state.clone(),p=d.viewpoint.clone();return p.targetGeometry=new o(l[0],l[1],e.state.spatialReference),d.viewpoint=p,d.size=[f.C_HITTEST_SEARCH_SIZE,f.C_HITTEST_SEARCH_SIZE],this._updateTilesTransform(d,s),n.hitTest({globalOpacity:1,painter:n,context:a,drawPhase:u.WGLDrawPhase.HITTEST,pixelRatio:e.pixelRatio,displayLevel:e.displayLevel,rendererInfo:this._rendererInfo,requiredLevel:s,state:d,stationary:e.stationary},this.children)},t.prototype._updateTilesTransform=function(e,t){for(var r=0,i=this.children;r<i.length;r++){var n=i[r],a=this.tileInfoView.tileInfo.lods[n.key.level].resolution,o=a/(e.resolution*e.pixelRatio);n.setTransform(e,o),n.setLabelTransform(e,a)}},t.prototype._updateHighlightOptions=function(){if(!this._highlightOptionsUpToDate&&this.parent){var e=this.stage.painter,t=this._highlightOptions;if(e){var r=t.color.toRgba();r[0]/=255,r[1]/=255,r[2]/=255;var i=r.slice();r[3]*=t.fillOpacity,i[3]*=t.haloOpacity,e.setHighlightOptions({fillColor:r,outlineColor:i,outlineWidth:2,outerHaloWidth:.3,innerHaloWidth:.3,outlinePosition:0}),this._highlightOptionsUpToDate=!0}}},t.prototype._buildHLList=function(){for(var e=0,t=this.children;e<t.length;e++)t[e].buildHLList(this._highlightIDs);this.requestRender()},t}(s.Container);t.default=p}.apply(null,i))||(e.exports=n)}}]);